# data


```python
import torch 
import importlib
import monotonic
import data_manager
import metrics
import utils
importlib.reload(utils)
import train as Train
from train import execute_model_evaluation
import train_config
from data_manager import DatasetManager
from train_config import FlatACLConfig, FlatDLinearConfig, FlatNaiveConfig, FlatPatchTSTConfig, FlatTimeMixerConfig
from dataclasses import replace

%load_ext autoreload
%autoreload 2
modules_to_reload_list = [
    data_manager,
    Train,
    train_config,
    monotonic,
    # data_manager, # Reloaded only once even if listed twice
    utils,
    # train_config, # Reloaded only once even if listed twice
    metrics
]
data_mgr = DatasetManager(device='cuda')

# Load a synthetic dataset
data_mgr.load_csv('etth1', './etth1.csv')
```

    
    ==================================================
    Dataset: etth1 (csv)
    ==================================================
    Shape: torch.Size([17420, 7])
    Channels: 7
    Length: 17420
    Source: ./etth1.csv
    
    Sample data (first 2 rows):
    tensor([[ 5.8270,  2.0090,  1.5990,  0.4620,  4.2030,  1.3400, 30.5310],
            [ 5.6930,  2.0760,  1.4920,  0.4260,  4.1420,  1.3710, 27.7870]])
    ==================================================
    




    <data_manager.DatasetManager at 0x14d9c556f60>



## Seq=196

### EigenACL

#### pred=96


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=196,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 15.9581, mae: 2.2052, huber: 1.8037, swd: 7.7195, ept: 31.3875
    Epoch [1/50], Val Losses: mse: 9.1330, mae: 1.6334, huber: 1.2648, swd: 1.6973, ept: 45.4527
    Epoch [1/50], Test Losses: mse: 13.6672, mae: 1.9859, huber: 1.6035, swd: 3.3078, ept: 32.6439
      Epoch 1 composite train-obj: 1.803664
            Val objective improved inf → 1.2648, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0902, mae: 1.5847, huber: 1.2047, swd: 2.0486, ept: 44.1402
    Epoch [2/50], Val Losses: mse: 8.5081, mae: 1.6048, huber: 1.2349, swd: 1.1542, ept: 43.4052
    Epoch [2/50], Test Losses: mse: 11.1000, mae: 1.8709, huber: 1.4894, swd: 2.1339, ept: 33.2841
      Epoch 2 composite train-obj: 1.204707
            Val objective improved 1.2648 → 1.2349, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.3625, mae: 1.5119, huber: 1.1372, swd: 1.7731, ept: 46.4026
    Epoch [3/50], Val Losses: mse: 8.2565, mae: 1.5801, huber: 1.2164, swd: 1.8433, ept: 45.2124
    Epoch [3/50], Test Losses: mse: 10.1950, mae: 1.8031, huber: 1.4270, swd: 2.6442, ept: 35.1931
      Epoch 3 composite train-obj: 1.137166
            Val objective improved 1.2349 → 1.2164, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.1873, mae: 1.4917, huber: 1.1196, swd: 1.7548, ept: 47.5205
    Epoch [4/50], Val Losses: mse: 8.0379, mae: 1.5385, huber: 1.1759, swd: 1.3275, ept: 45.8348
    Epoch [4/50], Test Losses: mse: 10.0885, mae: 1.7775, huber: 1.4027, swd: 2.2251, ept: 36.3136
      Epoch 4 composite train-obj: 1.119576
            Val objective improved 1.2164 → 1.1759, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 5.8945, mae: 1.4455, huber: 1.0766, swd: 1.5558, ept: 49.0562
    Epoch [5/50], Val Losses: mse: 7.8274, mae: 1.5129, huber: 1.1527, swd: 1.3518, ept: 47.0514
    Epoch [5/50], Test Losses: mse: 9.9489, mae: 1.7475, huber: 1.3759, swd: 2.0719, ept: 37.3271
      Epoch 5 composite train-obj: 1.076554
            Val objective improved 1.1759 → 1.1527, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 5.7937, mae: 1.4306, huber: 1.0627, swd: 1.5012, ept: 49.5665
    Epoch [6/50], Val Losses: mse: 8.0871, mae: 1.5489, huber: 1.1877, swd: 1.7429, ept: 47.3331
    Epoch [6/50], Test Losses: mse: 9.8043, mae: 1.7502, huber: 1.3780, swd: 2.3257, ept: 37.6900
      Epoch 6 composite train-obj: 1.062736
            No improvement (1.1877), counter 1/5
    Epoch [7/50], Train Losses: mse: 5.6872, mae: 1.4126, huber: 1.0462, swd: 1.4367, ept: 50.3025
    Epoch [7/50], Val Losses: mse: 7.9093, mae: 1.5438, huber: 1.1817, swd: 1.8149, ept: 47.3146
    Epoch [7/50], Test Losses: mse: 9.8250, mae: 1.7500, huber: 1.3769, swd: 2.3383, ept: 37.4612
      Epoch 7 composite train-obj: 1.046194
            No improvement (1.1817), counter 2/5
    Epoch [8/50], Train Losses: mse: 5.7219, mae: 1.4178, huber: 1.0510, swd: 1.4874, ept: 50.4330
    Epoch [8/50], Val Losses: mse: 7.8167, mae: 1.5412, huber: 1.1790, swd: 1.9443, ept: 47.8423
    Epoch [8/50], Test Losses: mse: 10.1223, mae: 1.7745, huber: 1.4008, swd: 2.7039, ept: 37.5136
      Epoch 8 composite train-obj: 1.050986
            No improvement (1.1790), counter 3/5
    Epoch [9/50], Train Losses: mse: 5.5902, mae: 1.3961, huber: 1.0308, swd: 1.4012, ept: 50.9069
    Epoch [9/50], Val Losses: mse: 7.9425, mae: 1.5420, huber: 1.1815, swd: 1.8105, ept: 48.2245
    Epoch [9/50], Test Losses: mse: 9.9032, mae: 1.7482, huber: 1.3764, swd: 2.3928, ept: 38.1884
      Epoch 9 composite train-obj: 1.030755
            No improvement (1.1815), counter 4/5
    Epoch [10/50], Train Losses: mse: 5.5443, mae: 1.3871, huber: 1.0226, swd: 1.3940, ept: 51.3934
    Epoch [10/50], Val Losses: mse: 7.7608, mae: 1.5063, huber: 1.1449, swd: 1.3501, ept: 47.1411
    Epoch [10/50], Test Losses: mse: 10.2377, mae: 1.7617, huber: 1.3888, swd: 2.0609, ept: 38.3419
      Epoch 10 composite train-obj: 1.022585
            Val objective improved 1.1527 → 1.1449, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 5.4846, mae: 1.3795, huber: 1.0154, swd: 1.3751, ept: 51.6879
    Epoch [11/50], Val Losses: mse: 8.0359, mae: 1.5330, huber: 1.1731, swd: 1.5749, ept: 48.4241
    Epoch [11/50], Test Losses: mse: 9.9300, mae: 1.7409, huber: 1.3697, swd: 2.1435, ept: 39.2154
      Epoch 11 composite train-obj: 1.015404
            No improvement (1.1731), counter 1/5
    Epoch [12/50], Train Losses: mse: 5.3479, mae: 1.3590, huber: 0.9963, swd: 1.2925, ept: 52.0923
    Epoch [12/50], Val Losses: mse: 7.8127, mae: 1.5261, huber: 1.1656, swd: 1.7251, ept: 48.5608
    Epoch [12/50], Test Losses: mse: 10.0019, mae: 1.7547, huber: 1.3809, swd: 2.2700, ept: 38.3710
      Epoch 12 composite train-obj: 0.996268
            No improvement (1.1656), counter 2/5
    Epoch [13/50], Train Losses: mse: 5.3021, mae: 1.3549, huber: 0.9921, swd: 1.2885, ept: 52.1737
    Epoch [13/50], Val Losses: mse: 8.0622, mae: 1.5569, huber: 1.1957, swd: 1.9059, ept: 48.3539
    Epoch [13/50], Test Losses: mse: 10.1762, mae: 1.7688, huber: 1.3962, swd: 2.5431, ept: 38.7411
      Epoch 13 composite train-obj: 0.992081
            No improvement (1.1957), counter 3/5
    Epoch [14/50], Train Losses: mse: 5.2533, mae: 1.3487, huber: 0.9864, swd: 1.2814, ept: 52.4200
    Epoch [14/50], Val Losses: mse: 8.0853, mae: 1.5454, huber: 1.1853, swd: 1.7423, ept: 49.0393
    Epoch [14/50], Test Losses: mse: 10.3075, mae: 1.7563, huber: 1.3851, swd: 2.2909, ept: 38.8454
      Epoch 14 composite train-obj: 0.986380
            No improvement (1.1853), counter 4/5
    Epoch [15/50], Train Losses: mse: 5.1663, mae: 1.3368, huber: 0.9752, swd: 1.2474, ept: 52.7121
    Epoch [15/50], Val Losses: mse: 8.0894, mae: 1.5570, huber: 1.1954, swd: 1.7174, ept: 48.4140
    Epoch [15/50], Test Losses: mse: 10.4217, mae: 1.7596, huber: 1.3885, swd: 2.2352, ept: 39.0665
      Epoch 15 composite train-obj: 0.975239
    Epoch [15/50], Test Losses: mse: 10.2383, mae: 1.7618, huber: 1.3888, swd: 2.0609, ept: 38.3326
    Best round's Test MSE: 10.2377, MAE: 1.7617, SWD: 2.0609
    Best round's Validation MSE: 7.7608, MAE: 1.5063, SWD: 1.3501
    Best round's Test verification MSE : 10.2383, MAE: 1.7618, SWD: 2.0609
    Time taken: 37.13 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.3438, mae: 2.2306, huber: 1.8281, swd: 7.8983, ept: 31.7345
    Epoch [1/50], Val Losses: mse: 9.1904, mae: 1.6375, huber: 1.2698, swd: 1.6535, ept: 45.2398
    Epoch [1/50], Test Losses: mse: 13.5576, mae: 1.9796, huber: 1.5975, swd: 3.1778, ept: 32.8458
      Epoch 1 composite train-obj: 1.828137
            Val objective improved inf → 1.2698, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0617, mae: 1.5843, huber: 1.2047, swd: 1.9566, ept: 44.0553
    Epoch [2/50], Val Losses: mse: 8.5378, mae: 1.5998, huber: 1.2323, swd: 1.2841, ept: 43.6976
    Epoch [2/50], Test Losses: mse: 11.0232, mae: 1.8550, huber: 1.4750, swd: 2.2554, ept: 33.3722
      Epoch 2 composite train-obj: 1.204683
            Val objective improved 1.2698 → 1.2323, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.3844, mae: 1.5145, huber: 1.1399, swd: 1.6924, ept: 46.2396
    Epoch [3/50], Val Losses: mse: 8.2754, mae: 1.5882, huber: 1.2239, swd: 1.9391, ept: 45.6662
    Epoch [3/50], Test Losses: mse: 10.3544, mae: 1.8164, huber: 1.4394, swd: 2.7666, ept: 34.9691
      Epoch 3 composite train-obj: 1.139915
            Val objective improved 1.2323 → 1.2239, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.1006, mae: 1.4755, huber: 1.1046, swd: 1.5729, ept: 47.9548
    Epoch [4/50], Val Losses: mse: 8.1277, mae: 1.5418, huber: 1.1809, swd: 1.2592, ept: 45.8551
    Epoch [4/50], Test Losses: mse: 10.2368, mae: 1.7770, huber: 1.4042, swd: 1.9841, ept: 36.2791
      Epoch 4 composite train-obj: 1.104554
            Val objective improved 1.2239 → 1.1809, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 5.9471, mae: 1.4517, huber: 1.0829, swd: 1.5047, ept: 49.0822
    Epoch [5/50], Val Losses: mse: 8.1175, mae: 1.5887, huber: 1.2238, swd: 2.1177, ept: 46.1384
    Epoch [5/50], Test Losses: mse: 10.0770, mae: 1.7938, huber: 1.4180, swd: 2.7065, ept: 36.0115
      Epoch 5 composite train-obj: 1.082889
            No improvement (1.2238), counter 1/5
    Epoch [6/50], Train Losses: mse: 5.8049, mae: 1.4300, huber: 1.0627, swd: 1.4328, ept: 49.9126
    Epoch [6/50], Val Losses: mse: 7.9585, mae: 1.5354, huber: 1.1751, swd: 1.6119, ept: 47.3826
    Epoch [6/50], Test Losses: mse: 9.9701, mae: 1.7466, huber: 1.3743, swd: 2.1034, ept: 37.6879
      Epoch 6 composite train-obj: 1.062703
            Val objective improved 1.1809 → 1.1751, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 5.7635, mae: 1.4229, huber: 1.0562, swd: 1.4247, ept: 50.4034
    Epoch [7/50], Val Losses: mse: 8.1200, mae: 1.5510, huber: 1.1907, swd: 1.6708, ept: 47.0367
    Epoch [7/50], Test Losses: mse: 9.9275, mae: 1.7481, huber: 1.3762, swd: 2.1222, ept: 37.6933
      Epoch 7 composite train-obj: 1.056176
            No improvement (1.1907), counter 1/5
    Epoch [8/50], Train Losses: mse: 5.6666, mae: 1.4066, huber: 1.0410, swd: 1.3766, ept: 50.9700
    Epoch [8/50], Val Losses: mse: 7.8894, mae: 1.5223, huber: 1.1631, swd: 1.5736, ept: 47.5830
    Epoch [8/50], Test Losses: mse: 10.0016, mae: 1.7480, huber: 1.3757, swd: 2.0134, ept: 37.4962
      Epoch 8 composite train-obj: 1.041034
            Val objective improved 1.1751 → 1.1631, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 5.5753, mae: 1.3941, huber: 1.0292, swd: 1.3275, ept: 51.2935
    Epoch [9/50], Val Losses: mse: 7.9240, mae: 1.5251, huber: 1.1660, swd: 1.5222, ept: 47.2864
    Epoch [9/50], Test Losses: mse: 10.0442, mae: 1.7497, huber: 1.3777, swd: 2.0504, ept: 37.9608
      Epoch 9 composite train-obj: 1.029162
            No improvement (1.1660), counter 1/5
    Epoch [10/50], Train Losses: mse: 5.5190, mae: 1.3872, huber: 1.0226, swd: 1.3117, ept: 51.5153
    Epoch [10/50], Val Losses: mse: 7.9597, mae: 1.5351, huber: 1.1756, swd: 1.7170, ept: 48.0973
    Epoch [10/50], Test Losses: mse: 10.1313, mae: 1.7564, huber: 1.3850, swd: 2.3366, ept: 38.0699
      Epoch 10 composite train-obj: 1.022555
            No improvement (1.1756), counter 2/5
    Epoch [11/50], Train Losses: mse: 5.4180, mae: 1.3709, huber: 1.0072, swd: 1.2637, ept: 51.8569
    Epoch [11/50], Val Losses: mse: 8.2965, mae: 1.5657, huber: 1.2047, swd: 1.7379, ept: 47.6733
    Epoch [11/50], Test Losses: mse: 10.0573, mae: 1.7567, huber: 1.3834, swd: 2.1393, ept: 38.0016
      Epoch 11 composite train-obj: 1.007200
            No improvement (1.2047), counter 3/5
    Epoch [12/50], Train Losses: mse: 5.3640, mae: 1.3644, huber: 1.0010, swd: 1.2545, ept: 52.1829
    Epoch [12/50], Val Losses: mse: 7.9203, mae: 1.5230, huber: 1.1638, swd: 1.5565, ept: 47.7533
    Epoch [12/50], Test Losses: mse: 10.2903, mae: 1.7572, huber: 1.3855, swd: 2.0853, ept: 38.5307
      Epoch 12 composite train-obj: 1.001027
            No improvement (1.1638), counter 4/5
    Epoch [13/50], Train Losses: mse: 5.2760, mae: 1.3517, huber: 0.9893, swd: 1.2170, ept: 52.3260
    Epoch [13/50], Val Losses: mse: 8.3164, mae: 1.5888, huber: 1.2258, swd: 1.9699, ept: 48.5033
    Epoch [13/50], Test Losses: mse: 10.2671, mae: 1.7764, huber: 1.4029, swd: 2.5274, ept: 38.0323
      Epoch 13 composite train-obj: 0.989274
    Epoch [13/50], Test Losses: mse: 10.0020, mae: 1.7480, huber: 1.3757, swd: 2.0133, ept: 37.5046
    Best round's Test MSE: 10.0016, MAE: 1.7480, SWD: 2.0134
    Best round's Validation MSE: 7.8894, MAE: 1.5223, SWD: 1.5736
    Best round's Test verification MSE : 10.0020, MAE: 1.7480, SWD: 2.0133
    Time taken: 31.66 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.8693, mae: 2.2734, huber: 1.8694, swd: 7.9813, ept: 31.1584
    Epoch [1/50], Val Losses: mse: 9.2317, mae: 1.6539, huber: 1.2844, swd: 1.7562, ept: 45.0433
    Epoch [1/50], Test Losses: mse: 13.5313, mae: 1.9963, huber: 1.6128, swd: 3.4545, ept: 32.2219
      Epoch 1 composite train-obj: 1.869442
            Val objective improved inf → 1.2844, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0235, mae: 1.5774, huber: 1.1979, swd: 1.8886, ept: 44.2370
    Epoch [2/50], Val Losses: mse: 8.4257, mae: 1.5771, huber: 1.2125, swd: 1.2562, ept: 45.2808
    Epoch [2/50], Test Losses: mse: 10.8695, mae: 1.8445, huber: 1.4663, swd: 2.3854, ept: 33.9186
      Epoch 2 composite train-obj: 1.197861
            Val objective improved 1.2844 → 1.2125, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.3237, mae: 1.5056, huber: 1.1315, swd: 1.6241, ept: 46.5561
    Epoch [3/50], Val Losses: mse: 8.2464, mae: 1.5553, huber: 1.1931, swd: 1.3963, ept: 45.8529
    Epoch [3/50], Test Losses: mse: 10.1346, mae: 1.7872, huber: 1.4125, swd: 2.3140, ept: 35.3477
      Epoch 3 composite train-obj: 1.131483
            Val objective improved 1.2125 → 1.1931, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.0675, mae: 1.4714, huber: 1.1005, swd: 1.5321, ept: 48.1167
    Epoch [4/50], Val Losses: mse: 8.1046, mae: 1.5755, huber: 1.2111, swd: 1.8926, ept: 45.9302
    Epoch [4/50], Test Losses: mse: 10.0086, mae: 1.7893, huber: 1.4136, swd: 2.7101, ept: 35.5631
      Epoch 4 composite train-obj: 1.100489
            No improvement (1.2111), counter 1/5
    Epoch [5/50], Train Losses: mse: 5.9524, mae: 1.4523, huber: 1.0834, swd: 1.4877, ept: 49.1751
    Epoch [5/50], Val Losses: mse: 8.0097, mae: 1.5310, huber: 1.1714, swd: 1.4682, ept: 47.4575
    Epoch [5/50], Test Losses: mse: 9.7271, mae: 1.7340, huber: 1.3629, swd: 2.1104, ept: 37.5453
      Epoch 5 composite train-obj: 1.083446
            Val objective improved 1.1931 → 1.1714, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 5.7785, mae: 1.4244, huber: 1.0575, swd: 1.3756, ept: 50.1048
    Epoch [6/50], Val Losses: mse: 7.9707, mae: 1.5289, huber: 1.1696, swd: 1.4916, ept: 47.8460
    Epoch [6/50], Test Losses: mse: 9.8238, mae: 1.7358, huber: 1.3652, swd: 2.1617, ept: 38.1144
      Epoch 6 composite train-obj: 1.057492
            Val objective improved 1.1714 → 1.1696, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 5.7055, mae: 1.4126, huber: 1.0466, swd: 1.3454, ept: 50.5607
    Epoch [7/50], Val Losses: mse: 7.9095, mae: 1.5152, huber: 1.1539, swd: 1.2474, ept: 46.9684
    Epoch [7/50], Test Losses: mse: 9.9735, mae: 1.7394, huber: 1.3673, swd: 1.9248, ept: 38.3929
      Epoch 7 composite train-obj: 1.046587
            Val objective improved 1.1696 → 1.1539, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 5.6482, mae: 1.4017, huber: 1.0365, swd: 1.3162, ept: 51.0741
    Epoch [8/50], Val Losses: mse: 7.7941, mae: 1.5142, huber: 1.1548, swd: 1.5378, ept: 48.0532
    Epoch [8/50], Test Losses: mse: 9.9109, mae: 1.7438, huber: 1.3722, swd: 2.2683, ept: 37.8433
      Epoch 8 composite train-obj: 1.036517
            No improvement (1.1548), counter 1/5
    Epoch [9/50], Train Losses: mse: 5.5665, mae: 1.3901, huber: 1.0257, swd: 1.2860, ept: 51.4729
    Epoch [9/50], Val Losses: mse: 7.6869, mae: 1.5190, huber: 1.1591, swd: 1.7203, ept: 48.6114
    Epoch [9/50], Test Losses: mse: 9.9888, mae: 1.7522, huber: 1.3801, swd: 2.4949, ept: 38.0292
      Epoch 9 composite train-obj: 1.025675
            No improvement (1.1591), counter 2/5
    Epoch [10/50], Train Losses: mse: 5.4872, mae: 1.3783, huber: 1.0145, swd: 1.2518, ept: 51.8521
    Epoch [10/50], Val Losses: mse: 7.8707, mae: 1.5198, huber: 1.1588, swd: 1.3642, ept: 47.7739
    Epoch [10/50], Test Losses: mse: 10.0017, mae: 1.7375, huber: 1.3660, swd: 2.0435, ept: 39.0089
      Epoch 10 composite train-obj: 1.014517
            No improvement (1.1588), counter 3/5
    Epoch [11/50], Train Losses: mse: 5.4210, mae: 1.3675, huber: 1.0044, swd: 1.2188, ept: 52.1118
    Epoch [11/50], Val Losses: mse: 7.8631, mae: 1.5126, huber: 1.1534, swd: 1.3239, ept: 48.2758
    Epoch [11/50], Test Losses: mse: 10.1524, mae: 1.7448, huber: 1.3730, swd: 1.9655, ept: 38.9812
      Epoch 11 composite train-obj: 1.004438
            Val objective improved 1.1539 → 1.1534, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 5.3633, mae: 1.3605, huber: 0.9979, swd: 1.2065, ept: 52.3916
    Epoch [12/50], Val Losses: mse: 7.9125, mae: 1.5426, huber: 1.1821, swd: 1.7879, ept: 48.6803
    Epoch [12/50], Test Losses: mse: 10.1745, mae: 1.7528, huber: 1.3812, swd: 2.4291, ept: 38.5369
      Epoch 12 composite train-obj: 0.997914
            No improvement (1.1821), counter 1/5
    Epoch [13/50], Train Losses: mse: 5.3754, mae: 1.3649, huber: 1.0020, swd: 1.2331, ept: 52.4456
    Epoch [13/50], Val Losses: mse: 7.8709, mae: 1.5209, huber: 1.1614, swd: 1.5215, ept: 48.8360
    Epoch [13/50], Test Losses: mse: 10.1901, mae: 1.7448, huber: 1.3737, swd: 2.1939, ept: 39.1632
      Epoch 13 composite train-obj: 1.001957
            No improvement (1.1614), counter 2/5
    Epoch [14/50], Train Losses: mse: 5.2351, mae: 1.3439, huber: 0.9823, swd: 1.1644, ept: 52.8272
    Epoch [14/50], Val Losses: mse: 7.9567, mae: 1.5433, huber: 1.1826, swd: 1.6372, ept: 48.6114
    Epoch [14/50], Test Losses: mse: 10.0895, mae: 1.7491, huber: 1.3768, swd: 2.2663, ept: 39.0408
      Epoch 14 composite train-obj: 0.982319
            No improvement (1.1826), counter 3/5
    Epoch [15/50], Train Losses: mse: 5.1484, mae: 1.3328, huber: 0.9718, swd: 1.1368, ept: 53.1417
    Epoch [15/50], Val Losses: mse: 8.2581, mae: 1.5602, huber: 1.1997, swd: 1.5763, ept: 48.7186
    Epoch [15/50], Test Losses: mse: 10.3285, mae: 1.7496, huber: 1.3795, swd: 2.1340, ept: 39.5696
      Epoch 15 composite train-obj: 0.971791
            No improvement (1.1997), counter 4/5
    Epoch [16/50], Train Losses: mse: 5.0523, mae: 1.3190, huber: 0.9586, swd: 1.0895, ept: 53.2797
    Epoch [16/50], Val Losses: mse: 8.0474, mae: 1.5531, huber: 1.1922, swd: 1.7672, ept: 48.5499
    Epoch [16/50], Test Losses: mse: 10.6050, mae: 1.7690, huber: 1.3966, swd: 2.4116, ept: 38.7548
      Epoch 16 composite train-obj: 0.958570
    Epoch [16/50], Test Losses: mse: 10.1524, mae: 1.7448, huber: 1.3730, swd: 1.9655, ept: 38.9760
    Best round's Test MSE: 10.1524, MAE: 1.7448, SWD: 1.9655
    Best round's Validation MSE: 7.8631, MAE: 1.5126, SWD: 1.3239
    Best round's Test verification MSE : 10.1524, MAE: 1.7448, SWD: 1.9655
    Time taken: 40.10 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq196_pred96_20250510_1535)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.1306 ± 0.0976
      mae: 1.7515 ± 0.0073
      huber: 1.3792 ± 0.0069
      swd: 2.0133 ± 0.0389
      ept: 38.2731 ± 0.6082
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 7.8378 ± 0.0555
      mae: 1.5137 ± 0.0066
      huber: 1.1538 ± 0.0075
      swd: 1.4159 ± 0.1120
      ept: 47.6666 ± 0.4670
      count: 12.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 110.23 seconds
    
    Experiment complete: ACL_etth1_seq196_pred96_20250510_1535
    Model: ACL
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=196,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 11
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.6162, mae: 2.2886, huber: 1.8830, swd: 7.9954, ept: 45.4585
    Epoch [1/50], Val Losses: mse: 10.9665, mae: 1.8413, huber: 1.4655, swd: 2.8228, ept: 61.3014
    Epoch [1/50], Test Losses: mse: 14.3596, mae: 2.0935, huber: 1.7020, swd: 4.0973, ept: 49.1300
      Epoch 1 composite train-obj: 1.883039
            Val objective improved inf → 1.4655, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.7376, mae: 1.6793, huber: 1.2923, swd: 2.0926, ept: 64.5246
    Epoch [2/50], Val Losses: mse: 11.7177, mae: 1.9445, huber: 1.5572, swd: 1.4914, ept: 47.9072
    Epoch [2/50], Test Losses: mse: 12.2822, mae: 2.0734, huber: 1.6772, swd: 2.3251, ept: 44.2687
      Epoch 2 composite train-obj: 1.292318
            No improvement (1.5572), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.1101, mae: 1.6309, huber: 1.2465, swd: 1.8776, ept: 66.7253
    Epoch [3/50], Val Losses: mse: 10.5896, mae: 1.7748, huber: 1.4057, swd: 1.8924, ept: 60.7175
    Epoch [3/50], Test Losses: mse: 10.5548, mae: 1.8733, huber: 1.4891, swd: 2.3104, ept: 51.7677
      Epoch 3 composite train-obj: 1.246505
            Val objective improved 1.4655 → 1.4057, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.7456, mae: 1.5848, huber: 1.2036, swd: 1.6922, ept: 69.3829
    Epoch [4/50], Val Losses: mse: 10.6515, mae: 1.7673, huber: 1.3987, swd: 1.7482, ept: 59.4296
    Epoch [4/50], Test Losses: mse: 10.3728, mae: 1.8592, huber: 1.4758, swd: 2.0281, ept: 53.2074
      Epoch 4 composite train-obj: 1.203588
            Val objective improved 1.4057 → 1.3987, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.5833, mae: 1.5628, huber: 1.1838, swd: 1.6370, ept: 71.0364
    Epoch [5/50], Val Losses: mse: 10.6809, mae: 1.7856, huber: 1.4177, swd: 2.3300, ept: 62.1816
    Epoch [5/50], Test Losses: mse: 10.0410, mae: 1.8314, huber: 1.4493, swd: 2.3536, ept: 54.1773
      Epoch 5 composite train-obj: 1.183756
            No improvement (1.4177), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.4569, mae: 1.5441, huber: 1.1668, swd: 1.5697, ept: 72.2203
    Epoch [6/50], Val Losses: mse: 10.6683, mae: 1.7908, huber: 1.4228, swd: 2.4921, ept: 63.5265
    Epoch [6/50], Test Losses: mse: 10.0169, mae: 1.8351, huber: 1.4528, swd: 2.5589, ept: 55.3725
      Epoch 6 composite train-obj: 1.166789
            No improvement (1.4228), counter 2/5
    Epoch [7/50], Train Losses: mse: 6.3918, mae: 1.5336, huber: 1.1573, swd: 1.5534, ept: 73.2686
    Epoch [7/50], Val Losses: mse: 10.5993, mae: 1.7575, huber: 1.3930, swd: 2.0514, ept: 63.9470
    Epoch [7/50], Test Losses: mse: 10.0253, mae: 1.8181, huber: 1.4378, swd: 2.0437, ept: 55.8661
      Epoch 7 composite train-obj: 1.157327
            Val objective improved 1.3987 → 1.3930, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.2837, mae: 1.5184, huber: 1.1430, swd: 1.4785, ept: 74.3073
    Epoch [8/50], Val Losses: mse: 10.4465, mae: 1.7518, huber: 1.3866, swd: 2.1383, ept: 62.2843
    Epoch [8/50], Test Losses: mse: 10.0976, mae: 1.8255, huber: 1.4444, swd: 2.1967, ept: 55.4649
      Epoch 8 composite train-obj: 1.143004
            Val objective improved 1.3930 → 1.3866, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.1773, mae: 1.5020, huber: 1.1277, swd: 1.4096, ept: 74.9669
    Epoch [9/50], Val Losses: mse: 10.7232, mae: 1.7707, huber: 1.4063, swd: 2.2467, ept: 65.2479
    Epoch [9/50], Test Losses: mse: 9.9153, mae: 1.8045, huber: 1.4245, swd: 2.0288, ept: 56.4598
      Epoch 9 composite train-obj: 1.127675
            No improvement (1.4063), counter 1/5
    Epoch [10/50], Train Losses: mse: 6.1775, mae: 1.5005, huber: 1.1265, swd: 1.4243, ept: 75.3679
    Epoch [10/50], Val Losses: mse: 10.7452, mae: 1.7809, huber: 1.4156, swd: 2.3741, ept: 64.8636
    Epoch [10/50], Test Losses: mse: 9.9688, mae: 1.8138, huber: 1.4333, swd: 2.1995, ept: 56.6256
      Epoch 10 composite train-obj: 1.126487
            No improvement (1.4156), counter 2/5
    Epoch [11/50], Train Losses: mse: 6.1121, mae: 1.4890, huber: 1.1159, swd: 1.3773, ept: 75.9722
    Epoch [11/50], Val Losses: mse: 10.5934, mae: 1.8005, huber: 1.4327, swd: 2.8330, ept: 66.2869
    Epoch [11/50], Test Losses: mse: 10.2165, mae: 1.8474, huber: 1.4650, swd: 2.7038, ept: 57.3571
      Epoch 11 composite train-obj: 1.115861
            No improvement (1.4327), counter 3/5
    Epoch [12/50], Train Losses: mse: 6.0829, mae: 1.4853, huber: 1.1125, swd: 1.3875, ept: 76.4831
    Epoch [12/50], Val Losses: mse: 10.3210, mae: 1.7495, huber: 1.3845, swd: 2.3209, ept: 65.5763
    Epoch [12/50], Test Losses: mse: 10.1244, mae: 1.8190, huber: 1.4383, swd: 2.1859, ept: 57.1236
      Epoch 12 composite train-obj: 1.112536
            Val objective improved 1.3866 → 1.3845, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 5.9909, mae: 1.4727, huber: 1.1006, swd: 1.3322, ept: 76.9703
    Epoch [13/50], Val Losses: mse: 10.3784, mae: 1.7701, huber: 1.4035, swd: 2.5518, ept: 65.5611
    Epoch [13/50], Test Losses: mse: 10.3756, mae: 1.8444, huber: 1.4630, swd: 2.5544, ept: 57.1953
      Epoch 13 composite train-obj: 1.100554
            No improvement (1.4035), counter 1/5
    Epoch [14/50], Train Losses: mse: 5.8933, mae: 1.4588, huber: 1.0874, swd: 1.2780, ept: 77.4091
    Epoch [14/50], Val Losses: mse: 11.2095, mae: 1.8034, huber: 1.4381, swd: 2.1603, ept: 64.1176
    Epoch [14/50], Test Losses: mse: 10.1663, mae: 1.8152, huber: 1.4346, swd: 1.8478, ept: 56.2592
      Epoch 14 composite train-obj: 1.087396
            No improvement (1.4381), counter 2/5
    Epoch [15/50], Train Losses: mse: 5.8600, mae: 1.4537, huber: 1.0825, swd: 1.2650, ept: 77.5307
    Epoch [15/50], Val Losses: mse: 10.5913, mae: 1.7993, huber: 1.4316, swd: 2.6594, ept: 65.2662
    Epoch [15/50], Test Losses: mse: 10.6617, mae: 1.8578, huber: 1.4762, swd: 2.6377, ept: 56.7737
      Epoch 15 composite train-obj: 1.082480
            No improvement (1.4316), counter 3/5
    Epoch [16/50], Train Losses: mse: 5.7895, mae: 1.4438, huber: 1.0732, swd: 1.2458, ept: 77.6863
    Epoch [16/50], Val Losses: mse: 11.1227, mae: 1.8251, huber: 1.4577, swd: 2.5705, ept: 65.2814
    Epoch [16/50], Test Losses: mse: 10.3227, mae: 1.8341, huber: 1.4531, swd: 2.3062, ept: 56.8681
      Epoch 16 composite train-obj: 1.073157
            No improvement (1.4577), counter 4/5
    Epoch [17/50], Train Losses: mse: 5.7134, mae: 1.4315, huber: 1.0617, swd: 1.1985, ept: 78.5525
    Epoch [17/50], Val Losses: mse: 10.8412, mae: 1.8220, huber: 1.4538, swd: 2.7616, ept: 65.2202
    Epoch [17/50], Test Losses: mse: 10.5007, mae: 1.8475, huber: 1.4673, swd: 2.5258, ept: 56.9565
      Epoch 17 composite train-obj: 1.061742
    Epoch [17/50], Test Losses: mse: 10.1244, mae: 1.8190, huber: 1.4384, swd: 2.1861, ept: 57.0974
    Best round's Test MSE: 10.1244, MAE: 1.8190, SWD: 2.1859
    Best round's Validation MSE: 10.3210, MAE: 1.7495, SWD: 2.3209
    Best round's Test verification MSE : 10.1244, MAE: 1.8190, SWD: 2.1861
    Time taken: 48.61 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.4609, mae: 2.3372, huber: 1.9303, swd: 8.5531, ept: 43.5388
    Epoch [1/50], Val Losses: mse: 10.8703, mae: 1.8027, huber: 1.4293, swd: 2.3363, ept: 62.0790
    Epoch [1/50], Test Losses: mse: 14.6608, mae: 2.0806, huber: 1.6917, swd: 3.4390, ept: 49.7608
      Epoch 1 composite train-obj: 1.930301
            Val objective improved inf → 1.4293, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.7295, mae: 1.6764, huber: 1.2901, swd: 1.9814, ept: 64.7991
    Epoch [2/50], Val Losses: mse: 10.6393, mae: 1.8013, huber: 1.4302, swd: 2.1941, ept: 59.2024
    Epoch [2/50], Test Losses: mse: 11.4393, mae: 1.9331, huber: 1.5468, swd: 2.6751, ept: 49.9841
      Epoch 2 composite train-obj: 1.290053
            No improvement (1.4302), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.0249, mae: 1.6196, huber: 1.2365, swd: 1.7740, ept: 67.2114
    Epoch [3/50], Val Losses: mse: 10.9431, mae: 1.8198, huber: 1.4494, swd: 2.2765, ept: 58.6876
    Epoch [3/50], Test Losses: mse: 10.4996, mae: 1.8798, huber: 1.4950, swd: 2.2704, ept: 51.3208
      Epoch 3 composite train-obj: 1.236521
            No improvement (1.4494), counter 2/5
    Epoch [4/50], Train Losses: mse: 6.7122, mae: 1.5821, huber: 1.2020, swd: 1.6446, ept: 69.8648
    Epoch [4/50], Val Losses: mse: 10.5044, mae: 1.7637, huber: 1.3963, swd: 1.7947, ept: 60.0331
    Epoch [4/50], Test Losses: mse: 10.4667, mae: 1.8591, huber: 1.4769, swd: 1.8018, ept: 53.0460
      Epoch 4 composite train-obj: 1.201964
            Val objective improved 1.4293 → 1.3963, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.6122, mae: 1.5678, huber: 1.1894, swd: 1.6438, ept: 71.6367
    Epoch [5/50], Val Losses: mse: 10.5698, mae: 1.7741, huber: 1.4071, swd: 2.0705, ept: 61.2895
    Epoch [5/50], Test Losses: mse: 10.2281, mae: 1.8431, huber: 1.4612, swd: 1.8966, ept: 53.8717
      Epoch 5 composite train-obj: 1.189384
            No improvement (1.4071), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.4176, mae: 1.5387, huber: 1.1624, swd: 1.5217, ept: 73.2935
    Epoch [6/50], Val Losses: mse: 10.6992, mae: 1.7757, huber: 1.4102, swd: 2.1656, ept: 62.7667
    Epoch [6/50], Test Losses: mse: 10.1284, mae: 1.8295, huber: 1.4495, swd: 1.9586, ept: 54.9928
      Epoch 6 composite train-obj: 1.162366
            No improvement (1.4102), counter 2/5
    Epoch [7/50], Train Losses: mse: 6.3351, mae: 1.5260, huber: 1.1505, swd: 1.4889, ept: 74.1068
    Epoch [7/50], Val Losses: mse: 10.7407, mae: 1.7969, huber: 1.4285, swd: 2.5720, ept: 62.9029
    Epoch [7/50], Test Losses: mse: 10.0241, mae: 1.8306, huber: 1.4490, swd: 2.3237, ept: 55.4170
      Epoch 7 composite train-obj: 1.150472
            No improvement (1.4285), counter 3/5
    Epoch [8/50], Train Losses: mse: 6.1885, mae: 1.5034, huber: 1.1293, swd: 1.3890, ept: 75.5912
    Epoch [8/50], Val Losses: mse: 10.7800, mae: 1.8009, huber: 1.4347, swd: 2.6354, ept: 63.8572
    Epoch [8/50], Test Losses: mse: 10.0621, mae: 1.8234, huber: 1.4437, swd: 2.2599, ept: 55.9484
      Epoch 8 composite train-obj: 1.129324
            No improvement (1.4347), counter 4/5
    Epoch [9/50], Train Losses: mse: 6.1386, mae: 1.4959, huber: 1.1223, swd: 1.3737, ept: 75.9647
    Epoch [9/50], Val Losses: mse: 10.7240, mae: 1.8003, huber: 1.4321, swd: 2.3870, ept: 61.6052
    Epoch [9/50], Test Losses: mse: 10.2991, mae: 1.8420, huber: 1.4600, swd: 1.9616, ept: 55.0129
      Epoch 9 composite train-obj: 1.122269
    Epoch [9/50], Test Losses: mse: 10.4668, mae: 1.8592, huber: 1.4770, swd: 1.8023, ept: 53.0473
    Best round's Test MSE: 10.4667, MAE: 1.8591, SWD: 1.8018
    Best round's Validation MSE: 10.5044, MAE: 1.7637, SWD: 1.7947
    Best round's Test verification MSE : 10.4668, MAE: 1.8592, SWD: 1.8023
    Time taken: 27.84 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.1874, mae: 2.3235, huber: 1.9169, swd: 7.1236, ept: 44.2934
    Epoch [1/50], Val Losses: mse: 11.0513, mae: 1.8113, huber: 1.4359, swd: 2.3300, ept: 61.9716
    Epoch [1/50], Test Losses: mse: 15.5693, mae: 2.1350, huber: 1.7446, swd: 3.7584, ept: 49.7957
      Epoch 1 composite train-obj: 1.916933
            Val objective improved inf → 1.4359, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.8138, mae: 1.6808, huber: 1.2945, swd: 1.8728, ept: 64.8459
    Epoch [2/50], Val Losses: mse: 10.5416, mae: 1.7811, huber: 1.4107, swd: 1.8150, ept: 60.6078
    Epoch [2/50], Test Losses: mse: 11.1919, mae: 1.9149, huber: 1.5294, swd: 2.4852, ept: 51.1948
      Epoch 2 composite train-obj: 1.294530
            Val objective improved 1.4359 → 1.4107, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.9951, mae: 1.6124, huber: 1.2298, swd: 1.6106, ept: 68.0922
    Epoch [3/50], Val Losses: mse: 10.5511, mae: 1.7805, huber: 1.4115, swd: 1.9538, ept: 60.9693
    Epoch [3/50], Test Losses: mse: 10.6569, mae: 1.8887, huber: 1.5050, swd: 2.5781, ept: 52.3615
      Epoch 3 composite train-obj: 1.229819
            No improvement (1.4115), counter 1/5
    Epoch [4/50], Train Losses: mse: 6.7149, mae: 1.5776, huber: 1.1981, swd: 1.5101, ept: 70.4942
    Epoch [4/50], Val Losses: mse: 10.4595, mae: 1.7697, huber: 1.4036, swd: 2.0856, ept: 62.6033
    Epoch [4/50], Test Losses: mse: 10.2054, mae: 1.8409, huber: 1.4597, swd: 2.2858, ept: 55.1640
      Epoch 4 composite train-obj: 1.198107
            Val objective improved 1.4107 → 1.4036, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.5359, mae: 1.5524, huber: 1.1753, swd: 1.4511, ept: 72.7626
    Epoch [5/50], Val Losses: mse: 10.4442, mae: 1.7812, huber: 1.4136, swd: 2.3813, ept: 62.9882
    Epoch [5/50], Test Losses: mse: 10.0993, mae: 1.8407, huber: 1.4593, swd: 2.4626, ept: 55.2409
      Epoch 5 composite train-obj: 1.175255
            No improvement (1.4136), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.3865, mae: 1.5312, huber: 1.1557, swd: 1.3725, ept: 74.1231
    Epoch [6/50], Val Losses: mse: 10.5653, mae: 1.7600, huber: 1.3961, swd: 1.9594, ept: 62.8928
    Epoch [6/50], Test Losses: mse: 9.9514, mae: 1.8103, huber: 1.4312, swd: 1.9741, ept: 56.3424
      Epoch 6 composite train-obj: 1.155681
            Val objective improved 1.4036 → 1.3961, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.3059, mae: 1.5191, huber: 1.1443, swd: 1.3319, ept: 75.0201
    Epoch [7/50], Val Losses: mse: 10.6011, mae: 1.8132, huber: 1.4431, swd: 2.6324, ept: 62.4585
    Epoch [7/50], Test Losses: mse: 10.0233, mae: 1.8399, huber: 1.4579, swd: 2.5959, ept: 55.8651
      Epoch 7 composite train-obj: 1.144284
            No improvement (1.4431), counter 1/5
    Epoch [8/50], Train Losses: mse: 6.2374, mae: 1.5080, huber: 1.1340, swd: 1.3129, ept: 75.7232
    Epoch [8/50], Val Losses: mse: 10.3602, mae: 1.7501, huber: 1.3861, swd: 2.0134, ept: 64.3349
    Epoch [8/50], Test Losses: mse: 9.9488, mae: 1.8073, huber: 1.4282, swd: 1.9292, ept: 56.9920
      Epoch 8 composite train-obj: 1.134030
            Val objective improved 1.3961 → 1.3861, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.1660, mae: 1.4967, huber: 1.1234, swd: 1.2640, ept: 76.1496
    Epoch [9/50], Val Losses: mse: 10.1249, mae: 1.7344, huber: 1.3698, swd: 1.9367, ept: 63.8526
    Epoch [9/50], Test Losses: mse: 10.2201, mae: 1.8253, huber: 1.4453, swd: 1.9572, ept: 56.5804
      Epoch 9 composite train-obj: 1.123403
            Val objective improved 1.3861 → 1.3698, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 6.0625, mae: 1.4819, huber: 1.1095, swd: 1.2092, ept: 76.7844
    Epoch [10/50], Val Losses: mse: 10.3783, mae: 1.7541, huber: 1.3894, swd: 1.8944, ept: 63.3548
    Epoch [10/50], Test Losses: mse: 10.3426, mae: 1.8304, huber: 1.4507, swd: 1.7915, ept: 55.8404
      Epoch 10 composite train-obj: 1.109466
            No improvement (1.3894), counter 1/5
    Epoch [11/50], Train Losses: mse: 6.0500, mae: 1.4799, huber: 1.1077, swd: 1.2262, ept: 76.9203
    Epoch [11/50], Val Losses: mse: 10.5367, mae: 1.7828, huber: 1.4160, swd: 2.1705, ept: 62.2333
    Epoch [11/50], Test Losses: mse: 10.2565, mae: 1.8313, huber: 1.4504, swd: 2.0217, ept: 55.4421
      Epoch 11 composite train-obj: 1.107740
            No improvement (1.4160), counter 2/5
    Epoch [12/50], Train Losses: mse: 5.9829, mae: 1.4694, huber: 1.0978, swd: 1.1914, ept: 77.5288
    Epoch [12/50], Val Losses: mse: 10.4412, mae: 1.7742, huber: 1.4093, swd: 2.3555, ept: 65.5212
    Epoch [12/50], Test Losses: mse: 10.1347, mae: 1.8223, huber: 1.4431, swd: 2.2052, ept: 57.4564
      Epoch 12 composite train-obj: 1.097817
            No improvement (1.4093), counter 3/5
    Epoch [13/50], Train Losses: mse: 5.9231, mae: 1.4610, huber: 1.0899, swd: 1.1718, ept: 77.8442
    Epoch [13/50], Val Losses: mse: 10.6431, mae: 1.7851, huber: 1.4199, swd: 2.3026, ept: 65.2343
    Epoch [13/50], Test Losses: mse: 10.1076, mae: 1.8180, huber: 1.4385, swd: 2.1202, ept: 57.2255
      Epoch 13 composite train-obj: 1.089862
            No improvement (1.4199), counter 4/5
    Epoch [14/50], Train Losses: mse: 5.8470, mae: 1.4509, huber: 1.0802, swd: 1.1311, ept: 78.3490
    Epoch [14/50], Val Losses: mse: 10.7793, mae: 1.7963, huber: 1.4308, swd: 2.2453, ept: 64.6001
    Epoch [14/50], Test Losses: mse: 10.2068, mae: 1.8175, huber: 1.4380, swd: 1.9457, ept: 56.6201
      Epoch 14 composite train-obj: 1.080188
    Epoch [14/50], Test Losses: mse: 10.2201, mae: 1.8253, huber: 1.4453, swd: 1.9573, ept: 56.5816
    Best round's Test MSE: 10.2201, MAE: 1.8253, SWD: 1.9572
    Best round's Validation MSE: 10.1249, MAE: 1.7344, SWD: 1.9367
    Best round's Test verification MSE : 10.2201, MAE: 1.8253, SWD: 1.9573
    Time taken: 35.82 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq196_pred196_20250510_1537)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.2704 ± 0.1442
      mae: 1.8345 ± 0.0176
      huber: 1.4535 ± 0.0168
      swd: 1.9816 ± 0.1578
      ept: 55.5833 ± 1.8078
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 10.3168 ± 0.1549
      mae: 1.7492 ± 0.0120
      huber: 1.3836 ± 0.0109
      swd: 2.0174 ± 0.2223
      ept: 63.1540 ± 2.3163
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 112.33 seconds
    
    Experiment complete: ACL_etth1_seq196_pred196_20250510_1537
    Model: ACL
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=196,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.6468, mae: 2.3866, huber: 1.9769, swd: 7.7098, ept: 54.5291
    Epoch [1/50], Val Losses: mse: 11.3366, mae: 1.8415, huber: 1.4653, swd: 2.3089, ept: 80.5152
    Epoch [1/50], Test Losses: mse: 15.8123, mae: 2.1826, huber: 1.7878, swd: 3.6500, ept: 68.0549
      Epoch 1 composite train-obj: 1.976880
            Val objective improved inf → 1.4653, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.3036, mae: 1.7590, huber: 1.3668, swd: 2.0817, ept: 81.2025
    Epoch [2/50], Val Losses: mse: 11.5249, mae: 1.8632, huber: 1.4863, swd: 1.2888, ept: 69.4034
    Epoch [2/50], Test Losses: mse: 11.7797, mae: 2.0011, huber: 1.6102, swd: 1.8522, ept: 66.7535
      Epoch 2 composite train-obj: 1.366792
            No improvement (1.4863), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.4858, mae: 1.6966, huber: 1.3072, swd: 1.8229, ept: 85.6857
    Epoch [3/50], Val Losses: mse: 11.3765, mae: 1.8338, huber: 1.4644, swd: 2.0828, ept: 76.8665
    Epoch [3/50], Test Losses: mse: 10.6564, mae: 1.9256, huber: 1.5367, swd: 2.3526, ept: 71.8701
      Epoch 3 composite train-obj: 1.307170
            Val objective improved 1.4653 → 1.4644, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.1445, mae: 1.6550, huber: 1.2686, swd: 1.6437, ept: 88.6056
    Epoch [4/50], Val Losses: mse: 11.5212, mae: 1.8337, huber: 1.4656, swd: 1.9505, ept: 76.6392
    Epoch [4/50], Test Losses: mse: 10.4966, mae: 1.9171, huber: 1.5291, swd: 2.0918, ept: 71.8484
      Epoch 4 composite train-obj: 1.268564
            No improvement (1.4656), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.9791, mae: 1.6336, huber: 1.2492, swd: 1.5973, ept: 90.9686
    Epoch [5/50], Val Losses: mse: 11.8355, mae: 1.8867, huber: 1.5145, swd: 2.5400, ept: 74.6255
    Epoch [5/50], Test Losses: mse: 10.2268, mae: 1.9199, huber: 1.5297, swd: 2.5542, ept: 72.5657
      Epoch 5 composite train-obj: 1.249185
            No improvement (1.5145), counter 2/5
    Epoch [6/50], Train Losses: mse: 6.8178, mae: 1.6087, huber: 1.2263, swd: 1.5045, ept: 93.1323
    Epoch [6/50], Val Losses: mse: 11.4958, mae: 1.8398, huber: 1.4718, swd: 2.2334, ept: 77.8859
    Epoch [6/50], Test Losses: mse: 10.1215, mae: 1.8871, huber: 1.4996, swd: 2.0825, ept: 73.6525
      Epoch 6 composite train-obj: 1.226289
            No improvement (1.4718), counter 3/5
    Epoch [7/50], Train Losses: mse: 6.7355, mae: 1.5972, huber: 1.2158, swd: 1.4697, ept: 94.4162
    Epoch [7/50], Val Losses: mse: 12.0164, mae: 1.9000, huber: 1.5293, swd: 2.6803, ept: 78.6763
    Epoch [7/50], Test Losses: mse: 10.1051, mae: 1.8983, huber: 1.5112, swd: 2.4838, ept: 74.6213
      Epoch 7 composite train-obj: 1.215843
            No improvement (1.5293), counter 4/5
    Epoch [8/50], Train Losses: mse: 6.6961, mae: 1.5900, huber: 1.2094, swd: 1.4608, ept: 94.4747
    Epoch [8/50], Val Losses: mse: 11.9922, mae: 1.8859, huber: 1.5160, swd: 2.4604, ept: 78.8811
    Epoch [8/50], Test Losses: mse: 9.9482, mae: 1.8675, huber: 1.4820, swd: 2.1114, ept: 74.8867
      Epoch 8 composite train-obj: 1.209426
    Epoch [8/50], Test Losses: mse: 10.6569, mae: 1.9257, huber: 1.5367, swd: 2.3533, ept: 71.8450
    Best round's Test MSE: 10.6564, MAE: 1.9256, SWD: 2.3526
    Best round's Validation MSE: 11.3765, MAE: 1.8338, SWD: 2.0828
    Best round's Test verification MSE : 10.6569, MAE: 1.9257, SWD: 2.3533
    Time taken: 19.71 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 18.3649, mae: 2.4334, huber: 2.0227, swd: 8.7278, ept: 54.3084
    Epoch [1/50], Val Losses: mse: 11.2444, mae: 1.8256, huber: 1.4486, swd: 1.9601, ept: 79.6620
    Epoch [1/50], Test Losses: mse: 16.1605, mae: 2.1764, huber: 1.7826, swd: 2.8575, ept: 69.4730
      Epoch 1 composite train-obj: 2.022726
            Val objective improved inf → 1.4486, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.3663, mae: 1.7602, huber: 1.3678, swd: 2.0652, ept: 81.6419
    Epoch [2/50], Val Losses: mse: 11.4408, mae: 1.8510, huber: 1.4791, swd: 2.2934, ept: 78.4596
    Epoch [2/50], Test Losses: mse: 11.6168, mae: 1.9940, huber: 1.6017, swd: 2.9381, ept: 69.3928
      Epoch 2 composite train-obj: 1.367803
            No improvement (1.4791), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.4782, mae: 1.6953, huber: 1.3051, swd: 1.8244, ept: 85.2574
    Epoch [3/50], Val Losses: mse: 11.6959, mae: 1.9001, huber: 1.5252, swd: 2.9804, ept: 77.1331
    Epoch [3/50], Test Losses: mse: 10.9648, mae: 1.9892, huber: 1.5946, swd: 3.2625, ept: 69.8221
      Epoch 3 composite train-obj: 1.305145
            No improvement (1.5252), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.2950, mae: 1.6784, huber: 1.2895, swd: 1.8145, ept: 86.1714
    Epoch [4/50], Val Losses: mse: 11.7512, mae: 1.8719, huber: 1.5013, swd: 2.6320, ept: 78.5332
    Epoch [4/50], Test Losses: mse: 10.4522, mae: 1.9276, huber: 1.5373, swd: 2.6543, ept: 71.6977
      Epoch 4 composite train-obj: 1.289530
            No improvement (1.5013), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.0699, mae: 1.6496, huber: 1.2628, swd: 1.6865, ept: 89.0148
    Epoch [5/50], Val Losses: mse: 11.9148, mae: 1.9116, huber: 1.5367, swd: 3.0086, ept: 77.7876
    Epoch [5/50], Test Losses: mse: 10.3789, mae: 1.9483, huber: 1.5558, swd: 2.9948, ept: 71.8776
      Epoch 5 composite train-obj: 1.262820
            No improvement (1.5367), counter 4/5
    Epoch [6/50], Train Losses: mse: 6.9129, mae: 1.6280, huber: 1.2432, swd: 1.6056, ept: 90.9522
    Epoch [6/50], Val Losses: mse: 11.9535, mae: 1.9305, huber: 1.5552, swd: 3.3132, ept: 78.9486
    Epoch [6/50], Test Losses: mse: 10.4396, mae: 1.9563, huber: 1.5649, swd: 3.2689, ept: 73.2603
      Epoch 6 composite train-obj: 1.243239
    Epoch [6/50], Test Losses: mse: 16.1607, mae: 2.1764, huber: 1.7827, swd: 2.8575, ept: 69.4586
    Best round's Test MSE: 16.1605, MAE: 2.1764, SWD: 2.8575
    Best round's Validation MSE: 11.2444, MAE: 1.8256, SWD: 1.9601
    Best round's Test verification MSE : 16.1607, MAE: 2.1764, SWD: 2.8575
    Time taken: 14.56 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.6138, mae: 2.3791, huber: 1.9699, swd: 7.7587, ept: 55.9191
    Epoch [1/50], Val Losses: mse: 11.4109, mae: 1.8918, huber: 1.5127, swd: 3.1654, ept: 82.3736
    Epoch [1/50], Test Losses: mse: 15.6985, mae: 2.2227, huber: 1.8252, swd: 4.7641, ept: 68.5749
      Epoch 1 composite train-obj: 1.969861
            Val objective improved inf → 1.5127, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.3516, mae: 1.7582, huber: 1.3663, swd: 2.1048, ept: 82.3742
    Epoch [2/50], Val Losses: mse: 11.1457, mae: 1.8242, huber: 1.4530, swd: 1.9045, ept: 77.7253
    Epoch [2/50], Test Losses: mse: 11.4162, mae: 1.9664, huber: 1.5752, swd: 2.5409, ept: 70.3346
      Epoch 2 composite train-obj: 1.366299
            Val objective improved 1.5127 → 1.4530, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.4314, mae: 1.6858, huber: 1.2969, swd: 1.7527, ept: 86.2053
    Epoch [3/50], Val Losses: mse: 11.3958, mae: 1.8372, huber: 1.4675, swd: 2.1045, ept: 77.7137
    Epoch [3/50], Test Losses: mse: 10.6778, mae: 1.9300, huber: 1.5408, swd: 2.5198, ept: 71.4285
      Epoch 3 composite train-obj: 1.296868
            No improvement (1.4675), counter 1/5
    Epoch [4/50], Train Losses: mse: 7.1567, mae: 1.6541, huber: 1.2677, swd: 1.6503, ept: 88.7820
    Epoch [4/50], Val Losses: mse: 11.5645, mae: 1.8478, huber: 1.4789, swd: 2.2809, ept: 77.5941
    Epoch [4/50], Test Losses: mse: 10.2988, mae: 1.9067, huber: 1.5181, swd: 2.4868, ept: 72.4935
      Epoch 4 composite train-obj: 1.267750
            No improvement (1.4789), counter 2/5
    Epoch [5/50], Train Losses: mse: 7.0099, mae: 1.6340, huber: 1.2495, swd: 1.5979, ept: 90.7760
    Epoch [5/50], Val Losses: mse: 11.5042, mae: 1.8646, huber: 1.4940, swd: 2.5980, ept: 79.2344
    Epoch [5/50], Test Losses: mse: 10.1540, mae: 1.9003, huber: 1.5122, swd: 2.6067, ept: 73.6860
      Epoch 5 composite train-obj: 1.249472
            No improvement (1.4940), counter 3/5
    Epoch [6/50], Train Losses: mse: 6.8470, mae: 1.6128, huber: 1.2299, swd: 1.5035, ept: 92.5284
    Epoch [6/50], Val Losses: mse: 11.6011, mae: 1.8931, huber: 1.5205, swd: 2.8908, ept: 80.4976
    Epoch [6/50], Test Losses: mse: 10.2054, mae: 1.9133, huber: 1.5252, swd: 2.9149, ept: 74.8285
      Epoch 6 composite train-obj: 1.229902
            No improvement (1.5205), counter 4/5
    Epoch [7/50], Train Losses: mse: 6.7955, mae: 1.6059, huber: 1.2235, swd: 1.4942, ept: 93.8394
    Epoch [7/50], Val Losses: mse: 11.9293, mae: 1.9637, huber: 1.5815, swd: 3.3175, ept: 76.1464
    Epoch [7/50], Test Losses: mse: 10.4054, mae: 1.9721, huber: 1.5747, swd: 3.2448, ept: 72.7992
      Epoch 7 composite train-obj: 1.223493
    Epoch [7/50], Test Losses: mse: 11.4162, mae: 1.9664, huber: 1.5752, swd: 2.5410, ept: 70.2942
    Best round's Test MSE: 11.4162, MAE: 1.9664, SWD: 2.5409
    Best round's Validation MSE: 11.1457, MAE: 1.8242, SWD: 1.9045
    Best round's Test verification MSE : 11.4162, MAE: 1.9664, SWD: 2.5410
    Time taken: 17.40 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq196_pred336_20250510_1539)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 12.7444 ± 2.4354
      mae: 2.0228 ± 0.1099
      huber: 1.6315 ± 0.1080
      swd: 2.5837 ± 0.2083
      ept: 70.5592 ± 0.9914
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 11.2555 ± 0.0945
      mae: 1.8279 ± 0.0042
      huber: 1.4553 ± 0.0067
      swd: 1.9825 ± 0.0745
      ept: 78.0846 ± 1.1692
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 51.74 seconds
    
    Experiment complete: ACL_etth1_seq196_pred336_20250510_1539
    Model: ACL
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=196,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 18.1685, mae: 2.4893, huber: 2.0738, swd: 8.0557, ept: 66.7348
    Epoch [1/50], Val Losses: mse: 11.3140, mae: 1.8816, huber: 1.5020, swd: 2.7762, ept: 133.6242
    Epoch [1/50], Test Losses: mse: 17.5150, mae: 2.3809, huber: 1.9741, swd: 4.3555, ept: 104.6859
      Epoch 1 composite train-obj: 2.073762
            Val objective improved inf → 1.5020, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.1769, mae: 1.8875, huber: 1.4860, swd: 2.4089, ept: 101.4151
    Epoch [2/50], Val Losses: mse: 10.9962, mae: 1.9227, huber: 1.5456, swd: 3.0222, ept: 117.4399
    Epoch [2/50], Test Losses: mse: 12.4257, mae: 2.1554, huber: 1.7493, swd: 3.7745, ept: 110.1918
      Epoch 2 composite train-obj: 1.486017
            No improvement (1.5456), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.2413, mae: 1.8187, huber: 1.4196, swd: 2.1455, ept: 105.2221
    Epoch [3/50], Val Losses: mse: 11.4822, mae: 1.9698, huber: 1.5916, swd: 3.1153, ept: 98.5767
    Epoch [3/50], Test Losses: mse: 11.5427, mae: 2.1029, huber: 1.6980, swd: 3.3316, ept: 112.8131
      Epoch 3 composite train-obj: 1.419571
            No improvement (1.5916), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.9666, mae: 1.7894, huber: 1.3921, swd: 2.0253, ept: 108.0534
    Epoch [4/50], Val Losses: mse: 12.1946, mae: 2.0275, huber: 1.6497, swd: 3.1930, ept: 93.1667
    Epoch [4/50], Test Losses: mse: 11.1866, mae: 2.0832, huber: 1.6808, swd: 3.0241, ept: 113.6077
      Epoch 4 composite train-obj: 1.392139
            No improvement (1.6497), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.7462, mae: 1.7631, huber: 1.3673, swd: 1.9169, ept: 109.9371
    Epoch [5/50], Val Losses: mse: 12.5351, mae: 2.0553, huber: 1.6763, swd: 3.4100, ept: 93.7565
    Epoch [5/50], Test Losses: mse: 10.9339, mae: 2.0675, huber: 1.6647, swd: 3.1023, ept: 115.2993
      Epoch 5 composite train-obj: 1.367291
            No improvement (1.6763), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.6095, mae: 1.7441, huber: 1.3496, swd: 1.8671, ept: 112.0717
    Epoch [6/50], Val Losses: mse: 13.2159, mae: 2.1112, huber: 1.7332, swd: 3.5727, ept: 90.5415
    Epoch [6/50], Test Losses: mse: 11.0209, mae: 2.0782, huber: 1.6770, swd: 2.9284, ept: 106.5943
      Epoch 6 composite train-obj: 1.349571
    Epoch [6/50], Test Losses: mse: 17.5143, mae: 2.3808, huber: 1.9740, swd: 4.3544, ept: 104.7149
    Best round's Test MSE: 17.5150, MAE: 2.3809, SWD: 4.3555
    Best round's Validation MSE: 11.3140, MAE: 1.8816, SWD: 2.7762
    Best round's Test verification MSE : 17.5143, MAE: 2.3808, SWD: 4.3544
    Time taken: 14.34 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 19.0505, mae: 2.5467, huber: 2.1297, swd: 8.1754, ept: 64.5318
    Epoch [1/50], Val Losses: mse: 12.0410, mae: 1.8550, huber: 1.4736, swd: 1.5772, ept: 109.6529
    Epoch [1/50], Test Losses: mse: 19.8042, mae: 2.4641, huber: 2.0573, swd: 3.3329, ept: 100.1547
      Epoch 1 composite train-obj: 2.129746
            Val objective improved inf → 1.4736, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.4886, mae: 1.9076, huber: 1.5057, swd: 2.3689, ept: 99.4425
    Epoch [2/50], Val Losses: mse: 10.4927, mae: 1.8501, huber: 1.4760, swd: 1.9432, ept: 110.8811
    Epoch [2/50], Test Losses: mse: 12.4911, mae: 2.1306, huber: 1.7262, swd: 2.8810, ept: 108.8186
      Epoch 2 composite train-obj: 1.505744
            No improvement (1.4760), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.2578, mae: 1.8202, huber: 1.4211, swd: 2.0080, ept: 105.4769
    Epoch [3/50], Val Losses: mse: 11.6127, mae: 1.9679, huber: 1.5902, swd: 2.7597, ept: 107.2967
    Epoch [3/50], Test Losses: mse: 11.5844, mae: 2.1142, huber: 1.7106, swd: 3.3206, ept: 114.1251
      Epoch 3 composite train-obj: 1.421134
            No improvement (1.5902), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.8941, mae: 1.7805, huber: 1.3836, swd: 1.8460, ept: 109.7068
    Epoch [4/50], Val Losses: mse: 12.0867, mae: 2.0185, huber: 1.6387, swd: 3.0680, ept: 99.6179
    Epoch [4/50], Test Losses: mse: 11.2751, mae: 2.1040, huber: 1.6997, swd: 3.4499, ept: 114.1776
      Epoch 4 composite train-obj: 1.383595
            No improvement (1.6387), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.7697, mae: 1.7661, huber: 1.3704, swd: 1.8307, ept: 111.1607
    Epoch [5/50], Val Losses: mse: 12.2227, mae: 2.0198, huber: 1.6444, swd: 2.9581, ept: 94.2013
    Epoch [5/50], Test Losses: mse: 10.8946, mae: 2.0481, huber: 1.6472, swd: 2.8050, ept: 116.6160
      Epoch 5 composite train-obj: 1.370445
            No improvement (1.6444), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.5948, mae: 1.7415, huber: 1.3476, swd: 1.7495, ept: 114.9040
    Epoch [6/50], Val Losses: mse: 12.6899, mae: 2.0521, huber: 1.6747, swd: 3.0065, ept: 93.8231
    Epoch [6/50], Test Losses: mse: 10.7596, mae: 2.0550, huber: 1.6528, swd: 2.8671, ept: 116.1217
      Epoch 6 composite train-obj: 1.347560
    Epoch [6/50], Test Losses: mse: 19.8030, mae: 2.4640, huber: 2.0572, swd: 3.3334, ept: 99.9556
    Best round's Test MSE: 19.8042, MAE: 2.4641, SWD: 3.3329
    Best round's Validation MSE: 12.0410, MAE: 1.8550, SWD: 1.5772
    Best round's Test verification MSE : 19.8030, MAE: 2.4640, SWD: 3.3334
    Time taken: 14.05 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 18.3595, mae: 2.4929, huber: 2.0773, swd: 8.2825, ept: 66.8445
    Epoch [1/50], Val Losses: mse: 11.2809, mae: 1.8604, huber: 1.4805, swd: 2.2420, ept: 126.5791
    Epoch [1/50], Test Losses: mse: 17.7322, mae: 2.3736, huber: 1.9680, swd: 3.9596, ept: 105.6527
      Epoch 1 composite train-obj: 2.077302
            Val objective improved inf → 1.4805, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.3522, mae: 1.9005, huber: 1.4989, swd: 2.6079, ept: 100.7015
    Epoch [2/50], Val Losses: mse: 10.7148, mae: 1.8813, huber: 1.5067, swd: 2.1211, ept: 104.8143
    Epoch [2/50], Test Losses: mse: 12.3886, mae: 2.1254, huber: 1.7233, swd: 2.8943, ept: 108.6258
      Epoch 2 composite train-obj: 1.498906
            No improvement (1.5067), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.2063, mae: 1.8142, huber: 1.4154, swd: 2.1759, ept: 106.5991
    Epoch [3/50], Val Losses: mse: 11.3928, mae: 1.9614, huber: 1.5838, swd: 3.2165, ept: 104.3165
    Epoch [3/50], Test Losses: mse: 11.6025, mae: 2.1159, huber: 1.7110, swd: 3.6927, ept: 113.0092
      Epoch 3 composite train-obj: 1.415399
            No improvement (1.5838), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.8305, mae: 1.7716, huber: 1.3753, swd: 1.9895, ept: 111.5483
    Epoch [4/50], Val Losses: mse: 12.2093, mae: 2.0234, huber: 1.6470, swd: 2.9823, ept: 86.2396
    Epoch [4/50], Test Losses: mse: 11.1228, mae: 2.0657, huber: 1.6643, swd: 2.5700, ept: 107.7906
      Epoch 4 composite train-obj: 1.375307
            No improvement (1.6470), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.6842, mae: 1.7540, huber: 1.3590, swd: 1.9543, ept: 113.0234
    Epoch [5/50], Val Losses: mse: 12.2905, mae: 2.0401, huber: 1.6613, swd: 3.4697, ept: 99.4946
    Epoch [5/50], Test Losses: mse: 10.9571, mae: 2.0689, huber: 1.6670, swd: 3.2659, ept: 115.3997
      Epoch 5 composite train-obj: 1.359040
            No improvement (1.6613), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.5121, mae: 1.7303, huber: 1.3370, swd: 1.8579, ept: 115.2072
    Epoch [6/50], Val Losses: mse: 12.8451, mae: 2.1142, huber: 1.7321, swd: 4.0634, ept: 100.1596
    Epoch [6/50], Test Losses: mse: 11.0638, mae: 2.0981, huber: 1.6964, swd: 3.7419, ept: 115.8719
      Epoch 6 composite train-obj: 1.336974
    Epoch [6/50], Test Losses: mse: 17.7323, mae: 2.3737, huber: 1.9680, swd: 3.9610, ept: 105.7679
    Best round's Test MSE: 17.7322, MAE: 2.3736, SWD: 3.9596
    Best round's Validation MSE: 11.2809, MAE: 1.8604, SWD: 2.2420
    Best round's Test verification MSE : 17.7323, MAE: 2.3737, SWD: 3.9610
    Time taken: 14.00 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq196_pred720_20250510_1540)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 18.3505 ± 1.0317
      mae: 2.4062 ± 0.0410
      huber: 1.9998 ± 0.0407
      swd: 3.8826 ± 0.4210
      ept: 103.4978 ± 2.3966
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 11.5453 ± 0.3508
      mae: 1.8657 ± 0.0115
      huber: 1.4854 ± 0.0121
      swd: 2.1985 ± 0.4904
      ept: 123.2854 ± 10.0595
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 42.49 seconds
    
    Experiment complete: ACL_etth1_seq196_pred720_20250510_1540
    Model: ACL
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### Timemixer

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=196,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.7415, mae: 1.6560, huber: 1.2782, swd: 1.9945, target_std: 6.4648
    Epoch [1/50], Val Losses: mse: 8.1312, mae: 1.4776, huber: 1.1209, swd: 0.9657, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 10.6900, mae: 1.7690, huber: 1.4002, swd: 1.7929, target_std: 4.7554
      Epoch 1 composite train-obj: 1.278178
            Val objective improved inf → 1.1209, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.1884, mae: 1.4558, huber: 1.0905, swd: 1.6092, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 7.9745, mae: 1.4468, huber: 1.0922, swd: 0.8806, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.5388, mae: 1.7341, huber: 1.3673, swd: 1.6595, target_std: 4.7554
      Epoch 2 composite train-obj: 1.090499
            Val objective improved 1.1209 → 1.0922, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.0311, mae: 1.4293, huber: 1.0665, swd: 1.5675, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 7.7300, mae: 1.4252, huber: 1.0720, swd: 0.8506, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.3280, mae: 1.7203, huber: 1.3546, swd: 1.6663, target_std: 4.7554
      Epoch 3 composite train-obj: 1.066515
            Val objective improved 1.0922 → 1.0720, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 5.9086, mae: 1.4100, huber: 1.0491, swd: 1.5177, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.7705, mae: 1.4303, huber: 1.0783, swd: 0.9882, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.1999, mae: 1.7084, huber: 1.3435, swd: 1.8096, target_std: 4.7554
      Epoch 4 composite train-obj: 1.049076
            No improvement (1.0783), counter 1/5
    Epoch [5/50], Train Losses: mse: 5.8043, mae: 1.3955, huber: 1.0357, swd: 1.4779, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.7318, mae: 1.4291, huber: 1.0773, swd: 1.0130, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 10.0878, mae: 1.7019, huber: 1.3375, swd: 1.8151, target_std: 4.7554
      Epoch 5 composite train-obj: 1.035717
            No improvement (1.0773), counter 2/5
    Epoch [6/50], Train Losses: mse: 5.7132, mae: 1.3822, huber: 1.0234, swd: 1.4367, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.9650, mae: 1.4477, huber: 1.0946, swd: 0.9145, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 10.2571, mae: 1.7024, huber: 1.3380, swd: 1.6016, target_std: 4.7554
      Epoch 6 composite train-obj: 1.023350
            No improvement (1.0946), counter 3/5
    Epoch [7/50], Train Losses: mse: 5.6150, mae: 1.3692, huber: 1.0110, swd: 1.3881, target_std: 6.4647
    Epoch [7/50], Val Losses: mse: 7.7150, mae: 1.4301, huber: 1.0769, swd: 0.9523, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 10.1778, mae: 1.7119, huber: 1.3461, swd: 1.7794, target_std: 4.7554
      Epoch 7 composite train-obj: 1.010972
            No improvement (1.0769), counter 4/5
    Epoch [8/50], Train Losses: mse: 5.5151, mae: 1.3567, huber: 0.9989, swd: 1.3428, target_std: 6.4648
    Epoch [8/50], Val Losses: mse: 7.7295, mae: 1.4389, huber: 1.0848, swd: 0.9843, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 10.0649, mae: 1.7048, huber: 1.3389, swd: 1.7118, target_std: 4.7554
      Epoch 8 composite train-obj: 0.998905
    Epoch [8/50], Test Losses: mse: 10.3280, mae: 1.7203, huber: 1.3546, swd: 1.6663, target_std: 4.7554
    Best round's Test MSE: 10.3280, MAE: 1.7203, SWD: 1.6663
    Best round's Validation MSE: 7.7300, MAE: 1.4252
    Best round's Test verification MSE : 10.3280, MAE: 1.7203, SWD: 1.6663
    Time taken: 29.24 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.5405, mae: 1.6321, huber: 1.2554, swd: 1.8845, target_std: 6.4647
    Epoch [1/50], Val Losses: mse: 8.0617, mae: 1.4694, huber: 1.1137, swd: 0.8623, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 10.7142, mae: 1.7733, huber: 1.4049, swd: 1.6749, target_std: 4.7554
      Epoch 1 composite train-obj: 1.255386
            Val objective improved inf → 1.1137, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.2205, mae: 1.4587, huber: 1.0936, swd: 1.5501, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 7.7219, mae: 1.4156, huber: 1.0636, swd: 0.8279, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.4617, mae: 1.7377, huber: 1.3720, swd: 1.7183, target_std: 4.7554
      Epoch 2 composite train-obj: 1.093647
            Val objective improved 1.1137 → 1.0636, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.0783, mae: 1.4365, huber: 1.0734, swd: 1.5124, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 7.8070, mae: 1.4237, huber: 1.0715, swd: 0.8185, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.4674, mae: 1.7240, huber: 1.3597, swd: 1.6203, target_std: 4.7554
      Epoch 3 composite train-obj: 1.073366
            No improvement (1.0715), counter 1/5
    Epoch [4/50], Train Losses: mse: 5.9787, mae: 1.4200, huber: 1.0585, swd: 1.4728, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.6147, mae: 1.4145, huber: 1.0622, swd: 0.8323, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.3083, mae: 1.7188, huber: 1.3547, swd: 1.6940, target_std: 4.7554
      Epoch 4 composite train-obj: 1.058503
            Val objective improved 1.0636 → 1.0622, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 5.8883, mae: 1.4075, huber: 1.0470, swd: 1.4395, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.5585, mae: 1.4044, huber: 1.0533, swd: 0.8842, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 10.1683, mae: 1.7120, huber: 1.3477, swd: 1.7951, target_std: 4.7554
      Epoch 5 composite train-obj: 1.046955
            Val objective improved 1.0622 → 1.0533, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 5.7989, mae: 1.3949, huber: 1.0352, swd: 1.4001, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.7025, mae: 1.4129, huber: 1.0616, swd: 0.8583, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 10.2345, mae: 1.7133, huber: 1.3492, swd: 1.7236, target_std: 4.7554
      Epoch 6 composite train-obj: 1.035189
            No improvement (1.0616), counter 1/5
    Epoch [7/50], Train Losses: mse: 5.7184, mae: 1.3837, huber: 1.0245, swd: 1.3566, target_std: 6.4647
    Epoch [7/50], Val Losses: mse: 7.6334, mae: 1.4154, huber: 1.0635, swd: 0.9160, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 10.0934, mae: 1.7061, huber: 1.3415, swd: 1.6977, target_std: 4.7554
      Epoch 7 composite train-obj: 1.024452
            No improvement (1.0635), counter 2/5
    Epoch [8/50], Train Losses: mse: 5.5887, mae: 1.3666, huber: 1.0082, swd: 1.2915, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.6427, mae: 1.4235, huber: 1.0708, swd: 0.9357, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 10.2076, mae: 1.7218, huber: 1.3566, swd: 1.7740, target_std: 4.7554
      Epoch 8 composite train-obj: 1.008236
            No improvement (1.0708), counter 3/5
    Epoch [9/50], Train Losses: mse: 5.4714, mae: 1.3500, huber: 0.9923, swd: 1.2279, target_std: 6.4647
    Epoch [9/50], Val Losses: mse: 7.8784, mae: 1.4335, huber: 1.0813, swd: 0.9463, target_std: 4.3393
    Epoch [9/50], Test Losses: mse: 10.2400, mae: 1.7160, huber: 1.3509, swd: 1.6718, target_std: 4.7554
      Epoch 9 composite train-obj: 0.992302
            No improvement (1.0813), counter 4/5
    Epoch [10/50], Train Losses: mse: 5.3272, mae: 1.3322, huber: 0.9750, swd: 1.1583, target_std: 6.4647
    Epoch [10/50], Val Losses: mse: 7.5792, mae: 1.4201, huber: 1.0672, swd: 0.9553, target_std: 4.3393
    Epoch [10/50], Test Losses: mse: 10.1990, mae: 1.7245, huber: 1.3581, swd: 1.7483, target_std: 4.7554
      Epoch 10 composite train-obj: 0.975044
    Epoch [10/50], Test Losses: mse: 10.1683, mae: 1.7120, huber: 1.3477, swd: 1.7951, target_std: 4.7554
    Best round's Test MSE: 10.1683, MAE: 1.7120, SWD: 1.7951
    Best round's Validation MSE: 7.5585, MAE: 1.4044
    Best round's Test verification MSE : 10.1683, MAE: 1.7120, SWD: 1.7951
    Time taken: 35.06 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.9581, mae: 1.6790, huber: 1.3006, swd: 1.8535, target_std: 6.4648
    Epoch [1/50], Val Losses: mse: 7.9794, mae: 1.4705, huber: 1.1142, swd: 0.9895, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 10.5919, mae: 1.7753, huber: 1.4060, swd: 1.8710, target_std: 4.7554
      Epoch 1 composite train-obj: 1.300598
            Val objective improved inf → 1.1142, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.2628, mae: 1.4678, huber: 1.1018, swd: 1.5022, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 7.8173, mae: 1.4346, huber: 1.0812, swd: 0.8785, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.4779, mae: 1.7395, huber: 1.3735, swd: 1.7167, target_std: 4.7554
      Epoch 2 composite train-obj: 1.101821
            Val objective improved 1.1142 → 1.0812, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.1061, mae: 1.4411, huber: 1.0776, swd: 1.4576, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 7.7702, mae: 1.4287, huber: 1.0755, swd: 0.8734, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.3896, mae: 1.7294, huber: 1.3637, swd: 1.6989, target_std: 4.7554
      Epoch 3 composite train-obj: 1.077571
            Val objective improved 1.0812 → 1.0755, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.0146, mae: 1.4265, huber: 1.0642, swd: 1.4250, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.7115, mae: 1.4241, huber: 1.0714, swd: 0.9332, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.2729, mae: 1.7203, huber: 1.3557, swd: 1.7855, target_std: 4.7554
      Epoch 4 composite train-obj: 1.064227
            Val objective improved 1.0755 → 1.0714, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 5.9305, mae: 1.4138, huber: 1.0526, swd: 1.3944, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.6797, mae: 1.4211, huber: 1.0689, swd: 0.9061, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 10.1907, mae: 1.7108, huber: 1.3468, swd: 1.7426, target_std: 4.7554
      Epoch 5 composite train-obj: 1.052584
            Val objective improved 1.0714 → 1.0689, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 5.8530, mae: 1.4020, huber: 1.0416, swd: 1.3656, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.6034, mae: 1.4193, huber: 1.0654, swd: 0.9324, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 10.2560, mae: 1.7270, huber: 1.3614, swd: 1.9436, target_std: 4.7554
      Epoch 6 composite train-obj: 1.041582
            Val objective improved 1.0689 → 1.0654, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 5.7583, mae: 1.3896, huber: 1.0299, swd: 1.3322, target_std: 6.4648
    Epoch [7/50], Val Losses: mse: 7.7946, mae: 1.4389, huber: 1.0860, swd: 1.0512, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 10.2768, mae: 1.7335, huber: 1.3680, swd: 1.9843, target_std: 4.7554
      Epoch 7 composite train-obj: 1.029901
            No improvement (1.0860), counter 1/5
    Epoch [8/50], Train Losses: mse: 5.6742, mae: 1.3784, huber: 1.0193, swd: 1.2960, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.7148, mae: 1.4341, huber: 1.0809, swd: 0.9652, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 10.1483, mae: 1.7170, huber: 1.3520, swd: 1.8155, target_std: 4.7554
      Epoch 8 composite train-obj: 1.019280
            No improvement (1.0809), counter 2/5
    Epoch [9/50], Train Losses: mse: 5.5842, mae: 1.3660, huber: 1.0075, swd: 1.2564, target_std: 6.4648
    Epoch [9/50], Val Losses: mse: 7.7698, mae: 1.4351, huber: 1.0818, swd: 0.9478, target_std: 4.3393
    Epoch [9/50], Test Losses: mse: 10.2128, mae: 1.7180, huber: 1.3526, swd: 1.7747, target_std: 4.7554
      Epoch 9 composite train-obj: 1.007535
            No improvement (1.0818), counter 3/5
    Epoch [10/50], Train Losses: mse: 5.4749, mae: 1.3527, huber: 0.9946, swd: 1.2128, target_std: 6.4648
    Epoch [10/50], Val Losses: mse: 7.8462, mae: 1.4557, huber: 1.1013, swd: 1.1076, target_std: 4.3393
    Epoch [10/50], Test Losses: mse: 10.3052, mae: 1.7382, huber: 1.3714, swd: 1.9196, target_std: 4.7554
      Epoch 10 composite train-obj: 0.994557
            No improvement (1.1013), counter 4/5
    Epoch [11/50], Train Losses: mse: 5.3668, mae: 1.3381, huber: 0.9806, swd: 1.1622, target_std: 6.4647
    Epoch [11/50], Val Losses: mse: 7.7409, mae: 1.4477, huber: 1.0936, swd: 1.0217, target_std: 4.3393
    Epoch [11/50], Test Losses: mse: 10.1037, mae: 1.7215, huber: 1.3551, swd: 1.7393, target_std: 4.7554
      Epoch 11 composite train-obj: 0.980573
    Epoch [11/50], Test Losses: mse: 10.2560, mae: 1.7270, huber: 1.3614, swd: 1.9436, target_std: 4.7554
    Best round's Test MSE: 10.2560, MAE: 1.7270, SWD: 1.9436
    Best round's Validation MSE: 7.6034, MAE: 1.4193
    Best round's Test verification MSE : 10.2560, MAE: 1.7270, SWD: 1.9436
    Time taken: 38.90 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq196_pred96_20250503_2011)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.2508 ± 0.0653
      mae: 1.7198 ± 0.0061
      huber: 1.3546 ± 0.0056
      swd: 1.8017 ± 0.1133
      target_std: 4.7554 ± 0.0000
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 7.6306 ± 0.0726
      mae: 1.4163 ± 0.0088
      huber: 1.0636 ± 0.0078
      swd: 0.8891 ± 0.0336
      target_std: 4.3393 ± 0.0000
      count: 12.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 103.29 seconds
    
    Experiment complete: TimeMixer_etth1_seq196_pred96_20250503_2011
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=196,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 11
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.8138, mae: 1.7778, huber: 1.3912, swd: 1.9247, target_std: 6.4575
    Epoch [1/50], Val Losses: mse: 9.9810, mae: 1.6621, huber: 1.2993, swd: 1.1070, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 10.8568, mae: 1.8520, huber: 1.4755, swd: 1.7695, target_std: 4.7558
      Epoch 1 composite train-obj: 1.391153
            Val objective improved inf → 1.2993, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.9453, mae: 1.5785, huber: 1.2041, swd: 1.6703, target_std: 6.4554
    Epoch [2/50], Val Losses: mse: 10.0947, mae: 1.6296, huber: 1.2695, swd: 1.1302, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.7272, mae: 1.8200, huber: 1.4446, swd: 1.5874, target_std: 4.7558
      Epoch 2 composite train-obj: 1.204076
            Val objective improved 1.2993 → 1.2695, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.7708, mae: 1.5535, huber: 1.1808, swd: 1.6175, target_std: 6.4595
    Epoch [3/50], Val Losses: mse: 9.9411, mae: 1.6272, huber: 1.2665, swd: 1.3034, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.6974, mae: 1.8237, huber: 1.4474, swd: 1.8607, target_std: 4.7558
      Epoch 3 composite train-obj: 1.180751
            Val objective improved 1.2695 → 1.2665, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.6594, mae: 1.5395, huber: 1.1675, swd: 1.5870, target_std: 6.4524
    Epoch [4/50], Val Losses: mse: 9.9625, mae: 1.6316, huber: 1.2710, swd: 1.3354, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.4637, mae: 1.8084, huber: 1.4321, swd: 1.7400, target_std: 4.7558
      Epoch 4 composite train-obj: 1.167491
            No improvement (1.2710), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.5605, mae: 1.5262, huber: 1.1546, swd: 1.5497, target_std: 6.4581
    Epoch [5/50], Val Losses: mse: 10.0491, mae: 1.6533, huber: 1.2908, swd: 1.4784, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.5090, mae: 1.8188, huber: 1.4411, swd: 1.9242, target_std: 4.7558
      Epoch 5 composite train-obj: 1.154646
            No improvement (1.2908), counter 2/5
    Epoch [6/50], Train Losses: mse: 6.4665, mae: 1.5146, huber: 1.1436, swd: 1.5103, target_std: 6.4515
    Epoch [6/50], Val Losses: mse: 9.8835, mae: 1.6383, huber: 1.2760, swd: 1.3241, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.3932, mae: 1.8042, huber: 1.4269, swd: 1.6735, target_std: 4.7558
      Epoch 6 composite train-obj: 1.143595
            No improvement (1.2760), counter 3/5
    Epoch [7/50], Train Losses: mse: 6.3426, mae: 1.4974, huber: 1.1270, swd: 1.4501, target_std: 6.4545
    Epoch [7/50], Val Losses: mse: 10.0109, mae: 1.6595, huber: 1.2955, swd: 1.3485, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.4367, mae: 1.8181, huber: 1.4402, swd: 1.5825, target_std: 4.7558
      Epoch 7 composite train-obj: 1.126984
            No improvement (1.2955), counter 4/5
    Epoch [8/50], Train Losses: mse: 6.2390, mae: 1.4850, huber: 1.1147, swd: 1.3995, target_std: 6.4581
    Epoch [8/50], Val Losses: mse: 11.3263, mae: 1.7541, huber: 1.3883, swd: 1.6616, target_std: 4.3251
    Epoch [8/50], Test Losses: mse: 10.8907, mae: 1.8409, huber: 1.4610, swd: 1.8340, target_std: 4.7558
      Epoch 8 composite train-obj: 1.114741
    Epoch [8/50], Test Losses: mse: 10.6974, mae: 1.8237, huber: 1.4474, swd: 1.8607, target_std: 4.7558
    Best round's Test MSE: 10.6974, MAE: 1.8237, SWD: 1.8607
    Best round's Validation MSE: 9.9411, MAE: 1.6272
    Best round's Test verification MSE : 10.6974, MAE: 1.8237, SWD: 1.8607
    Time taken: 29.91 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.4353, mae: 1.7476, huber: 1.3630, swd: 1.9555, target_std: 6.4571
    Epoch [1/50], Val Losses: mse: 9.9270, mae: 1.6717, huber: 1.3088, swd: 1.1039, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 10.9540, mae: 1.8629, huber: 1.4860, swd: 1.7059, target_std: 4.7558
      Epoch 1 composite train-obj: 1.363046
            Val objective improved inf → 1.3088, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0109, mae: 1.5863, huber: 1.2119, swd: 1.7000, target_std: 6.4584
    Epoch [2/50], Val Losses: mse: 9.8120, mae: 1.6083, huber: 1.2487, swd: 1.0271, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.8602, mae: 1.8244, huber: 1.4500, swd: 1.6113, target_std: 4.7558
      Epoch 2 composite train-obj: 1.211921
            Val objective improved 1.3088 → 1.2487, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.8829, mae: 1.5625, huber: 1.1900, swd: 1.6572, target_std: 6.4499
    Epoch [3/50], Val Losses: mse: 9.6005, mae: 1.5948, huber: 1.2362, swd: 1.1200, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.5793, mae: 1.8100, huber: 1.4356, swd: 1.7188, target_std: 4.7558
      Epoch 3 composite train-obj: 1.190035
            Val objective improved 1.2487 → 1.2362, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.7840, mae: 1.5499, huber: 1.1783, swd: 1.6229, target_std: 6.4548
    Epoch [4/50], Val Losses: mse: 9.6767, mae: 1.6050, huber: 1.2459, swd: 1.1691, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.5240, mae: 1.8076, huber: 1.4327, swd: 1.7284, target_std: 4.7558
      Epoch 4 composite train-obj: 1.178328
            No improvement (1.2459), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.6698, mae: 1.5368, huber: 1.1659, swd: 1.5848, target_std: 6.4529
    Epoch [5/50], Val Losses: mse: 10.0333, mae: 1.6343, huber: 1.2743, swd: 1.2855, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.5490, mae: 1.8014, huber: 1.4261, swd: 1.6434, target_std: 4.7558
      Epoch 5 composite train-obj: 1.165893
            No improvement (1.2743), counter 2/5
    Epoch [6/50], Train Losses: mse: 6.5647, mae: 1.5244, huber: 1.1540, swd: 1.5489, target_std: 6.4548
    Epoch [6/50], Val Losses: mse: 9.6091, mae: 1.6020, huber: 1.2434, swd: 1.1186, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.4160, mae: 1.7976, huber: 1.4229, swd: 1.5435, target_std: 4.7558
      Epoch 6 composite train-obj: 1.154045
            No improvement (1.2434), counter 3/5
    Epoch [7/50], Train Losses: mse: 6.4508, mae: 1.5098, huber: 1.1400, swd: 1.4893, target_std: 6.4616
    Epoch [7/50], Val Losses: mse: 10.3653, mae: 1.6646, huber: 1.3040, swd: 1.3937, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.4923, mae: 1.8070, huber: 1.4305, swd: 1.6652, target_std: 4.7558
      Epoch 7 composite train-obj: 1.140021
            No improvement (1.3040), counter 4/5
    Epoch [8/50], Train Losses: mse: 6.3481, mae: 1.4972, huber: 1.1277, swd: 1.4340, target_std: 6.4518
    Epoch [8/50], Val Losses: mse: 10.0335, mae: 1.6627, huber: 1.3012, swd: 1.6122, target_std: 4.3251
    Epoch [8/50], Test Losses: mse: 10.4211, mae: 1.8265, huber: 1.4484, swd: 1.9801, target_std: 4.7558
      Epoch 8 composite train-obj: 1.127746
    Epoch [8/50], Test Losses: mse: 10.5793, mae: 1.8100, huber: 1.4356, swd: 1.7188, target_std: 4.7558
    Best round's Test MSE: 10.5793, MAE: 1.8100, SWD: 1.7188
    Best round's Validation MSE: 9.6005, MAE: 1.5948
    Best round's Test verification MSE : 10.5793, MAE: 1.8100, SWD: 1.7188
    Time taken: 29.05 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.1620, mae: 1.8099, huber: 1.4226, swd: 1.7662, target_std: 6.4634
    Epoch [1/50], Val Losses: mse: 10.0715, mae: 1.6712, huber: 1.3086, swd: 1.0706, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 10.9176, mae: 1.8554, huber: 1.4793, swd: 1.6548, target_std: 4.7558
      Epoch 1 composite train-obj: 1.422594
            Val objective improved inf → 1.3086, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0135, mae: 1.5885, huber: 1.2139, swd: 1.5236, target_std: 6.4563
    Epoch [2/50], Val Losses: mse: 9.7398, mae: 1.6084, huber: 1.2488, swd: 1.0308, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.7057, mae: 1.8233, huber: 1.4488, swd: 1.6725, target_std: 4.7558
      Epoch 2 composite train-obj: 1.213864
            Val objective improved 1.3086 → 1.2488, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.8367, mae: 1.5600, huber: 1.1875, swd: 1.4788, target_std: 6.4585
    Epoch [3/50], Val Losses: mse: 9.7209, mae: 1.6094, huber: 1.2494, swd: 1.0246, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.5869, mae: 1.8189, huber: 1.4439, swd: 1.5447, target_std: 4.7558
      Epoch 3 composite train-obj: 1.187515
            No improvement (1.2494), counter 1/5
    Epoch [4/50], Train Losses: mse: 6.7076, mae: 1.5422, huber: 1.1709, swd: 1.4295, target_std: 6.4611
    Epoch [4/50], Val Losses: mse: 10.1309, mae: 1.6464, huber: 1.2850, swd: 1.2796, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.6448, mae: 1.8175, huber: 1.4415, swd: 1.7860, target_std: 4.7558
      Epoch 4 composite train-obj: 1.170880
            No improvement (1.2850), counter 2/5
    Epoch [5/50], Train Losses: mse: 6.6114, mae: 1.5288, huber: 1.1582, swd: 1.3979, target_std: 6.4542
    Epoch [5/50], Val Losses: mse: 10.1102, mae: 1.6478, huber: 1.2865, swd: 1.3424, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.5493, mae: 1.8181, huber: 1.4416, swd: 1.8184, target_std: 4.7558
      Epoch 5 composite train-obj: 1.158160
            No improvement (1.2865), counter 3/5
    Epoch [6/50], Train Losses: mse: 6.4908, mae: 1.5141, huber: 1.1440, swd: 1.3581, target_std: 6.4531
    Epoch [6/50], Val Losses: mse: 10.3002, mae: 1.6600, huber: 1.2981, swd: 1.3124, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.6415, mae: 1.8235, huber: 1.4462, swd: 1.7320, target_std: 4.7558
      Epoch 6 composite train-obj: 1.143978
            No improvement (1.2981), counter 4/5
    Epoch [7/50], Train Losses: mse: 6.3606, mae: 1.4985, huber: 1.1287, swd: 1.3118, target_std: 6.4559
    Epoch [7/50], Val Losses: mse: 9.9628, mae: 1.6370, huber: 1.2750, swd: 1.0514, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.6211, mae: 1.8236, huber: 1.4463, swd: 1.4391, target_std: 4.7558
      Epoch 7 composite train-obj: 1.128681
    Epoch [7/50], Test Losses: mse: 10.7057, mae: 1.8233, huber: 1.4488, swd: 1.6725, target_std: 4.7558
    Best round's Test MSE: 10.7057, MAE: 1.8233, SWD: 1.6725
    Best round's Validation MSE: 9.7398, MAE: 1.6084
    Best round's Test verification MSE : 10.7057, MAE: 1.8233, SWD: 1.6725
    Time taken: 26.00 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq196_pred196_20250503_2012)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.6608 ± 0.0577
      mae: 1.8190 ± 0.0064
      huber: 1.4439 ± 0.0059
      swd: 1.7507 ± 0.0801
      target_std: 4.7558 ± 0.0000
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.7605 ± 0.1398
      mae: 1.6101 ± 0.0133
      huber: 1.2505 ± 0.0124
      swd: 1.1514 ± 0.1135
      target_std: 4.3251 ± 0.0000
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 85.02 seconds
    
    Experiment complete: TimeMixer_etth1_seq196_pred196_20250503_2012
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=196,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.3335, mae: 1.8832, huber: 1.4918, swd: 2.1711, target_std: 6.4462
    Epoch [1/50], Val Losses: mse: 10.6352, mae: 1.6953, huber: 1.3328, swd: 1.1779, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 10.8892, mae: 1.9221, huber: 1.5400, swd: 1.9444, target_std: 4.7862
      Epoch 1 composite train-obj: 1.491814
            Val objective improved inf → 1.3328, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.5913, mae: 1.6882, huber: 1.3068, swd: 1.8230, target_std: 6.4495
    Epoch [2/50], Val Losses: mse: 10.8131, mae: 1.6719, huber: 1.3115, swd: 0.9995, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 10.6414, mae: 1.8768, huber: 1.4968, swd: 1.6141, target_std: 4.7862
      Epoch 2 composite train-obj: 1.306751
            Val objective improved 1.3328 → 1.3115, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3979, mae: 1.6591, huber: 1.2798, swd: 1.7622, target_std: 6.4326
    Epoch [3/50], Val Losses: mse: 11.2176, mae: 1.6879, huber: 1.3267, swd: 0.9822, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.6818, mae: 1.8745, huber: 1.4939, swd: 1.5267, target_std: 4.7862
      Epoch 3 composite train-obj: 1.279824
            No improvement (1.3267), counter 1/5
    Epoch [4/50], Train Losses: mse: 7.2452, mae: 1.6406, huber: 1.2623, swd: 1.7066, target_std: 6.4406
    Epoch [4/50], Val Losses: mse: 10.5882, mae: 1.6618, huber: 1.3015, swd: 1.2116, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.5135, mae: 1.8878, huber: 1.5055, swd: 1.8993, target_std: 4.7862
      Epoch 4 composite train-obj: 1.262264
            Val objective improved 1.3115 → 1.3015, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.1065, mae: 1.6260, huber: 1.2481, swd: 1.6572, target_std: 6.4402
    Epoch [5/50], Val Losses: mse: 10.9979, mae: 1.6957, huber: 1.3332, swd: 1.2621, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.5030, mae: 1.8817, huber: 1.4986, swd: 1.7272, target_std: 4.7862
      Epoch 5 composite train-obj: 1.248131
            No improvement (1.3332), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.9752, mae: 1.6104, huber: 1.2329, swd: 1.5787, target_std: 6.4422
    Epoch [6/50], Val Losses: mse: 10.6973, mae: 1.6960, huber: 1.3315, swd: 1.3090, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.5386, mae: 1.8989, huber: 1.5137, swd: 1.8596, target_std: 4.7862
      Epoch 6 composite train-obj: 1.232898
            No improvement (1.3315), counter 2/5
    Epoch [7/50], Train Losses: mse: 6.8186, mae: 1.5921, huber: 1.2145, swd: 1.4985, target_std: 6.4323
    Epoch [7/50], Val Losses: mse: 11.8197, mae: 1.7564, huber: 1.3899, swd: 1.2256, target_std: 4.3096
    Epoch [7/50], Test Losses: mse: 10.5944, mae: 1.8826, huber: 1.4984, swd: 1.4577, target_std: 4.7862
      Epoch 7 composite train-obj: 1.214511
            No improvement (1.3899), counter 3/5
    Epoch [8/50], Train Losses: mse: 6.6718, mae: 1.5748, huber: 1.1973, swd: 1.4003, target_std: 6.4394
    Epoch [8/50], Val Losses: mse: 12.8976, mae: 1.8308, huber: 1.4614, swd: 1.4128, target_std: 4.3096
    Epoch [8/50], Test Losses: mse: 10.8162, mae: 1.8991, huber: 1.5129, swd: 1.5600, target_std: 4.7862
      Epoch 8 composite train-obj: 1.197322
            No improvement (1.4614), counter 4/5
    Epoch [9/50], Train Losses: mse: 6.5235, mae: 1.5571, huber: 1.1798, swd: 1.3163, target_std: 6.4392
    Epoch [9/50], Val Losses: mse: 11.8677, mae: 1.7736, huber: 1.4052, swd: 1.3350, target_std: 4.3096
    Epoch [9/50], Test Losses: mse: 10.6709, mae: 1.9117, huber: 1.5243, swd: 1.7393, target_std: 4.7862
      Epoch 9 composite train-obj: 1.179780
    Epoch [9/50], Test Losses: mse: 10.5135, mae: 1.8878, huber: 1.5055, swd: 1.8993, target_std: 4.7862
    Best round's Test MSE: 10.5135, MAE: 1.8878, SWD: 1.8993
    Best round's Validation MSE: 10.5882, MAE: 1.6618
    Best round's Test verification MSE : 10.5135, MAE: 1.8878, SWD: 1.8993
    Time taken: 37.83 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.6917, mae: 1.8931, huber: 1.4999, swd: 2.1660, target_std: 6.4434
    Epoch [1/50], Val Losses: mse: 10.5697, mae: 1.7070, huber: 1.3436, swd: 1.2475, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 10.9904, mae: 1.9358, huber: 1.5526, swd: 2.0577, target_std: 4.7862
      Epoch 1 composite train-obj: 1.499919
            Val objective improved inf → 1.3436, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.5918, mae: 1.6902, huber: 1.3084, swd: 1.8463, target_std: 6.4452
    Epoch [2/50], Val Losses: mse: 10.1492, mae: 1.6332, huber: 1.2723, swd: 0.9029, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 10.8030, mae: 1.8931, huber: 1.5131, swd: 1.5957, target_std: 4.7862
      Epoch 2 composite train-obj: 1.308432
            Val objective improved 1.3436 → 1.2723, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3818, mae: 1.6583, huber: 1.2789, swd: 1.7700, target_std: 6.4367
    Epoch [3/50], Val Losses: mse: 10.8350, mae: 1.6613, huber: 1.3010, swd: 0.9409, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.6886, mae: 1.8851, huber: 1.5038, swd: 1.5635, target_std: 4.7862
      Epoch 3 composite train-obj: 1.278889
            No improvement (1.3010), counter 1/5
    Epoch [4/50], Train Losses: mse: 7.2582, mae: 1.6438, huber: 1.2653, swd: 1.7299, target_std: 6.4380
    Epoch [4/50], Val Losses: mse: 10.8637, mae: 1.6723, huber: 1.3109, swd: 1.0835, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.6047, mae: 1.8863, huber: 1.5032, swd: 1.5629, target_std: 4.7862
      Epoch 4 composite train-obj: 1.265305
            No improvement (1.3109), counter 2/5
    Epoch [5/50], Train Losses: mse: 7.1268, mae: 1.6295, huber: 1.2513, swd: 1.6625, target_std: 6.4333
    Epoch [5/50], Val Losses: mse: 10.5162, mae: 1.6692, huber: 1.3063, swd: 1.1118, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.7253, mae: 1.9035, huber: 1.5202, swd: 1.5437, target_std: 4.7862
      Epoch 5 composite train-obj: 1.251261
            No improvement (1.3063), counter 3/5
    Epoch [6/50], Train Losses: mse: 6.9975, mae: 1.6152, huber: 1.2371, swd: 1.6015, target_std: 6.4430
    Epoch [6/50], Val Losses: mse: 11.9770, mae: 1.7712, huber: 1.4050, swd: 1.4839, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.7491, mae: 1.9147, huber: 1.5274, swd: 1.7184, target_std: 4.7862
      Epoch 6 composite train-obj: 1.237101
            No improvement (1.4050), counter 4/5
    Epoch [7/50], Train Losses: mse: 6.8669, mae: 1.5993, huber: 1.2215, swd: 1.5308, target_std: 6.4447
    Epoch [7/50], Val Losses: mse: 11.7251, mae: 1.7426, huber: 1.3770, swd: 1.1220, target_std: 4.3096
    Epoch [7/50], Test Losses: mse: 10.6565, mae: 1.8849, huber: 1.5007, swd: 1.4083, target_std: 4.7862
      Epoch 7 composite train-obj: 1.221515
    Epoch [7/50], Test Losses: mse: 10.8030, mae: 1.8931, huber: 1.5131, swd: 1.5957, target_std: 4.7862
    Best round's Test MSE: 10.8030, MAE: 1.8931, SWD: 1.5957
    Best round's Validation MSE: 10.1492, MAE: 1.6332
    Best round's Test verification MSE : 10.8030, MAE: 1.8931, SWD: 1.5957
    Time taken: 29.85 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.9904, mae: 2.0888, huber: 1.6920, swd: 2.3709, target_std: 6.4418
    Epoch [1/50], Val Losses: mse: 11.0275, mae: 1.7519, huber: 1.3882, swd: 1.4504, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 10.9419, mae: 1.9455, huber: 1.5622, swd: 2.1210, target_std: 4.7862
      Epoch 1 composite train-obj: 1.691951
            Val objective improved inf → 1.3882, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6904, mae: 1.7078, huber: 1.3252, swd: 1.8182, target_std: 6.4380
    Epoch [2/50], Val Losses: mse: 10.6732, mae: 1.6670, huber: 1.3069, swd: 1.1667, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 10.7182, mae: 1.9020, huber: 1.5205, swd: 1.8783, target_std: 4.7862
      Epoch 2 composite train-obj: 1.325237
            Val objective improved 1.3882 → 1.3069, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.4754, mae: 1.6722, huber: 1.2921, swd: 1.7448, target_std: 6.4385
    Epoch [3/50], Val Losses: mse: 10.5703, mae: 1.6591, huber: 1.2989, swd: 1.1974, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.6920, mae: 1.9034, huber: 1.5217, swd: 1.9716, target_std: 4.7862
      Epoch 3 composite train-obj: 1.292055
            Val objective improved 1.3069 → 1.2989, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.3524, mae: 1.6553, huber: 1.2762, swd: 1.7150, target_std: 6.4449
    Epoch [4/50], Val Losses: mse: 10.6457, mae: 1.6625, huber: 1.3022, swd: 1.1623, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.6173, mae: 1.8904, huber: 1.5088, swd: 1.8723, target_std: 4.7862
      Epoch 4 composite train-obj: 1.276231
            No improvement (1.3022), counter 1/5
    Epoch [5/50], Train Losses: mse: 7.2507, mae: 1.6417, huber: 1.2632, swd: 1.6786, target_std: 6.4523
    Epoch [5/50], Val Losses: mse: 10.6640, mae: 1.6706, huber: 1.3085, swd: 1.0737, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.7034, mae: 1.8897, huber: 1.5083, swd: 1.7156, target_std: 4.7862
      Epoch 5 composite train-obj: 1.263208
            No improvement (1.3085), counter 2/5
    Epoch [6/50], Train Losses: mse: 7.1406, mae: 1.6296, huber: 1.2515, swd: 1.6226, target_std: 6.4374
    Epoch [6/50], Val Losses: mse: 11.2012, mae: 1.7205, huber: 1.3572, swd: 1.4420, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.7184, mae: 1.9098, huber: 1.5266, swd: 2.0086, target_std: 4.7862
      Epoch 6 composite train-obj: 1.251450
            No improvement (1.3572), counter 3/5
    Epoch [7/50], Train Losses: mse: 7.0213, mae: 1.6149, huber: 1.2371, swd: 1.5704, target_std: 6.4429
    Epoch [7/50], Val Losses: mse: 11.4983, mae: 1.7518, huber: 1.3869, swd: 1.5922, target_std: 4.3096
    Epoch [7/50], Test Losses: mse: 10.6835, mae: 1.9094, huber: 1.5249, swd: 1.9917, target_std: 4.7862
      Epoch 7 composite train-obj: 1.237125
            No improvement (1.3869), counter 4/5
    Epoch [8/50], Train Losses: mse: 6.9091, mae: 1.6024, huber: 1.2248, swd: 1.5106, target_std: 6.4478
    Epoch [8/50], Val Losses: mse: 11.5992, mae: 1.7538, huber: 1.3878, swd: 1.4430, target_std: 4.3096
    Epoch [8/50], Test Losses: mse: 10.7931, mae: 1.9118, huber: 1.5267, swd: 1.8269, target_std: 4.7862
      Epoch 8 composite train-obj: 1.224823
    Epoch [8/50], Test Losses: mse: 10.6920, mae: 1.9034, huber: 1.5217, swd: 1.9716, target_std: 4.7862
    Best round's Test MSE: 10.6920, MAE: 1.9034, SWD: 1.9716
    Best round's Validation MSE: 10.5703, MAE: 1.6591
    Best round's Test verification MSE : 10.6920, MAE: 1.9034, SWD: 1.9716
    Time taken: 30.35 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq196_pred336_20250503_2014)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.6695 ± 0.1192
      mae: 1.8948 ± 0.0064
      huber: 1.5134 ± 0.0066
      swd: 1.8222 ± 0.1628
      target_std: 4.7862 ± 0.0000
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 10.4359 ± 0.2028
      mae: 1.6514 ± 0.0129
      huber: 1.2909 ± 0.0132
      swd: 1.1040 ± 0.1423
      target_std: 4.3096 ± 0.0000
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 98.10 seconds
    
    Experiment complete: TimeMixer_etth1_seq196_pred336_20250503_2014
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=196,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.7593, mae: 2.0681, huber: 1.6651, swd: 2.6767, target_std: 6.3648
    Epoch [1/50], Val Losses: mse: 9.9738, mae: 1.7126, huber: 1.3479, swd: 1.2136, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 12.3012, mae: 2.1662, huber: 1.7682, swd: 2.5463, target_std: 4.8325
      Epoch 1 composite train-obj: 1.665125
            Val objective improved inf → 1.3479, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.9343, mae: 1.8906, huber: 1.4953, swd: 2.5028, target_std: 6.3674
    Epoch [2/50], Val Losses: mse: 9.7869, mae: 1.6581, huber: 1.2947, swd: 1.0806, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.1302, mae: 2.1318, huber: 1.7350, swd: 2.4423, target_std: 4.8325
      Epoch 2 composite train-obj: 1.495258
            Val objective improved 1.3479 → 1.2947, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.7032, mae: 1.8615, huber: 1.4677, swd: 2.3988, target_std: 6.3699
    Epoch [3/50], Val Losses: mse: 10.9287, mae: 1.7927, huber: 1.4237, swd: 2.0337, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 12.2234, mae: 2.1752, huber: 1.7738, swd: 2.8330, target_std: 4.8325
      Epoch 3 composite train-obj: 1.467651
            No improvement (1.4237), counter 1/5
    Epoch [4/50], Train Losses: mse: 8.4492, mae: 1.8374, huber: 1.4440, swd: 2.2762, target_std: 6.3656
    Epoch [4/50], Val Losses: mse: 11.5605, mae: 1.8051, huber: 1.4365, swd: 1.6804, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 12.2664, mae: 2.1486, huber: 1.7484, swd: 2.4331, target_std: 4.8325
      Epoch 4 composite train-obj: 1.443961
            No improvement (1.4365), counter 2/5
    Epoch [5/50], Train Losses: mse: 8.2627, mae: 1.8163, huber: 1.4230, swd: 2.1564, target_std: 6.3572
    Epoch [5/50], Val Losses: mse: 12.4067, mae: 1.8907, huber: 1.5202, swd: 2.0609, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 12.1088, mae: 2.1421, huber: 1.7413, swd: 2.3073, target_std: 4.8325
      Epoch 5 composite train-obj: 1.423010
            No improvement (1.5202), counter 3/5
    Epoch [6/50], Train Losses: mse: 8.0247, mae: 1.7880, huber: 1.3950, swd: 2.0063, target_std: 6.3574
    Epoch [6/50], Val Losses: mse: 11.9205, mae: 1.8434, huber: 1.4729, swd: 1.8098, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.0190, mae: 2.1363, huber: 1.7343, swd: 2.2293, target_std: 4.8325
      Epoch 6 composite train-obj: 1.394967
            No improvement (1.4729), counter 4/5
    Epoch [7/50], Train Losses: mse: 7.7880, mae: 1.7595, huber: 1.3669, swd: 1.8446, target_std: 6.3592
    Epoch [7/50], Val Losses: mse: 11.2697, mae: 1.7885, huber: 1.4190, swd: 1.5521, target_std: 4.3199
    Epoch [7/50], Test Losses: mse: 12.0335, mae: 2.1468, huber: 1.7432, swd: 2.1643, target_std: 4.8325
      Epoch 7 composite train-obj: 1.366898
    Epoch [7/50], Test Losses: mse: 12.1302, mae: 2.1318, huber: 1.7350, swd: 2.4423, target_std: 4.8325
    Best round's Test MSE: 12.1302, MAE: 2.1318, SWD: 2.4423
    Best round's Validation MSE: 9.7869, MAE: 1.6581
    Best round's Test verification MSE : 12.1302, MAE: 2.1318, SWD: 2.4423
    Time taken: 30.50 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.7072, mae: 2.0562, huber: 1.6534, swd: 2.5757, target_std: 6.3668
    Epoch [1/50], Val Losses: mse: 9.5801, mae: 1.6763, huber: 1.3127, swd: 1.1243, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 12.2539, mae: 2.1576, huber: 1.7608, swd: 2.5218, target_std: 4.8325
      Epoch 1 composite train-obj: 1.653448
            Val objective improved inf → 1.3127, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.9830, mae: 1.8934, huber: 1.4981, swd: 2.3356, target_std: 6.3616
    Epoch [2/50], Val Losses: mse: 9.4815, mae: 1.6301, huber: 1.2677, swd: 0.9568, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.0241, mae: 2.1166, huber: 1.7219, swd: 2.3951, target_std: 4.8325
      Epoch 2 composite train-obj: 1.498090
            Val objective improved 1.3127 → 1.2677, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.8113, mae: 1.8690, huber: 1.4750, swd: 2.2730, target_std: 6.3648
    Epoch [3/50], Val Losses: mse: 9.4363, mae: 1.6114, huber: 1.2491, swd: 0.9113, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 11.9705, mae: 2.1179, huber: 1.7229, swd: 2.3131, target_std: 4.8325
      Epoch 3 composite train-obj: 1.475025
            Val objective improved 1.2677 → 1.2491, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 8.5020, mae: 1.8384, huber: 1.4451, swd: 2.1054, target_std: 6.3698
    Epoch [4/50], Val Losses: mse: 9.7977, mae: 1.6744, huber: 1.3096, swd: 1.3444, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 11.9048, mae: 2.1167, huber: 1.7195, swd: 2.3554, target_std: 4.8325
      Epoch 4 composite train-obj: 1.445051
            No improvement (1.3096), counter 1/5
    Epoch [5/50], Train Losses: mse: 8.1546, mae: 1.8011, huber: 1.4085, swd: 1.9017, target_std: 6.3659
    Epoch [5/50], Val Losses: mse: 10.3806, mae: 1.7286, huber: 1.3627, swd: 1.3882, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 11.5952, mae: 2.0798, huber: 1.6828, swd: 1.8760, target_std: 4.8325
      Epoch 5 composite train-obj: 1.408533
            No improvement (1.3627), counter 2/5
    Epoch [6/50], Train Losses: mse: 7.9489, mae: 1.7761, huber: 1.3843, swd: 1.7724, target_std: 6.3641
    Epoch [6/50], Val Losses: mse: 9.8063, mae: 1.6794, huber: 1.3138, swd: 1.2428, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 11.6283, mae: 2.0833, huber: 1.6886, swd: 2.0834, target_std: 4.8325
      Epoch 6 composite train-obj: 1.384277
            No improvement (1.3138), counter 3/5
    Epoch [7/50], Train Losses: mse: 7.7108, mae: 1.7471, huber: 1.3558, swd: 1.6410, target_std: 6.3684
    Epoch [7/50], Val Losses: mse: 10.1238, mae: 1.7118, huber: 1.3461, swd: 1.3312, target_std: 4.3199
    Epoch [7/50], Test Losses: mse: 11.6027, mae: 2.0929, huber: 1.6973, swd: 2.2324, target_std: 4.8325
      Epoch 7 composite train-obj: 1.355822
            No improvement (1.3461), counter 4/5
    Epoch [8/50], Train Losses: mse: 7.4911, mae: 1.7193, huber: 1.3287, swd: 1.5282, target_std: 6.3631
    Epoch [8/50], Val Losses: mse: 10.3887, mae: 1.7496, huber: 1.3816, swd: 1.4344, target_std: 4.3199
    Epoch [8/50], Test Losses: mse: 11.7195, mae: 2.1079, huber: 1.7104, swd: 2.2021, target_std: 4.8325
      Epoch 8 composite train-obj: 1.328727
    Epoch [8/50], Test Losses: mse: 11.9705, mae: 2.1179, huber: 1.7229, swd: 2.3131, target_std: 4.8325
    Best round's Test MSE: 11.9705, MAE: 2.1179, SWD: 2.3131
    Best round's Validation MSE: 9.4363, MAE: 1.6114
    Best round's Test verification MSE : 11.9705, MAE: 2.1179, SWD: 2.3131
    Time taken: 34.84 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.5159, mae: 2.1413, huber: 1.7375, swd: 3.2444, target_std: 6.3654
    Epoch [1/50], Val Losses: mse: 10.4562, mae: 1.7772, huber: 1.4109, swd: 1.8935, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 12.5114, mae: 2.2090, huber: 1.8094, swd: 3.1864, target_std: 4.8325
      Epoch 1 composite train-obj: 1.737466
            Val objective improved inf → 1.4109, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.9989, mae: 1.9038, huber: 1.5079, swd: 2.6265, target_std: 6.3728
    Epoch [2/50], Val Losses: mse: 9.6365, mae: 1.6644, huber: 1.3005, swd: 1.3212, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.1762, mae: 2.1533, huber: 1.7568, swd: 2.8181, target_std: 4.8325
      Epoch 2 composite train-obj: 1.507907
            Val objective improved 1.4109 → 1.3005, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.7826, mae: 1.8713, huber: 1.4769, swd: 2.5156, target_std: 6.3624
    Epoch [3/50], Val Losses: mse: 9.9224, mae: 1.7061, huber: 1.3391, swd: 1.7643, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 12.5363, mae: 2.2098, huber: 1.8106, swd: 3.2660, target_std: 4.8325
      Epoch 3 composite train-obj: 1.476940
            No improvement (1.3391), counter 1/5
    Epoch [4/50], Train Losses: mse: 8.6273, mae: 1.8520, huber: 1.4583, swd: 2.4427, target_std: 6.3589
    Epoch [4/50], Val Losses: mse: 10.3632, mae: 1.7446, huber: 1.3754, swd: 1.7782, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 12.4716, mae: 2.1950, huber: 1.7954, swd: 2.9876, target_std: 4.8325
      Epoch 4 composite train-obj: 1.458326
            No improvement (1.3754), counter 2/5
    Epoch [5/50], Train Losses: mse: 8.2704, mae: 1.8193, huber: 1.4254, swd: 2.2081, target_std: 6.3678
    Epoch [5/50], Val Losses: mse: 12.7191, mae: 1.9826, huber: 1.6058, swd: 2.7771, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 13.3043, mae: 2.2987, huber: 1.8921, swd: 3.3386, target_std: 4.8325
      Epoch 5 composite train-obj: 1.425434
            No improvement (1.6058), counter 3/5
    Epoch [6/50], Train Losses: mse: 8.0027, mae: 1.7892, huber: 1.3963, swd: 1.9970, target_std: 6.3617
    Epoch [6/50], Val Losses: mse: 11.2304, mae: 1.8623, huber: 1.4899, swd: 2.4477, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.1406, mae: 2.1523, huber: 1.7530, swd: 2.5129, target_std: 4.8325
      Epoch 6 composite train-obj: 1.396274
            No improvement (1.4899), counter 4/5
    Epoch [7/50], Train Losses: mse: 7.8052, mae: 1.7650, huber: 1.3729, swd: 1.8545, target_std: 6.3661
    Epoch [7/50], Val Losses: mse: 14.4727, mae: 2.1548, huber: 1.7748, swd: 3.6223, target_std: 4.3199
    Epoch [7/50], Test Losses: mse: 13.7338, mae: 2.3464, huber: 1.9387, swd: 3.5815, target_std: 4.8325
      Epoch 7 composite train-obj: 1.372887
    Epoch [7/50], Test Losses: mse: 12.1762, mae: 2.1533, huber: 1.7568, swd: 2.8181, target_std: 4.8325
    Best round's Test MSE: 12.1762, MAE: 2.1533, SWD: 2.8181
    Best round's Validation MSE: 9.6365, MAE: 1.6644
    Best round's Test verification MSE : 12.1762, MAE: 2.1533, SWD: 2.8181
    Time taken: 31.17 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq196_pred720_20250503_2015)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 12.0923 ± 0.0881
      mae: 2.1343 ± 0.0145
      huber: 1.7382 ± 0.0140
      swd: 2.5245 ± 0.2142
      target_std: 4.8325 ± 0.0000
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.6199 ± 0.1436
      mae: 1.6446 ± 0.0236
      huber: 1.2814 ± 0.0229
      swd: 1.1044 ± 0.1682
      target_std: 4.3199 ± 0.0000
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 96.57 seconds
    
    Experiment complete: TimeMixer_etth1_seq196_pred720_20250503_2015
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### PatchTST

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=196,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.8794, mae: 1.6607, huber: 1.2841, swd: 1.7985, target_std: 6.4647
    Epoch [1/50], Val Losses: mse: 7.8031, mae: 1.4335, huber: 1.0791, swd: 1.0077, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 10.6414, mae: 1.7767, huber: 1.4098, swd: 2.1552, target_std: 4.7554
      Epoch 1 composite train-obj: 1.284096
            Val objective improved inf → 1.0791, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.9350, mae: 1.5417, huber: 1.1717, swd: 1.6786, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 7.5566, mae: 1.4148, huber: 1.0616, swd: 1.0402, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.3481, mae: 1.7506, huber: 1.3839, swd: 2.1529, target_std: 4.7554
      Epoch 2 composite train-obj: 1.171682
            Val objective improved 1.0791 → 1.0616, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.7624, mae: 1.5168, huber: 1.1480, swd: 1.6179, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 7.7227, mae: 1.4333, huber: 1.0790, swd: 0.9007, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.3186, mae: 1.7269, huber: 1.3612, swd: 1.6151, target_std: 4.7554
      Epoch 3 composite train-obj: 1.148001
            No improvement (1.0790), counter 1/5
    Epoch [4/50], Train Losses: mse: 6.6394, mae: 1.5006, huber: 1.1324, swd: 1.5720, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.5595, mae: 1.4344, huber: 1.0806, swd: 1.2022, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.0133, mae: 1.7327, huber: 1.3659, swd: 2.1451, target_std: 4.7554
      Epoch 4 composite train-obj: 1.132428
            No improvement (1.0806), counter 2/5
    Epoch [5/50], Train Losses: mse: 6.5204, mae: 1.4849, huber: 1.1173, swd: 1.5171, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.4676, mae: 1.4203, huber: 1.0655, swd: 0.9402, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 10.1063, mae: 1.7269, huber: 1.3596, swd: 1.7266, target_std: 4.7554
      Epoch 5 composite train-obj: 1.117338
            No improvement (1.0655), counter 3/5
    Epoch [6/50], Train Losses: mse: 6.3938, mae: 1.4699, huber: 1.1028, swd: 1.4743, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.3391, mae: 1.4089, huber: 1.0550, swd: 1.1150, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 9.8515, mae: 1.7229, huber: 1.3547, swd: 2.1016, target_std: 4.7554
      Epoch 6 composite train-obj: 1.102756
            Val objective improved 1.0616 → 1.0550, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.2726, mae: 1.4565, huber: 1.0895, swd: 1.4295, target_std: 6.4648
    Epoch [7/50], Val Losses: mse: 7.2128, mae: 1.4053, huber: 1.0516, swd: 1.1081, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 10.0637, mae: 1.7495, huber: 1.3803, swd: 2.2573, target_std: 4.7554
      Epoch 7 composite train-obj: 1.089500
            Val objective improved 1.0550 → 1.0516, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.1527, mae: 1.4413, huber: 1.0748, swd: 1.3793, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.1724, mae: 1.4153, huber: 1.0588, swd: 1.0273, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 9.9469, mae: 1.7303, huber: 1.3599, swd: 1.8358, target_std: 4.7554
      Epoch 8 composite train-obj: 1.074757
            No improvement (1.0588), counter 1/5
    Epoch [9/50], Train Losses: mse: 6.0000, mae: 1.4231, huber: 1.0569, swd: 1.3114, target_std: 6.4647
    Epoch [9/50], Val Losses: mse: 7.1677, mae: 1.4224, huber: 1.0654, swd: 1.1308, target_std: 4.3393
    Epoch [9/50], Test Losses: mse: 10.0490, mae: 1.7446, huber: 1.3730, swd: 2.0107, target_std: 4.7554
      Epoch 9 composite train-obj: 1.056856
            No improvement (1.0654), counter 2/5
    Epoch [10/50], Train Losses: mse: 5.8854, mae: 1.4096, huber: 1.0437, swd: 1.2575, target_std: 6.4647
    Epoch [10/50], Val Losses: mse: 7.1040, mae: 1.4137, huber: 1.0563, swd: 1.1206, target_std: 4.3393
    Epoch [10/50], Test Losses: mse: 10.2532, mae: 1.7761, huber: 1.4031, swd: 2.4054, target_std: 4.7554
      Epoch 10 composite train-obj: 1.043721
            No improvement (1.0563), counter 3/5
    Epoch [11/50], Train Losses: mse: 5.7936, mae: 1.3986, huber: 1.0330, swd: 1.2294, target_std: 6.4648
    Epoch [11/50], Val Losses: mse: 7.0647, mae: 1.4067, huber: 1.0492, swd: 1.0151, target_std: 4.3393
    Epoch [11/50], Test Losses: mse: 10.1176, mae: 1.7533, huber: 1.3809, swd: 1.9638, target_std: 4.7554
      Epoch 11 composite train-obj: 1.032996
            Val objective improved 1.0516 → 1.0492, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 5.6569, mae: 1.3816, huber: 1.0165, swd: 1.1724, target_std: 6.4647
    Epoch [12/50], Val Losses: mse: 7.2960, mae: 1.4243, huber: 1.0659, swd: 0.9454, target_std: 4.3393
    Epoch [12/50], Test Losses: mse: 10.2356, mae: 1.7581, huber: 1.3850, swd: 1.8003, target_std: 4.7554
      Epoch 12 composite train-obj: 1.016518
            No improvement (1.0659), counter 1/5
    Epoch [13/50], Train Losses: mse: 5.5606, mae: 1.3688, huber: 1.0043, swd: 1.1244, target_std: 6.4647
    Epoch [13/50], Val Losses: mse: 7.2470, mae: 1.4242, huber: 1.0671, swd: 1.1385, target_std: 4.3393
    Epoch [13/50], Test Losses: mse: 10.3517, mae: 1.7853, huber: 1.4107, swd: 2.2316, target_std: 4.7554
      Epoch 13 composite train-obj: 1.004346
            No improvement (1.0671), counter 2/5
    Epoch [14/50], Train Losses: mse: 5.4679, mae: 1.3568, huber: 0.9927, swd: 1.0888, target_std: 6.4647
    Epoch [14/50], Val Losses: mse: 7.2268, mae: 1.4399, huber: 1.0803, swd: 1.1551, target_std: 4.3393
    Epoch [14/50], Test Losses: mse: 10.3208, mae: 1.7902, huber: 1.4137, swd: 2.2936, target_std: 4.7554
      Epoch 14 composite train-obj: 0.992709
            No improvement (1.0803), counter 3/5
    Epoch [15/50], Train Losses: mse: 5.3493, mae: 1.3448, huber: 0.9807, swd: 1.0534, target_std: 6.4648
    Epoch [15/50], Val Losses: mse: 7.0557, mae: 1.4138, huber: 1.0553, swd: 1.0016, target_std: 4.3393
    Epoch [15/50], Test Losses: mse: 10.3060, mae: 1.7790, huber: 1.4032, swd: 2.0415, target_std: 4.7554
      Epoch 15 composite train-obj: 0.980711
            No improvement (1.0553), counter 4/5
    Epoch [16/50], Train Losses: mse: 5.2482, mae: 1.3301, huber: 0.9669, swd: 1.0091, target_std: 6.4647
    Epoch [16/50], Val Losses: mse: 7.4455, mae: 1.4472, huber: 1.0873, swd: 1.0740, target_std: 4.3393
    Epoch [16/50], Test Losses: mse: 10.3807, mae: 1.7866, huber: 1.4094, swd: 2.0341, target_std: 4.7554
      Epoch 16 composite train-obj: 0.966852
    Epoch [16/50], Test Losses: mse: 10.1176, mae: 1.7533, huber: 1.3809, swd: 1.9638, target_std: 4.7554
    Best round's Test MSE: 10.1176, MAE: 1.7533, SWD: 1.9638
    Best round's Validation MSE: 7.0647, MAE: 1.4067
    Best round's Test verification MSE : 10.1176, MAE: 1.7533, SWD: 1.9638
    Time taken: 36.45 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.8608, mae: 1.6589, huber: 1.2822, swd: 1.7019, target_std: 6.4647
    Epoch [1/50], Val Losses: mse: 8.0378, mae: 1.4753, huber: 1.1186, swd: 0.9909, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 10.4084, mae: 1.7723, huber: 1.4040, swd: 1.9353, target_std: 4.7554
      Epoch 1 composite train-obj: 1.282244
            Val objective improved inf → 1.1186, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.8830, mae: 1.5372, huber: 1.1669, swd: 1.5704, target_std: 6.4648
    Epoch [2/50], Val Losses: mse: 7.8269, mae: 1.4565, huber: 1.1013, swd: 1.0497, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.1333, mae: 1.7299, huber: 1.3632, swd: 1.8110, target_std: 4.7554
      Epoch 2 composite train-obj: 1.166944
            Val objective improved 1.1186 → 1.1013, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.6795, mae: 1.5111, huber: 1.1423, swd: 1.5129, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 7.3806, mae: 1.4137, huber: 1.0597, swd: 0.8304, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.0073, mae: 1.7208, huber: 1.3540, swd: 1.6706, target_std: 4.7554
      Epoch 3 composite train-obj: 1.142325
            Val objective improved 1.1013 → 1.0597, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.5478, mae: 1.4956, huber: 1.1271, swd: 1.4683, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.7658, mae: 1.4546, huber: 1.0986, swd: 0.9273, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.0772, mae: 1.7184, huber: 1.3511, swd: 1.6590, target_std: 4.7554
      Epoch 4 composite train-obj: 1.127134
            No improvement (1.0986), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.4310, mae: 1.4810, huber: 1.1130, swd: 1.4386, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.5466, mae: 1.4429, huber: 1.0880, swd: 1.0289, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 9.7848, mae: 1.7035, huber: 1.3368, swd: 1.6938, target_std: 4.7554
      Epoch 5 composite train-obj: 1.113006
            No improvement (1.0880), counter 2/5
    Epoch [6/50], Train Losses: mse: 6.2702, mae: 1.4617, huber: 1.0941, swd: 1.3819, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.2432, mae: 1.4146, huber: 1.0586, swd: 1.0864, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 9.9654, mae: 1.7416, huber: 1.3717, swd: 2.2525, target_std: 4.7554
      Epoch 6 composite train-obj: 1.094146
            Val objective improved 1.0597 → 1.0586, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.1494, mae: 1.4470, huber: 1.0797, swd: 1.3369, target_std: 6.4647
    Epoch [7/50], Val Losses: mse: 7.3386, mae: 1.4389, huber: 1.0816, swd: 1.0419, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 9.8041, mae: 1.7145, huber: 1.3460, swd: 1.8759, target_std: 4.7554
      Epoch 7 composite train-obj: 1.079687
            No improvement (1.0816), counter 1/5
    Epoch [8/50], Train Losses: mse: 6.0400, mae: 1.4335, huber: 1.0666, swd: 1.2982, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.3658, mae: 1.4422, huber: 1.0864, swd: 1.1637, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 9.8178, mae: 1.7254, huber: 1.3544, swd: 1.9251, target_std: 4.7554
      Epoch 8 composite train-obj: 1.066562
            No improvement (1.0864), counter 2/5
    Epoch [9/50], Train Losses: mse: 5.9323, mae: 1.4215, huber: 1.0547, swd: 1.2548, target_std: 6.4647
    Epoch [9/50], Val Losses: mse: 7.2455, mae: 1.4311, huber: 1.0740, swd: 1.1617, target_std: 4.3393
    Epoch [9/50], Test Losses: mse: 9.9088, mae: 1.7306, huber: 1.3594, swd: 2.0829, target_std: 4.7554
      Epoch 9 composite train-obj: 1.054731
            No improvement (1.0740), counter 3/5
    Epoch [10/50], Train Losses: mse: 5.8165, mae: 1.4062, huber: 1.0400, swd: 1.2052, target_std: 6.4648
    Epoch [10/50], Val Losses: mse: 7.4150, mae: 1.4586, huber: 1.0984, swd: 1.1068, target_std: 4.3393
    Epoch [10/50], Test Losses: mse: 9.8113, mae: 1.7295, huber: 1.3566, swd: 1.7783, target_std: 4.7554
      Epoch 10 composite train-obj: 1.039964
            No improvement (1.0984), counter 4/5
    Epoch [11/50], Train Losses: mse: 5.7075, mae: 1.3939, huber: 1.0278, swd: 1.1561, target_std: 6.4647
    Epoch [11/50], Val Losses: mse: 7.2187, mae: 1.4284, huber: 1.0713, swd: 1.1133, target_std: 4.3393
    Epoch [11/50], Test Losses: mse: 9.9434, mae: 1.7404, huber: 1.3681, swd: 2.1058, target_std: 4.7554
      Epoch 11 composite train-obj: 1.027845
    Epoch [11/50], Test Losses: mse: 9.9654, mae: 1.7416, huber: 1.3717, swd: 2.2525, target_std: 4.7554
    Best round's Test MSE: 9.9654, MAE: 1.7416, SWD: 2.2525
    Best round's Validation MSE: 7.2432, MAE: 1.4146
    Best round's Test verification MSE : 9.9654, MAE: 1.7416, SWD: 2.2525
    Time taken: 24.65 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.8136, mae: 1.6535, huber: 1.2772, swd: 1.6277, target_std: 6.4647
    Epoch [1/50], Val Losses: mse: 7.7075, mae: 1.4262, huber: 1.0720, swd: 0.9537, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 10.6132, mae: 1.7804, huber: 1.4123, swd: 2.1096, target_std: 4.7554
      Epoch 1 composite train-obj: 1.277198
            Val objective improved inf → 1.0720, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.9038, mae: 1.5385, huber: 1.1687, swd: 1.5194, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 7.4780, mae: 1.4123, huber: 1.0587, swd: 0.9235, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.1876, mae: 1.7523, huber: 1.3841, swd: 1.9880, target_std: 4.7554
      Epoch 2 composite train-obj: 1.168659
            Val objective improved 1.0720 → 1.0587, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.7169, mae: 1.5128, huber: 1.1442, swd: 1.4575, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 7.3457, mae: 1.4036, huber: 1.0495, swd: 1.0995, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.2574, mae: 1.7626, huber: 1.3918, swd: 2.3929, target_std: 4.7554
      Epoch 3 composite train-obj: 1.144200
            Val objective improved 1.0587 → 1.0495, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.5612, mae: 1.4929, huber: 1.1248, swd: 1.4209, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.3824, mae: 1.4216, huber: 1.0674, swd: 1.0270, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 9.8915, mae: 1.7112, huber: 1.3449, swd: 1.8850, target_std: 4.7554
      Epoch 4 composite train-obj: 1.124827
            No improvement (1.0674), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.4263, mae: 1.4754, huber: 1.1078, swd: 1.3683, target_std: 6.4648
    Epoch [5/50], Val Losses: mse: 7.3621, mae: 1.4221, huber: 1.0677, swd: 1.0937, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 9.8577, mae: 1.7273, huber: 1.3581, swd: 1.9311, target_std: 4.7554
      Epoch 5 composite train-obj: 1.107838
            No improvement (1.0677), counter 2/5
    Epoch [6/50], Train Losses: mse: 6.3114, mae: 1.4627, huber: 1.0952, swd: 1.3378, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.5647, mae: 1.4571, huber: 1.1018, swd: 1.2305, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 9.7754, mae: 1.7245, huber: 1.3551, swd: 1.9738, target_std: 4.7554
      Epoch 6 composite train-obj: 1.095224
            No improvement (1.1018), counter 3/5
    Epoch [7/50], Train Losses: mse: 6.1607, mae: 1.4442, huber: 1.0774, swd: 1.2851, target_std: 6.4647
    Epoch [7/50], Val Losses: mse: 7.4071, mae: 1.4457, huber: 1.0886, swd: 1.1758, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 9.9160, mae: 1.7325, huber: 1.3620, swd: 1.8953, target_std: 4.7554
      Epoch 7 composite train-obj: 1.077356
            No improvement (1.0886), counter 4/5
    Epoch [8/50], Train Losses: mse: 6.0073, mae: 1.4265, huber: 1.0600, swd: 1.2256, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.2818, mae: 1.4238, huber: 1.0684, swd: 1.2473, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 10.0787, mae: 1.7636, huber: 1.3911, swd: 2.3888, target_std: 4.7554
      Epoch 8 composite train-obj: 1.059963
    Epoch [8/50], Test Losses: mse: 10.2574, mae: 1.7626, huber: 1.3918, swd: 2.3929, target_std: 4.7554
    Best round's Test MSE: 10.2574, MAE: 1.7626, SWD: 2.3929
    Best round's Validation MSE: 7.3457, MAE: 1.4036
    Best round's Test verification MSE : 10.2574, MAE: 1.7626, SWD: 2.3929
    Time taken: 18.31 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq196_pred96_20250503_2002)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.1135 ± 0.1192
      mae: 1.7525 ± 0.0086
      huber: 1.3815 ± 0.0082
      swd: 2.2031 ± 0.1786
      target_std: 4.7554 ± 0.0000
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 7.2179 ± 0.1161
      mae: 1.4083 ± 0.0046
      huber: 1.0524 ± 0.0044
      swd: 1.0670 ± 0.0371
      target_std: 4.3393 ± 0.0000
      count: 12.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 79.50 seconds
    
    Experiment complete: PatchTST_etth1_seq196_pred96_20250503_2002
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=196,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 11
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.5288, mae: 1.7591, huber: 1.3760, swd: 1.8526, target_std: 6.4497
    Epoch [1/50], Val Losses: mse: 9.2858, mae: 1.6043, huber: 1.2425, swd: 1.0915, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 10.8944, mae: 1.8625, huber: 1.4867, swd: 1.9066, target_std: 4.7558
      Epoch 1 composite train-obj: 1.376046
            Val objective improved inf → 1.2425, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6520, mae: 1.6561, huber: 1.2781, swd: 1.7518, target_std: 6.4606
    Epoch [2/50], Val Losses: mse: 9.6018, mae: 1.6343, huber: 1.2739, swd: 1.5212, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.6156, mae: 1.8542, huber: 1.4783, swd: 2.2016, target_std: 4.7558
      Epoch 2 composite train-obj: 1.278087
            No improvement (1.2739), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.4334, mae: 1.6323, huber: 1.2548, swd: 1.6800, target_std: 6.4590
    Epoch [3/50], Val Losses: mse: 9.2972, mae: 1.6143, huber: 1.2538, swd: 1.2586, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.3361, mae: 1.8047, huber: 1.4303, swd: 1.7880, target_std: 4.7558
      Epoch 3 composite train-obj: 1.254782
            No improvement (1.2538), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.1942, mae: 1.6079, huber: 1.2306, swd: 1.5873, target_std: 6.4565
    Epoch [4/50], Val Losses: mse: 9.1475, mae: 1.6276, huber: 1.2646, swd: 1.5535, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.2175, mae: 1.8276, huber: 1.4487, swd: 2.1846, target_std: 4.7558
      Epoch 4 composite train-obj: 1.230632
            No improvement (1.2646), counter 3/5
    Epoch [5/50], Train Losses: mse: 6.9659, mae: 1.5835, huber: 1.2063, swd: 1.4979, target_std: 6.4505
    Epoch [5/50], Val Losses: mse: 9.8666, mae: 1.6724, huber: 1.3075, swd: 1.4113, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.2780, mae: 1.8218, huber: 1.4415, swd: 1.5833, target_std: 4.7558
      Epoch 5 composite train-obj: 1.206330
            No improvement (1.3075), counter 4/5
    Epoch [6/50], Train Losses: mse: 6.7830, mae: 1.5632, huber: 1.1864, swd: 1.4239, target_std: 6.4559
    Epoch [6/50], Val Losses: mse: 9.9359, mae: 1.6642, huber: 1.3011, swd: 1.4094, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.2901, mae: 1.8168, huber: 1.4358, swd: 1.6495, target_std: 4.7558
      Epoch 6 composite train-obj: 1.186400
    Epoch [6/50], Test Losses: mse: 10.8944, mae: 1.8625, huber: 1.4867, swd: 1.9066, target_std: 4.7558
    Best round's Test MSE: 10.8944, MAE: 1.8625, SWD: 1.9066
    Best round's Validation MSE: 9.2858, MAE: 1.6043
    Best round's Test verification MSE : 10.8944, MAE: 1.8625, SWD: 1.9066
    Time taken: 14.27 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.5487, mae: 1.7621, huber: 1.3785, swd: 1.8303, target_std: 6.4578
    Epoch [1/50], Val Losses: mse: 9.2963, mae: 1.6075, huber: 1.2467, swd: 1.2443, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 10.8231, mae: 1.8587, huber: 1.4837, swd: 2.0479, target_std: 4.7558
      Epoch 1 composite train-obj: 1.378471
            Val objective improved inf → 1.2467, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6039, mae: 1.6548, huber: 1.2757, swd: 1.7165, target_std: 6.4538
    Epoch [2/50], Val Losses: mse: 8.9553, mae: 1.5829, huber: 1.2216, swd: 1.0499, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.8134, mae: 1.8536, huber: 1.4765, swd: 1.7391, target_std: 4.7558
      Epoch 2 composite train-obj: 1.275700
            Val objective improved 1.2467 → 1.2216, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3081, mae: 1.6230, huber: 1.2441, swd: 1.6254, target_std: 6.4559
    Epoch [3/50], Val Losses: mse: 9.3682, mae: 1.6411, huber: 1.2778, swd: 1.6771, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.5440, mae: 1.8742, huber: 1.4907, swd: 2.4335, target_std: 4.7558
      Epoch 3 composite train-obj: 1.244103
            No improvement (1.2778), counter 1/5
    Epoch [4/50], Train Losses: mse: 7.0910, mae: 1.5974, huber: 1.2191, swd: 1.5363, target_std: 6.4592
    Epoch [4/50], Val Losses: mse: 9.3707, mae: 1.6419, huber: 1.2771, swd: 1.5725, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.1947, mae: 1.8381, huber: 1.4539, swd: 1.9569, target_std: 4.7558
      Epoch 4 composite train-obj: 1.219051
            No improvement (1.2771), counter 2/5
    Epoch [5/50], Train Losses: mse: 6.9114, mae: 1.5771, huber: 1.1994, swd: 1.4665, target_std: 6.4605
    Epoch [5/50], Val Losses: mse: 8.8605, mae: 1.6078, huber: 1.2415, swd: 1.5381, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.6520, mae: 1.8545, huber: 1.4711, swd: 2.1627, target_std: 4.7558
      Epoch 5 composite train-obj: 1.199426
            No improvement (1.2415), counter 3/5
    Epoch [6/50], Train Losses: mse: 6.7484, mae: 1.5564, huber: 1.1794, swd: 1.3929, target_std: 6.4585
    Epoch [6/50], Val Losses: mse: 8.9499, mae: 1.6221, huber: 1.2587, swd: 1.8108, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.2524, mae: 1.8560, huber: 1.4717, swd: 2.4869, target_std: 4.7558
      Epoch 6 composite train-obj: 1.179411
            No improvement (1.2587), counter 4/5
    Epoch [7/50], Train Losses: mse: 6.5929, mae: 1.5377, huber: 1.1615, swd: 1.3248, target_std: 6.4625
    Epoch [7/50], Val Losses: mse: 8.7799, mae: 1.5906, huber: 1.2275, swd: 1.1925, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.1351, mae: 1.8357, huber: 1.4497, swd: 1.7228, target_std: 4.7558
      Epoch 7 composite train-obj: 1.161451
    Epoch [7/50], Test Losses: mse: 10.8134, mae: 1.8536, huber: 1.4765, swd: 1.7391, target_std: 4.7558
    Best round's Test MSE: 10.8134, MAE: 1.8536, SWD: 1.7391
    Best round's Validation MSE: 8.9553, MAE: 1.5829
    Best round's Test verification MSE : 10.8134, MAE: 1.8536, SWD: 1.7391
    Time taken: 16.61 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.5490, mae: 1.7616, huber: 1.3785, swd: 1.6539, target_std: 6.4536
    Epoch [1/50], Val Losses: mse: 9.4565, mae: 1.6305, huber: 1.2693, swd: 1.2655, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 10.9993, mae: 1.8857, huber: 1.5092, swd: 2.0701, target_std: 4.7558
      Epoch 1 composite train-obj: 1.378455
            Val objective improved inf → 1.2693, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6417, mae: 1.6540, huber: 1.2762, swd: 1.5494, target_std: 6.4530
    Epoch [2/50], Val Losses: mse: 9.2346, mae: 1.6019, huber: 1.2422, swd: 1.1770, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.6260, mae: 1.8374, huber: 1.4619, swd: 1.8959, target_std: 4.7558
      Epoch 2 composite train-obj: 1.276171
            Val objective improved 1.2693 → 1.2422, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.4030, mae: 1.6273, huber: 1.2499, swd: 1.4871, target_std: 6.4521
    Epoch [3/50], Val Losses: mse: 9.4646, mae: 1.6457, huber: 1.2838, swd: 1.5931, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.5127, mae: 1.8590, huber: 1.4803, swd: 2.3092, target_std: 4.7558
      Epoch 3 composite train-obj: 1.249922
            No improvement (1.2838), counter 1/5
    Epoch [4/50], Train Losses: mse: 7.1988, mae: 1.6075, huber: 1.2298, swd: 1.4256, target_std: 6.4510
    Epoch [4/50], Val Losses: mse: 9.3742, mae: 1.6398, huber: 1.2772, swd: 1.4688, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.2706, mae: 1.8296, huber: 1.4502, swd: 1.9854, target_std: 4.7558
      Epoch 4 composite train-obj: 1.229811
            No improvement (1.2772), counter 2/5
    Epoch [5/50], Train Losses: mse: 7.0082, mae: 1.5864, huber: 1.2088, swd: 1.3524, target_std: 6.4613
    Epoch [5/50], Val Losses: mse: 9.6535, mae: 1.6475, huber: 1.2825, swd: 1.0908, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.2739, mae: 1.8245, huber: 1.4436, swd: 1.4282, target_std: 4.7558
      Epoch 5 composite train-obj: 1.208778
            No improvement (1.2825), counter 3/5
    Epoch [6/50], Train Losses: mse: 6.8321, mae: 1.5640, huber: 1.1871, swd: 1.2819, target_std: 6.4564
    Epoch [6/50], Val Losses: mse: 9.1758, mae: 1.6248, huber: 1.2609, swd: 1.4876, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.1945, mae: 1.8331, huber: 1.4512, swd: 2.1525, target_std: 4.7558
      Epoch 6 composite train-obj: 1.187067
            No improvement (1.2609), counter 4/5
    Epoch [7/50], Train Losses: mse: 6.7155, mae: 1.5515, huber: 1.1749, swd: 1.2349, target_std: 6.4507
    Epoch [7/50], Val Losses: mse: 10.9727, mae: 1.7353, huber: 1.3681, swd: 1.1923, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.2587, mae: 1.8292, huber: 1.4447, swd: 1.4310, target_std: 4.7558
      Epoch 7 composite train-obj: 1.174907
    Epoch [7/50], Test Losses: mse: 10.6260, mae: 1.8374, huber: 1.4619, swd: 1.8959, target_std: 4.7558
    Best round's Test MSE: 10.6260, MAE: 1.8374, SWD: 1.8959
    Best round's Validation MSE: 9.2346, MAE: 1.6019
    Best round's Test verification MSE : 10.6260, MAE: 1.8374, SWD: 1.8959
    Time taken: 16.74 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq196_pred196_20250503_2004)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.7779 ± 0.1124
      mae: 1.8512 ± 0.0104
      huber: 1.4751 ± 0.0102
      swd: 1.8472 ± 0.0766
      target_std: 4.7558 ± 0.0000
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.1586 ± 0.1452
      mae: 1.5963 ± 0.0095
      huber: 1.2354 ± 0.0098
      swd: 1.1061 ± 0.0529
      target_std: 4.3251 ± 0.0000
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 47.69 seconds
    
    Experiment complete: PatchTST_etth1_seq196_pred196_20250503_2004
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=196,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.1148, mae: 1.8538, huber: 1.4643, swd: 1.9266, target_std: 6.4417
    Epoch [1/50], Val Losses: mse: 10.0018, mae: 1.6602, huber: 1.2969, swd: 1.1757, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 11.4232, mae: 1.9659, huber: 1.5829, swd: 2.2511, target_std: 4.7862
      Epoch 1 composite train-obj: 1.464313
            Val objective improved inf → 1.2969, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.2287, mae: 1.7552, huber: 1.3700, swd: 1.8493, target_std: 6.4411
    Epoch [2/50], Val Losses: mse: 10.1505, mae: 1.6726, huber: 1.3086, swd: 1.1742, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 10.6672, mae: 1.9071, huber: 1.5257, swd: 1.9278, target_std: 4.7862
      Epoch 2 composite train-obj: 1.369958
            No improvement (1.3086), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.8396, mae: 1.7161, huber: 1.3308, swd: 1.6970, target_std: 6.4472
    Epoch [3/50], Val Losses: mse: 11.9553, mae: 1.8126, huber: 1.4418, swd: 1.5403, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 11.0946, mae: 1.9509, huber: 1.5608, swd: 1.7463, target_std: 4.7862
      Epoch 3 composite train-obj: 1.330757
            No improvement (1.4418), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.5554, mae: 1.6864, huber: 1.3010, swd: 1.5655, target_std: 6.4360
    Epoch [4/50], Val Losses: mse: 10.2182, mae: 1.7073, huber: 1.3373, swd: 1.0568, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.5788, mae: 1.9178, huber: 1.5289, swd: 1.6719, target_std: 4.7862
      Epoch 4 composite train-obj: 1.300978
            No improvement (1.3373), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.3282, mae: 1.6606, huber: 1.2758, swd: 1.4709, target_std: 6.4456
    Epoch [5/50], Val Losses: mse: 10.3160, mae: 1.7075, huber: 1.3377, swd: 1.0740, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.7557, mae: 1.9233, huber: 1.5335, swd: 1.5113, target_std: 4.7862
      Epoch 5 composite train-obj: 1.275765
            No improvement (1.3377), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.1428, mae: 1.6362, huber: 1.2522, swd: 1.3778, target_std: 6.4398
    Epoch [6/50], Val Losses: mse: 10.9734, mae: 1.7411, huber: 1.3709, swd: 1.3420, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.8238, mae: 1.9497, huber: 1.5560, swd: 1.9734, target_std: 4.7862
      Epoch 6 composite train-obj: 1.252204
    Epoch [6/50], Test Losses: mse: 11.4232, mae: 1.9659, huber: 1.5829, swd: 2.2511, target_std: 4.7862
    Best round's Test MSE: 11.4232, MAE: 1.9659, SWD: 2.2511
    Best round's Validation MSE: 10.0018, MAE: 1.6602
    Best round's Test verification MSE : 11.4232, MAE: 1.9659, SWD: 2.2511
    Time taken: 15.41 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.0903, mae: 1.8503, huber: 1.4609, swd: 1.9511, target_std: 6.4351
    Epoch [1/50], Val Losses: mse: 10.0888, mae: 1.6769, huber: 1.3126, swd: 1.2280, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 11.3130, mae: 1.9597, huber: 1.5769, swd: 2.0434, target_std: 4.7862
      Epoch 1 composite train-obj: 1.460896
            Val objective improved inf → 1.3126, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.1129, mae: 1.7491, huber: 1.3629, swd: 1.8417, target_std: 6.4574
    Epoch [2/50], Val Losses: mse: 10.9313, mae: 1.7275, huber: 1.3598, swd: 1.0914, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 10.7373, mae: 1.9287, huber: 1.5421, swd: 1.4475, target_std: 4.7862
      Epoch 2 composite train-obj: 1.362950
            No improvement (1.3598), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.7313, mae: 1.7090, huber: 1.3229, swd: 1.6796, target_std: 6.4334
    Epoch [3/50], Val Losses: mse: 10.1634, mae: 1.7139, huber: 1.3435, swd: 1.4399, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.7869, mae: 1.9411, huber: 1.5511, swd: 1.9895, target_std: 4.7862
      Epoch 3 composite train-obj: 1.322937
            No improvement (1.3435), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.4574, mae: 1.6758, huber: 1.2904, swd: 1.5639, target_std: 6.4466
    Epoch [4/50], Val Losses: mse: 10.3121, mae: 1.7251, huber: 1.3551, swd: 1.4466, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.6465, mae: 1.9295, huber: 1.5388, swd: 1.9578, target_std: 4.7862
      Epoch 4 composite train-obj: 1.290426
            No improvement (1.3551), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.2611, mae: 1.6511, huber: 1.2663, swd: 1.4846, target_std: 6.4404
    Epoch [5/50], Val Losses: mse: 9.6128, mae: 1.6542, huber: 1.2862, swd: 1.1969, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.9957, mae: 1.9517, huber: 1.5599, swd: 2.0204, target_std: 4.7862
      Epoch 5 composite train-obj: 1.266341
            Val objective improved 1.3126 → 1.2862, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.1212, mae: 1.6314, huber: 1.2475, swd: 1.4217, target_std: 6.4372
    Epoch [6/50], Val Losses: mse: 9.8284, mae: 1.6897, huber: 1.3197, swd: 1.5523, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 11.0371, mae: 1.9853, huber: 1.5909, swd: 2.3963, target_std: 4.7862
      Epoch 6 composite train-obj: 1.247480
            No improvement (1.3197), counter 1/5
    Epoch [7/50], Train Losses: mse: 6.9408, mae: 1.6070, huber: 1.2239, swd: 1.3419, target_std: 6.4388
    Epoch [7/50], Val Losses: mse: 10.4566, mae: 1.7205, huber: 1.3494, swd: 1.4702, target_std: 4.3096
    Epoch [7/50], Test Losses: mse: 11.0422, mae: 1.9885, huber: 1.5916, swd: 2.1674, target_std: 4.7862
      Epoch 7 composite train-obj: 1.223941
            No improvement (1.3494), counter 2/5
    Epoch [8/50], Train Losses: mse: 6.8356, mae: 1.5937, huber: 1.2111, swd: 1.2895, target_std: 6.4362
    Epoch [8/50], Val Losses: mse: 12.6381, mae: 1.8485, huber: 1.4743, swd: 1.5178, target_std: 4.3096
    Epoch [8/50], Test Losses: mse: 11.0635, mae: 1.9730, huber: 1.5779, swd: 1.8491, target_std: 4.7862
      Epoch 8 composite train-obj: 1.211089
            No improvement (1.4743), counter 3/5
    Epoch [9/50], Train Losses: mse: 6.6766, mae: 1.5726, huber: 1.1907, swd: 1.2121, target_std: 6.4362
    Epoch [9/50], Val Losses: mse: 10.3305, mae: 1.7061, huber: 1.3361, swd: 1.2699, target_std: 4.3096
    Epoch [9/50], Test Losses: mse: 10.9593, mae: 1.9744, huber: 1.5820, swd: 2.3435, target_std: 4.7862
      Epoch 9 composite train-obj: 1.190711
            No improvement (1.3361), counter 4/5
    Epoch [10/50], Train Losses: mse: 6.5884, mae: 1.5607, huber: 1.1792, swd: 1.1861, target_std: 6.4417
    Epoch [10/50], Val Losses: mse: 10.7730, mae: 1.7252, huber: 1.3534, swd: 1.2535, target_std: 4.3096
    Epoch [10/50], Test Losses: mse: 11.1857, mae: 1.9873, huber: 1.5938, swd: 2.1674, target_std: 4.7862
      Epoch 10 composite train-obj: 1.179206
    Epoch [10/50], Test Losses: mse: 10.9957, mae: 1.9517, huber: 1.5599, swd: 2.0204, target_std: 4.7862
    Best round's Test MSE: 10.9957, MAE: 1.9517, SWD: 2.0204
    Best round's Validation MSE: 9.6128, MAE: 1.6542
    Best round's Test verification MSE : 10.9957, MAE: 1.9517, SWD: 2.0204
    Time taken: 26.43 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.1252, mae: 1.8520, huber: 1.4631, swd: 1.8933, target_std: 6.4396
    Epoch [1/50], Val Losses: mse: 9.8683, mae: 1.6553, huber: 1.2927, swd: 1.4290, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 11.3582, mae: 1.9628, huber: 1.5801, swd: 2.5497, target_std: 4.7862
      Epoch 1 composite train-obj: 1.463127
            Val objective improved inf → 1.2927, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.1800, mae: 1.7507, huber: 1.3655, swd: 1.7919, target_std: 6.4443
    Epoch [2/50], Val Losses: mse: 11.4882, mae: 1.8173, huber: 1.4457, swd: 1.9435, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 11.2999, mae: 1.9959, huber: 1.6045, swd: 2.3208, target_std: 4.7862
      Epoch 2 composite train-obj: 1.365503
            No improvement (1.4457), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.7960, mae: 1.7136, huber: 1.3281, swd: 1.6450, target_std: 6.4505
    Epoch [3/50], Val Losses: mse: 10.7679, mae: 1.7370, huber: 1.3693, swd: 1.3632, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.6175, mae: 1.8996, huber: 1.5147, swd: 1.6134, target_std: 4.7862
      Epoch 3 composite train-obj: 1.328051
            No improvement (1.3693), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.5670, mae: 1.6902, huber: 1.3046, swd: 1.5475, target_std: 6.4345
    Epoch [4/50], Val Losses: mse: 10.5713, mae: 1.7238, huber: 1.3565, swd: 1.4085, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.6192, mae: 1.9178, huber: 1.5295, swd: 1.8354, target_std: 4.7862
      Epoch 4 composite train-obj: 1.304613
            No improvement (1.3565), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.3216, mae: 1.6598, huber: 1.2753, swd: 1.4612, target_std: 6.4330
    Epoch [5/50], Val Losses: mse: 9.9322, mae: 1.6923, huber: 1.3251, swd: 1.3719, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.6859, mae: 1.9325, huber: 1.5436, swd: 2.1616, target_std: 4.7862
      Epoch 5 composite train-obj: 1.275295
            No improvement (1.3251), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.1771, mae: 1.6404, huber: 1.2565, swd: 1.3934, target_std: 6.4475
    Epoch [6/50], Val Losses: mse: 11.7666, mae: 1.8207, huber: 1.4505, swd: 1.6130, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.7555, mae: 1.9478, huber: 1.5556, swd: 2.0016, target_std: 4.7862
      Epoch 6 composite train-obj: 1.256481
    Epoch [6/50], Test Losses: mse: 11.3582, mae: 1.9628, huber: 1.5801, swd: 2.5497, target_std: 4.7862
    Best round's Test MSE: 11.3582, MAE: 1.9628, SWD: 2.5497
    Best round's Validation MSE: 9.8683, MAE: 1.6553
    Best round's Test verification MSE : 11.3582, MAE: 1.9628, SWD: 2.5497
    Time taken: 15.98 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq196_pred336_20250503_2004)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 11.2590 ± 0.1881
      mae: 1.9601 ± 0.0061
      huber: 1.5743 ± 0.0103
      swd: 2.2737 ± 0.2167
      target_std: 4.7862 ± 0.0000
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.8276 ± 0.1614
      mae: 1.6566 ± 0.0026
      huber: 1.2919 ± 0.0044
      swd: 1.2672 ± 0.1147
      target_std: 4.3096 ± 0.0000
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 57.92 seconds
    
    Experiment complete: PatchTST_etth1_seq196_pred336_20250503_2004
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=196,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.5006, mae: 2.0432, huber: 1.6419, swd: 2.6118, target_std: 6.3704
    Epoch [1/50], Val Losses: mse: 9.7353, mae: 1.6837, huber: 1.3181, swd: 0.7582, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 12.4091, mae: 2.1743, huber: 1.7760, swd: 1.9455, target_std: 4.8325
      Epoch 1 composite train-obj: 1.641934
            Val objective improved inf → 1.3181, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.4413, mae: 1.9390, huber: 1.5399, swd: 2.4180, target_std: 6.3693
    Epoch [2/50], Val Losses: mse: 9.6471, mae: 1.6869, huber: 1.3191, swd: 0.9983, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.1176, mae: 2.1676, huber: 1.7634, swd: 2.0891, target_std: 4.8325
      Epoch 2 composite train-obj: 1.539904
            No improvement (1.3191), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.9251, mae: 1.8874, huber: 1.4878, swd: 2.1514, target_std: 6.3620
    Epoch [3/50], Val Losses: mse: 10.4457, mae: 1.7903, huber: 1.4211, swd: 2.1405, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 12.0408, mae: 2.2090, huber: 1.8023, swd: 3.1148, target_std: 4.8325
      Epoch 3 composite train-obj: 1.487809
            No improvement (1.4211), counter 2/5
    Epoch [4/50], Train Losses: mse: 8.5347, mae: 1.8439, huber: 1.4450, swd: 1.9291, target_std: 6.3626
    Epoch [4/50], Val Losses: mse: 12.6021, mae: 1.9534, huber: 1.5778, swd: 2.2303, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 12.2731, mae: 2.2428, huber: 1.8296, swd: 2.8693, target_std: 4.8325
      Epoch 4 composite train-obj: 1.444961
            No improvement (1.5778), counter 3/5
    Epoch [5/50], Train Losses: mse: 8.2333, mae: 1.8041, huber: 1.4065, swd: 1.7552, target_std: 6.3633
    Epoch [5/50], Val Losses: mse: 12.0295, mae: 1.8678, huber: 1.4943, swd: 1.6802, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 11.8839, mae: 2.1699, huber: 1.7600, swd: 2.2600, target_std: 4.8325
      Epoch 5 composite train-obj: 1.406490
            No improvement (1.4943), counter 4/5
    Epoch [6/50], Train Losses: mse: 8.0192, mae: 1.7740, huber: 1.3775, swd: 1.6348, target_std: 6.3694
    Epoch [6/50], Val Losses: mse: 13.2212, mae: 1.9387, huber: 1.5643, swd: 1.7960, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.4237, mae: 2.2104, huber: 1.7979, swd: 2.1383, target_std: 4.8325
      Epoch 6 composite train-obj: 1.377507
    Epoch [6/50], Test Losses: mse: 12.4091, mae: 2.1743, huber: 1.7760, swd: 1.9455, target_std: 4.8325
    Best round's Test MSE: 12.4091, MAE: 2.1743, SWD: 1.9455
    Best round's Validation MSE: 9.7353, MAE: 1.6837
    Best round's Test verification MSE : 12.4091, MAE: 2.1743, SWD: 1.9455
    Time taken: 16.48 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.4471, mae: 2.0389, huber: 1.6374, swd: 2.4052, target_std: 6.3566
    Epoch [1/50], Val Losses: mse: 9.7515, mae: 1.6969, huber: 1.3314, swd: 1.1019, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 12.5581, mae: 2.1951, huber: 1.7955, swd: 2.4453, target_std: 4.8325
      Epoch 1 composite train-obj: 1.637380
            Val objective improved inf → 1.3314, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.3199, mae: 1.9285, huber: 1.5287, swd: 2.1838, target_std: 6.3613
    Epoch [2/50], Val Losses: mse: 9.8608, mae: 1.7262, huber: 1.3562, swd: 1.1837, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.1570, mae: 2.1485, huber: 1.7442, swd: 2.1429, target_std: 4.8325
      Epoch 2 composite train-obj: 1.528688
            No improvement (1.3562), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.7840, mae: 1.8715, huber: 1.4720, swd: 1.9271, target_std: 6.3607
    Epoch [3/50], Val Losses: mse: 11.2865, mae: 1.8146, huber: 1.4415, swd: 1.1072, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 11.8122, mae: 2.1395, huber: 1.7331, swd: 1.9965, target_std: 4.8325
      Epoch 3 composite train-obj: 1.471950
            No improvement (1.4415), counter 2/5
    Epoch [4/50], Train Losses: mse: 8.4603, mae: 1.8309, huber: 1.4324, swd: 1.7646, target_std: 6.3586
    Epoch [4/50], Val Losses: mse: 10.1698, mae: 1.7416, huber: 1.3703, swd: 1.1635, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 11.6476, mae: 2.1403, huber: 1.7328, swd: 2.1122, target_std: 4.8325
      Epoch 4 composite train-obj: 1.432443
            No improvement (1.3703), counter 3/5
    Epoch [5/50], Train Losses: mse: 8.1887, mae: 1.7976, huber: 1.4000, swd: 1.6386, target_std: 6.3655
    Epoch [5/50], Val Losses: mse: 12.0741, mae: 1.8416, huber: 1.4675, swd: 1.1414, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 11.9557, mae: 2.1892, huber: 1.7768, swd: 2.1312, target_std: 4.8325
      Epoch 5 composite train-obj: 1.399982
            No improvement (1.4675), counter 4/5
    Epoch [6/50], Train Losses: mse: 8.0144, mae: 1.7737, huber: 1.3769, swd: 1.5437, target_std: 6.3615
    Epoch [6/50], Val Losses: mse: 11.6997, mae: 1.8778, huber: 1.5041, swd: 1.9314, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.0743, mae: 2.2323, huber: 1.8190, swd: 2.7653, target_std: 4.8325
      Epoch 6 composite train-obj: 1.376896
    Epoch [6/50], Test Losses: mse: 12.5581, mae: 2.1951, huber: 1.7955, swd: 2.4453, target_std: 4.8325
    Best round's Test MSE: 12.5581, MAE: 2.1951, SWD: 2.4453
    Best round's Validation MSE: 9.7515, MAE: 1.6969
    Best round's Test verification MSE : 12.5581, MAE: 2.1951, SWD: 2.4453
    Time taken: 15.83 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.5447, mae: 2.0467, huber: 1.6454, swd: 2.7002, target_std: 6.3651
    Epoch [1/50], Val Losses: mse: 9.9661, mae: 1.7077, huber: 1.3426, swd: 1.0213, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 12.1601, mae: 2.1364, huber: 1.7399, swd: 1.9372, target_std: 4.8325
      Epoch 1 composite train-obj: 1.645410
            Val objective improved inf → 1.3426, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.2861, mae: 1.9273, huber: 1.5275, swd: 2.4053, target_std: 6.3781
    Epoch [2/50], Val Losses: mse: 9.8815, mae: 1.7150, huber: 1.3469, swd: 1.2510, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.3066, mae: 2.1780, huber: 1.7710, swd: 2.2034, target_std: 4.8325
      Epoch 2 composite train-obj: 1.527490
            No improvement (1.3469), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.8111, mae: 1.8770, huber: 1.4772, swd: 2.1559, target_std: 6.3675
    Epoch [3/50], Val Losses: mse: 11.8546, mae: 1.8353, huber: 1.4657, swd: 1.3756, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 11.8763, mae: 2.1501, huber: 1.7439, swd: 2.3626, target_std: 4.8325
      Epoch 3 composite train-obj: 1.477236
            No improvement (1.4657), counter 2/5
    Epoch [4/50], Train Losses: mse: 8.5210, mae: 1.8421, huber: 1.4432, swd: 1.9920, target_std: 6.3612
    Epoch [4/50], Val Losses: mse: 12.5633, mae: 1.8745, huber: 1.5036, swd: 1.4946, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 11.8363, mae: 2.1653, huber: 1.7552, swd: 2.5553, target_std: 4.8325
      Epoch 4 composite train-obj: 1.443240
            No improvement (1.5036), counter 3/5
    Epoch [5/50], Train Losses: mse: 8.2597, mae: 1.8080, huber: 1.4102, swd: 1.8389, target_std: 6.3634
    Epoch [5/50], Val Losses: mse: 13.3634, mae: 1.9723, huber: 1.5982, swd: 2.1268, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 12.1865, mae: 2.2123, huber: 1.8012, swd: 3.0909, target_std: 4.8325
      Epoch 5 composite train-obj: 1.410181
            No improvement (1.5982), counter 4/5
    Epoch [6/50], Train Losses: mse: 8.0738, mae: 1.7846, huber: 1.3876, swd: 1.7431, target_std: 6.3644
    Epoch [6/50], Val Losses: mse: 11.3139, mae: 1.7803, huber: 1.4109, swd: 1.3599, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.0293, mae: 2.1843, huber: 1.7732, swd: 2.6529, target_std: 4.8325
      Epoch 6 composite train-obj: 1.387617
    Epoch [6/50], Test Losses: mse: 12.1601, mae: 2.1364, huber: 1.7399, swd: 1.9372, target_std: 4.8325
    Best round's Test MSE: 12.1601, MAE: 2.1364, SWD: 1.9372
    Best round's Validation MSE: 9.9661, MAE: 1.7077
    Best round's Test verification MSE : 12.1601, MAE: 2.1364, SWD: 1.9372
    Time taken: 16.16 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq196_pred720_20250503_2005)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 12.3758 ± 0.1642
      mae: 2.1686 ± 0.0243
      huber: 1.7704 ± 0.0230
      swd: 2.1094 ± 0.2376
      target_std: 4.8325 ± 0.0000
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.8176 ± 0.1052
      mae: 1.6961 ± 0.0098
      huber: 1.3307 ± 0.0100
      swd: 0.9605 ± 0.1467
      target_std: 4.3199 ± 0.0000
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 48.57 seconds
    
    Experiment complete: PatchTST_etth1_seq196_pred720_20250503_2005
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### DLinear

#### pred=96


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=196,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.5885, mae: 1.9239, huber: 1.5361, swd: 2.5397, target_std: 6.4647
    Epoch [1/50], Val Losses: mse: 8.7812, mae: 1.5735, huber: 1.2112, swd: 1.0358, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 11.2104, mae: 1.8609, huber: 1.4855, swd: 1.8677, target_std: 4.7554
      Epoch 1 composite train-obj: 1.536060
            Val objective improved inf → 1.2112, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.4761, mae: 1.5013, huber: 1.1335, swd: 1.7293, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 8.2298, mae: 1.4932, huber: 1.1364, swd: 1.0841, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.6130, mae: 1.7679, huber: 1.3994, swd: 1.8219, target_std: 4.7554
      Epoch 2 composite train-obj: 1.133489
            Val objective improved 1.2112 → 1.1364, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.2134, mae: 1.4563, huber: 1.0920, swd: 1.6575, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 8.0383, mae: 1.4633, huber: 1.1087, swd: 1.0039, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.4860, mae: 1.7411, huber: 1.3745, swd: 1.7275, target_std: 4.7554
      Epoch 3 composite train-obj: 1.091992
            Val objective improved 1.1364 → 1.1087, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.1387, mae: 1.4418, huber: 1.0788, swd: 1.6370, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.7994, mae: 1.4351, huber: 1.0819, swd: 0.9508, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.3828, mae: 1.7302, huber: 1.3642, swd: 1.7678, target_std: 4.7554
      Epoch 4 composite train-obj: 1.078827
            Val objective improved 1.1087 → 1.0819, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.0774, mae: 1.4296, huber: 1.0678, swd: 1.6151, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.7563, mae: 1.4257, huber: 1.0730, swd: 0.9107, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 10.3381, mae: 1.7221, huber: 1.3565, swd: 1.7136, target_std: 4.7554
      Epoch 5 composite train-obj: 1.067776
            Val objective improved 1.0819 → 1.0730, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.0443, mae: 1.4243, huber: 1.0629, swd: 1.6087, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.7682, mae: 1.4339, huber: 1.0816, swd: 1.0619, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 10.2923, mae: 1.7161, huber: 1.3511, swd: 1.7877, target_std: 4.7554
      Epoch 6 composite train-obj: 1.062857
            No improvement (1.0816), counter 1/5
    Epoch [7/50], Train Losses: mse: 6.0334, mae: 1.4213, huber: 1.0603, swd: 1.6069, target_std: 6.4647
    Epoch [7/50], Val Losses: mse: 7.7283, mae: 1.4230, huber: 1.0715, swd: 0.9820, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 10.2593, mae: 1.7069, huber: 1.3427, swd: 1.7179, target_std: 4.7554
      Epoch 7 composite train-obj: 1.060266
            Val objective improved 1.0730 → 1.0715, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.0163, mae: 1.4175, huber: 1.0570, swd: 1.6054, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.6764, mae: 1.4124, huber: 1.0607, swd: 0.8878, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 10.2971, mae: 1.7104, huber: 1.3460, swd: 1.6648, target_std: 4.7554
      Epoch 8 composite train-obj: 1.056955
            Val objective improved 1.0715 → 1.0607, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.0046, mae: 1.4157, huber: 1.0552, swd: 1.6006, target_std: 6.4647
    Epoch [9/50], Val Losses: mse: 7.6903, mae: 1.4173, huber: 1.0658, swd: 0.9797, target_std: 4.3393
    Epoch [9/50], Test Losses: mse: 10.2883, mae: 1.7068, huber: 1.3430, swd: 1.7112, target_std: 4.7554
      Epoch 9 composite train-obj: 1.055210
            No improvement (1.0658), counter 1/5
    Epoch [10/50], Train Losses: mse: 6.0205, mae: 1.4169, huber: 1.0565, swd: 1.6107, target_std: 6.4648
    Epoch [10/50], Val Losses: mse: 7.6579, mae: 1.4082, huber: 1.0568, swd: 0.8418, target_std: 4.3393
    Epoch [10/50], Test Losses: mse: 10.3090, mae: 1.7100, huber: 1.3454, swd: 1.6270, target_std: 4.7554
      Epoch 10 composite train-obj: 1.056466
            Val objective improved 1.0607 → 1.0568, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 5.9949, mae: 1.4137, huber: 1.0534, swd: 1.6003, target_std: 6.4647
    Epoch [11/50], Val Losses: mse: 7.7398, mae: 1.4225, huber: 1.0713, swd: 0.9588, target_std: 4.3393
    Epoch [11/50], Test Losses: mse: 10.2689, mae: 1.7026, huber: 1.3383, swd: 1.6476, target_std: 4.7554
      Epoch 11 composite train-obj: 1.053356
            No improvement (1.0713), counter 1/5
    Epoch [12/50], Train Losses: mse: 5.9941, mae: 1.4129, huber: 1.0528, swd: 1.5962, target_std: 6.4647
    Epoch [12/50], Val Losses: mse: 7.7846, mae: 1.4365, huber: 1.0848, swd: 1.1713, target_std: 4.3393
    Epoch [12/50], Test Losses: mse: 10.1891, mae: 1.6964, huber: 1.3336, swd: 1.7770, target_std: 4.7554
      Epoch 12 composite train-obj: 1.052758
            No improvement (1.0848), counter 2/5
    Epoch [13/50], Train Losses: mse: 5.9869, mae: 1.4125, huber: 1.0523, swd: 1.5935, target_std: 6.4647
    Epoch [13/50], Val Losses: mse: 7.6586, mae: 1.4197, huber: 1.0687, swd: 1.0644, target_std: 4.3393
    Epoch [13/50], Test Losses: mse: 10.1669, mae: 1.7004, huber: 1.3355, swd: 1.7664, target_std: 4.7554
      Epoch 13 composite train-obj: 1.052305
            No improvement (1.0687), counter 3/5
    Epoch [14/50], Train Losses: mse: 5.9875, mae: 1.4122, huber: 1.0520, swd: 1.6020, target_std: 6.4647
    Epoch [14/50], Val Losses: mse: 7.6989, mae: 1.4214, huber: 1.0706, swd: 1.0596, target_std: 4.3393
    Epoch [14/50], Test Losses: mse: 10.1823, mae: 1.6958, huber: 1.3322, swd: 1.7236, target_std: 4.7554
      Epoch 14 composite train-obj: 1.052009
            No improvement (1.0706), counter 4/5
    Epoch [15/50], Train Losses: mse: 5.9718, mae: 1.4102, huber: 1.0501, swd: 1.5902, target_std: 6.4647
    Epoch [15/50], Val Losses: mse: 7.6937, mae: 1.4169, huber: 1.0656, swd: 0.9535, target_std: 4.3393
    Epoch [15/50], Test Losses: mse: 10.2480, mae: 1.7011, huber: 1.3371, swd: 1.6297, target_std: 4.7554
      Epoch 15 composite train-obj: 1.050067
    Epoch [15/50], Test Losses: mse: 10.3090, mae: 1.7100, huber: 1.3454, swd: 1.6270, target_std: 4.7554
    Best round's Test MSE: 10.3090, MAE: 1.7100, SWD: 1.6270
    Best round's Validation MSE: 7.6579, MAE: 1.4082
    Best round's Test verification MSE : 10.3090, MAE: 1.7100, SWD: 1.6270
    Time taken: 20.50 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.1413, mae: 1.9026, huber: 1.5156, swd: 2.5028, target_std: 6.4647
    Epoch [1/50], Val Losses: mse: 8.8094, mae: 1.5844, huber: 1.2211, swd: 1.0900, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 11.1911, mae: 1.8601, huber: 1.4852, swd: 1.8588, target_std: 4.7554
      Epoch 1 composite train-obj: 1.515603
            Val objective improved inf → 1.2211, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.4751, mae: 1.5009, huber: 1.1329, swd: 1.6589, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 8.1443, mae: 1.4772, huber: 1.1209, swd: 0.9002, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.6654, mae: 1.7750, huber: 1.4051, swd: 1.6922, target_std: 4.7554
      Epoch 2 composite train-obj: 1.132950
            Val objective improved 1.2211 → 1.1209, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.2172, mae: 1.4567, huber: 1.0922, swd: 1.5860, target_std: 6.4648
    Epoch [3/50], Val Losses: mse: 7.8957, mae: 1.4448, huber: 1.0906, swd: 0.8689, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.4670, mae: 1.7440, huber: 1.3762, swd: 1.6772, target_std: 4.7554
      Epoch 3 composite train-obj: 1.092246
            Val objective improved 1.1209 → 1.0906, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.1323, mae: 1.4403, huber: 1.0774, swd: 1.5631, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.8315, mae: 1.4421, huber: 1.0885, swd: 0.9653, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.3951, mae: 1.7323, huber: 1.3658, swd: 1.7064, target_std: 4.7554
      Epoch 4 composite train-obj: 1.077443
            Val objective improved 1.0906 → 1.0885, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.0851, mae: 1.4312, huber: 1.0692, swd: 1.5513, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.8212, mae: 1.4406, huber: 1.0878, swd: 1.0288, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 10.3594, mae: 1.7229, huber: 1.3578, swd: 1.7120, target_std: 4.7554
      Epoch 5 composite train-obj: 1.069238
            Val objective improved 1.0885 → 1.0878, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.0436, mae: 1.4236, huber: 1.0623, swd: 1.5331, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.7557, mae: 1.4270, huber: 1.0742, swd: 0.9136, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 10.3065, mae: 1.7131, huber: 1.3482, swd: 1.6157, target_std: 4.7554
      Epoch 6 composite train-obj: 1.062282
            Val objective improved 1.0878 → 1.0742, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.0291, mae: 1.4205, huber: 1.0596, swd: 1.5344, target_std: 6.4648
    Epoch [7/50], Val Losses: mse: 7.7435, mae: 1.4223, huber: 1.0707, swd: 0.8734, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 10.3261, mae: 1.7119, huber: 1.3472, swd: 1.5648, target_std: 4.7554
      Epoch 7 composite train-obj: 1.059594
            Val objective improved 1.0742 → 1.0707, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.0166, mae: 1.4171, huber: 1.0565, swd: 1.5275, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.7239, mae: 1.4222, huber: 1.0706, swd: 0.9359, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 10.2904, mae: 1.7084, huber: 1.3437, swd: 1.6091, target_std: 4.7554
      Epoch 8 composite train-obj: 1.056524
            Val objective improved 1.0707 → 1.0706, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 5.9947, mae: 1.4144, huber: 1.0538, swd: 1.5201, target_std: 6.4648
    Epoch [9/50], Val Losses: mse: 7.6789, mae: 1.4141, huber: 1.0633, swd: 0.8911, target_std: 4.3393
    Epoch [9/50], Test Losses: mse: 10.2981, mae: 1.7069, huber: 1.3420, swd: 1.5980, target_std: 4.7554
      Epoch 9 composite train-obj: 1.053850
            Val objective improved 1.0706 → 1.0633, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 6.0101, mae: 1.4147, huber: 1.0544, swd: 1.5305, target_std: 6.4648
    Epoch [10/50], Val Losses: mse: 7.6499, mae: 1.4111, huber: 1.0597, swd: 0.8807, target_std: 4.3393
    Epoch [10/50], Test Losses: mse: 10.2647, mae: 1.7061, huber: 1.3415, swd: 1.6116, target_std: 4.7554
      Epoch 10 composite train-obj: 1.054394
            Val objective improved 1.0633 → 1.0597, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 6.0087, mae: 1.4160, huber: 1.0555, swd: 1.5309, target_std: 6.4648
    Epoch [11/50], Val Losses: mse: 7.7432, mae: 1.4290, huber: 1.0769, swd: 1.0359, target_std: 4.3393
    Epoch [11/50], Test Losses: mse: 10.2428, mae: 1.7041, huber: 1.3395, swd: 1.6541, target_std: 4.7554
      Epoch 11 composite train-obj: 1.055524
            No improvement (1.0769), counter 1/5
    Epoch [12/50], Train Losses: mse: 6.0191, mae: 1.4164, huber: 1.0561, swd: 1.5425, target_std: 6.4647
    Epoch [12/50], Val Losses: mse: 7.6541, mae: 1.4163, huber: 1.0649, swd: 0.9302, target_std: 4.3393
    Epoch [12/50], Test Losses: mse: 10.2512, mae: 1.7049, huber: 1.3408, swd: 1.6362, target_std: 4.7554
      Epoch 12 composite train-obj: 1.056122
            No improvement (1.0649), counter 2/5
    Epoch [13/50], Train Losses: mse: 5.9763, mae: 1.4106, huber: 1.0504, swd: 1.5176, target_std: 6.4648
    Epoch [13/50], Val Losses: mse: 7.6134, mae: 1.4118, huber: 1.0596, swd: 0.9573, target_std: 4.3393
    Epoch [13/50], Test Losses: mse: 10.2316, mae: 1.7032, huber: 1.3397, swd: 1.6849, target_std: 4.7554
      Epoch 13 composite train-obj: 1.050420
            Val objective improved 1.0597 → 1.0596, saving checkpoint.
    Epoch [14/50], Train Losses: mse: 5.9785, mae: 1.4108, huber: 1.0507, swd: 1.5218, target_std: 6.4647
    Epoch [14/50], Val Losses: mse: 7.6520, mae: 1.4269, huber: 1.0739, swd: 1.0385, target_std: 4.3393
    Epoch [14/50], Test Losses: mse: 10.2259, mae: 1.7064, huber: 1.3426, swd: 1.7420, target_std: 4.7554
      Epoch 14 composite train-obj: 1.050715
            No improvement (1.0739), counter 1/5
    Epoch [15/50], Train Losses: mse: 5.9907, mae: 1.4131, huber: 1.0528, swd: 1.5256, target_std: 6.4647
    Epoch [15/50], Val Losses: mse: 7.7009, mae: 1.4252, huber: 1.0741, swd: 1.0362, target_std: 4.3393
    Epoch [15/50], Test Losses: mse: 10.2344, mae: 1.7043, huber: 1.3401, swd: 1.7217, target_std: 4.7554
      Epoch 15 composite train-obj: 1.052770
            No improvement (1.0741), counter 2/5
    Epoch [16/50], Train Losses: mse: 5.9836, mae: 1.4107, huber: 1.0509, swd: 1.5201, target_std: 6.4647
    Epoch [16/50], Val Losses: mse: 7.6542, mae: 1.4227, huber: 1.0715, swd: 1.0878, target_std: 4.3393
    Epoch [16/50], Test Losses: mse: 10.1414, mae: 1.6960, huber: 1.3327, swd: 1.7392, target_std: 4.7554
      Epoch 16 composite train-obj: 1.050857
            No improvement (1.0715), counter 3/5
    Epoch [17/50], Train Losses: mse: 5.9631, mae: 1.4081, huber: 1.0482, swd: 1.5144, target_std: 6.4647
    Epoch [17/50], Val Losses: mse: 7.6759, mae: 1.4128, huber: 1.0624, swd: 0.9149, target_std: 4.3393
    Epoch [17/50], Test Losses: mse: 10.2487, mae: 1.6996, huber: 1.3364, swd: 1.5933, target_std: 4.7554
      Epoch 17 composite train-obj: 1.048222
            No improvement (1.0624), counter 4/5
    Epoch [18/50], Train Losses: mse: 5.9659, mae: 1.4078, huber: 1.0480, swd: 1.5137, target_std: 6.4647
    Epoch [18/50], Val Losses: mse: 7.6267, mae: 1.4031, huber: 1.0529, swd: 0.8241, target_std: 4.3393
    Epoch [18/50], Test Losses: mse: 10.2592, mae: 1.6993, huber: 1.3360, swd: 1.5255, target_std: 4.7554
      Epoch 18 composite train-obj: 1.047988
            Val objective improved 1.0596 → 1.0529, saving checkpoint.
    Epoch [19/50], Train Losses: mse: 5.9594, mae: 1.4078, huber: 1.0480, swd: 1.5161, target_std: 6.4647
    Epoch [19/50], Val Losses: mse: 7.6546, mae: 1.4094, huber: 1.0596, swd: 0.8998, target_std: 4.3393
    Epoch [19/50], Test Losses: mse: 10.2088, mae: 1.6935, huber: 1.3309, swd: 1.5492, target_std: 4.7554
      Epoch 19 composite train-obj: 1.047996
            No improvement (1.0596), counter 1/5
    Epoch [20/50], Train Losses: mse: 5.9598, mae: 1.4072, huber: 1.0475, swd: 1.5136, target_std: 6.4647
    Epoch [20/50], Val Losses: mse: 7.6110, mae: 1.4065, huber: 1.0566, swd: 0.9187, target_std: 4.3393
    Epoch [20/50], Test Losses: mse: 10.2416, mae: 1.6999, huber: 1.3364, swd: 1.6277, target_std: 4.7554
      Epoch 20 composite train-obj: 1.047513
            No improvement (1.0566), counter 2/5
    Epoch [21/50], Train Losses: mse: 5.9698, mae: 1.4070, huber: 1.0476, swd: 1.5121, target_std: 6.4648
    Epoch [21/50], Val Losses: mse: 7.5971, mae: 1.4110, huber: 1.0599, swd: 0.9523, target_std: 4.3393
    Epoch [21/50], Test Losses: mse: 10.1875, mae: 1.6981, huber: 1.3346, swd: 1.6397, target_std: 4.7554
      Epoch 21 composite train-obj: 1.047564
            No improvement (1.0599), counter 3/5
    Epoch [22/50], Train Losses: mse: 5.9683, mae: 1.4087, huber: 1.0488, swd: 1.5165, target_std: 6.4647
    Epoch [22/50], Val Losses: mse: 7.6511, mae: 1.4131, huber: 1.0625, swd: 0.9604, target_std: 4.3393
    Epoch [22/50], Test Losses: mse: 10.1777, mae: 1.6950, huber: 1.3314, swd: 1.5974, target_std: 4.7554
      Epoch 22 composite train-obj: 1.048844
            No improvement (1.0625), counter 4/5
    Epoch [23/50], Train Losses: mse: 5.9663, mae: 1.4080, huber: 1.0481, swd: 1.5150, target_std: 6.4647
    Epoch [23/50], Val Losses: mse: 7.6535, mae: 1.4175, huber: 1.0671, swd: 1.0283, target_std: 4.3393
    Epoch [23/50], Test Losses: mse: 10.1776, mae: 1.6946, huber: 1.3316, swd: 1.6600, target_std: 4.7554
      Epoch 23 composite train-obj: 1.048094
    Epoch [23/50], Test Losses: mse: 10.2592, mae: 1.6993, huber: 1.3360, swd: 1.5255, target_std: 4.7554
    Best round's Test MSE: 10.2592, MAE: 1.6993, SWD: 1.5255
    Best round's Validation MSE: 7.6267, MAE: 1.4031
    Best round's Test verification MSE : 10.2592, MAE: 1.6993, SWD: 1.5255
    Time taken: 32.55 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.7340, mae: 1.9258, huber: 1.5379, swd: 2.3483, target_std: 6.4647
    Epoch [1/50], Val Losses: mse: 8.8102, mae: 1.5791, huber: 1.2167, swd: 1.0566, target_std: 4.3393
    Epoch [1/50], Test Losses: mse: 11.2098, mae: 1.8577, huber: 1.4831, swd: 1.8032, target_std: 4.7554
      Epoch 1 composite train-obj: 1.537857
            Val objective improved inf → 1.2167, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.4754, mae: 1.5016, huber: 1.1336, swd: 1.5863, target_std: 6.4647
    Epoch [2/50], Val Losses: mse: 8.2030, mae: 1.4873, huber: 1.1306, swd: 0.9912, target_std: 4.3393
    Epoch [2/50], Test Losses: mse: 10.6418, mae: 1.7706, huber: 1.4012, swd: 1.7372, target_std: 4.7554
      Epoch 2 composite train-obj: 1.133610
            Val objective improved 1.2167 → 1.1306, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.2230, mae: 1.4577, huber: 1.0932, swd: 1.5278, target_std: 6.4647
    Epoch [3/50], Val Losses: mse: 8.0097, mae: 1.4581, huber: 1.1033, swd: 0.9526, target_std: 4.3393
    Epoch [3/50], Test Losses: mse: 10.5087, mae: 1.7448, huber: 1.3773, swd: 1.6694, target_std: 4.7554
      Epoch 3 composite train-obj: 1.093173
            Val objective improved 1.1306 → 1.1033, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.1196, mae: 1.4384, huber: 1.0757, swd: 1.5007, target_std: 6.4647
    Epoch [4/50], Val Losses: mse: 7.8524, mae: 1.4406, huber: 1.0875, swd: 0.9401, target_std: 4.3393
    Epoch [4/50], Test Losses: mse: 10.3887, mae: 1.7284, huber: 1.3621, swd: 1.6596, target_std: 4.7554
      Epoch 4 composite train-obj: 1.075707
            Val objective improved 1.1033 → 1.0875, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.0794, mae: 1.4303, huber: 1.0684, swd: 1.4900, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 7.7986, mae: 1.4328, huber: 1.0801, swd: 0.9093, target_std: 4.3393
    Epoch [5/50], Test Losses: mse: 10.3860, mae: 1.7237, huber: 1.3582, swd: 1.6200, target_std: 4.7554
      Epoch 5 composite train-obj: 1.068376
            Val objective improved 1.0875 → 1.0801, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.0472, mae: 1.4239, huber: 1.0628, swd: 1.4753, target_std: 6.4647
    Epoch [6/50], Val Losses: mse: 7.8238, mae: 1.4396, huber: 1.0870, swd: 1.0015, target_std: 4.3393
    Epoch [6/50], Test Losses: mse: 10.3254, mae: 1.7144, huber: 1.3501, swd: 1.6523, target_std: 4.7554
      Epoch 6 composite train-obj: 1.062760
            No improvement (1.0870), counter 1/5
    Epoch [7/50], Train Losses: mse: 6.0344, mae: 1.4214, huber: 1.0604, swd: 1.4762, target_std: 6.4647
    Epoch [7/50], Val Losses: mse: 7.8003, mae: 1.4377, huber: 1.0846, swd: 1.0571, target_std: 4.3393
    Epoch [7/50], Test Losses: mse: 10.3055, mae: 1.7128, huber: 1.3480, swd: 1.6870, target_std: 4.7554
      Epoch 7 composite train-obj: 1.060391
            No improvement (1.0846), counter 2/5
    Epoch [8/50], Train Losses: mse: 6.0104, mae: 1.4177, huber: 1.0569, swd: 1.4706, target_std: 6.4647
    Epoch [8/50], Val Losses: mse: 7.6700, mae: 1.4094, huber: 1.0579, swd: 0.7907, target_std: 4.3393
    Epoch [8/50], Test Losses: mse: 10.3719, mae: 1.7163, huber: 1.3513, swd: 1.5565, target_std: 4.7554
      Epoch 8 composite train-obj: 1.056930
            Val objective improved 1.0801 → 1.0579, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.0096, mae: 1.4162, huber: 1.0556, swd: 1.4678, target_std: 6.4647
    Epoch [9/50], Val Losses: mse: 7.6573, mae: 1.4123, huber: 1.0613, swd: 0.9087, target_std: 4.3393
    Epoch [9/50], Test Losses: mse: 10.2928, mae: 1.7071, huber: 1.3432, swd: 1.6332, target_std: 4.7554
      Epoch 9 composite train-obj: 1.055616
            No improvement (1.0613), counter 1/5
    Epoch [10/50], Train Losses: mse: 6.0034, mae: 1.4147, huber: 1.0544, swd: 1.4708, target_std: 6.4647
    Epoch [10/50], Val Losses: mse: 7.6570, mae: 1.4135, huber: 1.0628, swd: 0.9603, target_std: 4.3393
    Epoch [10/50], Test Losses: mse: 10.2113, mae: 1.6990, huber: 1.3356, swd: 1.6498, target_std: 4.7554
      Epoch 10 composite train-obj: 1.054429
            No improvement (1.0628), counter 2/5
    Epoch [11/50], Train Losses: mse: 5.9955, mae: 1.4134, huber: 1.0531, swd: 1.4713, target_std: 6.4647
    Epoch [11/50], Val Losses: mse: 7.6892, mae: 1.4153, huber: 1.0642, swd: 0.9184, target_std: 4.3393
    Epoch [11/50], Test Losses: mse: 10.2504, mae: 1.7018, huber: 1.3383, swd: 1.6072, target_std: 4.7554
      Epoch 11 composite train-obj: 1.053101
            No improvement (1.0642), counter 3/5
    Epoch [12/50], Train Losses: mse: 5.9907, mae: 1.4127, huber: 1.0525, swd: 1.4692, target_std: 6.4647
    Epoch [12/50], Val Losses: mse: 7.5918, mae: 1.4061, huber: 1.0557, swd: 0.9507, target_std: 4.3393
    Epoch [12/50], Test Losses: mse: 10.1878, mae: 1.6971, huber: 1.3335, swd: 1.6612, target_std: 4.7554
      Epoch 12 composite train-obj: 1.052514
            Val objective improved 1.0579 → 1.0557, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 5.9788, mae: 1.4106, huber: 1.0505, swd: 1.4599, target_std: 6.4647
    Epoch [13/50], Val Losses: mse: 7.7071, mae: 1.4238, huber: 1.0732, swd: 1.0639, target_std: 4.3393
    Epoch [13/50], Test Losses: mse: 10.1867, mae: 1.6947, huber: 1.3317, swd: 1.6838, target_std: 4.7554
      Epoch 13 composite train-obj: 1.050490
            No improvement (1.0732), counter 1/5
    Epoch [14/50], Train Losses: mse: 5.9823, mae: 1.4103, huber: 1.0505, swd: 1.4662, target_std: 6.4648
    Epoch [14/50], Val Losses: mse: 7.6610, mae: 1.4140, huber: 1.0636, swd: 0.9240, target_std: 4.3393
    Epoch [14/50], Test Losses: mse: 10.2504, mae: 1.7030, huber: 1.3392, swd: 1.6414, target_std: 4.7554
      Epoch 14 composite train-obj: 1.050477
            No improvement (1.0636), counter 2/5
    Epoch [15/50], Train Losses: mse: 6.0010, mae: 1.4141, huber: 1.0538, swd: 1.4794, target_std: 6.4647
    Epoch [15/50], Val Losses: mse: 7.6458, mae: 1.4142, huber: 1.0634, swd: 0.9392, target_std: 4.3393
    Epoch [15/50], Test Losses: mse: 10.2238, mae: 1.6994, huber: 1.3362, swd: 1.6468, target_std: 4.7554
      Epoch 15 composite train-obj: 1.053847
            No improvement (1.0634), counter 3/5
    Epoch [16/50], Train Losses: mse: 5.9658, mae: 1.4081, huber: 1.0483, swd: 1.4588, target_std: 6.4647
    Epoch [16/50], Val Losses: mse: 7.5513, mae: 1.4005, huber: 1.0503, swd: 0.9360, target_std: 4.3393
    Epoch [16/50], Test Losses: mse: 10.1930, mae: 1.6984, huber: 1.3352, swd: 1.6745, target_std: 4.7554
      Epoch 16 composite train-obj: 1.048307
            Val objective improved 1.0557 → 1.0503, saving checkpoint.
    Epoch [17/50], Train Losses: mse: 5.9683, mae: 1.4086, huber: 1.0487, swd: 1.4620, target_std: 6.4647
    Epoch [17/50], Val Losses: mse: 7.6523, mae: 1.4110, huber: 1.0610, swd: 0.9211, target_std: 4.3393
    Epoch [17/50], Test Losses: mse: 10.2310, mae: 1.6990, huber: 1.3352, swd: 1.5847, target_std: 4.7554
      Epoch 17 composite train-obj: 1.048734
            No improvement (1.0610), counter 1/5
    Epoch [18/50], Train Losses: mse: 5.9616, mae: 1.4076, huber: 1.0480, swd: 1.4576, target_std: 6.4647
    Epoch [18/50], Val Losses: mse: 7.6721, mae: 1.4169, huber: 1.0662, swd: 1.0202, target_std: 4.3393
    Epoch [18/50], Test Losses: mse: 10.1975, mae: 1.6945, huber: 1.3314, swd: 1.6315, target_std: 4.7554
      Epoch 18 composite train-obj: 1.047970
            No improvement (1.0662), counter 2/5
    Epoch [19/50], Train Losses: mse: 5.9747, mae: 1.4092, huber: 1.0493, swd: 1.4636, target_std: 6.4648
    Epoch [19/50], Val Losses: mse: 7.6005, mae: 1.4032, huber: 1.0528, swd: 0.8817, target_std: 4.3393
    Epoch [19/50], Test Losses: mse: 10.2406, mae: 1.6988, huber: 1.3351, swd: 1.5748, target_std: 4.7554
      Epoch 19 composite train-obj: 1.049305
            No improvement (1.0528), counter 3/5
    Epoch [20/50], Train Losses: mse: 5.9719, mae: 1.4092, huber: 1.0492, swd: 1.4598, target_std: 6.4647
    Epoch [20/50], Val Losses: mse: 7.6940, mae: 1.4173, huber: 1.0667, swd: 0.9894, target_std: 4.3393
    Epoch [20/50], Test Losses: mse: 10.1865, mae: 1.6926, huber: 1.3292, swd: 1.5910, target_std: 4.7554
      Epoch 20 composite train-obj: 1.049202
            No improvement (1.0667), counter 4/5
    Epoch [21/50], Train Losses: mse: 5.9719, mae: 1.4090, huber: 1.0492, swd: 1.4669, target_std: 6.4647
    Epoch [21/50], Val Losses: mse: 7.7029, mae: 1.4232, huber: 1.0723, swd: 1.0536, target_std: 4.3393
    Epoch [21/50], Test Losses: mse: 10.1985, mae: 1.6950, huber: 1.3325, swd: 1.6913, target_std: 4.7554
      Epoch 21 composite train-obj: 1.049217
    Epoch [21/50], Test Losses: mse: 10.1930, mae: 1.6984, huber: 1.3352, swd: 1.6745, target_std: 4.7554
    Best round's Test MSE: 10.1930, MAE: 1.6984, SWD: 1.6745
    Best round's Validation MSE: 7.5513, MAE: 1.4005
    Best round's Test verification MSE : 10.1930, MAE: 1.6984, SWD: 1.6745
    Time taken: 31.53 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq196_pred96_20250503_1958)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.2537 ± 0.0475
      mae: 1.7025 ± 0.0053
      huber: 1.3389 ± 0.0047
      swd: 1.6090 ± 0.0621
      target_std: 4.7554 ± 0.0000
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 7.6120 ± 0.0447
      mae: 1.4039 ± 0.0032
      huber: 1.0534 ± 0.0027
      swd: 0.8673 ± 0.0491
      target_std: 4.3393 ± 0.0000
      count: 12.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 84.61 seconds
    
    Experiment complete: DLinear_etth1_seq196_pred96_20250503_1958
    Model: DLinear
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=196,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 11
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 12.0906, mae: 2.0095, huber: 1.6157, swd: 2.5854, target_std: 6.4571
    Epoch [1/50], Val Losses: mse: 10.5737, mae: 1.7339, huber: 1.3665, swd: 1.2285, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 11.3219, mae: 1.9193, huber: 1.5363, swd: 1.7076, target_std: 4.7558
      Epoch 1 composite train-obj: 1.615733
            Val objective improved inf → 1.3665, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.1599, mae: 1.6101, huber: 1.2335, swd: 1.7675, target_std: 6.4524
    Epoch [2/50], Val Losses: mse: 9.9553, mae: 1.6553, huber: 1.2914, swd: 1.3059, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.8853, mae: 1.8546, huber: 1.4764, swd: 1.8505, target_std: 4.7558
      Epoch 2 composite train-obj: 1.233535
            Val objective improved 1.3665 → 1.2914, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.9412, mae: 1.5743, huber: 1.2002, swd: 1.7319, target_std: 6.4535
    Epoch [3/50], Val Losses: mse: 9.8479, mae: 1.6370, huber: 1.2751, swd: 1.3554, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.7420, mae: 1.8253, huber: 1.4493, swd: 1.7958, target_std: 4.7558
      Epoch 3 composite train-obj: 1.200169
            Val objective improved 1.2914 → 1.2751, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.8619, mae: 1.5594, huber: 1.1866, swd: 1.7148, target_std: 6.4528
    Epoch [4/50], Val Losses: mse: 9.7436, mae: 1.6194, huber: 1.2589, swd: 1.2396, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.7195, mae: 1.8160, huber: 1.4410, swd: 1.7044, target_std: 4.7558
      Epoch 4 composite train-obj: 1.186584
            Val objective improved 1.2751 → 1.2589, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.8122, mae: 1.5514, huber: 1.1792, swd: 1.7059, target_std: 6.4647
    Epoch [5/50], Val Losses: mse: 9.7966, mae: 1.6213, huber: 1.2619, swd: 1.3581, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.6424, mae: 1.8035, huber: 1.4282, swd: 1.6940, target_std: 4.7558
      Epoch 5 composite train-obj: 1.179242
            No improvement (1.2619), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.7980, mae: 1.5475, huber: 1.1758, swd: 1.6990, target_std: 6.4543
    Epoch [6/50], Val Losses: mse: 9.5630, mae: 1.5979, huber: 1.2387, swd: 1.1638, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.6667, mae: 1.8071, huber: 1.4321, swd: 1.6726, target_std: 4.7558
      Epoch 6 composite train-obj: 1.175818
            Val objective improved 1.2589 → 1.2387, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.7890, mae: 1.5452, huber: 1.1736, swd: 1.7046, target_std: 6.4546
    Epoch [7/50], Val Losses: mse: 9.6683, mae: 1.6041, huber: 1.2453, swd: 1.2696, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.6204, mae: 1.7990, huber: 1.4242, swd: 1.6690, target_std: 4.7558
      Epoch 7 composite train-obj: 1.173612
            No improvement (1.2453), counter 1/5
    Epoch [8/50], Train Losses: mse: 6.7573, mae: 1.5422, huber: 1.1707, swd: 1.6860, target_std: 6.4621
    Epoch [8/50], Val Losses: mse: 9.5289, mae: 1.5915, huber: 1.2322, swd: 1.0643, target_std: 4.3251
    Epoch [8/50], Test Losses: mse: 10.7051, mae: 1.8082, huber: 1.4324, swd: 1.6011, target_std: 4.7558
      Epoch 8 composite train-obj: 1.170678
            Val objective improved 1.2387 → 1.2322, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.7438, mae: 1.5391, huber: 1.1678, swd: 1.6837, target_std: 6.4540
    Epoch [9/50], Val Losses: mse: 9.6155, mae: 1.6078, huber: 1.2482, swd: 1.2940, target_std: 4.3251
    Epoch [9/50], Test Losses: mse: 10.6257, mae: 1.8019, huber: 1.4264, swd: 1.6840, target_std: 4.7558
      Epoch 9 composite train-obj: 1.167808
            No improvement (1.2482), counter 1/5
    Epoch [10/50], Train Losses: mse: 6.7116, mae: 1.5330, huber: 1.1624, swd: 1.6671, target_std: 6.4519
    Epoch [10/50], Val Losses: mse: 9.5627, mae: 1.5962, huber: 1.2376, swd: 1.1899, target_std: 4.3251
    Epoch [10/50], Test Losses: mse: 10.6043, mae: 1.7966, huber: 1.4227, swd: 1.6393, target_std: 4.7558
      Epoch 10 composite train-obj: 1.162372
            No improvement (1.2376), counter 2/5
    Epoch [11/50], Train Losses: mse: 6.7453, mae: 1.5371, huber: 1.1662, swd: 1.6905, target_std: 6.4602
    Epoch [11/50], Val Losses: mse: 9.5623, mae: 1.5962, huber: 1.2383, swd: 1.3482, target_std: 4.3251
    Epoch [11/50], Test Losses: mse: 10.5447, mae: 1.7917, huber: 1.4182, swd: 1.7318, target_std: 4.7558
      Epoch 11 composite train-obj: 1.166246
            No improvement (1.2383), counter 3/5
    Epoch [12/50], Train Losses: mse: 6.7250, mae: 1.5342, huber: 1.1636, swd: 1.6691, target_std: 6.4580
    Epoch [12/50], Val Losses: mse: 9.6933, mae: 1.6124, huber: 1.2538, swd: 1.3504, target_std: 4.3251
    Epoch [12/50], Test Losses: mse: 10.5898, mae: 1.7959, huber: 1.4215, swd: 1.6754, target_std: 4.7558
      Epoch 12 composite train-obj: 1.163558
            No improvement (1.2538), counter 4/5
    Epoch [13/50], Train Losses: mse: 6.7241, mae: 1.5333, huber: 1.1627, swd: 1.6728, target_std: 6.4582
    Epoch [13/50], Val Losses: mse: 9.4364, mae: 1.5935, huber: 1.2340, swd: 1.2786, target_std: 4.3251
    Epoch [13/50], Test Losses: mse: 10.5883, mae: 1.8000, huber: 1.4256, swd: 1.7659, target_std: 4.7558
      Epoch 13 composite train-obj: 1.162654
    Epoch [13/50], Test Losses: mse: 10.7051, mae: 1.8082, huber: 1.4324, swd: 1.6011, target_std: 4.7558
    Best round's Test MSE: 10.7051, MAE: 1.8082, SWD: 1.6011
    Best round's Validation MSE: 9.5289, MAE: 1.5915
    Best round's Test verification MSE : 10.7051, MAE: 1.8082, SWD: 1.6011
    Time taken: 21.69 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 12.0102, mae: 1.9958, huber: 1.6030, swd: 2.5558, target_std: 6.4565
    Epoch [1/50], Val Losses: mse: 10.4609, mae: 1.7303, huber: 1.3625, swd: 1.3101, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 11.3275, mae: 1.9202, huber: 1.5382, swd: 1.7655, target_std: 4.7558
      Epoch 1 composite train-obj: 1.602955
            Val objective improved inf → 1.3625, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.1495, mae: 1.6087, huber: 1.2321, swd: 1.7635, target_std: 6.4531
    Epoch [2/50], Val Losses: mse: 9.9806, mae: 1.6456, huber: 1.2830, swd: 1.1000, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.9051, mae: 1.8480, huber: 1.4700, swd: 1.5946, target_std: 4.7558
      Epoch 2 composite train-obj: 1.232098
            Val objective improved 1.3625 → 1.2830, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.9481, mae: 1.5746, huber: 1.2006, swd: 1.7251, target_std: 6.4535
    Epoch [3/50], Val Losses: mse: 9.8716, mae: 1.6349, huber: 1.2735, swd: 1.2194, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.7936, mae: 1.8304, huber: 1.4535, swd: 1.6191, target_std: 4.7558
      Epoch 3 composite train-obj: 1.200588
            Val objective improved 1.2830 → 1.2735, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.8595, mae: 1.5593, huber: 1.1864, swd: 1.7063, target_std: 6.4560
    Epoch [4/50], Val Losses: mse: 9.7134, mae: 1.6117, huber: 1.2517, swd: 1.1678, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.7467, mae: 1.8182, huber: 1.4423, swd: 1.6119, target_std: 4.7558
      Epoch 4 composite train-obj: 1.186389
            Val objective improved 1.2735 → 1.2517, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.8084, mae: 1.5511, huber: 1.1789, swd: 1.6974, target_std: 6.4514
    Epoch [5/50], Val Losses: mse: 9.5499, mae: 1.5932, huber: 1.2340, swd: 1.0558, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.7189, mae: 1.8138, huber: 1.4381, swd: 1.5856, target_std: 4.7558
      Epoch 5 composite train-obj: 1.178851
            Val objective improved 1.2517 → 1.2340, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.7799, mae: 1.5457, huber: 1.1740, swd: 1.6787, target_std: 6.4590
    Epoch [6/50], Val Losses: mse: 9.5333, mae: 1.5963, huber: 1.2375, swd: 1.1902, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.6250, mae: 1.8042, huber: 1.4290, swd: 1.6370, target_std: 4.7558
      Epoch 6 composite train-obj: 1.173961
            No improvement (1.2375), counter 1/5
    Epoch [7/50], Train Losses: mse: 6.7543, mae: 1.5418, huber: 1.1704, swd: 1.6730, target_std: 6.4541
    Epoch [7/50], Val Losses: mse: 9.6797, mae: 1.6105, huber: 1.2513, swd: 1.2725, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.6391, mae: 1.8035, huber: 1.4284, swd: 1.6127, target_std: 4.7558
      Epoch 7 composite train-obj: 1.170365
            No improvement (1.2513), counter 2/5
    Epoch [8/50], Train Losses: mse: 6.7552, mae: 1.5403, huber: 1.1690, swd: 1.6773, target_std: 6.4591
    Epoch [8/50], Val Losses: mse: 9.5548, mae: 1.6010, huber: 1.2415, swd: 1.2240, target_std: 4.3251
    Epoch [8/50], Test Losses: mse: 10.6173, mae: 1.8023, huber: 1.4280, swd: 1.6517, target_std: 4.7558
      Epoch 8 composite train-obj: 1.169009
            No improvement (1.2415), counter 3/5
    Epoch [9/50], Train Losses: mse: 6.7329, mae: 1.5368, huber: 1.1658, swd: 1.6702, target_std: 6.4576
    Epoch [9/50], Val Losses: mse: 9.6524, mae: 1.6199, huber: 1.2599, swd: 1.5064, target_std: 4.3251
    Epoch [9/50], Test Losses: mse: 10.5624, mae: 1.8017, huber: 1.4266, swd: 1.7901, target_std: 4.7558
      Epoch 9 composite train-obj: 1.165797
            No improvement (1.2599), counter 4/5
    Epoch [10/50], Train Losses: mse: 6.7459, mae: 1.5384, huber: 1.1673, swd: 1.6746, target_std: 6.4549
    Epoch [10/50], Val Losses: mse: 9.5013, mae: 1.5865, huber: 1.2284, swd: 1.1370, target_std: 4.3251
    Epoch [10/50], Test Losses: mse: 10.5865, mae: 1.7932, huber: 1.4197, swd: 1.5599, target_std: 4.7558
      Epoch 10 composite train-obj: 1.167300
            Val objective improved 1.2340 → 1.2284, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 6.7405, mae: 1.5370, huber: 1.1660, swd: 1.6753, target_std: 6.4593
    Epoch [11/50], Val Losses: mse: 9.4372, mae: 1.5817, huber: 1.2232, swd: 1.0034, target_std: 4.3251
    Epoch [11/50], Test Losses: mse: 10.6518, mae: 1.8025, huber: 1.4279, swd: 1.5226, target_std: 4.7558
      Epoch 11 composite train-obj: 1.166044
            Val objective improved 1.2284 → 1.2232, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 6.7291, mae: 1.5356, huber: 1.1645, swd: 1.6710, target_std: 6.4542
    Epoch [12/50], Val Losses: mse: 9.6635, mae: 1.6232, huber: 1.2611, swd: 1.4292, target_std: 4.3251
    Epoch [12/50], Test Losses: mse: 10.5510, mae: 1.8000, huber: 1.4232, swd: 1.6848, target_std: 4.7558
      Epoch 12 composite train-obj: 1.164550
            No improvement (1.2611), counter 1/5
    Epoch [13/50], Train Losses: mse: 6.7122, mae: 1.5333, huber: 1.1623, swd: 1.6692, target_std: 6.4626
    Epoch [13/50], Val Losses: mse: 9.5115, mae: 1.5954, huber: 1.2370, swd: 1.3024, target_std: 4.3251
    Epoch [13/50], Test Losses: mse: 10.5795, mae: 1.7951, huber: 1.4210, swd: 1.6464, target_std: 4.7558
      Epoch 13 composite train-obj: 1.162286
            No improvement (1.2370), counter 2/5
    Epoch [14/50], Train Losses: mse: 6.7166, mae: 1.5330, huber: 1.1624, swd: 1.6610, target_std: 6.4654
    Epoch [14/50], Val Losses: mse: 9.5161, mae: 1.5885, huber: 1.2315, swd: 1.1984, target_std: 4.3251
    Epoch [14/50], Test Losses: mse: 10.5500, mae: 1.7890, huber: 1.4150, swd: 1.5470, target_std: 4.7558
      Epoch 14 composite train-obj: 1.162362
            No improvement (1.2315), counter 3/5
    Epoch [15/50], Train Losses: mse: 6.7147, mae: 1.5313, huber: 1.1608, swd: 1.6608, target_std: 6.4530
    Epoch [15/50], Val Losses: mse: 9.5819, mae: 1.5986, huber: 1.2406, swd: 1.2456, target_std: 4.3251
    Epoch [15/50], Test Losses: mse: 10.5763, mae: 1.7903, huber: 1.4165, swd: 1.5406, target_std: 4.7558
      Epoch 15 composite train-obj: 1.160788
            No improvement (1.2406), counter 4/5
    Epoch [16/50], Train Losses: mse: 6.6864, mae: 1.5283, huber: 1.1579, swd: 1.6413, target_std: 6.4563
    Epoch [16/50], Val Losses: mse: 9.4591, mae: 1.5857, huber: 1.2272, swd: 1.1313, target_std: 4.3251
    Epoch [16/50], Test Losses: mse: 10.6020, mae: 1.7948, huber: 1.4203, swd: 1.5432, target_std: 4.7558
      Epoch 16 composite train-obj: 1.157942
    Epoch [16/50], Test Losses: mse: 10.6518, mae: 1.8025, huber: 1.4279, swd: 1.5226, target_std: 4.7558
    Best round's Test MSE: 10.6518, MAE: 1.8025, SWD: 1.5226
    Best round's Validation MSE: 9.4372, MAE: 1.5817
    Best round's Test verification MSE : 10.6518, MAE: 1.8025, SWD: 1.5226
    Time taken: 25.54 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.8195, mae: 1.9960, huber: 1.6028, swd: 2.3509, target_std: 6.4637
    Epoch [1/50], Val Losses: mse: 10.5698, mae: 1.7301, huber: 1.3632, swd: 1.1580, target_std: 4.3251
    Epoch [1/50], Test Losses: mse: 11.3594, mae: 1.9194, huber: 1.5361, swd: 1.5747, target_std: 4.7558
      Epoch 1 composite train-obj: 1.602850
            Val objective improved inf → 1.3632, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.1576, mae: 1.6098, huber: 1.2332, swd: 1.5881, target_std: 6.4535
    Epoch [2/50], Val Losses: mse: 9.9604, mae: 1.6497, huber: 1.2867, swd: 1.1747, target_std: 4.3251
    Epoch [2/50], Test Losses: mse: 10.8750, mae: 1.8483, huber: 1.4695, swd: 1.6392, target_std: 4.7558
      Epoch 2 composite train-obj: 1.233165
            Val objective improved 1.3632 → 1.2867, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.9489, mae: 1.5746, huber: 1.2006, swd: 1.5560, target_std: 6.4541
    Epoch [3/50], Val Losses: mse: 9.8231, mae: 1.6300, huber: 1.2683, swd: 1.1731, target_std: 4.3251
    Epoch [3/50], Test Losses: mse: 10.7368, mae: 1.8232, huber: 1.4472, swd: 1.6015, target_std: 4.7558
      Epoch 3 composite train-obj: 1.200615
            Val objective improved 1.2867 → 1.2683, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.8545, mae: 1.5583, huber: 1.1855, swd: 1.5348, target_std: 6.4530
    Epoch [4/50], Val Losses: mse: 9.7269, mae: 1.6183, huber: 1.2580, swd: 1.1598, target_std: 4.3251
    Epoch [4/50], Test Losses: mse: 10.6951, mae: 1.8166, huber: 1.4409, swd: 1.6016, target_std: 4.7558
      Epoch 4 composite train-obj: 1.185491
            Val objective improved 1.2683 → 1.2580, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.8050, mae: 1.5504, huber: 1.1782, swd: 1.5244, target_std: 6.4555
    Epoch [5/50], Val Losses: mse: 9.6003, mae: 1.6062, huber: 1.2464, swd: 1.1371, target_std: 4.3251
    Epoch [5/50], Test Losses: mse: 10.6578, mae: 1.8108, huber: 1.4354, swd: 1.6046, target_std: 4.7558
      Epoch 5 composite train-obj: 1.178221
            Val objective improved 1.2580 → 1.2464, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.7787, mae: 1.5464, huber: 1.1745, swd: 1.5244, target_std: 6.4588
    Epoch [6/50], Val Losses: mse: 9.7763, mae: 1.6311, huber: 1.2697, swd: 1.3625, target_std: 4.3251
    Epoch [6/50], Test Losses: mse: 10.6331, mae: 1.8081, huber: 1.4322, swd: 1.6737, target_std: 4.7558
      Epoch 6 composite train-obj: 1.174528
            No improvement (1.2697), counter 1/5
    Epoch [7/50], Train Losses: mse: 6.7559, mae: 1.5429, huber: 1.1710, swd: 1.5141, target_std: 6.4549
    Epoch [7/50], Val Losses: mse: 9.5240, mae: 1.5923, huber: 1.2335, swd: 1.0647, target_std: 4.3251
    Epoch [7/50], Test Losses: mse: 10.6438, mae: 1.8024, huber: 1.4278, swd: 1.5270, target_std: 4.7558
      Epoch 7 composite train-obj: 1.171009
            Val objective improved 1.2464 → 1.2335, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.7516, mae: 1.5401, huber: 1.1688, swd: 1.5091, target_std: 6.4544
    Epoch [8/50], Val Losses: mse: 9.4400, mae: 1.5866, huber: 1.2276, swd: 1.0438, target_std: 4.3251
    Epoch [8/50], Test Losses: mse: 10.6536, mae: 1.8090, huber: 1.4334, swd: 1.5804, target_std: 4.7558
      Epoch 8 composite train-obj: 1.168787
            Val objective improved 1.2335 → 1.2276, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.7359, mae: 1.5379, huber: 1.1667, swd: 1.5109, target_std: 6.4564
    Epoch [9/50], Val Losses: mse: 9.5581, mae: 1.5991, huber: 1.2404, swd: 1.1757, target_std: 4.3251
    Epoch [9/50], Test Losses: mse: 10.5757, mae: 1.7938, huber: 1.4203, swd: 1.5668, target_std: 4.7558
      Epoch 9 composite train-obj: 1.166669
            No improvement (1.2404), counter 1/5
    Epoch [10/50], Train Losses: mse: 6.7232, mae: 1.5349, huber: 1.1641, swd: 1.5058, target_std: 6.4560
    Epoch [10/50], Val Losses: mse: 9.4749, mae: 1.5868, huber: 1.2276, swd: 1.0427, target_std: 4.3251
    Epoch [10/50], Test Losses: mse: 10.6064, mae: 1.7994, huber: 1.4248, swd: 1.5344, target_std: 4.7558
      Epoch 10 composite train-obj: 1.164083
            No improvement (1.2276), counter 2/5
    Epoch [11/50], Train Losses: mse: 6.7274, mae: 1.5349, huber: 1.1639, swd: 1.5101, target_std: 6.4639
    Epoch [11/50], Val Losses: mse: 9.6517, mae: 1.5999, huber: 1.2411, swd: 1.0918, target_std: 4.3251
    Epoch [11/50], Test Losses: mse: 10.6197, mae: 1.7994, huber: 1.4222, swd: 1.4559, target_std: 4.7558
      Epoch 11 composite train-obj: 1.163917
            No improvement (1.2411), counter 3/5
    Epoch [12/50], Train Losses: mse: 6.7400, mae: 1.5359, huber: 1.1651, swd: 1.5103, target_std: 6.4597
    Epoch [12/50], Val Losses: mse: 9.5812, mae: 1.6007, huber: 1.2420, swd: 1.2303, target_std: 4.3251
    Epoch [12/50], Test Losses: mse: 10.5477, mae: 1.7904, huber: 1.4171, swd: 1.5782, target_std: 4.7558
      Epoch 12 composite train-obj: 1.165073
            No improvement (1.2420), counter 4/5
    Epoch [13/50], Train Losses: mse: 6.7206, mae: 1.5337, huber: 1.1631, swd: 1.5084, target_std: 6.4580
    Epoch [13/50], Val Losses: mse: 9.5354, mae: 1.5962, huber: 1.2380, swd: 1.1620, target_std: 4.3251
    Epoch [13/50], Test Losses: mse: 10.5714, mae: 1.7916, huber: 1.4181, swd: 1.5518, target_std: 4.7558
      Epoch 13 composite train-obj: 1.163050
    Epoch [13/50], Test Losses: mse: 10.6536, mae: 1.8090, huber: 1.4334, swd: 1.5804, target_std: 4.7558
    Best round's Test MSE: 10.6536, MAE: 1.8090, SWD: 1.5804
    Best round's Validation MSE: 9.4400, MAE: 1.5866
    Best round's Test verification MSE : 10.6536, MAE: 1.8090, SWD: 1.5804
    Time taken: 20.70 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq196_pred196_20250503_1959)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.6702 ± 0.0247
      mae: 1.8066 ± 0.0029
      huber: 1.4312 ± 0.0024
      swd: 1.5681 ± 0.0332
      target_std: 4.7558 ± 0.0000
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.4687 ± 0.0426
      mae: 1.5866 ± 0.0040
      huber: 1.2277 ± 0.0037
      swd: 1.0372 ± 0.0253
      target_std: 4.3251 ± 0.0000
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 67.96 seconds
    
    Experiment complete: DLinear_etth1_seq196_pred196_20250503_1959
    Model: DLinear
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=196,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 12.8507, mae: 2.0874, huber: 1.6891, swd: 2.5717, target_std: 6.4412
    Epoch [1/50], Val Losses: mse: 11.3864, mae: 1.7776, huber: 1.4082, swd: 1.1975, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 11.5688, mae: 2.0033, huber: 1.6123, swd: 1.7922, target_std: 4.7862
      Epoch 1 composite train-obj: 1.689136
            Val objective improved inf → 1.4082, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6955, mae: 1.6998, huber: 1.3161, swd: 1.8518, target_std: 6.4443
    Epoch [2/50], Val Losses: mse: 10.9871, mae: 1.7010, huber: 1.3365, swd: 1.1005, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 11.0245, mae: 1.9269, huber: 1.5408, swd: 1.7079, target_std: 4.7862
      Epoch 2 composite train-obj: 1.316075
            Val objective improved 1.4082 → 1.3365, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.4853, mae: 1.6666, huber: 1.2852, swd: 1.8104, target_std: 6.4323
    Epoch [3/50], Val Losses: mse: 10.9354, mae: 1.6954, huber: 1.3314, swd: 1.2139, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.8930, mae: 1.9083, huber: 1.5225, swd: 1.7307, target_std: 4.7862
      Epoch 3 composite train-obj: 1.285246
            Val objective improved 1.3365 → 1.3314, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.3922, mae: 1.6524, huber: 1.2720, swd: 1.7964, target_std: 6.4405
    Epoch [4/50], Val Losses: mse: 10.5447, mae: 1.6585, huber: 1.2969, swd: 1.1238, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.8761, mae: 1.9006, huber: 1.5150, swd: 1.7537, target_std: 4.7862
      Epoch 4 composite train-obj: 1.271992
            Val objective improved 1.3314 → 1.2969, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.3545, mae: 1.6445, huber: 1.2647, swd: 1.7859, target_std: 6.4424
    Epoch [5/50], Val Losses: mse: 10.6934, mae: 1.6735, huber: 1.3106, swd: 1.2020, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.8459, mae: 1.8979, huber: 1.5140, swd: 1.7612, target_std: 4.7862
      Epoch 5 composite train-obj: 1.264750
            No improvement (1.3106), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.3507, mae: 1.6430, huber: 1.2633, swd: 1.7858, target_std: 6.4428
    Epoch [6/50], Val Losses: mse: 10.6124, mae: 1.6690, huber: 1.3066, swd: 1.1781, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.7833, mae: 1.8838, huber: 1.5021, swd: 1.6690, target_std: 4.7862
      Epoch 6 composite train-obj: 1.263303
            No improvement (1.3066), counter 2/5
    Epoch [7/50], Train Losses: mse: 7.3256, mae: 1.6394, huber: 1.2599, swd: 1.7905, target_std: 6.4449
    Epoch [7/50], Val Losses: mse: 10.5593, mae: 1.6774, huber: 1.3102, swd: 1.2206, target_std: 4.3096
    Epoch [7/50], Test Losses: mse: 10.8130, mae: 1.9003, huber: 1.5132, swd: 1.7759, target_std: 4.7862
      Epoch 7 composite train-obj: 1.259893
            No improvement (1.3102), counter 3/5
    Epoch [8/50], Train Losses: mse: 7.2641, mae: 1.6324, huber: 1.2531, swd: 1.7573, target_std: 6.4418
    Epoch [8/50], Val Losses: mse: 10.6382, mae: 1.6676, huber: 1.3052, swd: 1.2055, target_std: 4.3096
    Epoch [8/50], Test Losses: mse: 10.7571, mae: 1.8859, huber: 1.5019, swd: 1.7334, target_std: 4.7862
      Epoch 8 composite train-obj: 1.253086
            No improvement (1.3052), counter 4/5
    Epoch [9/50], Train Losses: mse: 7.2768, mae: 1.6323, huber: 1.2532, swd: 1.7663, target_std: 6.4335
    Epoch [9/50], Val Losses: mse: 10.4678, mae: 1.6457, huber: 1.2854, swd: 1.0650, target_std: 4.3096
    Epoch [9/50], Test Losses: mse: 10.7600, mae: 1.8799, huber: 1.4950, swd: 1.6023, target_std: 4.7862
      Epoch 9 composite train-obj: 1.253245
            Val objective improved 1.2969 → 1.2854, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 7.2623, mae: 1.6291, huber: 1.2503, swd: 1.7530, target_std: 6.4459
    Epoch [10/50], Val Losses: mse: 10.4942, mae: 1.6521, huber: 1.2917, swd: 1.1317, target_std: 4.3096
    Epoch [10/50], Test Losses: mse: 10.7432, mae: 1.8774, huber: 1.4936, swd: 1.6510, target_std: 4.7862
      Epoch 10 composite train-obj: 1.250322
            No improvement (1.2917), counter 1/5
    Epoch [11/50], Train Losses: mse: 7.2622, mae: 1.6278, huber: 1.2494, swd: 1.7456, target_std: 6.4293
    Epoch [11/50], Val Losses: mse: 10.3110, mae: 1.6425, huber: 1.2799, swd: 1.0876, target_std: 4.3096
    Epoch [11/50], Test Losses: mse: 10.8443, mae: 1.8926, huber: 1.5075, swd: 1.6965, target_std: 4.7862
      Epoch 11 composite train-obj: 1.249352
            Val objective improved 1.2854 → 1.2799, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 7.2668, mae: 1.6285, huber: 1.2498, swd: 1.7540, target_std: 6.4359
    Epoch [12/50], Val Losses: mse: 10.3934, mae: 1.6335, huber: 1.2745, swd: 1.0167, target_std: 4.3096
    Epoch [12/50], Test Losses: mse: 10.7311, mae: 1.8729, huber: 1.4879, swd: 1.5566, target_std: 4.7862
      Epoch 12 composite train-obj: 1.249787
            Val objective improved 1.2799 → 1.2745, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 7.2483, mae: 1.6252, huber: 1.2468, swd: 1.7449, target_std: 6.4367
    Epoch [13/50], Val Losses: mse: 10.4024, mae: 1.6398, huber: 1.2795, swd: 1.0692, target_std: 4.3096
    Epoch [13/50], Test Losses: mse: 10.7212, mae: 1.8724, huber: 1.4901, swd: 1.6145, target_std: 4.7862
      Epoch 13 composite train-obj: 1.246764
            No improvement (1.2795), counter 1/5
    Epoch [14/50], Train Losses: mse: 7.2541, mae: 1.6253, huber: 1.2470, swd: 1.7433, target_std: 6.4346
    Epoch [14/50], Val Losses: mse: 10.4276, mae: 1.6541, huber: 1.2911, swd: 1.1883, target_std: 4.3096
    Epoch [14/50], Test Losses: mse: 10.7577, mae: 1.8884, huber: 1.5003, swd: 1.7440, target_std: 4.7862
      Epoch 14 composite train-obj: 1.246978
            No improvement (1.2911), counter 2/5
    Epoch [15/50], Train Losses: mse: 7.2622, mae: 1.6260, huber: 1.2476, swd: 1.7439, target_std: 6.4353
    Epoch [15/50], Val Losses: mse: 10.3692, mae: 1.6541, huber: 1.2918, swd: 1.1393, target_std: 4.3096
    Epoch [15/50], Test Losses: mse: 10.7709, mae: 1.8805, huber: 1.4969, swd: 1.6506, target_std: 4.7862
      Epoch 15 composite train-obj: 1.247586
            No improvement (1.2918), counter 3/5
    Epoch [16/50], Train Losses: mse: 7.2585, mae: 1.6261, huber: 1.2474, swd: 1.7562, target_std: 6.4427
    Epoch [16/50], Val Losses: mse: 10.4815, mae: 1.6547, huber: 1.2921, swd: 1.1410, target_std: 4.3096
    Epoch [16/50], Test Losses: mse: 10.7236, mae: 1.8801, huber: 1.4945, swd: 1.6847, target_std: 4.7862
      Epoch 16 composite train-obj: 1.247363
            No improvement (1.2921), counter 4/5
    Epoch [17/50], Train Losses: mse: 7.2539, mae: 1.6253, huber: 1.2470, swd: 1.7526, target_std: 6.4409
    Epoch [17/50], Val Losses: mse: 10.3433, mae: 1.6512, huber: 1.2900, swd: 1.1967, target_std: 4.3096
    Epoch [17/50], Test Losses: mse: 10.7305, mae: 1.8725, huber: 1.4899, swd: 1.6793, target_std: 4.7862
      Epoch 17 composite train-obj: 1.246994
    Epoch [17/50], Test Losses: mse: 10.7311, mae: 1.8729, huber: 1.4879, swd: 1.5566, target_std: 4.7862
    Best round's Test MSE: 10.7311, MAE: 1.8729, SWD: 1.5566
    Best round's Validation MSE: 10.3934, MAE: 1.6335
    Best round's Test verification MSE : 10.7311, MAE: 1.8729, SWD: 1.5566
    Time taken: 25.69 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 12.8774, mae: 2.0808, huber: 1.6825, swd: 2.7003, target_std: 6.4385
    Epoch [1/50], Val Losses: mse: 11.2967, mae: 1.7689, huber: 1.3994, swd: 1.1053, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 11.5319, mae: 2.0014, huber: 1.6089, swd: 1.7008, target_std: 4.7862
      Epoch 1 composite train-obj: 1.682481
            Val objective improved inf → 1.3994, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6868, mae: 1.6988, huber: 1.3152, swd: 1.8797, target_std: 6.4385
    Epoch [2/50], Val Losses: mse: 10.6834, mae: 1.6880, huber: 1.3228, swd: 1.1094, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 11.1430, mae: 1.9444, huber: 1.5555, swd: 1.8207, target_std: 4.7862
      Epoch 2 composite train-obj: 1.315161
            Val objective improved 1.3994 → 1.3228, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.4996, mae: 1.6678, huber: 1.2864, swd: 1.8602, target_std: 6.4404
    Epoch [3/50], Val Losses: mse: 10.7561, mae: 1.6789, huber: 1.3162, swd: 1.1583, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.8833, mae: 1.9046, huber: 1.5187, swd: 1.6570, target_std: 4.7862
      Epoch 3 composite train-obj: 1.286405
            Val objective improved 1.3228 → 1.3162, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.4005, mae: 1.6532, huber: 1.2727, swd: 1.8337, target_std: 6.4433
    Epoch [4/50], Val Losses: mse: 10.5135, mae: 1.6699, huber: 1.3063, swd: 1.2047, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.9391, mae: 1.9136, huber: 1.5269, swd: 1.8040, target_std: 4.7862
      Epoch 4 composite train-obj: 1.272710
            Val objective improved 1.3162 → 1.3063, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.3472, mae: 1.6448, huber: 1.2649, swd: 1.8163, target_std: 6.4321
    Epoch [5/50], Val Losses: mse: 10.5825, mae: 1.6552, huber: 1.2937, swd: 1.0821, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.8833, mae: 1.8962, huber: 1.5132, swd: 1.6621, target_std: 4.7862
      Epoch 5 composite train-obj: 1.264874
            Val objective improved 1.3063 → 1.2937, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.3432, mae: 1.6419, huber: 1.2624, swd: 1.8283, target_std: 6.4372
    Epoch [6/50], Val Losses: mse: 10.6981, mae: 1.6754, huber: 1.3118, swd: 1.1877, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.8014, mae: 1.8928, huber: 1.5069, swd: 1.6398, target_std: 4.7862
      Epoch 6 composite train-obj: 1.262364
            No improvement (1.3118), counter 1/5
    Epoch [7/50], Train Losses: mse: 7.3219, mae: 1.6385, huber: 1.2592, swd: 1.8053, target_std: 6.4377
    Epoch [7/50], Val Losses: mse: 10.5419, mae: 1.6731, huber: 1.3080, swd: 1.2034, target_std: 4.3096
    Epoch [7/50], Test Losses: mse: 10.8230, mae: 1.8978, huber: 1.5123, swd: 1.7005, target_std: 4.7862
      Epoch 7 composite train-obj: 1.259246
            No improvement (1.3080), counter 2/5
    Epoch [8/50], Train Losses: mse: 7.2953, mae: 1.6347, huber: 1.2556, swd: 1.8034, target_std: 6.4303
    Epoch [8/50], Val Losses: mse: 10.4539, mae: 1.6562, huber: 1.2938, swd: 1.1577, target_std: 4.3096
    Epoch [8/50], Test Losses: mse: 10.8089, mae: 1.8855, huber: 1.5036, swd: 1.6858, target_std: 4.7862
      Epoch 8 composite train-obj: 1.255569
            No improvement (1.2938), counter 3/5
    Epoch [9/50], Train Losses: mse: 7.2884, mae: 1.6327, huber: 1.2539, swd: 1.8027, target_std: 6.4410
    Epoch [9/50], Val Losses: mse: 10.4403, mae: 1.6401, huber: 1.2803, swd: 1.0473, target_std: 4.3096
    Epoch [9/50], Test Losses: mse: 10.7600, mae: 1.8752, huber: 1.4926, swd: 1.5438, target_std: 4.7862
      Epoch 9 composite train-obj: 1.253878
            Val objective improved 1.2937 → 1.2803, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 7.2732, mae: 1.6304, huber: 1.2516, swd: 1.7898, target_std: 6.4445
    Epoch [10/50], Val Losses: mse: 10.5301, mae: 1.6534, huber: 1.2923, swd: 1.1329, target_std: 4.3096
    Epoch [10/50], Test Losses: mse: 10.7442, mae: 1.8737, huber: 1.4926, swd: 1.5880, target_std: 4.7862
      Epoch 10 composite train-obj: 1.251631
            No improvement (1.2923), counter 1/5
    Epoch [11/50], Train Losses: mse: 7.2712, mae: 1.6298, huber: 1.2511, swd: 1.7929, target_std: 6.4468
    Epoch [11/50], Val Losses: mse: 10.5097, mae: 1.6667, huber: 1.3052, swd: 1.4236, target_std: 4.3096
    Epoch [11/50], Test Losses: mse: 10.7140, mae: 1.8807, huber: 1.4972, swd: 1.8210, target_std: 4.7862
      Epoch 11 composite train-obj: 1.251111
            No improvement (1.3052), counter 2/5
    Epoch [12/50], Train Losses: mse: 7.2750, mae: 1.6289, huber: 1.2504, swd: 1.7911, target_std: 6.4411
    Epoch [12/50], Val Losses: mse: 10.3635, mae: 1.6439, huber: 1.2836, swd: 1.1629, target_std: 4.3096
    Epoch [12/50], Test Losses: mse: 10.7269, mae: 1.8745, huber: 1.4918, swd: 1.6461, target_std: 4.7862
      Epoch 12 composite train-obj: 1.250402
            No improvement (1.2836), counter 3/5
    Epoch [13/50], Train Losses: mse: 7.2541, mae: 1.6264, huber: 1.2480, swd: 1.7727, target_std: 6.4426
    Epoch [13/50], Val Losses: mse: 10.4415, mae: 1.6497, huber: 1.2883, swd: 1.1783, target_std: 4.3096
    Epoch [13/50], Test Losses: mse: 10.7596, mae: 1.8797, huber: 1.4979, swd: 1.6819, target_std: 4.7862
      Epoch 13 composite train-obj: 1.247960
            No improvement (1.2883), counter 4/5
    Epoch [14/50], Train Losses: mse: 7.2597, mae: 1.6258, huber: 1.2475, swd: 1.7833, target_std: 6.4446
    Epoch [14/50], Val Losses: mse: 10.4403, mae: 1.6537, huber: 1.2911, swd: 1.1170, target_std: 4.3096
    Epoch [14/50], Test Losses: mse: 10.7425, mae: 1.8787, huber: 1.4935, swd: 1.5790, target_std: 4.7862
      Epoch 14 composite train-obj: 1.247461
    Epoch [14/50], Test Losses: mse: 10.7600, mae: 1.8752, huber: 1.4926, swd: 1.5438, target_std: 4.7862
    Best round's Test MSE: 10.7600, MAE: 1.8752, SWD: 1.5438
    Best round's Validation MSE: 10.4403, MAE: 1.6401
    Best round's Test verification MSE : 10.7600, MAE: 1.8752, SWD: 1.5438
    Time taken: 18.07 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 12.8812, mae: 2.0783, huber: 1.6800, swd: 2.3892, target_std: 6.4447
    Epoch [1/50], Val Losses: mse: 11.3643, mae: 1.7755, huber: 1.4059, swd: 1.2540, target_std: 4.3096
    Epoch [1/50], Test Losses: mse: 11.5021, mae: 1.9997, huber: 1.6081, swd: 1.8339, target_std: 4.7862
      Epoch 1 composite train-obj: 1.680003
            Val objective improved inf → 1.4059, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6822, mae: 1.6989, huber: 1.3152, swd: 1.8139, target_std: 6.4484
    Epoch [2/50], Val Losses: mse: 10.8142, mae: 1.7025, huber: 1.3357, swd: 1.2226, target_std: 4.3096
    Epoch [2/50], Test Losses: mse: 11.1173, mae: 1.9439, huber: 1.5551, swd: 1.8811, target_std: 4.7862
      Epoch 2 composite train-obj: 1.315222
            Val objective improved 1.4059 → 1.3357, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.4802, mae: 1.6670, huber: 1.2853, swd: 1.7840, target_std: 6.4344
    Epoch [3/50], Val Losses: mse: 10.8293, mae: 1.6905, huber: 1.3256, swd: 1.1791, target_std: 4.3096
    Epoch [3/50], Test Losses: mse: 10.9742, mae: 1.9191, huber: 1.5328, swd: 1.7760, target_std: 4.7862
      Epoch 3 composite train-obj: 1.285283
            Val objective improved 1.3357 → 1.3256, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.3902, mae: 1.6520, huber: 1.2716, swd: 1.7612, target_std: 6.4475
    Epoch [4/50], Val Losses: mse: 10.7456, mae: 1.6731, huber: 1.3108, swd: 1.1940, target_std: 4.3096
    Epoch [4/50], Test Losses: mse: 10.8780, mae: 1.9017, huber: 1.5168, swd: 1.7426, target_std: 4.7862
      Epoch 4 composite train-obj: 1.271566
            Val objective improved 1.3256 → 1.3108, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.3660, mae: 1.6459, huber: 1.2661, swd: 1.7551, target_std: 6.4362
    Epoch [5/50], Val Losses: mse: 10.5107, mae: 1.6572, huber: 1.2950, swd: 1.0955, target_std: 4.3096
    Epoch [5/50], Test Losses: mse: 10.8820, mae: 1.8931, huber: 1.5107, swd: 1.6463, target_std: 4.7862
      Epoch 5 composite train-obj: 1.266103
            Val objective improved 1.3108 → 1.2950, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.3490, mae: 1.6430, huber: 1.2634, swd: 1.7553, target_std: 6.4361
    Epoch [6/50], Val Losses: mse: 10.6304, mae: 1.6627, huber: 1.3014, swd: 1.1955, target_std: 4.3096
    Epoch [6/50], Test Losses: mse: 10.7698, mae: 1.8841, huber: 1.5000, swd: 1.6837, target_std: 4.7862
      Epoch 6 composite train-obj: 1.263385
            No improvement (1.3014), counter 1/5
    Epoch [7/50], Train Losses: mse: 7.3187, mae: 1.6387, huber: 1.2592, swd: 1.7378, target_std: 6.4374
    Epoch [7/50], Val Losses: mse: 10.7060, mae: 1.6896, huber: 1.3246, swd: 1.3971, target_std: 4.3096
    Epoch [7/50], Test Losses: mse: 10.8019, mae: 1.9007, huber: 1.5152, swd: 1.9084, target_std: 4.7862
      Epoch 7 composite train-obj: 1.259190
            No improvement (1.3246), counter 2/5
    Epoch [8/50], Train Losses: mse: 7.3132, mae: 1.6363, huber: 1.2570, swd: 1.7488, target_std: 6.4346
    Epoch [8/50], Val Losses: mse: 10.3965, mae: 1.6421, huber: 1.2818, swd: 1.1374, target_std: 4.3096
    Epoch [8/50], Test Losses: mse: 10.8075, mae: 1.8843, huber: 1.5015, swd: 1.7322, target_std: 4.7862
      Epoch 8 composite train-obj: 1.256997
            Val objective improved 1.2950 → 1.2818, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 7.3031, mae: 1.6356, huber: 1.2565, swd: 1.7479, target_std: 6.4396
    Epoch [9/50], Val Losses: mse: 10.4624, mae: 1.6472, huber: 1.2867, swd: 1.1708, target_std: 4.3096
    Epoch [9/50], Test Losses: mse: 10.7767, mae: 1.8784, huber: 1.4966, swd: 1.7104, target_std: 4.7862
      Epoch 9 composite train-obj: 1.256458
            No improvement (1.2867), counter 1/5
    Epoch [10/50], Train Losses: mse: 7.2876, mae: 1.6329, huber: 1.2541, swd: 1.7466, target_std: 6.4468
    Epoch [10/50], Val Losses: mse: 10.4393, mae: 1.6552, huber: 1.2941, swd: 1.2661, target_std: 4.3096
    Epoch [10/50], Test Losses: mse: 10.7256, mae: 1.8819, huber: 1.4957, swd: 1.7591, target_std: 4.7862
      Epoch 10 composite train-obj: 1.254137
            No improvement (1.2941), counter 2/5
    Epoch [11/50], Train Losses: mse: 7.2967, mae: 1.6326, huber: 1.2538, swd: 1.7507, target_std: 6.4453
    Epoch [11/50], Val Losses: mse: 10.6337, mae: 1.6675, huber: 1.3064, swd: 1.3456, target_std: 4.3096
    Epoch [11/50], Test Losses: mse: 10.6616, mae: 1.8708, huber: 1.4885, swd: 1.7477, target_std: 4.7862
      Epoch 11 composite train-obj: 1.253790
            No improvement (1.3064), counter 3/5
    Epoch [12/50], Train Losses: mse: 7.2543, mae: 1.6276, huber: 1.2491, swd: 1.7249, target_std: 6.4412
    Epoch [12/50], Val Losses: mse: 10.2935, mae: 1.6366, huber: 1.2757, swd: 0.9945, target_std: 4.3096
    Epoch [12/50], Test Losses: mse: 10.8384, mae: 1.8806, huber: 1.4979, swd: 1.5673, target_std: 4.7862
      Epoch 12 composite train-obj: 1.249148
            Val objective improved 1.2818 → 1.2757, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 7.2835, mae: 1.6297, huber: 1.2511, swd: 1.7399, target_std: 6.4443
    Epoch [13/50], Val Losses: mse: 10.3852, mae: 1.6444, huber: 1.2850, swd: 1.2082, target_std: 4.3096
    Epoch [13/50], Test Losses: mse: 10.7375, mae: 1.8725, huber: 1.4902, swd: 1.7235, target_std: 4.7862
      Epoch 13 composite train-obj: 1.251073
            No improvement (1.2850), counter 1/5
    Epoch [14/50], Train Losses: mse: 7.2660, mae: 1.6279, huber: 1.2494, swd: 1.7280, target_std: 6.4499
    Epoch [14/50], Val Losses: mse: 10.3192, mae: 1.6607, huber: 1.2959, swd: 1.2962, target_std: 4.3096
    Epoch [14/50], Test Losses: mse: 10.7780, mae: 1.8877, huber: 1.5035, swd: 1.8563, target_std: 4.7862
      Epoch 14 composite train-obj: 1.249373
            No improvement (1.2959), counter 2/5
    Epoch [15/50], Train Losses: mse: 7.2368, mae: 1.6237, huber: 1.2454, swd: 1.7113, target_std: 6.4404
    Epoch [15/50], Val Losses: mse: 10.3934, mae: 1.6432, huber: 1.2827, swd: 1.0961, target_std: 4.3096
    Epoch [15/50], Test Losses: mse: 10.7340, mae: 1.8701, huber: 1.4885, swd: 1.5955, target_std: 4.7862
      Epoch 15 composite train-obj: 1.245409
            No improvement (1.2827), counter 3/5
    Epoch [16/50], Train Losses: mse: 7.2458, mae: 1.6242, huber: 1.2460, swd: 1.7256, target_std: 6.4426
    Epoch [16/50], Val Losses: mse: 10.3983, mae: 1.6410, huber: 1.2815, swd: 1.1397, target_std: 4.3096
    Epoch [16/50], Test Losses: mse: 10.7107, mae: 1.8696, huber: 1.4862, swd: 1.6030, target_std: 4.7862
      Epoch 16 composite train-obj: 1.246030
            No improvement (1.2815), counter 4/5
    Epoch [17/50], Train Losses: mse: 7.2471, mae: 1.6236, huber: 1.2454, swd: 1.7097, target_std: 6.4428
    Epoch [17/50], Val Losses: mse: 10.3423, mae: 1.6388, huber: 1.2779, swd: 1.0797, target_std: 4.3096
    Epoch [17/50], Test Losses: mse: 10.7644, mae: 1.8758, huber: 1.4923, swd: 1.6426, target_std: 4.7862
      Epoch 17 composite train-obj: 1.245405
    Epoch [17/50], Test Losses: mse: 10.8384, mae: 1.8806, huber: 1.4979, swd: 1.5673, target_std: 4.7862
    Best round's Test MSE: 10.8384, MAE: 1.8806, SWD: 1.5673
    Best round's Validation MSE: 10.2935, MAE: 1.6366
    Best round's Test verification MSE : 10.8384, MAE: 1.8806, SWD: 1.5673
    Time taken: 21.51 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq196_pred336_20250503_2000)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.7765 ± 0.0453
      mae: 1.8762 ± 0.0033
      huber: 1.4928 ± 0.0041
      swd: 1.5559 ± 0.0096
      target_std: 4.7862 ± 0.0000
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 10.3758 ± 0.0612
      mae: 1.6367 ± 0.0027
      huber: 1.2768 ± 0.0025
      swd: 1.0195 ± 0.0216
      target_std: 4.3096 ± 0.0000
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 65.31 seconds
    
    Experiment complete: DLinear_etth1_seq196_pred336_20250503_2000
    Model: DLinear
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=196,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([196, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 196, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 196
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 13.3969, mae: 2.2197, huber: 1.8101, swd: 3.0530, target_std: 6.3755
    Epoch [1/50], Val Losses: mse: 10.0607, mae: 1.7640, huber: 1.3893, swd: 1.3882, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 13.1152, mae: 2.2593, huber: 1.8474, swd: 2.6256, target_std: 4.8325
      Epoch 1 composite train-obj: 1.810090
            Val objective improved inf → 1.3893, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.8119, mae: 1.8756, huber: 1.4780, swd: 2.4042, target_std: 6.3681
    Epoch [2/50], Val Losses: mse: 9.5904, mae: 1.6759, huber: 1.3079, swd: 1.1625, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.6419, mae: 2.1925, huber: 1.7850, swd: 2.4689, target_std: 4.8325
      Epoch 2 composite train-obj: 1.477995
            Val objective improved 1.3893 → 1.3079, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.6036, mae: 1.8434, huber: 1.4481, swd: 2.3724, target_std: 6.3652
    Epoch [3/50], Val Losses: mse: 9.7288, mae: 1.6885, huber: 1.3186, swd: 1.3634, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 12.4146, mae: 2.1699, huber: 1.7615, swd: 2.5505, target_std: 4.8325
      Epoch 3 composite train-obj: 1.448109
            No improvement (1.3186), counter 1/5
    Epoch [4/50], Train Losses: mse: 8.5159, mae: 1.8298, huber: 1.4354, swd: 2.3397, target_std: 6.3629
    Epoch [4/50], Val Losses: mse: 9.5012, mae: 1.6783, huber: 1.3088, swd: 1.4503, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 12.4358, mae: 2.1704, huber: 1.7649, swd: 2.7401, target_std: 4.8325
      Epoch 4 composite train-obj: 1.435402
            No improvement (1.3088), counter 2/5
    Epoch [5/50], Train Losses: mse: 8.4587, mae: 1.8200, huber: 1.4266, swd: 2.3237, target_std: 6.3609
    Epoch [5/50], Val Losses: mse: 9.4545, mae: 1.6613, huber: 1.2959, swd: 1.3459, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 12.2756, mae: 2.1407, huber: 1.7386, swd: 2.4654, target_std: 4.8325
      Epoch 5 composite train-obj: 1.426562
            Val objective improved 1.3079 → 1.2959, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 8.4214, mae: 1.8138, huber: 1.4210, swd: 2.2978, target_std: 6.3699
    Epoch [6/50], Val Losses: mse: 9.4883, mae: 1.6707, huber: 1.3025, swd: 1.4792, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.2064, mae: 2.1381, huber: 1.7344, swd: 2.5438, target_std: 4.8325
      Epoch 6 composite train-obj: 1.420957
            No improvement (1.3025), counter 1/5
    Epoch [7/50], Train Losses: mse: 8.3777, mae: 1.8079, huber: 1.4155, swd: 2.2763, target_std: 6.3671
    Epoch [7/50], Val Losses: mse: 9.2923, mae: 1.6403, huber: 1.2759, swd: 1.3048, target_std: 4.3199
    Epoch [7/50], Test Losses: mse: 12.1829, mae: 2.1242, huber: 1.7243, swd: 2.3959, target_std: 4.8325
      Epoch 7 composite train-obj: 1.415469
            Val objective improved 1.2959 → 1.2759, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 8.3434, mae: 1.8027, huber: 1.4107, swd: 2.2492, target_std: 6.3631
    Epoch [8/50], Val Losses: mse: 9.3573, mae: 1.6655, huber: 1.2955, swd: 1.4466, target_std: 4.3199
    Epoch [8/50], Test Losses: mse: 12.2463, mae: 2.1427, huber: 1.7381, swd: 2.5949, target_std: 4.8325
      Epoch 8 composite train-obj: 1.410722
            No improvement (1.2955), counter 1/5
    Epoch [9/50], Train Losses: mse: 8.3646, mae: 1.8042, huber: 1.4123, swd: 2.2818, target_std: 6.3719
    Epoch [9/50], Val Losses: mse: 9.3815, mae: 1.6469, huber: 1.2825, swd: 1.3729, target_std: 4.3199
    Epoch [9/50], Test Losses: mse: 12.1027, mae: 2.1109, huber: 1.7114, swd: 2.3519, target_std: 4.8325
      Epoch 9 composite train-obj: 1.412309
            No improvement (1.2825), counter 2/5
    Epoch [10/50], Train Losses: mse: 8.3303, mae: 1.7991, huber: 1.4077, swd: 2.2326, target_std: 6.3634
    Epoch [10/50], Val Losses: mse: 9.4498, mae: 1.6774, huber: 1.3098, swd: 1.5853, target_std: 4.3199
    Epoch [10/50], Test Losses: mse: 12.1534, mae: 2.1270, huber: 1.7258, swd: 2.6130, target_std: 4.8325
      Epoch 10 composite train-obj: 1.407654
            No improvement (1.3098), counter 3/5
    Epoch [11/50], Train Losses: mse: 8.3258, mae: 1.7969, huber: 1.4057, swd: 2.2317, target_std: 6.3592
    Epoch [11/50], Val Losses: mse: 9.2353, mae: 1.6291, huber: 1.2646, swd: 1.1948, target_std: 4.3199
    Epoch [11/50], Test Losses: mse: 12.1328, mae: 2.1175, huber: 1.7139, swd: 2.2802, target_std: 4.8325
      Epoch 11 composite train-obj: 1.405652
            Val objective improved 1.2759 → 1.2646, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 8.2987, mae: 1.7932, huber: 1.4021, swd: 2.2332, target_std: 6.3697
    Epoch [12/50], Val Losses: mse: 9.2623, mae: 1.6419, huber: 1.2757, swd: 1.3110, target_std: 4.3199
    Epoch [12/50], Test Losses: mse: 12.0326, mae: 2.1086, huber: 1.7043, swd: 2.2698, target_std: 4.8325
      Epoch 12 composite train-obj: 1.402137
            No improvement (1.2757), counter 1/5
    Epoch [13/50], Train Losses: mse: 8.2877, mae: 1.7917, huber: 1.4008, swd: 2.2144, target_std: 6.3656
    Epoch [13/50], Val Losses: mse: 9.4287, mae: 1.6923, huber: 1.3197, swd: 1.6213, target_std: 4.3199
    Epoch [13/50], Test Losses: mse: 12.0905, mae: 2.1222, huber: 1.7186, swd: 2.5537, target_std: 4.8325
      Epoch 13 composite train-obj: 1.400757
            No improvement (1.3197), counter 2/5
    Epoch [14/50], Train Losses: mse: 8.2597, mae: 1.7879, huber: 1.3970, swd: 2.1942, target_std: 6.3625
    Epoch [14/50], Val Losses: mse: 9.4270, mae: 1.6570, huber: 1.2899, swd: 1.3294, target_std: 4.3199
    Epoch [14/50], Test Losses: mse: 12.0057, mae: 2.1053, huber: 1.7029, swd: 2.2524, target_std: 4.8325
      Epoch 14 composite train-obj: 1.397000
            No improvement (1.2899), counter 3/5
    Epoch [15/50], Train Losses: mse: 8.2526, mae: 1.7867, huber: 1.3960, swd: 2.1876, target_std: 6.3654
    Epoch [15/50], Val Losses: mse: 9.4221, mae: 1.6705, huber: 1.3037, swd: 1.5841, target_std: 4.3199
    Epoch [15/50], Test Losses: mse: 12.0179, mae: 2.1026, huber: 1.7030, swd: 2.4452, target_std: 4.8325
      Epoch 15 composite train-obj: 1.395985
            No improvement (1.3037), counter 4/5
    Epoch [16/50], Train Losses: mse: 8.2756, mae: 1.7884, huber: 1.3977, swd: 2.1907, target_std: 6.3628
    Epoch [16/50], Val Losses: mse: 9.3148, mae: 1.6622, huber: 1.2956, swd: 1.4327, target_std: 4.3199
    Epoch [16/50], Test Losses: mse: 12.0465, mae: 2.1021, huber: 1.7031, swd: 2.3139, target_std: 4.8325
      Epoch 16 composite train-obj: 1.397722
    Epoch [16/50], Test Losses: mse: 12.1328, mae: 2.1175, huber: 1.7139, swd: 2.2802, target_std: 4.8325
    Best round's Test MSE: 12.1328, MAE: 2.1175, SWD: 2.2802
    Best round's Validation MSE: 9.2353, MAE: 1.6291
    Best round's Test verification MSE : 12.1328, MAE: 2.1175, SWD: 2.2802
    Time taken: 19.25 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 13.6493, mae: 2.2258, huber: 1.8161, swd: 2.7964, target_std: 6.3586
    Epoch [1/50], Val Losses: mse: 10.0882, mae: 1.7594, huber: 1.3855, swd: 1.2709, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 13.1455, mae: 2.2647, huber: 1.8522, swd: 2.5574, target_std: 4.8325
      Epoch 1 composite train-obj: 1.816091
            Val objective improved inf → 1.3855, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.8185, mae: 1.8761, huber: 1.4785, swd: 2.2554, target_std: 6.3636
    Epoch [2/50], Val Losses: mse: 9.6377, mae: 1.6960, huber: 1.3270, swd: 1.3132, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.5588, mae: 2.1846, huber: 1.7798, swd: 2.5396, target_std: 4.8325
      Epoch 2 composite train-obj: 1.478535
            Val objective improved 1.3855 → 1.3270, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.5964, mae: 1.8435, huber: 1.4481, swd: 2.2218, target_std: 6.3691
    Epoch [3/50], Val Losses: mse: 9.4377, mae: 1.6641, huber: 1.2969, swd: 1.2321, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 12.4193, mae: 2.1641, huber: 1.7575, swd: 2.4670, target_std: 4.8325
      Epoch 3 composite train-obj: 1.448068
            Val objective improved 1.3270 → 1.2969, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 8.4993, mae: 1.8277, huber: 1.4335, swd: 2.1887, target_std: 6.3642
    Epoch [4/50], Val Losses: mse: 9.2476, mae: 1.6395, huber: 1.2725, swd: 1.1427, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 12.4491, mae: 2.1604, huber: 1.7564, swd: 2.5350, target_std: 4.8325
      Epoch 4 composite train-obj: 1.433462
            Val objective improved 1.2969 → 1.2725, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 8.4688, mae: 1.8204, huber: 1.4269, swd: 2.1890, target_std: 6.3677
    Epoch [5/50], Val Losses: mse: 9.3104, mae: 1.6451, huber: 1.2773, swd: 1.0873, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 12.2811, mae: 2.1414, huber: 1.7346, swd: 2.2740, target_std: 4.8325
      Epoch 5 composite train-obj: 1.426928
            No improvement (1.2773), counter 1/5
    Epoch [6/50], Train Losses: mse: 8.4161, mae: 1.8146, huber: 1.4213, swd: 2.1570, target_std: 6.3736
    Epoch [6/50], Val Losses: mse: 9.5515, mae: 1.6783, huber: 1.3103, swd: 1.3188, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.2960, mae: 2.1465, huber: 1.7438, swd: 2.5100, target_std: 4.8325
      Epoch 6 composite train-obj: 1.421319
            No improvement (1.3103), counter 2/5
    Epoch [7/50], Train Losses: mse: 8.3688, mae: 1.8072, huber: 1.4149, swd: 2.1316, target_std: 6.3596
    Epoch [7/50], Val Losses: mse: 9.4237, mae: 1.6689, huber: 1.2994, swd: 1.3274, target_std: 4.3199
    Epoch [7/50], Test Losses: mse: 12.3197, mae: 2.1542, huber: 1.7481, swd: 2.5500, target_std: 4.8325
      Epoch 7 composite train-obj: 1.414900
            No improvement (1.2994), counter 3/5
    Epoch [8/50], Train Losses: mse: 8.3438, mae: 1.8017, huber: 1.4100, swd: 2.1297, target_std: 6.3612
    Epoch [8/50], Val Losses: mse: 9.3927, mae: 1.6448, huber: 1.2806, swd: 1.2066, target_std: 4.3199
    Epoch [8/50], Test Losses: mse: 12.1015, mae: 2.1150, huber: 1.7127, swd: 2.2675, target_std: 4.8325
      Epoch 8 composite train-obj: 1.409982
            No improvement (1.2806), counter 4/5
    Epoch [9/50], Train Losses: mse: 8.3403, mae: 1.8007, huber: 1.4091, swd: 2.1177, target_std: 6.3645
    Epoch [9/50], Val Losses: mse: 9.3411, mae: 1.6510, huber: 1.2845, swd: 1.2583, target_std: 4.3199
    Epoch [9/50], Test Losses: mse: 12.1282, mae: 2.1203, huber: 1.7170, swd: 2.3400, target_std: 4.8325
      Epoch 9 composite train-obj: 1.409116
    Epoch [9/50], Test Losses: mse: 12.4491, mae: 2.1604, huber: 1.7564, swd: 2.5350, target_std: 4.8325
    Best round's Test MSE: 12.4491, MAE: 2.1604, SWD: 2.5350
    Best round's Validation MSE: 9.2476, MAE: 1.6395
    Best round's Test verification MSE : 12.4491, MAE: 2.1604, SWD: 2.5350
    Time taken: 10.64 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 13.5429, mae: 2.2208, huber: 1.8116, swd: 3.1725, target_std: 6.3712
    Epoch [1/50], Val Losses: mse: 10.0558, mae: 1.7731, huber: 1.3982, swd: 1.4863, target_std: 4.3199
    Epoch [1/50], Test Losses: mse: 13.1747, mae: 2.2647, huber: 1.8557, swd: 2.8180, target_std: 4.8325
      Epoch 1 composite train-obj: 1.811562
            Val objective improved inf → 1.3982, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.7975, mae: 1.8738, huber: 1.4763, swd: 2.4764, target_std: 6.3634
    Epoch [2/50], Val Losses: mse: 9.7486, mae: 1.6973, huber: 1.3290, swd: 1.3917, target_std: 4.3199
    Epoch [2/50], Test Losses: mse: 12.5769, mae: 2.1888, huber: 1.7835, swd: 2.6928, target_std: 4.8325
      Epoch 2 composite train-obj: 1.476262
            Val objective improved 1.3982 → 1.3290, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.5778, mae: 1.8403, huber: 1.4451, swd: 2.4378, target_std: 6.3578
    Epoch [3/50], Val Losses: mse: 9.5348, mae: 1.6671, huber: 1.2998, swd: 1.3468, target_std: 4.3199
    Epoch [3/50], Test Losses: mse: 12.3769, mae: 2.1603, huber: 1.7541, swd: 2.5673, target_std: 4.8325
      Epoch 3 composite train-obj: 1.445139
            Val objective improved 1.3290 → 1.2998, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 8.4910, mae: 1.8267, huber: 1.4325, swd: 2.4164, target_std: 6.3636
    Epoch [4/50], Val Losses: mse: 9.3697, mae: 1.6565, huber: 1.2876, swd: 1.2520, target_std: 4.3199
    Epoch [4/50], Test Losses: mse: 12.3799, mae: 2.1564, huber: 1.7503, swd: 2.5998, target_std: 4.8325
      Epoch 4 composite train-obj: 1.432502
            Val objective improved 1.2998 → 1.2876, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 8.4569, mae: 1.8201, huber: 1.4264, swd: 2.4006, target_std: 6.3584
    Epoch [5/50], Val Losses: mse: 9.5043, mae: 1.6604, huber: 1.2945, swd: 1.3697, target_std: 4.3199
    Epoch [5/50], Test Losses: mse: 12.3778, mae: 2.1537, huber: 1.7508, swd: 2.6833, target_std: 4.8325
      Epoch 5 composite train-obj: 1.426435
            No improvement (1.2945), counter 1/5
    Epoch [6/50], Train Losses: mse: 8.4115, mae: 1.8133, huber: 1.4204, swd: 2.3825, target_std: 6.3620
    Epoch [6/50], Val Losses: mse: 9.3537, mae: 1.6408, huber: 1.2753, swd: 1.1929, target_std: 4.3199
    Epoch [6/50], Test Losses: mse: 12.1920, mae: 2.1245, huber: 1.7212, swd: 2.3190, target_std: 4.8325
      Epoch 6 composite train-obj: 1.420387
            Val objective improved 1.2876 → 1.2753, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 8.3867, mae: 1.8081, huber: 1.4159, swd: 2.3630, target_std: 6.3552
    Epoch [7/50], Val Losses: mse: 9.2280, mae: 1.6360, huber: 1.2704, swd: 1.2907, target_std: 4.3199
    Epoch [7/50], Test Losses: mse: 12.1694, mae: 2.1229, huber: 1.7198, swd: 2.4512, target_std: 4.8325
      Epoch 7 composite train-obj: 1.415927
            Val objective improved 1.2753 → 1.2704, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 8.3820, mae: 1.8066, huber: 1.4146, swd: 2.3681, target_std: 6.3619
    Epoch [8/50], Val Losses: mse: 9.2405, mae: 1.6446, huber: 1.2778, swd: 1.3862, target_std: 4.3199
    Epoch [8/50], Test Losses: mse: 12.1671, mae: 2.1248, huber: 1.7213, swd: 2.4906, target_std: 4.8325
      Epoch 8 composite train-obj: 1.414554
            No improvement (1.2778), counter 1/5
    Epoch [9/50], Train Losses: mse: 8.3465, mae: 1.8009, huber: 1.4092, swd: 2.3386, target_std: 6.3721
    Epoch [9/50], Val Losses: mse: 9.4636, mae: 1.6658, huber: 1.2994, swd: 1.4965, target_std: 4.3199
    Epoch [9/50], Test Losses: mse: 12.1368, mae: 2.1213, huber: 1.7207, swd: 2.5341, target_std: 4.8325
      Epoch 9 composite train-obj: 1.409193
            No improvement (1.2994), counter 2/5
    Epoch [10/50], Train Losses: mse: 8.3472, mae: 1.8001, huber: 1.4087, swd: 2.3329, target_std: 6.3634
    Epoch [10/50], Val Losses: mse: 9.3932, mae: 1.6618, huber: 1.2962, swd: 1.5727, target_std: 4.3199
    Epoch [10/50], Test Losses: mse: 12.0977, mae: 2.1192, huber: 1.7171, swd: 2.5542, target_std: 4.8325
      Epoch 10 composite train-obj: 1.408700
            No improvement (1.2962), counter 3/5
    Epoch [11/50], Train Losses: mse: 8.3385, mae: 1.7979, huber: 1.4066, swd: 2.3365, target_std: 6.3631
    Epoch [11/50], Val Losses: mse: 9.3229, mae: 1.6534, huber: 1.2871, swd: 1.4604, target_std: 4.3199
    Epoch [11/50], Test Losses: mse: 12.1886, mae: 2.1284, huber: 1.7268, swd: 2.5920, target_std: 4.8325
      Epoch 11 composite train-obj: 1.406649
            No improvement (1.2871), counter 4/5
    Epoch [12/50], Train Losses: mse: 8.3178, mae: 1.7967, huber: 1.4054, swd: 2.3053, target_std: 6.3650
    Epoch [12/50], Val Losses: mse: 9.1330, mae: 1.6210, huber: 1.2570, swd: 1.2398, target_std: 4.3199
    Epoch [12/50], Test Losses: mse: 12.0602, mae: 2.1042, huber: 1.7018, swd: 2.3084, target_std: 4.8325
      Epoch 12 composite train-obj: 1.405365
            Val objective improved 1.2704 → 1.2570, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 8.3041, mae: 1.7933, huber: 1.4022, swd: 2.3082, target_std: 6.3687
    Epoch [13/50], Val Losses: mse: 9.2837, mae: 1.6485, huber: 1.2818, swd: 1.3113, target_std: 4.3199
    Epoch [13/50], Test Losses: mse: 12.0517, mae: 2.1035, huber: 1.7024, swd: 2.3228, target_std: 4.8325
      Epoch 13 composite train-obj: 1.402243
            No improvement (1.2818), counter 1/5
    Epoch [14/50], Train Losses: mse: 8.2698, mae: 1.7884, huber: 1.3977, swd: 2.2720, target_std: 6.3645
    Epoch [14/50], Val Losses: mse: 9.5836, mae: 1.6820, huber: 1.3151, swd: 1.5435, target_std: 4.3199
    Epoch [14/50], Test Losses: mse: 11.9527, mae: 2.1007, huber: 1.7000, swd: 2.3050, target_std: 4.8325
      Epoch 14 composite train-obj: 1.397724
            No improvement (1.3151), counter 2/5
    Epoch [15/50], Train Losses: mse: 8.2639, mae: 1.7881, huber: 1.3976, swd: 2.2720, target_std: 6.3641
    Epoch [15/50], Val Losses: mse: 9.4180, mae: 1.6584, huber: 1.2948, swd: 1.5106, target_std: 4.3199
    Epoch [15/50], Test Losses: mse: 12.0523, mae: 2.1060, huber: 1.7083, swd: 2.4788, target_std: 4.8325
      Epoch 15 composite train-obj: 1.397562
            No improvement (1.2948), counter 3/5
    Epoch [16/50], Train Losses: mse: 8.2561, mae: 1.7870, huber: 1.3963, swd: 2.2577, target_std: 6.3680
    Epoch [16/50], Val Losses: mse: 9.4222, mae: 1.6592, huber: 1.2939, swd: 1.4143, target_std: 4.3199
    Epoch [16/50], Test Losses: mse: 12.0546, mae: 2.1098, huber: 1.7077, swd: 2.4207, target_std: 4.8325
      Epoch 16 composite train-obj: 1.396250
            No improvement (1.2939), counter 4/5
    Epoch [17/50], Train Losses: mse: 8.2626, mae: 1.7860, huber: 1.3954, swd: 2.2643, target_std: 6.3578
    Epoch [17/50], Val Losses: mse: 9.3181, mae: 1.6543, huber: 1.2872, swd: 1.3984, target_std: 4.3199
    Epoch [17/50], Test Losses: mse: 11.9755, mae: 2.0975, huber: 1.6965, swd: 2.2825, target_std: 4.8325
      Epoch 17 composite train-obj: 1.395391
    Epoch [17/50], Test Losses: mse: 12.0602, mae: 2.1042, huber: 1.7018, swd: 2.3084, target_std: 4.8325
    Best round's Test MSE: 12.0602, MAE: 2.1042, SWD: 2.3084
    Best round's Validation MSE: 9.1330, MAE: 1.6210
    Best round's Test verification MSE : 12.0602, MAE: 2.1042, SWD: 2.3084
    Time taken: 20.14 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq196_pred720_20250503_2001)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 12.2140 ± 0.1688
      mae: 2.1274 ± 0.0240
      huber: 1.7240 ± 0.0234
      swd: 2.3745 ± 0.1140
      target_std: 4.8325 ± 0.0000
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.2053 ± 0.0514
      mae: 1.6299 ± 0.0075
      huber: 1.2647 ± 0.0063
      swd: 1.1924 ± 0.0397
      target_std: 4.3199 ± 0.0000
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 50.10 seconds
    
    Experiment complete: DLinear_etth1_seq196_pred720_20250503_2001
    Model: DLinear
    Dataset: etth1
    Sequence Length: 196
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    


```python

```






