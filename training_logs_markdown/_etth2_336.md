# data


```python
import torch 
import importlib
import monotonic
import data_manager
import metrics
import utils
importlib.reload(utils)
import train as Train
from train import execute_model_evaluation
import train_config
from data_manager import DatasetManager
data_mgr = DatasetManager(device='cuda')

# Load a synthetic dataset
data_mgr.load_csv('etth2', './etth2.csv')
```

    
    ==================================================
    Dataset: etth2 (csv)
    ==================================================
    Shape: torch.Size([17420, 7])
    Channels: 7
    Length: 17420
    Source: ./etth2.csv
    
    Sample data (first 2 rows):
    tensor([[41.1300, 12.4810, 36.5360,  9.3550,  4.4240,  1.3110, 38.6620],
            [37.5280, 10.1360, 33.9360,  7.5320,  4.4350,  1.2150, 37.1240]])
    ==================================================
    




    <data_manager.DatasetManager at 0x1cf1c1305f0>



# exp-336

## Seq=336

### EigenACL

#### pred=96


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=336,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4000, mae: 0.3950, huber: 0.1554, swd: 0.2246, ept: 69.7196
    Epoch [1/50], Val Losses: mse: 0.2988, mae: 0.3850, huber: 0.1408, swd: 0.1444, ept: 62.5322
    Epoch [1/50], Test Losses: mse: 0.1646, mae: 0.2919, huber: 0.0807, swd: 0.0643, ept: 76.4172
      Epoch 1 composite train-obj: 0.155393
            Val objective improved inf → 0.1408, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2890, mae: 0.3287, huber: 0.1133, swd: 0.1296, ept: 77.3174
    Epoch [2/50], Val Losses: mse: 0.2923, mae: 0.3821, huber: 0.1379, swd: 0.1369, ept: 61.4684
    Epoch [2/50], Test Losses: mse: 0.1585, mae: 0.2873, huber: 0.0779, swd: 0.0587, ept: 77.0014
      Epoch 2 composite train-obj: 0.113337
            Val objective improved 0.1408 → 0.1379, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2529, mae: 0.3065, huber: 0.1002, swd: 0.1122, ept: 79.3598
    Epoch [3/50], Val Losses: mse: 0.2944, mae: 0.3799, huber: 0.1383, swd: 0.1333, ept: 62.9261
    Epoch [3/50], Test Losses: mse: 0.1494, mae: 0.2780, huber: 0.0735, swd: 0.0535, ept: 77.8687
      Epoch 3 composite train-obj: 0.100204
            No improvement (0.1383), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2228, mae: 0.2870, huber: 0.0896, swd: 0.0962, ept: 81.4115
    Epoch [4/50], Val Losses: mse: 0.2863, mae: 0.3768, huber: 0.1353, swd: 0.1237, ept: 62.8412
    Epoch [4/50], Test Losses: mse: 0.1499, mae: 0.2815, huber: 0.0740, swd: 0.0504, ept: 78.5256
      Epoch 4 composite train-obj: 0.089564
            Val objective improved 0.1379 → 0.1353, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2023, mae: 0.2777, huber: 0.0833, swd: 0.0823, ept: 82.3892
    Epoch [5/50], Val Losses: mse: 0.2995, mae: 0.3863, huber: 0.1406, swd: 0.1283, ept: 62.4628
    Epoch [5/50], Test Losses: mse: 0.1542, mae: 0.2869, huber: 0.0761, swd: 0.0535, ept: 78.2639
      Epoch 5 composite train-obj: 0.083294
            No improvement (0.1406), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.1858, mae: 0.2683, huber: 0.0774, swd: 0.0719, ept: 83.3554
    Epoch [6/50], Val Losses: mse: 0.2911, mae: 0.3782, huber: 0.1361, swd: 0.1250, ept: 65.3604
    Epoch [6/50], Test Losses: mse: 0.1544, mae: 0.2878, huber: 0.0762, swd: 0.0554, ept: 78.3759
      Epoch 6 composite train-obj: 0.077415
            No improvement (0.1361), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.1733, mae: 0.2600, huber: 0.0726, swd: 0.0645, ept: 84.1364
    Epoch [7/50], Val Losses: mse: 0.2945, mae: 0.3842, huber: 0.1390, swd: 0.1169, ept: 64.2019
    Epoch [7/50], Test Losses: mse: 0.1671, mae: 0.3011, huber: 0.0825, swd: 0.0581, ept: 77.9116
      Epoch 7 composite train-obj: 0.072620
            No improvement (0.1390), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.1641, mae: 0.2526, huber: 0.0687, swd: 0.0585, ept: 84.8451
    Epoch [8/50], Val Losses: mse: 0.3012, mae: 0.3872, huber: 0.1406, swd: 0.1272, ept: 65.5390
    Epoch [8/50], Test Losses: mse: 0.1654, mae: 0.3002, huber: 0.0817, swd: 0.0643, ept: 78.1610
      Epoch 8 composite train-obj: 0.068736
            No improvement (0.1406), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.1564, mae: 0.2465, huber: 0.0656, swd: 0.0537, ept: 85.2350
    Epoch [9/50], Val Losses: mse: 0.3029, mae: 0.3896, huber: 0.1416, swd: 0.1194, ept: 65.5632
    Epoch [9/50], Test Losses: mse: 0.1733, mae: 0.3062, huber: 0.0855, swd: 0.0619, ept: 77.6622
      Epoch 9 composite train-obj: 0.065584
    Epoch [9/50], Test Losses: mse: 0.1499, mae: 0.2815, huber: 0.0740, swd: 0.0504, ept: 78.5231
    Best round's Test MSE: 0.1499, MAE: 0.2815, SWD: 0.0504
    Best round's Validation MSE: 0.2863, MAE: 0.3768, SWD: 0.1237
    Best round's Test verification MSE : 0.1499, MAE: 0.2815, SWD: 0.0504
    Time taken: 22.99 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3990, mae: 0.3950, huber: 0.1554, swd: 0.2240, ept: 69.4764
    Epoch [1/50], Val Losses: mse: 0.2994, mae: 0.3836, huber: 0.1409, swd: 0.1390, ept: 62.0592
    Epoch [1/50], Test Losses: mse: 0.1661, mae: 0.2927, huber: 0.0814, swd: 0.0629, ept: 76.0857
      Epoch 1 composite train-obj: 0.155361
            Val objective improved inf → 0.1409, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2857, mae: 0.3270, huber: 0.1123, swd: 0.1291, ept: 77.2830
    Epoch [2/50], Val Losses: mse: 0.2948, mae: 0.3846, huber: 0.1395, swd: 0.1231, ept: 61.2329
    Epoch [2/50], Test Losses: mse: 0.1611, mae: 0.2908, huber: 0.0793, swd: 0.0512, ept: 76.9497
      Epoch 2 composite train-obj: 0.112342
            Val objective improved 0.1409 → 0.1395, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2464, mae: 0.3026, huber: 0.0981, swd: 0.1104, ept: 79.6345
    Epoch [3/50], Val Losses: mse: 0.2850, mae: 0.3754, huber: 0.1347, swd: 0.1228, ept: 62.5657
    Epoch [3/50], Test Losses: mse: 0.1509, mae: 0.2816, huber: 0.0744, swd: 0.0539, ept: 77.0415
      Epoch 3 composite train-obj: 0.098121
            Val objective improved 0.1395 → 0.1347, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2165, mae: 0.2856, huber: 0.0883, swd: 0.0929, ept: 81.4942
    Epoch [4/50], Val Losses: mse: 0.2763, mae: 0.3722, huber: 0.1314, swd: 0.1080, ept: 63.9908
    Epoch [4/50], Test Losses: mse: 0.1599, mae: 0.2946, huber: 0.0791, swd: 0.0514, ept: 77.8713
      Epoch 4 composite train-obj: 0.088299
            Val objective improved 0.1347 → 0.1314, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.1981, mae: 0.2767, huber: 0.0822, swd: 0.0806, ept: 82.6030
    Epoch [5/50], Val Losses: mse: 0.2806, mae: 0.3735, huber: 0.1324, swd: 0.1131, ept: 64.9746
    Epoch [5/50], Test Losses: mse: 0.1546, mae: 0.2881, huber: 0.0763, swd: 0.0526, ept: 78.4420
      Epoch 5 composite train-obj: 0.082183
            No improvement (0.1324), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.1839, mae: 0.2674, huber: 0.0768, swd: 0.0720, ept: 83.4745
    Epoch [6/50], Val Losses: mse: 0.2849, mae: 0.3771, huber: 0.1350, swd: 0.1119, ept: 64.6249
    Epoch [6/50], Test Losses: mse: 0.1625, mae: 0.2967, huber: 0.0802, swd: 0.0561, ept: 78.1112
      Epoch 6 composite train-obj: 0.076812
            No improvement (0.1350), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.1730, mae: 0.2602, huber: 0.0725, swd: 0.0659, ept: 84.1177
    Epoch [7/50], Val Losses: mse: 0.2877, mae: 0.3784, huber: 0.1361, swd: 0.1049, ept: 64.3656
    Epoch [7/50], Test Losses: mse: 0.1665, mae: 0.2985, huber: 0.0822, swd: 0.0556, ept: 77.6705
      Epoch 7 composite train-obj: 0.072528
            No improvement (0.1361), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.1643, mae: 0.2537, huber: 0.0690, swd: 0.0603, ept: 84.5827
    Epoch [8/50], Val Losses: mse: 0.2911, mae: 0.3802, huber: 0.1371, swd: 0.1205, ept: 65.5533
    Epoch [8/50], Test Losses: mse: 0.1677, mae: 0.3002, huber: 0.0825, swd: 0.0638, ept: 78.0429
      Epoch 8 composite train-obj: 0.069027
            No improvement (0.1371), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.1576, mae: 0.2481, huber: 0.0662, swd: 0.0562, ept: 85.0715
    Epoch [9/50], Val Losses: mse: 0.2921, mae: 0.3808, huber: 0.1374, swd: 0.1169, ept: 66.0557
    Epoch [9/50], Test Losses: mse: 0.1776, mae: 0.3113, huber: 0.0873, swd: 0.0701, ept: 77.9831
      Epoch 9 composite train-obj: 0.066155
    Epoch [9/50], Test Losses: mse: 0.1599, mae: 0.2946, huber: 0.0791, swd: 0.0514, ept: 77.8713
    Best round's Test MSE: 0.1599, MAE: 0.2946, SWD: 0.0514
    Best round's Validation MSE: 0.2763, MAE: 0.3722, SWD: 0.1080
    Best round's Test verification MSE : 0.1599, MAE: 0.2946, SWD: 0.0514
    Time taken: 22.80 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4062, mae: 0.3996, huber: 0.1582, swd: 0.2126, ept: 69.2038
    Epoch [1/50], Val Losses: mse: 0.3017, mae: 0.3873, huber: 0.1420, swd: 0.1362, ept: 62.1167
    Epoch [1/50], Test Losses: mse: 0.1664, mae: 0.2928, huber: 0.0815, swd: 0.0625, ept: 75.7305
      Epoch 1 composite train-obj: 0.158231
            Val objective improved inf → 0.1420, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2927, mae: 0.3298, huber: 0.1145, swd: 0.1239, ept: 77.1174
    Epoch [2/50], Val Losses: mse: 0.3059, mae: 0.3951, huber: 0.1435, swd: 0.1444, ept: 61.9062
    Epoch [2/50], Test Losses: mse: 0.1629, mae: 0.2930, huber: 0.0800, swd: 0.0649, ept: 76.3261
      Epoch 2 composite train-obj: 0.114525
            No improvement (0.1435), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2537, mae: 0.3044, huber: 0.1000, swd: 0.1059, ept: 79.5447
    Epoch [3/50], Val Losses: mse: 0.2796, mae: 0.3717, huber: 0.1323, swd: 0.1084, ept: 64.8216
    Epoch [3/50], Test Losses: mse: 0.1489, mae: 0.2789, huber: 0.0734, swd: 0.0473, ept: 78.5634
      Epoch 3 composite train-obj: 0.099968
            Val objective improved 0.1420 → 0.1323, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2264, mae: 0.2896, huber: 0.0910, swd: 0.0927, ept: 81.4256
    Epoch [4/50], Val Losses: mse: 0.2800, mae: 0.3729, huber: 0.1327, swd: 0.1072, ept: 64.4956
    Epoch [4/50], Test Losses: mse: 0.1521, mae: 0.2848, huber: 0.0752, swd: 0.0476, ept: 78.6408
      Epoch 4 composite train-obj: 0.091031
            No improvement (0.1327), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2054, mae: 0.2789, huber: 0.0843, swd: 0.0795, ept: 82.5505
    Epoch [5/50], Val Losses: mse: 0.2763, mae: 0.3709, huber: 0.1308, swd: 0.1024, ept: 65.6752
    Epoch [5/50], Test Losses: mse: 0.1536, mae: 0.2851, huber: 0.0759, swd: 0.0470, ept: 78.7138
      Epoch 5 composite train-obj: 0.084297
            Val objective improved 0.1323 → 0.1308, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.1912, mae: 0.2707, huber: 0.0792, swd: 0.0711, ept: 83.3474
    Epoch [6/50], Val Losses: mse: 0.2898, mae: 0.3824, huber: 0.1371, swd: 0.1035, ept: 64.3738
    Epoch [6/50], Test Losses: mse: 0.1639, mae: 0.2940, huber: 0.0809, swd: 0.0508, ept: 77.6999
      Epoch 6 composite train-obj: 0.079171
            No improvement (0.1371), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.1789, mae: 0.2634, huber: 0.0746, swd: 0.0646, ept: 84.0303
    Epoch [7/50], Val Losses: mse: 0.3030, mae: 0.3967, huber: 0.1436, swd: 0.1077, ept: 63.4086
    Epoch [7/50], Test Losses: mse: 0.1790, mae: 0.3095, huber: 0.0883, swd: 0.0550, ept: 77.0816
      Epoch 7 composite train-obj: 0.074613
            No improvement (0.1436), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.1702, mae: 0.2573, huber: 0.0712, swd: 0.0603, ept: 84.6004
    Epoch [8/50], Val Losses: mse: 0.3014, mae: 0.3886, huber: 0.1413, swd: 0.1233, ept: 65.1640
    Epoch [8/50], Test Losses: mse: 0.1764, mae: 0.3130, huber: 0.0870, swd: 0.0652, ept: 78.5510
      Epoch 8 composite train-obj: 0.071179
            No improvement (0.1413), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.1606, mae: 0.2495, huber: 0.0672, swd: 0.0543, ept: 85.0950
    Epoch [9/50], Val Losses: mse: 0.2848, mae: 0.3780, huber: 0.1345, swd: 0.1025, ept: 66.1179
    Epoch [9/50], Test Losses: mse: 0.1784, mae: 0.3100, huber: 0.0880, swd: 0.0581, ept: 77.7149
      Epoch 9 composite train-obj: 0.067225
            No improvement (0.1345), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.1555, mae: 0.2460, huber: 0.0652, swd: 0.0515, ept: 85.4475
    Epoch [10/50], Val Losses: mse: 0.2880, mae: 0.3810, huber: 0.1359, swd: 0.1073, ept: 66.1866
    Epoch [10/50], Test Losses: mse: 0.1745, mae: 0.3090, huber: 0.0860, swd: 0.0632, ept: 77.8433
      Epoch 10 composite train-obj: 0.065188
    Epoch [10/50], Test Losses: mse: 0.1536, mae: 0.2851, huber: 0.0759, swd: 0.0470, ept: 78.7138
    Best round's Test MSE: 0.1536, MAE: 0.2851, SWD: 0.0470
    Best round's Validation MSE: 0.2763, MAE: 0.3709, SWD: 0.1024
    Best round's Test verification MSE : 0.1536, MAE: 0.2851, SWD: 0.0470
    Time taken: 25.50 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq336_pred96_20250510_2117)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1545 ± 0.0041
      mae: 0.2871 ± 0.0055
      huber: 0.0763 ± 0.0021
      swd: 0.0496 ± 0.0019
      ept: 78.3702 ± 0.3610
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2796 ± 0.0047
      mae: 0.3733 ± 0.0025
      huber: 0.1325 ± 0.0020
      swd: 0.1114 ± 0.0090
      ept: 64.1691 ± 1.1638
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 72.34 seconds
    
    Experiment complete: ACL_etth2_seq336_pred96_20250510_2117
    Model: ACL
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=336,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4634, mae: 0.4272, huber: 0.1773, swd: 0.2667, ept: 119.9820
    Epoch [1/50], Val Losses: mse: 0.3678, mae: 0.4421, huber: 0.1718, swd: 0.2000, ept: 94.1448
    Epoch [1/50], Test Losses: mse: 0.1964, mae: 0.3210, huber: 0.0958, swd: 0.0964, ept: 128.8317
      Epoch 1 composite train-obj: 0.177269
            Val objective improved inf → 0.1718, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3677, mae: 0.3725, huber: 0.1411, swd: 0.1819, ept: 132.2857
    Epoch [2/50], Val Losses: mse: 0.3563, mae: 0.4358, huber: 0.1667, swd: 0.1853, ept: 94.4009
    Epoch [2/50], Test Losses: mse: 0.1917, mae: 0.3207, huber: 0.0938, swd: 0.0846, ept: 132.1009
      Epoch 2 composite train-obj: 0.141080
            Val objective improved 0.1718 → 0.1667, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3247, mae: 0.3476, huber: 0.1251, swd: 0.1593, ept: 136.3708
    Epoch [3/50], Val Losses: mse: 0.3321, mae: 0.4110, huber: 0.1561, swd: 0.1400, ept: 100.7256
    Epoch [3/50], Test Losses: mse: 0.1818, mae: 0.3152, huber: 0.0895, swd: 0.0665, ept: 131.5694
      Epoch 3 composite train-obj: 0.125076
            Val objective improved 0.1667 → 0.1561, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2926, mae: 0.3246, huber: 0.1125, swd: 0.1377, ept: 143.4662
    Epoch [4/50], Val Losses: mse: 0.3378, mae: 0.4127, huber: 0.1583, swd: 0.1321, ept: 101.5578
    Epoch [4/50], Test Losses: mse: 0.1796, mae: 0.3126, huber: 0.0886, swd: 0.0609, ept: 132.8707
      Epoch 4 composite train-obj: 0.112526
            No improvement (0.1583), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2746, mae: 0.3141, huber: 0.1058, swd: 0.1250, ept: 146.9073
    Epoch [5/50], Val Losses: mse: 0.3408, mae: 0.4191, huber: 0.1590, swd: 0.1474, ept: 102.7557
    Epoch [5/50], Test Losses: mse: 0.2079, mae: 0.3443, huber: 0.1026, swd: 0.0959, ept: 130.6176
      Epoch 5 composite train-obj: 0.105786
            No improvement (0.1590), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.2611, mae: 0.3066, huber: 0.1008, swd: 0.1147, ept: 149.1792
    Epoch [6/50], Val Losses: mse: 0.3757, mae: 0.4413, huber: 0.1744, swd: 0.1456, ept: 101.3102
    Epoch [6/50], Test Losses: mse: 0.1992, mae: 0.3303, huber: 0.0981, swd: 0.0687, ept: 132.0907
      Epoch 6 composite train-obj: 0.100821
            No improvement (0.1744), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.2477, mae: 0.2972, huber: 0.0955, swd: 0.1044, ept: 150.9308
    Epoch [7/50], Val Losses: mse: 0.3455, mae: 0.4130, huber: 0.1603, swd: 0.1248, ept: 105.4985
    Epoch [7/50], Test Losses: mse: 0.2142, mae: 0.3526, huber: 0.1057, swd: 0.0848, ept: 132.6138
      Epoch 7 composite train-obj: 0.095494
            No improvement (0.1603), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.2374, mae: 0.2916, huber: 0.0919, swd: 0.0969, ept: 152.0632
    Epoch [8/50], Val Losses: mse: 0.3601, mae: 0.4289, huber: 0.1666, swd: 0.1435, ept: 102.2942
    Epoch [8/50], Test Losses: mse: 0.2295, mae: 0.3618, huber: 0.1131, swd: 0.1039, ept: 130.0062
      Epoch 8 composite train-obj: 0.091945
    Epoch [8/50], Test Losses: mse: 0.1818, mae: 0.3152, huber: 0.0895, swd: 0.0665, ept: 131.5694
    Best round's Test MSE: 0.1818, MAE: 0.3152, SWD: 0.0665
    Best round's Validation MSE: 0.3321, MAE: 0.4110, SWD: 0.1400
    Best round's Test verification MSE : 0.1818, MAE: 0.3152, SWD: 0.0665
    Time taken: 20.45 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4617, mae: 0.4266, huber: 0.1772, swd: 0.2704, ept: 120.2740
    Epoch [1/50], Val Losses: mse: 0.3808, mae: 0.4508, huber: 0.1781, swd: 0.1732, ept: 91.2151
    Epoch [1/50], Test Losses: mse: 0.2027, mae: 0.3310, huber: 0.0992, swd: 0.0764, ept: 130.6347
      Epoch 1 composite train-obj: 0.177199
            Val objective improved inf → 0.1781, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3594, mae: 0.3679, huber: 0.1379, swd: 0.1798, ept: 133.1640
    Epoch [2/50], Val Losses: mse: 0.3537, mae: 0.4287, huber: 0.1653, swd: 0.1688, ept: 94.6853
    Epoch [2/50], Test Losses: mse: 0.1931, mae: 0.3220, huber: 0.0945, swd: 0.0810, ept: 131.0242
      Epoch 2 composite train-obj: 0.137940
            Val objective improved 0.1781 → 0.1653, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3206, mae: 0.3439, huber: 0.1232, swd: 0.1601, ept: 137.9238
    Epoch [3/50], Val Losses: mse: 0.3285, mae: 0.4094, huber: 0.1540, swd: 0.1492, ept: 101.1500
    Epoch [3/50], Test Losses: mse: 0.1826, mae: 0.3193, huber: 0.0900, swd: 0.0762, ept: 133.9125
      Epoch 3 composite train-obj: 0.123195
            Val objective improved 0.1653 → 0.1540, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2899, mae: 0.3222, huber: 0.1113, swd: 0.1386, ept: 144.8569
    Epoch [4/50], Val Losses: mse: 0.3263, mae: 0.4055, huber: 0.1526, swd: 0.1409, ept: 103.6620
    Epoch [4/50], Test Losses: mse: 0.1811, mae: 0.3169, huber: 0.0892, swd: 0.0776, ept: 134.1136
      Epoch 4 composite train-obj: 0.111259
            Val objective improved 0.1540 → 0.1526, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2724, mae: 0.3135, huber: 0.1053, swd: 0.1245, ept: 147.7501
    Epoch [5/50], Val Losses: mse: 0.3329, mae: 0.4136, huber: 0.1566, swd: 0.1257, ept: 103.7400
    Epoch [5/50], Test Losses: mse: 0.1946, mae: 0.3310, huber: 0.0961, swd: 0.0715, ept: 134.1791
      Epoch 5 composite train-obj: 0.105271
            No improvement (0.1566), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.2592, mae: 0.3054, huber: 0.1005, swd: 0.1151, ept: 149.8780
    Epoch [6/50], Val Losses: mse: 0.3522, mae: 0.4230, huber: 0.1631, swd: 0.1395, ept: 101.6149
    Epoch [6/50], Test Losses: mse: 0.1929, mae: 0.3294, huber: 0.0951, swd: 0.0811, ept: 134.7300
      Epoch 6 composite train-obj: 0.100500
            No improvement (0.1631), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.2434, mae: 0.2966, huber: 0.0947, swd: 0.1025, ept: 151.1155
    Epoch [7/50], Val Losses: mse: 0.3738, mae: 0.4440, huber: 0.1731, swd: 0.1761, ept: 98.3435
    Epoch [7/50], Test Losses: mse: 0.2157, mae: 0.3515, huber: 0.1062, swd: 0.1050, ept: 130.6578
      Epoch 7 composite train-obj: 0.094736
            No improvement (0.1731), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.2326, mae: 0.2895, huber: 0.0907, swd: 0.0944, ept: 152.4896
    Epoch [8/50], Val Losses: mse: 0.3404, mae: 0.4191, huber: 0.1593, swd: 0.1312, ept: 102.4556
    Epoch [8/50], Test Losses: mse: 0.2056, mae: 0.3388, huber: 0.1012, swd: 0.0785, ept: 132.8552
      Epoch 8 composite train-obj: 0.090716
            No improvement (0.1593), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.2220, mae: 0.2837, huber: 0.0873, swd: 0.0868, ept: 153.5905
    Epoch [9/50], Val Losses: mse: 0.3440, mae: 0.4185, huber: 0.1601, swd: 0.1320, ept: 101.9472
    Epoch [9/50], Test Losses: mse: 0.2097, mae: 0.3456, huber: 0.1034, swd: 0.0897, ept: 133.4788
      Epoch 9 composite train-obj: 0.087291
    Epoch [9/50], Test Losses: mse: 0.1811, mae: 0.3169, huber: 0.0892, swd: 0.0776, ept: 134.1563
    Best round's Test MSE: 0.1811, MAE: 0.3169, SWD: 0.0776
    Best round's Validation MSE: 0.3263, MAE: 0.4055, SWD: 0.1409
    Best round's Test verification MSE : 0.1811, MAE: 0.3169, SWD: 0.0776
    Time taken: 22.65 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4681, mae: 0.4314, huber: 0.1797, swd: 0.2502, ept: 118.7534
    Epoch [1/50], Val Losses: mse: 0.3527, mae: 0.4249, huber: 0.1650, swd: 0.1471, ept: 98.6735
    Epoch [1/50], Test Losses: mse: 0.1900, mae: 0.3133, huber: 0.0927, swd: 0.0702, ept: 131.1359
      Epoch 1 composite train-obj: 0.179690
            Val objective improved inf → 0.1650, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3600, mae: 0.3677, huber: 0.1382, swd: 0.1645, ept: 132.9718
    Epoch [2/50], Val Losses: mse: 0.3369, mae: 0.4175, huber: 0.1582, swd: 0.1359, ept: 100.9009
    Epoch [2/50], Test Losses: mse: 0.1851, mae: 0.3134, huber: 0.0908, swd: 0.0606, ept: 133.1105
      Epoch 2 composite train-obj: 0.138179
            Val objective improved 0.1650 → 0.1582, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3178, mae: 0.3409, huber: 0.1220, swd: 0.1446, ept: 138.3934
    Epoch [3/50], Val Losses: mse: 0.3202, mae: 0.4087, huber: 0.1518, swd: 0.1165, ept: 102.6261
    Epoch [3/50], Test Losses: mse: 0.1856, mae: 0.3246, huber: 0.0917, swd: 0.0594, ept: 134.0993
      Epoch 3 composite train-obj: 0.122000
            Val objective improved 0.1582 → 0.1518, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2897, mae: 0.3225, huber: 0.1113, swd: 0.1274, ept: 144.5967
    Epoch [4/50], Val Losses: mse: 0.3342, mae: 0.4188, huber: 0.1564, swd: 0.1350, ept: 98.6496
    Epoch [4/50], Test Losses: mse: 0.1918, mae: 0.3304, huber: 0.0946, swd: 0.0781, ept: 134.3230
      Epoch 4 composite train-obj: 0.111288
            No improvement (0.1564), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2743, mae: 0.3126, huber: 0.1054, swd: 0.1173, ept: 147.0334
    Epoch [5/50], Val Losses: mse: 0.3363, mae: 0.4162, huber: 0.1578, swd: 0.1105, ept: 101.4274
    Epoch [5/50], Test Losses: mse: 0.1911, mae: 0.3302, huber: 0.0945, swd: 0.0621, ept: 132.7954
      Epoch 5 composite train-obj: 0.105418
            No improvement (0.1578), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.2620, mae: 0.3054, huber: 0.1008, swd: 0.1084, ept: 148.8375
    Epoch [6/50], Val Losses: mse: 0.3410, mae: 0.4228, huber: 0.1597, swd: 0.1312, ept: 100.0748
    Epoch [6/50], Test Losses: mse: 0.2126, mae: 0.3511, huber: 0.1050, swd: 0.0871, ept: 132.1710
      Epoch 6 composite train-obj: 0.100836
            No improvement (0.1597), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.2492, mae: 0.2981, huber: 0.0965, swd: 0.1000, ept: 150.3673
    Epoch [7/50], Val Losses: mse: 0.3786, mae: 0.4476, huber: 0.1756, swd: 0.1422, ept: 98.5233
    Epoch [7/50], Test Losses: mse: 0.2316, mae: 0.3656, huber: 0.1142, swd: 0.1040, ept: 127.1559
      Epoch 7 composite train-obj: 0.096506
            No improvement (0.1756), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.2398, mae: 0.2930, huber: 0.0931, swd: 0.0931, ept: 151.4532
    Epoch [8/50], Val Losses: mse: 0.3505, mae: 0.4288, huber: 0.1637, swd: 0.1281, ept: 102.5021
    Epoch [8/50], Test Losses: mse: 0.2271, mae: 0.3574, huber: 0.1117, swd: 0.0918, ept: 130.0194
      Epoch 8 composite train-obj: 0.093087
    Epoch [8/50], Test Losses: mse: 0.1856, mae: 0.3246, huber: 0.0917, swd: 0.0594, ept: 134.0862
    Best round's Test MSE: 0.1856, MAE: 0.3246, SWD: 0.0594
    Best round's Validation MSE: 0.3202, MAE: 0.4087, SWD: 0.1165
    Best round's Test verification MSE : 0.1856, MAE: 0.3246, SWD: 0.0594
    Time taken: 20.77 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq336_pred196_20250510_2118)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1828 ± 0.0020
      mae: 0.3189 ± 0.0041
      huber: 0.0901 ± 0.0011
      swd: 0.0678 ± 0.0075
      ept: 133.2608 ± 1.1960
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3262 ± 0.0049
      mae: 0.4084 ± 0.0022
      huber: 0.1535 ± 0.0018
      swd: 0.1325 ± 0.0113
      ept: 102.3379 ± 1.2160
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 63.95 seconds
    
    Experiment complete: ACL_etth2_seq336_pred196_20250510_2118
    Model: ACL
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=336,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 91
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 91
    Validation Batches: 9
    Test Batches: 22
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5209, mae: 0.4560, huber: 0.1968, swd: 0.2916, ept: 171.5404
    Epoch [1/50], Val Losses: mse: 0.3683, mae: 0.4437, huber: 0.1725, swd: 0.1627, ept: 135.0463
    Epoch [1/50], Test Losses: mse: 0.2028, mae: 0.3229, huber: 0.0987, swd: 0.0762, ept: 189.5807
      Epoch 1 composite train-obj: 0.196821
            Val objective improved inf → 0.1725, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4260, mae: 0.4044, huber: 0.1620, swd: 0.2126, ept: 190.3125
    Epoch [2/50], Val Losses: mse: 0.3614, mae: 0.4429, huber: 0.1700, swd: 0.1471, ept: 127.3070
    Epoch [2/50], Test Losses: mse: 0.2144, mae: 0.3415, huber: 0.1045, swd: 0.0825, ept: 190.0571
      Epoch 2 composite train-obj: 0.161960
            Val objective improved 0.1725 → 0.1700, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3825, mae: 0.3791, huber: 0.1456, swd: 0.1906, ept: 197.1088
    Epoch [3/50], Val Losses: mse: 0.3797, mae: 0.4503, huber: 0.1777, swd: 0.1338, ept: 138.5115
    Epoch [3/50], Test Losses: mse: 0.2115, mae: 0.3401, huber: 0.1036, swd: 0.0725, ept: 188.4346
      Epoch 3 composite train-obj: 0.145645
            No improvement (0.1777), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3494, mae: 0.3573, huber: 0.1323, swd: 0.1665, ept: 208.5046
    Epoch [4/50], Val Losses: mse: 0.3966, mae: 0.4556, huber: 0.1832, swd: 0.1265, ept: 143.9789
    Epoch [4/50], Test Losses: mse: 0.2192, mae: 0.3505, huber: 0.1077, swd: 0.0768, ept: 190.0454
      Epoch 4 composite train-obj: 0.132254
            No improvement (0.1832), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3305, mae: 0.3454, huber: 0.1250, swd: 0.1506, ept: 214.6868
    Epoch [5/50], Val Losses: mse: 0.3964, mae: 0.4549, huber: 0.1828, swd: 0.1307, ept: 141.7311
    Epoch [5/50], Test Losses: mse: 0.2288, mae: 0.3618, huber: 0.1125, swd: 0.0912, ept: 183.7191
      Epoch 5 composite train-obj: 0.124989
            No improvement (0.1828), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.3117, mae: 0.3344, huber: 0.1178, swd: 0.1372, ept: 218.6549
    Epoch [6/50], Val Losses: mse: 0.4084, mae: 0.4556, huber: 0.1856, swd: 0.1301, ept: 146.0671
    Epoch [6/50], Test Losses: mse: 0.2496, mae: 0.3809, huber: 0.1230, swd: 0.1051, ept: 174.9918
      Epoch 6 composite train-obj: 0.117823
            No improvement (0.1856), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.2999, mae: 0.3270, huber: 0.1132, swd: 0.1295, ept: 220.4174
    Epoch [7/50], Val Losses: mse: 0.4681, mae: 0.4868, huber: 0.2081, swd: 0.1598, ept: 140.1361
    Epoch [7/50], Test Losses: mse: 0.2829, mae: 0.4080, huber: 0.1388, swd: 0.1022, ept: 171.6188
      Epoch 7 composite train-obj: 0.113195
    Epoch [7/50], Test Losses: mse: 0.2144, mae: 0.3415, huber: 0.1045, swd: 0.0825, ept: 190.1178
    Best round's Test MSE: 0.2144, MAE: 0.3415, SWD: 0.0825
    Best round's Validation MSE: 0.3614, MAE: 0.4429, SWD: 0.1471
    Best round's Test verification MSE : 0.2144, MAE: 0.3415, SWD: 0.0825
    Time taken: 17.51 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5247, mae: 0.4576, huber: 0.1983, swd: 0.3040, ept: 172.0532
    Epoch [1/50], Val Losses: mse: 0.3815, mae: 0.4500, huber: 0.1781, swd: 0.1644, ept: 133.7186
    Epoch [1/50], Test Losses: mse: 0.2060, mae: 0.3250, huber: 0.1001, swd: 0.0774, ept: 189.2392
      Epoch 1 composite train-obj: 0.198282
            Val objective improved inf → 0.1781, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4271, mae: 0.4040, huber: 0.1619, swd: 0.2167, ept: 191.3190
    Epoch [2/50], Val Losses: mse: 0.3738, mae: 0.4484, huber: 0.1747, swd: 0.1393, ept: 129.6874
    Epoch [2/50], Test Losses: mse: 0.2124, mae: 0.3383, huber: 0.1036, swd: 0.0738, ept: 192.2358
      Epoch 2 composite train-obj: 0.161931
            Val objective improved 0.1781 → 0.1747, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3815, mae: 0.3781, huber: 0.1449, swd: 0.1931, ept: 196.6681
    Epoch [3/50], Val Losses: mse: 0.4276, mae: 0.4821, huber: 0.1980, swd: 0.1593, ept: 130.1632
    Epoch [3/50], Test Losses: mse: 0.2517, mae: 0.3700, huber: 0.1226, swd: 0.0893, ept: 178.8712
      Epoch 3 composite train-obj: 0.144887
            No improvement (0.1980), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3485, mae: 0.3556, huber: 0.1317, swd: 0.1686, ept: 208.9586
    Epoch [4/50], Val Losses: mse: 0.3952, mae: 0.4663, huber: 0.1830, swd: 0.1741, ept: 131.0449
    Epoch [4/50], Test Losses: mse: 0.2818, mae: 0.3930, huber: 0.1373, swd: 0.1621, ept: 161.1350
      Epoch 4 composite train-obj: 0.131735
            No improvement (0.1830), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3316, mae: 0.3464, huber: 0.1254, swd: 0.1551, ept: 214.3963
    Epoch [5/50], Val Losses: mse: 0.3779, mae: 0.4435, huber: 0.1749, swd: 0.1097, ept: 144.4659
    Epoch [5/50], Test Losses: mse: 0.2480, mae: 0.3760, huber: 0.1216, swd: 0.1088, ept: 177.7127
      Epoch 5 composite train-obj: 0.125378
            No improvement (0.1749), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.3123, mae: 0.3346, huber: 0.1179, swd: 0.1398, ept: 218.4882
    Epoch [6/50], Val Losses: mse: 0.3561, mae: 0.4302, huber: 0.1659, swd: 0.1113, ept: 146.5955
    Epoch [6/50], Test Losses: mse: 0.2815, mae: 0.3969, huber: 0.1380, swd: 0.1310, ept: 168.9570
      Epoch 6 composite train-obj: 0.117920
            Val objective improved 0.1747 → 0.1659, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.2974, mae: 0.3243, huber: 0.1118, swd: 0.1299, ept: 221.7924
    Epoch [7/50], Val Losses: mse: 0.3738, mae: 0.4375, huber: 0.1732, swd: 0.1058, ept: 148.2653
    Epoch [7/50], Test Losses: mse: 0.2724, mae: 0.3985, huber: 0.1337, swd: 0.1172, ept: 177.4386
      Epoch 7 composite train-obj: 0.111804
            No improvement (0.1732), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.2892, mae: 0.3179, huber: 0.1085, swd: 0.1246, ept: 224.5360
    Epoch [8/50], Val Losses: mse: 0.3612, mae: 0.4355, huber: 0.1686, swd: 0.1079, ept: 149.3538
    Epoch [8/50], Test Losses: mse: 0.2523, mae: 0.3802, huber: 0.1240, swd: 0.0954, ept: 183.3245
      Epoch 8 composite train-obj: 0.108462
            No improvement (0.1686), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.2814, mae: 0.3134, huber: 0.1054, swd: 0.1185, ept: 224.2948
    Epoch [9/50], Val Losses: mse: 0.3496, mae: 0.4261, huber: 0.1621, swd: 0.1107, ept: 151.8333
    Epoch [9/50], Test Losses: mse: 0.3342, mae: 0.4267, huber: 0.1611, swd: 0.1653, ept: 165.2094
      Epoch 9 composite train-obj: 0.105440
            Val objective improved 0.1659 → 0.1621, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 0.2736, mae: 0.3081, huber: 0.1025, swd: 0.1138, ept: 227.1194
    Epoch [10/50], Val Losses: mse: 0.4128, mae: 0.4548, huber: 0.1873, swd: 0.1236, ept: 147.0091
    Epoch [10/50], Test Losses: mse: 0.2963, mae: 0.4157, huber: 0.1448, swd: 0.1268, ept: 173.1187
      Epoch 10 composite train-obj: 0.102504
            No improvement (0.1873), counter 1/5
    Epoch [11/50], Train Losses: mse: 0.2635, mae: 0.3011, huber: 0.0987, swd: 0.1078, ept: 228.7523
    Epoch [11/50], Val Losses: mse: 0.3856, mae: 0.4446, huber: 0.1771, swd: 0.1131, ept: 150.1321
    Epoch [11/50], Test Losses: mse: 0.2750, mae: 0.4028, huber: 0.1347, swd: 0.1140, ept: 180.4085
      Epoch 11 composite train-obj: 0.098657
            No improvement (0.1771), counter 2/5
    Epoch [12/50], Train Losses: mse: 0.2579, mae: 0.2987, huber: 0.0969, swd: 0.1043, ept: 229.5131
    Epoch [12/50], Val Losses: mse: 0.4016, mae: 0.4536, huber: 0.1836, swd: 0.1161, ept: 148.5384
    Epoch [12/50], Test Losses: mse: 0.2790, mae: 0.4049, huber: 0.1363, swd: 0.1179, ept: 179.6243
      Epoch 12 composite train-obj: 0.096925
            No improvement (0.1836), counter 3/5
    Epoch [13/50], Train Losses: mse: 0.2532, mae: 0.2957, huber: 0.0953, swd: 0.1016, ept: 230.8831
    Epoch [13/50], Val Losses: mse: 0.3702, mae: 0.4384, huber: 0.1706, swd: 0.1118, ept: 150.0687
    Epoch [13/50], Test Losses: mse: 0.2609, mae: 0.3875, huber: 0.1278, swd: 0.1154, ept: 179.1841
      Epoch 13 composite train-obj: 0.095282
            No improvement (0.1706), counter 4/5
    Epoch [14/50], Train Losses: mse: 0.2454, mae: 0.2906, huber: 0.0924, swd: 0.0964, ept: 231.7903
    Epoch [14/50], Val Losses: mse: 0.3545, mae: 0.4298, huber: 0.1656, swd: 0.0993, ept: 152.1846
    Epoch [14/50], Test Losses: mse: 0.3059, mae: 0.4184, huber: 0.1493, swd: 0.1408, ept: 170.7560
      Epoch 14 composite train-obj: 0.092392
    Epoch [14/50], Test Losses: mse: 0.3342, mae: 0.4267, huber: 0.1611, swd: 0.1653, ept: 165.2096
    Best round's Test MSE: 0.3342, MAE: 0.4267, SWD: 0.1653
    Best round's Validation MSE: 0.3496, MAE: 0.4261, SWD: 0.1107
    Best round's Test verification MSE : 0.3342, MAE: 0.4267, SWD: 0.1653
    Time taken: 34.62 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5276, mae: 0.4602, huber: 0.1997, swd: 0.2982, ept: 170.6122
    Epoch [1/50], Val Losses: mse: 0.4099, mae: 0.4750, huber: 0.1913, swd: 0.1664, ept: 128.2667
    Epoch [1/50], Test Losses: mse: 0.2277, mae: 0.3491, huber: 0.1107, swd: 0.0802, ept: 185.1313
      Epoch 1 composite train-obj: 0.199733
            Val objective improved inf → 0.1913, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4291, mae: 0.4049, huber: 0.1626, swd: 0.2142, ept: 190.7045
    Epoch [2/50], Val Losses: mse: 0.4107, mae: 0.4816, huber: 0.1912, swd: 0.2180, ept: 120.6555
    Epoch [2/50], Test Losses: mse: 0.2422, mae: 0.3672, huber: 0.1179, swd: 0.1304, ept: 176.3281
      Epoch 2 composite train-obj: 0.162631
            Val objective improved 0.1913 → 0.1912, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3871, mae: 0.3819, huber: 0.1471, swd: 0.1946, ept: 196.5189
    Epoch [3/50], Val Losses: mse: 0.4590, mae: 0.5000, huber: 0.2114, swd: 0.1654, ept: 134.8207
    Epoch [3/50], Test Losses: mse: 0.2430, mae: 0.3563, huber: 0.1178, swd: 0.0795, ept: 182.4831
      Epoch 3 composite train-obj: 0.147128
            No improvement (0.2114), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3612, mae: 0.3639, huber: 0.1368, swd: 0.1741, ept: 204.7302
    Epoch [4/50], Val Losses: mse: 0.3591, mae: 0.4375, huber: 0.1692, swd: 0.1031, ept: 141.5182
    Epoch [4/50], Test Losses: mse: 0.2273, mae: 0.3611, huber: 0.1116, swd: 0.0785, ept: 188.0512
      Epoch 4 composite train-obj: 0.136805
            Val objective improved 0.1912 → 0.1692, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.3387, mae: 0.3505, huber: 0.1282, swd: 0.1605, ept: 211.7942
    Epoch [5/50], Val Losses: mse: 0.3672, mae: 0.4404, huber: 0.1710, swd: 0.1189, ept: 135.0714
    Epoch [5/50], Test Losses: mse: 0.2361, mae: 0.3669, huber: 0.1159, swd: 0.1066, ept: 177.7639
      Epoch 5 composite train-obj: 0.128176
            No improvement (0.1710), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.3166, mae: 0.3382, huber: 0.1202, swd: 0.1436, ept: 215.2591
    Epoch [6/50], Val Losses: mse: 0.3551, mae: 0.4281, huber: 0.1659, swd: 0.0946, ept: 145.1598
    Epoch [6/50], Test Losses: mse: 0.2689, mae: 0.3954, huber: 0.1319, swd: 0.1079, ept: 173.0437
      Epoch 6 composite train-obj: 0.120184
            Val objective improved 0.1692 → 0.1659, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.3044, mae: 0.3289, huber: 0.1147, swd: 0.1339, ept: 218.7109
    Epoch [7/50], Val Losses: mse: 0.3780, mae: 0.4448, huber: 0.1763, swd: 0.1083, ept: 148.2902
    Epoch [7/50], Test Losses: mse: 0.2684, mae: 0.3957, huber: 0.1315, swd: 0.1010, ept: 180.0548
      Epoch 7 composite train-obj: 0.114737
            No improvement (0.1763), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.2946, mae: 0.3229, huber: 0.1110, swd: 0.1290, ept: 221.0079
    Epoch [8/50], Val Losses: mse: 0.3506, mae: 0.4206, huber: 0.1625, swd: 0.0908, ept: 149.9140
    Epoch [8/50], Test Losses: mse: 0.2874, mae: 0.4067, huber: 0.1411, swd: 0.1283, ept: 162.7471
      Epoch 8 composite train-obj: 0.111047
            Val objective improved 0.1659 → 0.1625, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 0.2862, mae: 0.3175, huber: 0.1078, swd: 0.1239, ept: 222.3817
    Epoch [9/50], Val Losses: mse: 0.3719, mae: 0.4349, huber: 0.1718, swd: 0.0965, ept: 142.6497
    Epoch [9/50], Test Losses: mse: 0.2946, mae: 0.4065, huber: 0.1440, swd: 0.1207, ept: 162.2260
      Epoch 9 composite train-obj: 0.107825
            No improvement (0.1718), counter 1/5
    Epoch [10/50], Train Losses: mse: 0.2831, mae: 0.3163, huber: 0.1068, swd: 0.1199, ept: 222.9026
    Epoch [10/50], Val Losses: mse: 0.3831, mae: 0.4378, huber: 0.1755, swd: 0.1046, ept: 147.5996
    Epoch [10/50], Test Losses: mse: 0.2605, mae: 0.3854, huber: 0.1272, swd: 0.1102, ept: 177.7348
      Epoch 10 composite train-obj: 0.106822
            No improvement (0.1755), counter 2/5
    Epoch [11/50], Train Losses: mse: 0.2694, mae: 0.3071, huber: 0.1017, swd: 0.1128, ept: 225.9864
    Epoch [11/50], Val Losses: mse: 0.3752, mae: 0.4382, huber: 0.1728, swd: 0.1149, ept: 144.5790
    Epoch [11/50], Test Losses: mse: 0.2789, mae: 0.3991, huber: 0.1361, swd: 0.1286, ept: 168.5304
      Epoch 11 composite train-obj: 0.101673
            No improvement (0.1728), counter 3/5
    Epoch [12/50], Train Losses: mse: 0.2603, mae: 0.3010, huber: 0.0982, swd: 0.1071, ept: 227.7479
    Epoch [12/50], Val Losses: mse: 0.3626, mae: 0.4312, huber: 0.1687, swd: 0.0997, ept: 153.8642
    Epoch [12/50], Test Losses: mse: 0.2917, mae: 0.4068, huber: 0.1420, swd: 0.1167, ept: 170.6813
      Epoch 12 composite train-obj: 0.098245
            No improvement (0.1687), counter 4/5
    Epoch [13/50], Train Losses: mse: 0.2565, mae: 0.2995, huber: 0.0970, swd: 0.1046, ept: 228.4190
    Epoch [13/50], Val Losses: mse: 0.3721, mae: 0.4337, huber: 0.1712, swd: 0.1018, ept: 153.2833
    Epoch [13/50], Test Losses: mse: 0.2955, mae: 0.4051, huber: 0.1430, swd: 0.1258, ept: 169.8901
      Epoch 13 composite train-obj: 0.097013
    Epoch [13/50], Test Losses: mse: 0.2874, mae: 0.4067, huber: 0.1411, swd: 0.1283, ept: 162.7492
    Best round's Test MSE: 0.2874, MAE: 0.4067, SWD: 0.1283
    Best round's Validation MSE: 0.3506, MAE: 0.4206, SWD: 0.0908
    Best round's Test verification MSE : 0.2874, MAE: 0.4067, SWD: 0.1283
    Time taken: 31.46 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq336_pred336_20250510_2119)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2787 ± 0.0493
      mae: 0.3916 ± 0.0364
      huber: 0.1356 ± 0.0234
      swd: 0.1254 ± 0.0339
      ept: 172.6712 ± 12.3347
      count: 9.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3539 ± 0.0053
      mae: 0.4299 ± 0.0095
      huber: 0.1649 ± 0.0036
      swd: 0.1162 ± 0.0233
      ept: 143.0181 ± 11.1370
      count: 9.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 83.68 seconds
    
    Experiment complete: ACL_etth2_seq336_pred336_20250510_2119
    Model: ACL
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=336,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6301, mae: 0.5165, huber: 0.2371, swd: 0.3662, ept: 262.4241
    Epoch [1/50], Val Losses: mse: 0.3788, mae: 0.4670, huber: 0.1792, swd: 0.1327, ept: 212.7813
    Epoch [1/50], Test Losses: mse: 0.2570, mae: 0.3697, huber: 0.1234, swd: 0.1162, ept: 290.7791
      Epoch 1 composite train-obj: 0.237147
            Val objective improved inf → 0.1792, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5397, mae: 0.4632, huber: 0.2015, swd: 0.2895, ept: 289.7274
    Epoch [2/50], Val Losses: mse: 0.4914, mae: 0.5322, huber: 0.2269, swd: 0.1624, ept: 205.4712
    Epoch [2/50], Test Losses: mse: 0.2946, mae: 0.4045, huber: 0.1412, swd: 0.0923, ept: 263.6097
      Epoch 2 composite train-obj: 0.201453
            No improvement (0.2269), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4913, mae: 0.4327, huber: 0.1813, swd: 0.2573, ept: 304.6309
    Epoch [3/50], Val Losses: mse: 0.4003, mae: 0.4915, huber: 0.1894, swd: 0.1414, ept: 223.6298
    Epoch [3/50], Test Losses: mse: 0.3638, mae: 0.4494, huber: 0.1747, swd: 0.1752, ept: 238.5517
      Epoch 3 composite train-obj: 0.181259
            No improvement (0.1894), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.4583, mae: 0.4112, huber: 0.1678, swd: 0.2292, ept: 321.2747
    Epoch [4/50], Val Losses: mse: 0.3612, mae: 0.4430, huber: 0.1718, swd: 0.0881, ept: 249.7182
    Epoch [4/50], Test Losses: mse: 0.3041, mae: 0.4154, huber: 0.1480, swd: 0.1245, ept: 251.7040
      Epoch 4 composite train-obj: 0.167828
            Val objective improved 0.1792 → 0.1718, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.4373, mae: 0.3970, huber: 0.1587, swd: 0.2129, ept: 328.7393
    Epoch [5/50], Val Losses: mse: 0.4954, mae: 0.5554, huber: 0.2320, swd: 0.2651, ept: 193.3996
    Epoch [5/50], Test Losses: mse: 0.5344, mae: 0.5398, huber: 0.2459, swd: 0.3156, ept: 196.2718
      Epoch 5 composite train-obj: 0.158721
            No improvement (0.2320), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.4112, mae: 0.3869, huber: 0.1506, swd: 0.1953, ept: 331.3223
    Epoch [6/50], Val Losses: mse: 0.4022, mae: 0.4669, huber: 0.1876, swd: 0.1302, ept: 247.5709
    Epoch [6/50], Test Losses: mse: 0.3342, mae: 0.4376, huber: 0.1610, swd: 0.1396, ept: 237.9314
      Epoch 6 composite train-obj: 0.150570
            No improvement (0.1876), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.3891, mae: 0.3739, huber: 0.1423, swd: 0.1793, ept: 336.0345
    Epoch [7/50], Val Losses: mse: 0.4055, mae: 0.4598, huber: 0.1887, swd: 0.1184, ept: 263.6827
    Epoch [7/50], Test Losses: mse: 0.2973, mae: 0.4103, huber: 0.1432, swd: 0.1070, ept: 246.3203
      Epoch 7 composite train-obj: 0.142298
            No improvement (0.1887), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.3727, mae: 0.3643, huber: 0.1361, swd: 0.1679, ept: 341.7990
    Epoch [8/50], Val Losses: mse: 0.3954, mae: 0.4698, huber: 0.1864, swd: 0.1041, ept: 259.2918
    Epoch [8/50], Test Losses: mse: 0.3814, mae: 0.4687, huber: 0.1828, swd: 0.1545, ept: 233.5062
      Epoch 8 composite train-obj: 0.136123
            No improvement (0.1864), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.3637, mae: 0.3585, huber: 0.1326, swd: 0.1605, ept: 342.5659
    Epoch [9/50], Val Losses: mse: 0.3836, mae: 0.4673, huber: 0.1815, swd: 0.1214, ept: 246.1737
    Epoch [9/50], Test Losses: mse: 0.3939, mae: 0.4693, huber: 0.1878, swd: 0.1816, ept: 231.2459
      Epoch 9 composite train-obj: 0.132575
    Epoch [9/50], Test Losses: mse: 0.3041, mae: 0.4154, huber: 0.1480, swd: 0.1245, ept: 251.6534
    Best round's Test MSE: 0.3041, MAE: 0.4154, SWD: 0.1245
    Best round's Validation MSE: 0.3612, MAE: 0.4430, SWD: 0.0881
    Best round's Test verification MSE : 0.3041, MAE: 0.4154, SWD: 0.1245
    Time taken: 21.53 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6437, mae: 0.5196, huber: 0.2402, swd: 0.3664, ept: 262.4395
    Epoch [1/50], Val Losses: mse: 0.4501, mae: 0.5021, huber: 0.2095, swd: 0.1354, ept: 207.5181
    Epoch [1/50], Test Losses: mse: 0.2556, mae: 0.3625, huber: 0.1225, swd: 0.0859, ept: 307.9113
      Epoch 1 composite train-obj: 0.240226
            Val objective improved inf → 0.2095, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5474, mae: 0.4659, huber: 0.2037, swd: 0.2914, ept: 287.7271
    Epoch [2/50], Val Losses: mse: 0.4156, mae: 0.4865, huber: 0.1956, swd: 0.1227, ept: 215.1414
    Epoch [2/50], Test Losses: mse: 0.2947, mae: 0.4044, huber: 0.1423, swd: 0.1161, ept: 263.3659
      Epoch 2 composite train-obj: 0.203675
            Val objective improved 0.2095 → 0.1956, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4892, mae: 0.4318, huber: 0.1807, swd: 0.2530, ept: 304.9036
    Epoch [3/50], Val Losses: mse: 0.4045, mae: 0.4780, huber: 0.1911, swd: 0.0978, ept: 224.1373
    Epoch [3/50], Test Losses: mse: 0.2856, mae: 0.3946, huber: 0.1385, swd: 0.0959, ept: 262.6501
      Epoch 3 composite train-obj: 0.180701
            Val objective improved 0.1956 → 0.1911, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.4590, mae: 0.4105, huber: 0.1678, swd: 0.2266, ept: 320.9965
    Epoch [4/50], Val Losses: mse: 0.4197, mae: 0.4951, huber: 0.1980, swd: 0.1489, ept: 211.2271
    Epoch [4/50], Test Losses: mse: 0.3447, mae: 0.4439, huber: 0.1648, swd: 0.1767, ept: 224.3678
      Epoch 4 composite train-obj: 0.167787
            No improvement (0.1980), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.4429, mae: 0.4024, huber: 0.1619, swd: 0.2157, ept: 324.4325
    Epoch [5/50], Val Losses: mse: 0.5218, mae: 0.5352, huber: 0.2369, swd: 0.1395, ept: 219.9960
    Epoch [5/50], Test Losses: mse: 0.3155, mae: 0.4242, huber: 0.1531, swd: 0.0845, ept: 236.1477
      Epoch 5 composite train-obj: 0.161852
            No improvement (0.2369), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.4328, mae: 0.3985, huber: 0.1585, swd: 0.2064, ept: 324.0615
    Epoch [6/50], Val Losses: mse: 0.3549, mae: 0.4493, huber: 0.1692, swd: 0.0886, ept: 241.8566
    Epoch [6/50], Test Losses: mse: 0.3358, mae: 0.4350, huber: 0.1629, swd: 0.1424, ept: 245.4631
      Epoch 6 composite train-obj: 0.158544
            Val objective improved 0.1911 → 0.1692, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.3984, mae: 0.3775, huber: 0.1449, swd: 0.1840, ept: 333.2731
    Epoch [7/50], Val Losses: mse: 0.4595, mae: 0.4956, huber: 0.2116, swd: 0.1088, ept: 269.1162
    Epoch [7/50], Test Losses: mse: 0.3524, mae: 0.4572, huber: 0.1699, swd: 0.1179, ept: 243.6719
      Epoch 7 composite train-obj: 0.144939
            No improvement (0.2116), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.3957, mae: 0.3730, huber: 0.1427, swd: 0.1851, ept: 336.9136
    Epoch [8/50], Val Losses: mse: 0.3764, mae: 0.4539, huber: 0.1779, swd: 0.0935, ept: 243.6020
    Epoch [8/50], Test Losses: mse: 0.3327, mae: 0.4420, huber: 0.1603, swd: 0.1446, ept: 230.5114
      Epoch 8 composite train-obj: 0.142731
            No improvement (0.1779), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.3690, mae: 0.3625, huber: 0.1347, swd: 0.1655, ept: 341.2987
    Epoch [9/50], Val Losses: mse: 0.4534, mae: 0.4831, huber: 0.2056, swd: 0.1148, ept: 274.2260
    Epoch [9/50], Test Losses: mse: 0.2997, mae: 0.4162, huber: 0.1451, swd: 0.1014, ept: 244.6263
      Epoch 9 composite train-obj: 0.134711
            No improvement (0.2056), counter 3/5
    Epoch [10/50], Train Losses: mse: 0.3556, mae: 0.3537, huber: 0.1295, swd: 0.1566, ept: 346.1820
    Epoch [10/50], Val Losses: mse: 0.4297, mae: 0.4923, huber: 0.1993, swd: 0.1346, ept: 236.2818
    Epoch [10/50], Test Losses: mse: 0.3353, mae: 0.4408, huber: 0.1627, swd: 0.1514, ept: 236.1951
      Epoch 10 composite train-obj: 0.129481
            No improvement (0.1993), counter 4/5
    Epoch [11/50], Train Losses: mse: 0.3484, mae: 0.3496, huber: 0.1268, swd: 0.1520, ept: 348.5098
    Epoch [11/50], Val Losses: mse: 0.4162, mae: 0.4681, huber: 0.1919, swd: 0.1043, ept: 255.0420
    Epoch [11/50], Test Losses: mse: 0.3018, mae: 0.4202, huber: 0.1465, swd: 0.1204, ept: 243.9362
      Epoch 11 composite train-obj: 0.126770
    Epoch [11/50], Test Losses: mse: 0.3358, mae: 0.4350, huber: 0.1629, swd: 0.1424, ept: 245.5069
    Best round's Test MSE: 0.3358, MAE: 0.4350, SWD: 0.1424
    Best round's Validation MSE: 0.3549, MAE: 0.4493, SWD: 0.0886
    Best round's Test verification MSE : 0.3358, MAE: 0.4350, SWD: 0.1424
    Time taken: 25.91 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6293, mae: 0.5141, huber: 0.2361, swd: 0.3776, ept: 264.4517
    Epoch [1/50], Val Losses: mse: 0.4048, mae: 0.4737, huber: 0.1904, swd: 0.1145, ept: 213.4154
    Epoch [1/50], Test Losses: mse: 0.2457, mae: 0.3533, huber: 0.1176, swd: 0.0908, ept: 313.5283
      Epoch 1 composite train-obj: 0.236070
            Val objective improved inf → 0.1904, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5437, mae: 0.4633, huber: 0.2018, swd: 0.3069, ept: 288.7514
    Epoch [2/50], Val Losses: mse: 0.3753, mae: 0.4605, huber: 0.1785, swd: 0.1114, ept: 214.8083
    Epoch [2/50], Test Losses: mse: 0.2846, mae: 0.3978, huber: 0.1372, swd: 0.1418, ept: 254.2971
      Epoch 2 composite train-obj: 0.201815
            Val objective improved 0.1904 → 0.1785, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4889, mae: 0.4308, huber: 0.1801, swd: 0.2678, ept: 306.2245
    Epoch [3/50], Val Losses: mse: 0.5491, mae: 0.5662, huber: 0.2512, swd: 0.1817, ept: 215.7683
    Epoch [3/50], Test Losses: mse: 0.3085, mae: 0.4131, huber: 0.1479, swd: 0.1014, ept: 292.5636
      Epoch 3 composite train-obj: 0.180099
            No improvement (0.2512), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4748, mae: 0.4157, huber: 0.1718, swd: 0.2531, ept: 319.5428
    Epoch [4/50], Val Losses: mse: 0.3818, mae: 0.4575, huber: 0.1811, swd: 0.0884, ept: 246.1277
    Epoch [4/50], Test Losses: mse: 0.2751, mae: 0.3904, huber: 0.1334, swd: 0.1168, ept: 262.7446
      Epoch 4 composite train-obj: 0.171783
            No improvement (0.1811), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.4357, mae: 0.3975, huber: 0.1589, swd: 0.2220, ept: 327.7603
    Epoch [5/50], Val Losses: mse: 0.3860, mae: 0.4609, huber: 0.1827, swd: 0.1030, ept: 245.2435
    Epoch [5/50], Test Losses: mse: 0.2968, mae: 0.4101, huber: 0.1444, swd: 0.1243, ept: 246.7903
      Epoch 5 composite train-obj: 0.158857
            No improvement (0.1827), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.4091, mae: 0.3832, huber: 0.1490, swd: 0.2008, ept: 334.3431
    Epoch [6/50], Val Losses: mse: 0.3984, mae: 0.4707, huber: 0.1879, swd: 0.0985, ept: 248.7291
    Epoch [6/50], Test Losses: mse: 0.3177, mae: 0.4286, huber: 0.1540, swd: 0.1283, ept: 236.4875
      Epoch 6 composite train-obj: 0.149014
            No improvement (0.1879), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.3877, mae: 0.3726, huber: 0.1415, swd: 0.1860, ept: 338.0289
    Epoch [7/50], Val Losses: mse: 0.3917, mae: 0.4627, huber: 0.1845, swd: 0.1025, ept: 249.2815
    Epoch [7/50], Test Losses: mse: 0.3054, mae: 0.4200, huber: 0.1483, swd: 0.1338, ept: 238.1408
      Epoch 7 composite train-obj: 0.141473
    Epoch [7/50], Test Losses: mse: 0.2846, mae: 0.3978, huber: 0.1372, swd: 0.1418, ept: 254.0992
    Best round's Test MSE: 0.2846, MAE: 0.3978, SWD: 0.1418
    Best round's Validation MSE: 0.3753, MAE: 0.4605, SWD: 0.1114
    Best round's Test verification MSE : 0.2846, MAE: 0.3978, SWD: 0.1418
    Time taken: 16.54 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq336_pred720_20250510_2121)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.3082 ± 0.0211
      mae: 0.4161 ± 0.0152
      huber: 0.1494 ± 0.0105
      swd: 0.1362 ± 0.0083
      ept: 250.4881 ± 3.7075
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3638 ± 0.0085
      mae: 0.4509 ± 0.0072
      huber: 0.1732 ± 0.0039
      swd: 0.0960 ± 0.0108
      ept: 235.4610 ± 14.9522
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 64.08 seconds
    
    Experiment complete: ACL_etth2_seq336_pred720_20250510_2121
    Model: ACL
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### Timemixer

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=336,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3284, mae: 0.3356, huber: 0.1246, swd: 0.1222, ept: 74.5927
    Epoch [1/50], Val Losses: mse: 0.2639, mae: 0.3528, huber: 0.1256, swd: 0.1053, ept: 68.7085
    Epoch [1/50], Test Losses: mse: 0.1389, mae: 0.2636, huber: 0.0686, swd: 0.0451, ept: 80.1580
      Epoch 1 composite train-obj: 0.124602
            Val objective improved inf → 0.1256, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2682, mae: 0.2997, huber: 0.1028, swd: 0.1067, ept: 80.6768
    Epoch [2/50], Val Losses: mse: 0.2764, mae: 0.3647, huber: 0.1314, swd: 0.1096, ept: 68.2825
    Epoch [2/50], Test Losses: mse: 0.1425, mae: 0.2687, huber: 0.0704, swd: 0.0455, ept: 80.5805
      Epoch 2 composite train-obj: 0.102777
            No improvement (0.1314), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2488, mae: 0.2920, huber: 0.0969, swd: 0.1022, ept: 81.4574
    Epoch [3/50], Val Losses: mse: 0.2671, mae: 0.3598, huber: 0.1266, swd: 0.1141, ept: 68.4339
    Epoch [3/50], Test Losses: mse: 0.1386, mae: 0.2611, huber: 0.0684, swd: 0.0500, ept: 79.9542
      Epoch 3 composite train-obj: 0.096922
            No improvement (0.1266), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2330, mae: 0.2846, huber: 0.0919, swd: 0.0974, ept: 82.0144
    Epoch [4/50], Val Losses: mse: 0.2790, mae: 0.3672, huber: 0.1317, swd: 0.1165, ept: 67.6602
    Epoch [4/50], Test Losses: mse: 0.1411, mae: 0.2636, huber: 0.0695, swd: 0.0492, ept: 79.8749
      Epoch 4 composite train-obj: 0.091929
            No improvement (0.1317), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2161, mae: 0.2769, huber: 0.0866, swd: 0.0907, ept: 82.6010
    Epoch [5/50], Val Losses: mse: 0.2705, mae: 0.3622, huber: 0.1281, swd: 0.1109, ept: 68.4688
    Epoch [5/50], Test Losses: mse: 0.1488, mae: 0.2725, huber: 0.0733, swd: 0.0511, ept: 79.8048
      Epoch 5 composite train-obj: 0.086617
            No improvement (0.1281), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1973, mae: 0.2683, huber: 0.0809, swd: 0.0815, ept: 83.3124
    Epoch [6/50], Val Losses: mse: 0.2749, mae: 0.3658, huber: 0.1296, swd: 0.1116, ept: 68.7847
    Epoch [6/50], Test Losses: mse: 0.1519, mae: 0.2743, huber: 0.0747, swd: 0.0529, ept: 79.4535
      Epoch 6 composite train-obj: 0.080855
    Epoch [6/50], Test Losses: mse: 0.1389, mae: 0.2636, huber: 0.0686, swd: 0.0451, ept: 80.1580
    Best round's Test MSE: 0.1389, MAE: 0.2636, SWD: 0.0451
    Best round's Validation MSE: 0.2639, MAE: 0.3528, SWD: 0.1053
    Best round's Test verification MSE : 0.1389, MAE: 0.2636, SWD: 0.0451
    Time taken: 31.24 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3196, mae: 0.3335, huber: 0.1222, swd: 0.1233, ept: 74.5104
    Epoch [1/50], Val Losses: mse: 0.2712, mae: 0.3608, huber: 0.1290, swd: 0.1096, ept: 67.5246
    Epoch [1/50], Test Losses: mse: 0.1395, mae: 0.2654, huber: 0.0690, swd: 0.0448, ept: 80.1454
      Epoch 1 composite train-obj: 0.122227
            Val objective improved inf → 0.1290, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2578, mae: 0.2975, huber: 0.0998, swd: 0.1043, ept: 80.5564
    Epoch [2/50], Val Losses: mse: 0.2675, mae: 0.3591, huber: 0.1265, swd: 0.1073, ept: 69.0924
    Epoch [2/50], Test Losses: mse: 0.1401, mae: 0.2658, huber: 0.0692, swd: 0.0457, ept: 80.6279
      Epoch 2 composite train-obj: 0.099785
            Val objective improved 0.1290 → 0.1265, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2303, mae: 0.2835, huber: 0.0908, swd: 0.0949, ept: 82.1583
    Epoch [3/50], Val Losses: mse: 0.2709, mae: 0.3619, huber: 0.1279, swd: 0.1068, ept: 67.7334
    Epoch [3/50], Test Losses: mse: 0.1431, mae: 0.2673, huber: 0.0706, swd: 0.0469, ept: 80.1045
      Epoch 3 composite train-obj: 0.090836
            No improvement (0.1279), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2065, mae: 0.2728, huber: 0.0837, swd: 0.0851, ept: 82.9151
    Epoch [4/50], Val Losses: mse: 0.2714, mae: 0.3624, huber: 0.1280, swd: 0.1061, ept: 67.4911
    Epoch [4/50], Test Losses: mse: 0.1472, mae: 0.2706, huber: 0.0726, swd: 0.0495, ept: 79.7113
      Epoch 4 composite train-obj: 0.083681
            No improvement (0.1280), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.1830, mae: 0.2600, huber: 0.0756, swd: 0.0735, ept: 84.0004
    Epoch [5/50], Val Losses: mse: 0.2677, mae: 0.3583, huber: 0.1260, swd: 0.1048, ept: 68.0882
    Epoch [5/50], Test Losses: mse: 0.1514, mae: 0.2736, huber: 0.0744, swd: 0.0525, ept: 79.0456
      Epoch 5 composite train-obj: 0.075641
            Val objective improved 0.1265 → 0.1260, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.1654, mae: 0.2487, huber: 0.0689, swd: 0.0644, ept: 85.0759
    Epoch [6/50], Val Losses: mse: 0.2859, mae: 0.3745, huber: 0.1342, swd: 0.1093, ept: 66.9272
    Epoch [6/50], Test Losses: mse: 0.1659, mae: 0.2874, huber: 0.0814, swd: 0.0578, ept: 78.5718
      Epoch 6 composite train-obj: 0.068909
            No improvement (0.1342), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.1533, mae: 0.2398, huber: 0.0639, swd: 0.0579, ept: 86.0151
    Epoch [7/50], Val Losses: mse: 0.2982, mae: 0.3805, huber: 0.1384, swd: 0.1142, ept: 66.7806
    Epoch [7/50], Test Losses: mse: 0.1697, mae: 0.2908, huber: 0.0832, swd: 0.0607, ept: 77.7588
      Epoch 7 composite train-obj: 0.063907
            No improvement (0.1384), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.1425, mae: 0.2319, huber: 0.0595, swd: 0.0518, ept: 86.6924
    Epoch [8/50], Val Losses: mse: 0.2921, mae: 0.3792, huber: 0.1365, swd: 0.1127, ept: 67.1722
    Epoch [8/50], Test Losses: mse: 0.1704, mae: 0.2919, huber: 0.0836, swd: 0.0598, ept: 77.7833
      Epoch 8 composite train-obj: 0.059467
            No improvement (0.1365), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.1331, mae: 0.2241, huber: 0.0554, swd: 0.0463, ept: 87.4461
    Epoch [9/50], Val Losses: mse: 0.2878, mae: 0.3760, huber: 0.1346, swd: 0.1125, ept: 67.0124
    Epoch [9/50], Test Losses: mse: 0.1772, mae: 0.2967, huber: 0.0867, swd: 0.0624, ept: 77.2861
      Epoch 9 composite train-obj: 0.055414
            No improvement (0.1346), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.1257, mae: 0.2177, huber: 0.0521, swd: 0.0425, ept: 88.0239
    Epoch [10/50], Val Losses: mse: 0.3057, mae: 0.3826, huber: 0.1408, swd: 0.1189, ept: 66.2855
    Epoch [10/50], Test Losses: mse: 0.1820, mae: 0.3006, huber: 0.0889, swd: 0.0643, ept: 76.7048
      Epoch 10 composite train-obj: 0.052119
    Epoch [10/50], Test Losses: mse: 0.1514, mae: 0.2736, huber: 0.0744, swd: 0.0525, ept: 79.0456
    Best round's Test MSE: 0.1514, MAE: 0.2736, SWD: 0.0525
    Best round's Validation MSE: 0.2677, MAE: 0.3583, SWD: 0.1048
    Best round's Test verification MSE : 0.1514, MAE: 0.2736, SWD: 0.0525
    Time taken: 51.72 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3578, mae: 0.3505, huber: 0.1341, swd: 0.1130, ept: 70.9437
    Epoch [1/50], Val Losses: mse: 0.2616, mae: 0.3506, huber: 0.1242, swd: 0.0929, ept: 68.4062
    Epoch [1/50], Test Losses: mse: 0.1371, mae: 0.2614, huber: 0.0677, swd: 0.0402, ept: 79.7983
      Epoch 1 composite train-obj: 0.134133
            Val objective improved inf → 0.1242, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2780, mae: 0.3057, huber: 0.1064, swd: 0.0997, ept: 79.7833
    Epoch [2/50], Val Losses: mse: 0.2565, mae: 0.3511, huber: 0.1222, swd: 0.0930, ept: 69.5164
    Epoch [2/50], Test Losses: mse: 0.1366, mae: 0.2615, huber: 0.0675, swd: 0.0407, ept: 80.6126
      Epoch 2 composite train-obj: 0.106425
            Val objective improved 0.1242 → 0.1222, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2539, mae: 0.2938, huber: 0.0982, swd: 0.0952, ept: 81.1373
    Epoch [3/50], Val Losses: mse: 0.2740, mae: 0.3641, huber: 0.1296, swd: 0.0987, ept: 68.3944
    Epoch [3/50], Test Losses: mse: 0.1449, mae: 0.2700, huber: 0.0715, swd: 0.0428, ept: 80.1514
      Epoch 3 composite train-obj: 0.098244
            No improvement (0.1296), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2310, mae: 0.2841, huber: 0.0913, swd: 0.0888, ept: 81.9684
    Epoch [4/50], Val Losses: mse: 0.2689, mae: 0.3610, huber: 0.1272, swd: 0.0994, ept: 68.8493
    Epoch [4/50], Test Losses: mse: 0.1426, mae: 0.2670, huber: 0.0704, swd: 0.0432, ept: 80.1565
      Epoch 4 composite train-obj: 0.091283
            No improvement (0.1272), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.2107, mae: 0.2748, huber: 0.0851, swd: 0.0806, ept: 82.6688
    Epoch [5/50], Val Losses: mse: 0.2665, mae: 0.3592, huber: 0.1259, swd: 0.0951, ept: 68.7387
    Epoch [5/50], Test Losses: mse: 0.1466, mae: 0.2702, huber: 0.0722, swd: 0.0445, ept: 80.0721
      Epoch 5 composite train-obj: 0.085133
            No improvement (0.1259), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.1907, mae: 0.2656, huber: 0.0788, swd: 0.0712, ept: 83.4790
    Epoch [6/50], Val Losses: mse: 0.2701, mae: 0.3632, huber: 0.1278, swd: 0.0982, ept: 68.8177
    Epoch [6/50], Test Losses: mse: 0.1562, mae: 0.2809, huber: 0.0770, swd: 0.0490, ept: 79.2853
      Epoch 6 composite train-obj: 0.078762
            No improvement (0.1278), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.1757, mae: 0.2565, huber: 0.0732, swd: 0.0634, ept: 84.2098
    Epoch [7/50], Val Losses: mse: 0.2879, mae: 0.3726, huber: 0.1347, swd: 0.1068, ept: 67.3523
    Epoch [7/50], Test Losses: mse: 0.1663, mae: 0.2881, huber: 0.0817, swd: 0.0546, ept: 78.4052
      Epoch 7 composite train-obj: 0.073177
    Epoch [7/50], Test Losses: mse: 0.1366, mae: 0.2615, huber: 0.0675, swd: 0.0407, ept: 80.6126
    Best round's Test MSE: 0.1366, MAE: 0.2615, SWD: 0.0407
    Best round's Validation MSE: 0.2565, MAE: 0.3511, SWD: 0.0930
    Best round's Test verification MSE : 0.1366, MAE: 0.2615, SWD: 0.0407
    Time taken: 36.18 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq336_pred96_20250510_2122)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1423 ± 0.0065
      mae: 0.2662 ± 0.0053
      huber: 0.0702 ± 0.0030
      swd: 0.0461 ± 0.0049
      ept: 79.9387 ± 0.6583
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2627 ± 0.0047
      mae: 0.3541 ± 0.0031
      huber: 0.1246 ± 0.0017
      swd: 0.1010 ± 0.0057
      ept: 68.7710 ± 0.5847
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 119.21 seconds
    
    Experiment complete: TimeMixer_etth2_seq336_pred96_20250510_2122
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=336,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4010, mae: 0.3741, huber: 0.1491, swd: 0.1598, ept: 128.8882
    Epoch [1/50], Val Losses: mse: 0.3226, mae: 0.4016, huber: 0.1525, swd: 0.1154, ept: 110.5142
    Epoch [1/50], Test Losses: mse: 0.1731, mae: 0.2959, huber: 0.0851, swd: 0.0570, ept: 137.6154
      Epoch 1 composite train-obj: 0.149118
            Val objective improved inf → 0.1525, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3422, mae: 0.3424, huber: 0.1280, swd: 0.1415, ept: 141.3206
    Epoch [2/50], Val Losses: mse: 0.3158, mae: 0.3996, huber: 0.1487, swd: 0.1233, ept: 108.2253
    Epoch [2/50], Test Losses: mse: 0.1645, mae: 0.2874, huber: 0.0811, swd: 0.0552, ept: 138.1833
      Epoch 2 composite train-obj: 0.127952
            Val objective improved 0.1525 → 0.1487, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3081, mae: 0.3265, huber: 0.1166, swd: 0.1335, ept: 145.2570
    Epoch [3/50], Val Losses: mse: 0.3394, mae: 0.4243, huber: 0.1606, swd: 0.1231, ept: 111.0406
    Epoch [3/50], Test Losses: mse: 0.1928, mae: 0.3164, huber: 0.0948, swd: 0.0633, ept: 137.8243
      Epoch 3 composite train-obj: 0.116550
            No improvement (0.1606), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2873, mae: 0.3165, huber: 0.1097, swd: 0.1267, ept: 147.6161
    Epoch [4/50], Val Losses: mse: 0.3371, mae: 0.4125, huber: 0.1570, swd: 0.1353, ept: 108.5028
    Epoch [4/50], Test Losses: mse: 0.1754, mae: 0.2968, huber: 0.0861, swd: 0.0605, ept: 136.1035
      Epoch 4 composite train-obj: 0.109730
            No improvement (0.1570), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.2662, mae: 0.3048, huber: 0.1025, swd: 0.1171, ept: 149.9994
    Epoch [5/50], Val Losses: mse: 0.3439, mae: 0.4159, huber: 0.1594, swd: 0.1362, ept: 107.6712
    Epoch [5/50], Test Losses: mse: 0.1858, mae: 0.3066, huber: 0.0910, swd: 0.0645, ept: 135.6767
      Epoch 5 composite train-obj: 0.102521
            No improvement (0.1594), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.2513, mae: 0.2974, huber: 0.0977, swd: 0.1097, ept: 151.4760
    Epoch [6/50], Val Losses: mse: 0.3500, mae: 0.4189, huber: 0.1618, swd: 0.1388, ept: 108.0615
    Epoch [6/50], Test Losses: mse: 0.1924, mae: 0.3126, huber: 0.0942, swd: 0.0669, ept: 133.0711
      Epoch 6 composite train-obj: 0.097726
            No improvement (0.1618), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.2395, mae: 0.2896, huber: 0.0931, swd: 0.1024, ept: 153.1189
    Epoch [7/50], Val Losses: mse: 0.3516, mae: 0.4218, huber: 0.1629, swd: 0.1380, ept: 107.5962
    Epoch [7/50], Test Losses: mse: 0.1993, mae: 0.3170, huber: 0.0974, swd: 0.0679, ept: 132.6749
      Epoch 7 composite train-obj: 0.093133
    Epoch [7/50], Test Losses: mse: 0.1645, mae: 0.2874, huber: 0.0811, swd: 0.0552, ept: 138.1833
    Best round's Test MSE: 0.1645, MAE: 0.2874, SWD: 0.0552
    Best round's Validation MSE: 0.3158, MAE: 0.3996, SWD: 0.1233
    Best round's Test verification MSE : 0.1645, MAE: 0.2874, SWD: 0.0552
    Time taken: 37.56 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3983, mae: 0.3718, huber: 0.1479, swd: 0.1623, ept: 130.2671
    Epoch [1/50], Val Losses: mse: 0.3343, mae: 0.4085, huber: 0.1572, swd: 0.1282, ept: 110.2877
    Epoch [1/50], Test Losses: mse: 0.1731, mae: 0.2967, huber: 0.0852, swd: 0.0572, ept: 138.6440
      Epoch 1 composite train-obj: 0.147945
            Val objective improved inf → 0.1572, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3386, mae: 0.3396, huber: 0.1264, swd: 0.1460, ept: 142.5191
    Epoch [2/50], Val Losses: mse: 0.3261, mae: 0.4040, huber: 0.1526, swd: 0.1325, ept: 110.0670
    Epoch [2/50], Test Losses: mse: 0.1682, mae: 0.2923, huber: 0.0829, swd: 0.0566, ept: 140.4579
      Epoch 2 composite train-obj: 0.126363
            Val objective improved 0.1572 → 0.1526, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3106, mae: 0.3266, huber: 0.1171, swd: 0.1373, ept: 145.6283
    Epoch [3/50], Val Losses: mse: 0.3233, mae: 0.4048, huber: 0.1520, swd: 0.1295, ept: 108.8414
    Epoch [3/50], Test Losses: mse: 0.1719, mae: 0.2957, huber: 0.0846, swd: 0.0573, ept: 141.0682
      Epoch 3 composite train-obj: 0.117149
            Val objective improved 0.1526 → 0.1520, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2907, mae: 0.3166, huber: 0.1106, swd: 0.1313, ept: 147.9684
    Epoch [4/50], Val Losses: mse: 0.3149, mae: 0.4018, huber: 0.1487, swd: 0.1262, ept: 111.6751
    Epoch [4/50], Test Losses: mse: 0.1747, mae: 0.2997, huber: 0.0861, swd: 0.0595, ept: 140.4461
      Epoch 4 composite train-obj: 0.110612
            Val objective improved 0.1520 → 0.1487, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2701, mae: 0.3058, huber: 0.1037, swd: 0.1232, ept: 150.3721
    Epoch [5/50], Val Losses: mse: 0.3299, mae: 0.4112, huber: 0.1546, swd: 0.1301, ept: 111.6897
    Epoch [5/50], Test Losses: mse: 0.1911, mae: 0.3131, huber: 0.0938, swd: 0.0675, ept: 138.3295
      Epoch 5 composite train-obj: 0.103675
            No improvement (0.1546), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.2478, mae: 0.2946, huber: 0.0963, swd: 0.1102, ept: 152.1197
    Epoch [6/50], Val Losses: mse: 0.3467, mae: 0.4162, huber: 0.1604, swd: 0.1411, ept: 110.4844
    Epoch [6/50], Test Losses: mse: 0.1930, mae: 0.3129, huber: 0.0945, swd: 0.0684, ept: 136.3025
      Epoch 6 composite train-obj: 0.096326
            No improvement (0.1604), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.2300, mae: 0.2848, huber: 0.0900, swd: 0.0974, ept: 154.0205
    Epoch [7/50], Val Losses: mse: 0.3437, mae: 0.4144, huber: 0.1593, swd: 0.1385, ept: 110.5896
    Epoch [7/50], Test Losses: mse: 0.2018, mae: 0.3194, huber: 0.0984, swd: 0.0730, ept: 136.4069
      Epoch 7 composite train-obj: 0.090013
            No improvement (0.1593), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.2104, mae: 0.2720, huber: 0.0821, swd: 0.0836, ept: 156.7548
    Epoch [8/50], Val Losses: mse: 0.3476, mae: 0.4159, huber: 0.1607, swd: 0.1457, ept: 109.7887
    Epoch [8/50], Test Losses: mse: 0.2049, mae: 0.3209, huber: 0.0997, swd: 0.0752, ept: 134.4986
      Epoch 8 composite train-obj: 0.082147
            No improvement (0.1607), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.1974, mae: 0.2628, huber: 0.0769, swd: 0.0744, ept: 158.7308
    Epoch [9/50], Val Losses: mse: 0.3707, mae: 0.4270, huber: 0.1695, swd: 0.1487, ept: 110.0836
    Epoch [9/50], Test Losses: mse: 0.2113, mae: 0.3266, huber: 0.1027, swd: 0.0778, ept: 134.6853
      Epoch 9 composite train-obj: 0.076888
    Epoch [9/50], Test Losses: mse: 0.1747, mae: 0.2997, huber: 0.0861, swd: 0.0595, ept: 140.4461
    Best round's Test MSE: 0.1747, MAE: 0.2997, SWD: 0.0595
    Best round's Validation MSE: 0.3149, MAE: 0.4018, SWD: 0.1262
    Best round's Test verification MSE : 0.1747, MAE: 0.2997, SWD: 0.0595
    Time taken: 49.04 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3975, mae: 0.3725, huber: 0.1480, swd: 0.1469, ept: 130.4654
    Epoch [1/50], Val Losses: mse: 0.3347, mae: 0.4081, huber: 0.1573, swd: 0.1114, ept: 107.3468
    Epoch [1/50], Test Losses: mse: 0.1707, mae: 0.2943, huber: 0.0840, swd: 0.0496, ept: 138.3946
      Epoch 1 composite train-obj: 0.148047
            Val objective improved inf → 0.1573, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3404, mae: 0.3416, huber: 0.1273, swd: 0.1303, ept: 141.6713
    Epoch [2/50], Val Losses: mse: 0.3152, mae: 0.3991, huber: 0.1488, swd: 0.1070, ept: 110.9704
    Epoch [2/50], Test Losses: mse: 0.1668, mae: 0.2908, huber: 0.0822, swd: 0.0473, ept: 140.0698
      Epoch 2 composite train-obj: 0.127288
            Val objective improved 0.1573 → 0.1488, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3085, mae: 0.3258, huber: 0.1167, swd: 0.1226, ept: 145.2190
    Epoch [3/50], Val Losses: mse: 0.3286, mae: 0.4121, huber: 0.1551, swd: 0.1120, ept: 109.3012
    Epoch [3/50], Test Losses: mse: 0.1722, mae: 0.2962, huber: 0.0849, swd: 0.0496, ept: 140.3262
      Epoch 3 composite train-obj: 0.116688
            No improvement (0.1551), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2849, mae: 0.3138, huber: 0.1089, swd: 0.1159, ept: 147.8662
    Epoch [4/50], Val Losses: mse: 0.3250, mae: 0.4071, huber: 0.1525, swd: 0.1105, ept: 107.3089
    Epoch [4/50], Test Losses: mse: 0.1707, mae: 0.2932, huber: 0.0840, swd: 0.0511, ept: 138.4140
      Epoch 4 composite train-obj: 0.108928
            No improvement (0.1525), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.2634, mae: 0.3037, huber: 0.1020, swd: 0.1054, ept: 149.7457
    Epoch [5/50], Val Losses: mse: 0.3355, mae: 0.4155, huber: 0.1578, swd: 0.1093, ept: 105.8758
    Epoch [5/50], Test Losses: mse: 0.1826, mae: 0.3033, huber: 0.0896, swd: 0.0539, ept: 135.7779
      Epoch 5 composite train-obj: 0.102031
            No improvement (0.1578), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.2460, mae: 0.2939, huber: 0.0957, swd: 0.0976, ept: 151.6010
    Epoch [6/50], Val Losses: mse: 0.3680, mae: 0.4331, huber: 0.1699, swd: 0.1169, ept: 105.6712
    Epoch [6/50], Test Losses: mse: 0.2051, mae: 0.3224, huber: 0.1002, swd: 0.0613, ept: 132.5257
      Epoch 6 composite train-obj: 0.095739
            No improvement (0.1699), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.2300, mae: 0.2842, huber: 0.0896, swd: 0.0894, ept: 153.7986
    Epoch [7/50], Val Losses: mse: 0.3672, mae: 0.4346, huber: 0.1705, swd: 0.1257, ept: 106.2162
    Epoch [7/50], Test Losses: mse: 0.2012, mae: 0.3204, huber: 0.0982, swd: 0.0620, ept: 131.9901
      Epoch 7 composite train-obj: 0.089628
    Epoch [7/50], Test Losses: mse: 0.1668, mae: 0.2908, huber: 0.0822, swd: 0.0473, ept: 140.0698
    Best round's Test MSE: 0.1668, MAE: 0.2908, SWD: 0.0473
    Best round's Validation MSE: 0.3152, MAE: 0.3991, SWD: 0.1070
    Best round's Test verification MSE : 0.1668, MAE: 0.2908, SWD: 0.0473
    Time taken: 38.07 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq336_pred196_20250510_2124)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1686 ± 0.0044
      mae: 0.2926 ± 0.0052
      huber: 0.0832 ± 0.0022
      swd: 0.0540 ± 0.0050
      ept: 139.5664 ± 0.9900
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3153 ± 0.0004
      mae: 0.4002 ± 0.0012
      huber: 0.1487 ± 0.0001
      swd: 0.1188 ± 0.0085
      ept: 110.2902 ± 1.4882
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 124.74 seconds
    
    Experiment complete: TimeMixer_etth2_seq336_pred196_20250510_2124
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=336,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 91
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 91
    Validation Batches: 9
    Test Batches: 22
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4917, mae: 0.4181, huber: 0.1785, swd: 0.1911, ept: 183.2105
    Epoch [1/50], Val Losses: mse: 0.3489, mae: 0.4244, huber: 0.1643, swd: 0.1093, ept: 156.8357
    Epoch [1/50], Test Losses: mse: 0.1975, mae: 0.3176, huber: 0.0968, swd: 0.0568, ept: 200.9505
      Epoch 1 composite train-obj: 0.178528
            Val objective improved inf → 0.1643, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4254, mae: 0.3822, huber: 0.1547, swd: 0.1753, ept: 205.0993
    Epoch [2/50], Val Losses: mse: 0.3530, mae: 0.4271, huber: 0.1660, swd: 0.1184, ept: 152.4643
    Epoch [2/50], Test Losses: mse: 0.1890, mae: 0.3101, huber: 0.0929, swd: 0.0546, ept: 199.6852
      Epoch 2 composite train-obj: 0.154673
            No improvement (0.1660), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3926, mae: 0.3665, huber: 0.1434, swd: 0.1681, ept: 211.1202
    Epoch [3/50], Val Losses: mse: 0.3600, mae: 0.4365, huber: 0.1699, swd: 0.1148, ept: 156.3198
    Epoch [3/50], Test Losses: mse: 0.2017, mae: 0.3233, huber: 0.0991, swd: 0.0564, ept: 198.4493
      Epoch 3 composite train-obj: 0.143366
            No improvement (0.1699), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.3683, mae: 0.3534, huber: 0.1345, swd: 0.1597, ept: 215.3134
    Epoch [4/50], Val Losses: mse: 0.3710, mae: 0.4387, huber: 0.1734, swd: 0.1313, ept: 150.6496
    Epoch [4/50], Test Losses: mse: 0.1884, mae: 0.3096, huber: 0.0926, swd: 0.0525, ept: 198.9786
      Epoch 4 composite train-obj: 0.134505
            No improvement (0.1734), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.3528, mae: 0.3456, huber: 0.1293, swd: 0.1549, ept: 218.7194
    Epoch [5/50], Val Losses: mse: 0.3826, mae: 0.4530, huber: 0.1796, swd: 0.1232, ept: 154.8747
    Epoch [5/50], Test Losses: mse: 0.2174, mae: 0.3364, huber: 0.1064, swd: 0.0636, ept: 197.0154
      Epoch 5 composite train-obj: 0.129274
            No improvement (0.1796), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.3342, mae: 0.3358, huber: 0.1227, swd: 0.1447, ept: 221.2978
    Epoch [6/50], Val Losses: mse: 0.3760, mae: 0.4415, huber: 0.1751, swd: 0.1323, ept: 153.4259
    Epoch [6/50], Test Losses: mse: 0.1989, mae: 0.3191, huber: 0.0974, swd: 0.0593, ept: 195.2135
      Epoch 6 composite train-obj: 0.122719
    Epoch [6/50], Test Losses: mse: 0.1975, mae: 0.3176, huber: 0.0968, swd: 0.0568, ept: 200.9505
    Best round's Test MSE: 0.1975, MAE: 0.3176, SWD: 0.0568
    Best round's Validation MSE: 0.3489, MAE: 0.4244, SWD: 0.1093
    Best round's Test verification MSE : 0.1975, MAE: 0.3176, SWD: 0.0568
    Time taken: 33.98 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5305, mae: 0.4302, huber: 0.1880, swd: 0.2038, ept: 174.2393
    Epoch [1/50], Val Losses: mse: 0.3486, mae: 0.4229, huber: 0.1633, swd: 0.1179, ept: 149.7111
    Epoch [1/50], Test Losses: mse: 0.1853, mae: 0.3070, huber: 0.0912, swd: 0.0556, ept: 198.4122
      Epoch 1 composite train-obj: 0.188030
            Val objective improved inf → 0.1633, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4246, mae: 0.3842, huber: 0.1546, swd: 0.1808, ept: 202.2546
    Epoch [2/50], Val Losses: mse: 0.3428, mae: 0.4187, huber: 0.1608, swd: 0.1219, ept: 153.0831
    Epoch [2/50], Test Losses: mse: 0.1796, mae: 0.3009, huber: 0.0883, swd: 0.0546, ept: 199.7921
      Epoch 2 composite train-obj: 0.154637
            Val objective improved 0.1633 → 0.1608, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3953, mae: 0.3700, huber: 0.1449, swd: 0.1739, ept: 208.3339
    Epoch [3/50], Val Losses: mse: 0.3911, mae: 0.4574, huber: 0.1836, swd: 0.1327, ept: 152.1881
    Epoch [3/50], Test Losses: mse: 0.2187, mae: 0.3408, huber: 0.1071, swd: 0.0667, ept: 195.8325
      Epoch 3 composite train-obj: 0.144854
            No improvement (0.1836), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3860, mae: 0.3643, huber: 0.1411, swd: 0.1731, ept: 211.5378
    Epoch [4/50], Val Losses: mse: 0.3466, mae: 0.4204, huber: 0.1620, swd: 0.1267, ept: 154.6254
    Epoch [4/50], Test Losses: mse: 0.1790, mae: 0.3012, huber: 0.0880, swd: 0.0530, ept: 201.4337
      Epoch 4 composite train-obj: 0.141112
            No improvement (0.1620), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3779, mae: 0.3577, huber: 0.1375, swd: 0.1706, ept: 214.1751
    Epoch [5/50], Val Losses: mse: 0.3570, mae: 0.4297, huber: 0.1670, swd: 0.1245, ept: 154.4646
    Epoch [5/50], Test Losses: mse: 0.1865, mae: 0.3098, huber: 0.0917, swd: 0.0539, ept: 200.3022
      Epoch 5 composite train-obj: 0.137500
            No improvement (0.1670), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.3540, mae: 0.3445, huber: 0.1288, swd: 0.1598, ept: 218.9788
    Epoch [6/50], Val Losses: mse: 0.3707, mae: 0.4409, huber: 0.1733, swd: 0.1273, ept: 154.3656
    Epoch [6/50], Test Losses: mse: 0.2060, mae: 0.3275, huber: 0.1009, swd: 0.0612, ept: 197.5342
      Epoch 6 composite train-obj: 0.128847
            No improvement (0.1733), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.3403, mae: 0.3357, huber: 0.1236, swd: 0.1531, ept: 223.0447
    Epoch [7/50], Val Losses: mse: 0.3817, mae: 0.4402, huber: 0.1757, swd: 0.1494, ept: 151.0528
    Epoch [7/50], Test Losses: mse: 0.1821, mae: 0.3060, huber: 0.0894, swd: 0.0595, ept: 193.5778
      Epoch 7 composite train-obj: 0.123604
    Epoch [7/50], Test Losses: mse: 0.1796, mae: 0.3009, huber: 0.0883, swd: 0.0546, ept: 199.7921
    Best round's Test MSE: 0.1796, MAE: 0.3009, SWD: 0.0546
    Best round's Validation MSE: 0.3428, MAE: 0.4187, SWD: 0.1219
    Best round's Test verification MSE : 0.1796, MAE: 0.3009, SWD: 0.0546
    Time taken: 39.88 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5021, mae: 0.4171, huber: 0.1795, swd: 0.2017, ept: 185.0830
    Epoch [1/50], Val Losses: mse: 0.3595, mae: 0.4257, huber: 0.1678, swd: 0.1211, ept: 154.1369
    Epoch [1/50], Test Losses: mse: 0.1957, mae: 0.3111, huber: 0.0955, swd: 0.0566, ept: 198.5380
      Epoch 1 composite train-obj: 0.179498
            Val objective improved inf → 0.1678, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4205, mae: 0.3796, huber: 0.1528, swd: 0.1749, ept: 204.9984
    Epoch [2/50], Val Losses: mse: 0.3621, mae: 0.4299, huber: 0.1688, swd: 0.1238, ept: 154.2194
    Epoch [2/50], Test Losses: mse: 0.1865, mae: 0.3070, huber: 0.0916, swd: 0.0508, ept: 200.2015
      Epoch 2 composite train-obj: 0.152756
            No improvement (0.1688), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3887, mae: 0.3650, huber: 0.1419, swd: 0.1685, ept: 210.7161
    Epoch [3/50], Val Losses: mse: 0.3572, mae: 0.4252, huber: 0.1662, swd: 0.1236, ept: 156.4929
    Epoch [3/50], Test Losses: mse: 0.1892, mae: 0.3107, huber: 0.0929, swd: 0.0516, ept: 200.6500
      Epoch 3 composite train-obj: 0.141910
            Val objective improved 0.1678 → 0.1662, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.3624, mae: 0.3496, huber: 0.1322, swd: 0.1608, ept: 217.3214
    Epoch [4/50], Val Losses: mse: 0.3721, mae: 0.4361, huber: 0.1733, swd: 0.1273, ept: 157.1313
    Epoch [4/50], Test Losses: mse: 0.2078, mae: 0.3247, huber: 0.1014, swd: 0.0571, ept: 198.2510
      Epoch 4 composite train-obj: 0.132176
            No improvement (0.1733), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.3436, mae: 0.3380, huber: 0.1251, swd: 0.1538, ept: 221.8521
    Epoch [5/50], Val Losses: mse: 0.3939, mae: 0.4441, huber: 0.1801, swd: 0.1493, ept: 151.1790
    Epoch [5/50], Test Losses: mse: 0.1958, mae: 0.3152, huber: 0.0956, swd: 0.0585, ept: 194.1575
      Epoch 5 composite train-obj: 0.125132
            No improvement (0.1801), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.3259, mae: 0.3281, huber: 0.1188, swd: 0.1451, ept: 225.2961
    Epoch [6/50], Val Losses: mse: 0.3930, mae: 0.4452, huber: 0.1805, swd: 0.1449, ept: 154.7532
    Epoch [6/50], Test Losses: mse: 0.2106, mae: 0.3279, huber: 0.1025, swd: 0.0591, ept: 192.4363
      Epoch 6 composite train-obj: 0.118824
            No improvement (0.1805), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.3102, mae: 0.3197, huber: 0.1133, swd: 0.1370, ept: 228.1198
    Epoch [7/50], Val Losses: mse: 0.3821, mae: 0.4432, huber: 0.1768, swd: 0.1340, ept: 154.7990
    Epoch [7/50], Test Losses: mse: 0.2266, mae: 0.3411, huber: 0.1103, swd: 0.0640, ept: 189.2958
      Epoch 7 composite train-obj: 0.113261
            No improvement (0.1768), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.2967, mae: 0.3122, huber: 0.1085, swd: 0.1269, ept: 230.4834
    Epoch [8/50], Val Losses: mse: 0.4790, mae: 0.5066, huber: 0.2170, swd: 0.1595, ept: 146.4083
    Epoch [8/50], Test Losses: mse: 0.3609, mae: 0.4285, huber: 0.1686, swd: 0.1209, ept: 181.5799
      Epoch 8 composite train-obj: 0.108468
    Epoch [8/50], Test Losses: mse: 0.1892, mae: 0.3107, huber: 0.0929, swd: 0.0516, ept: 200.6500
    Best round's Test MSE: 0.1892, MAE: 0.3107, SWD: 0.0516
    Best round's Validation MSE: 0.3572, MAE: 0.4252, SWD: 0.1236
    Best round's Test verification MSE : 0.1892, MAE: 0.3107, SWD: 0.0516
    Time taken: 45.53 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq336_pred336_20250510_2126)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1888 ± 0.0073
      mae: 0.3097 ± 0.0069
      huber: 0.0927 ± 0.0035
      swd: 0.0543 ± 0.0021
      ept: 200.4642 ± 0.4909
      count: 9.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3496 ± 0.0059
      mae: 0.4227 ± 0.0029
      huber: 0.1638 ± 0.0022
      swd: 0.1183 ± 0.0064
      ept: 155.4706 ± 1.6940
      count: 9.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 119.45 seconds
    
    Experiment complete: TimeMixer_etth2_seq336_pred336_20250510_2126
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=336,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7076, mae: 0.5111, huber: 0.2464, swd: 0.2738, ept: 285.4912
    Epoch [1/50], Val Losses: mse: 0.4324, mae: 0.4771, huber: 0.2005, swd: 0.0878, ept: 271.6410
    Epoch [1/50], Test Losses: mse: 0.2433, mae: 0.3513, huber: 0.1179, swd: 0.0638, ept: 319.3461
      Epoch 1 composite train-obj: 0.246419
            Val objective improved inf → 0.2005, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.6388, mae: 0.4810, huber: 0.2236, swd: 0.2649, ept: 313.9301
    Epoch [2/50], Val Losses: mse: 0.4685, mae: 0.5000, huber: 0.2153, swd: 0.0923, ept: 256.0949
    Epoch [2/50], Test Losses: mse: 0.2680, mae: 0.3738, huber: 0.1292, swd: 0.0703, ept: 318.4176
      Epoch 2 composite train-obj: 0.223596
            No improvement (0.2153), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.6380, mae: 0.4778, huber: 0.2216, swd: 0.2750, ept: 316.0437
    Epoch [3/50], Val Losses: mse: 0.4103, mae: 0.4664, huber: 0.1918, swd: 0.0878, ept: 265.2168
    Epoch [3/50], Test Losses: mse: 0.2295, mae: 0.3418, huber: 0.1116, swd: 0.0597, ept: 322.7825
      Epoch 3 composite train-obj: 0.221570
            Val objective improved 0.2005 → 0.1918, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.5876, mae: 0.4555, huber: 0.2052, swd: 0.2512, ept: 326.5949
    Epoch [4/50], Val Losses: mse: 0.4144, mae: 0.4686, huber: 0.1936, swd: 0.0962, ept: 267.6037
    Epoch [4/50], Test Losses: mse: 0.2352, mae: 0.3462, huber: 0.1143, swd: 0.0612, ept: 324.2192
      Epoch 4 composite train-obj: 0.205201
            No improvement (0.1936), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.5741, mae: 0.4469, huber: 0.1994, swd: 0.2487, ept: 330.8216
    Epoch [5/50], Val Losses: mse: 0.4108, mae: 0.4678, huber: 0.1922, swd: 0.1049, ept: 268.6617
    Epoch [5/50], Test Losses: mse: 0.2469, mae: 0.3555, huber: 0.1197, swd: 0.0681, ept: 321.5170
      Epoch 5 composite train-obj: 0.199410
            No improvement (0.1922), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.5479, mae: 0.4360, huber: 0.1911, swd: 0.2359, ept: 336.0543
    Epoch [6/50], Val Losses: mse: 0.4405, mae: 0.4850, huber: 0.2040, swd: 0.1093, ept: 261.0742
    Epoch [6/50], Test Losses: mse: 0.2710, mae: 0.3721, huber: 0.1304, swd: 0.0763, ept: 320.7596
      Epoch 6 composite train-obj: 0.191092
            No improvement (0.2040), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.5397, mae: 0.4306, huber: 0.1875, swd: 0.2323, ept: 336.2971
    Epoch [7/50], Val Losses: mse: 0.3804, mae: 0.4534, huber: 0.1801, swd: 0.1163, ept: 266.5474
    Epoch [7/50], Test Losses: mse: 0.2283, mae: 0.3410, huber: 0.1105, swd: 0.0708, ept: 319.7267
      Epoch 7 composite train-obj: 0.187546
            Val objective improved 0.1918 → 0.1801, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 0.5394, mae: 0.4277, huber: 0.1861, swd: 0.2323, ept: 338.1418
    Epoch [8/50], Val Losses: mse: 0.4331, mae: 0.4811, huber: 0.2010, swd: 0.1168, ept: 266.5042
    Epoch [8/50], Test Losses: mse: 0.2823, mae: 0.3780, huber: 0.1348, swd: 0.0890, ept: 317.7121
      Epoch 8 composite train-obj: 0.186056
            No improvement (0.2010), counter 1/5
    Epoch [9/50], Train Losses: mse: 0.5157, mae: 0.4158, huber: 0.1777, swd: 0.2187, ept: 344.5846
    Epoch [9/50], Val Losses: mse: 0.3997, mae: 0.4638, huber: 0.1879, swd: 0.1155, ept: 269.1345
    Epoch [9/50], Test Losses: mse: 0.2580, mae: 0.3623, huber: 0.1241, swd: 0.0764, ept: 317.5619
      Epoch 9 composite train-obj: 0.177730
            No improvement (0.1879), counter 2/5
    Epoch [10/50], Train Losses: mse: 0.5086, mae: 0.4094, huber: 0.1739, swd: 0.2190, ept: 345.6535
    Epoch [10/50], Val Losses: mse: 0.4395, mae: 0.4861, huber: 0.2041, swd: 0.1247, ept: 271.2591
    Epoch [10/50], Test Losses: mse: 0.2931, mae: 0.3858, huber: 0.1394, swd: 0.0916, ept: 315.3021
      Epoch 10 composite train-obj: 0.173865
            No improvement (0.2041), counter 3/5
    Epoch [11/50], Train Losses: mse: 0.4824, mae: 0.3987, huber: 0.1658, swd: 0.2023, ept: 349.2095
    Epoch [11/50], Val Losses: mse: 0.4369, mae: 0.4856, huber: 0.2027, swd: 0.1051, ept: 273.3555
    Epoch [11/50], Test Losses: mse: 0.3148, mae: 0.3991, huber: 0.1489, swd: 0.0988, ept: 316.3517
      Epoch 11 composite train-obj: 0.165753
            No improvement (0.2027), counter 4/5
    Epoch [12/50], Train Losses: mse: 0.4656, mae: 0.3880, huber: 0.1590, swd: 0.1956, ept: 353.5874
    Epoch [12/50], Val Losses: mse: 0.4224, mae: 0.4767, huber: 0.1973, swd: 0.1056, ept: 273.1320
    Epoch [12/50], Test Losses: mse: 0.3110, mae: 0.3966, huber: 0.1471, swd: 0.0949, ept: 314.2367
      Epoch 12 composite train-obj: 0.159026
    Epoch [12/50], Test Losses: mse: 0.2283, mae: 0.3410, huber: 0.1105, swd: 0.0708, ept: 319.7267
    Best round's Test MSE: 0.2283, MAE: 0.3410, SWD: 0.0708
    Best round's Validation MSE: 0.3804, MAE: 0.4534, SWD: 0.1163
    Best round's Test verification MSE : 0.2283, MAE: 0.3410, SWD: 0.0708
    Time taken: 73.79 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6993, mae: 0.5085, huber: 0.2435, swd: 0.2671, ept: 289.2898
    Epoch [1/50], Val Losses: mse: 0.4617, mae: 0.4979, huber: 0.2128, swd: 0.0848, ept: 267.2123
    Epoch [1/50], Test Losses: mse: 0.2545, mae: 0.3627, huber: 0.1232, swd: 0.0599, ept: 323.1222
      Epoch 1 composite train-obj: 0.243547
            Val objective improved inf → 0.2128, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.6291, mae: 0.4757, huber: 0.2197, swd: 0.2570, ept: 317.5269
    Epoch [2/50], Val Losses: mse: 0.3993, mae: 0.4575, huber: 0.1864, swd: 0.0742, ept: 277.5948
    Epoch [2/50], Test Losses: mse: 0.2272, mae: 0.3391, huber: 0.1104, swd: 0.0537, ept: 322.2091
      Epoch 2 composite train-obj: 0.219722
            Val objective improved 0.2128 → 0.1864, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.5940, mae: 0.4590, huber: 0.2073, swd: 0.2472, ept: 324.2214
    Epoch [3/50], Val Losses: mse: 0.3604, mae: 0.4377, huber: 0.1708, swd: 0.0810, ept: 270.2922
    Epoch [3/50], Test Losses: mse: 0.2173, mae: 0.3308, huber: 0.1057, swd: 0.0538, ept: 322.5867
      Epoch 3 composite train-obj: 0.207315
            Val objective improved 0.1864 → 0.1708, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.5801, mae: 0.4482, huber: 0.2006, swd: 0.2438, ept: 329.4377
    Epoch [4/50], Val Losses: mse: 0.3866, mae: 0.4532, huber: 0.1816, swd: 0.1016, ept: 265.6885
    Epoch [4/50], Test Losses: mse: 0.2311, mae: 0.3408, huber: 0.1119, swd: 0.0612, ept: 318.5357
      Epoch 4 composite train-obj: 0.200641
            No improvement (0.1816), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.5427, mae: 0.4323, huber: 0.1888, swd: 0.2253, ept: 336.4434
    Epoch [5/50], Val Losses: mse: 0.4120, mae: 0.4716, huber: 0.1928, swd: 0.0937, ept: 261.2670
    Epoch [5/50], Test Losses: mse: 0.2746, mae: 0.3740, huber: 0.1318, swd: 0.0712, ept: 318.9457
      Epoch 5 composite train-obj: 0.188777
            No improvement (0.1928), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.5211, mae: 0.4191, huber: 0.1800, swd: 0.2144, ept: 340.7077
    Epoch [6/50], Val Losses: mse: 0.4170, mae: 0.4747, huber: 0.1946, swd: 0.1082, ept: 272.0283
    Epoch [6/50], Test Losses: mse: 0.2766, mae: 0.3727, huber: 0.1319, swd: 0.0764, ept: 316.3078
      Epoch 6 composite train-obj: 0.180049
            No improvement (0.1946), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.5053, mae: 0.4100, huber: 0.1738, swd: 0.2068, ept: 343.9554
    Epoch [7/50], Val Losses: mse: 0.4200, mae: 0.4777, huber: 0.1961, swd: 0.1150, ept: 258.9641
    Epoch [7/50], Test Losses: mse: 0.2714, mae: 0.3725, huber: 0.1295, swd: 0.0802, ept: 314.8611
      Epoch 7 composite train-obj: 0.173792
            No improvement (0.1961), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.5025, mae: 0.4055, huber: 0.1714, swd: 0.2081, ept: 345.3482
    Epoch [8/50], Val Losses: mse: 0.4334, mae: 0.4894, huber: 0.2028, swd: 0.1154, ept: 260.4913
    Epoch [8/50], Test Losses: mse: 0.2915, mae: 0.3872, huber: 0.1389, swd: 0.0831, ept: 312.6687
      Epoch 8 composite train-obj: 0.171373
    Epoch [8/50], Test Losses: mse: 0.2173, mae: 0.3308, huber: 0.1057, swd: 0.0538, ept: 322.5867
    Best round's Test MSE: 0.2173, MAE: 0.3308, SWD: 0.0538
    Best round's Validation MSE: 0.3604, MAE: 0.4377, SWD: 0.0810
    Best round's Test verification MSE : 0.2173, MAE: 0.3308, SWD: 0.0538
    Time taken: 49.81 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6835, mae: 0.5019, huber: 0.2389, swd: 0.2928, ept: 290.1275
    Epoch [1/50], Val Losses: mse: 0.4371, mae: 0.4821, huber: 0.2028, swd: 0.0869, ept: 277.2459
    Epoch [1/50], Test Losses: mse: 0.2454, mae: 0.3539, huber: 0.1189, swd: 0.0656, ept: 319.9366
      Epoch 1 composite train-obj: 0.238903
            Val objective improved inf → 0.2028, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.6196, mae: 0.4724, huber: 0.2170, swd: 0.2729, ept: 315.9165
    Epoch [2/50], Val Losses: mse: 0.4206, mae: 0.4732, huber: 0.1964, swd: 0.0978, ept: 263.4272
    Epoch [2/50], Test Losses: mse: 0.2344, mae: 0.3467, huber: 0.1139, swd: 0.0624, ept: 318.1996
      Epoch 2 composite train-obj: 0.216976
            Val objective improved 0.2028 → 0.1964, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.5743, mae: 0.4499, huber: 0.2008, swd: 0.2582, ept: 326.6810
    Epoch [3/50], Val Losses: mse: 0.4608, mae: 0.4989, huber: 0.2128, swd: 0.1069, ept: 251.8864
    Epoch [3/50], Test Losses: mse: 0.2832, mae: 0.3827, huber: 0.1360, swd: 0.0814, ept: 315.3229
      Epoch 3 composite train-obj: 0.200825
            No improvement (0.2128), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.5441, mae: 0.4317, huber: 0.1888, swd: 0.2450, ept: 335.1181
    Epoch [4/50], Val Losses: mse: 0.4037, mae: 0.4665, huber: 0.1890, swd: 0.0958, ept: 257.5451
    Epoch [4/50], Test Losses: mse: 0.2562, mae: 0.3633, huber: 0.1236, swd: 0.0731, ept: 314.7275
      Epoch 4 composite train-obj: 0.188766
            Val objective improved 0.1964 → 0.1890, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.5177, mae: 0.4169, huber: 0.1789, swd: 0.2326, ept: 341.4206
    Epoch [5/50], Val Losses: mse: 0.4613, mae: 0.5025, huber: 0.2134, swd: 0.1188, ept: 249.1294
    Epoch [5/50], Test Losses: mse: 0.3038, mae: 0.3967, huber: 0.1452, swd: 0.0881, ept: 311.3407
      Epoch 5 composite train-obj: 0.178886
            No improvement (0.2134), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.4978, mae: 0.4055, huber: 0.1711, swd: 0.2228, ept: 347.7311
    Epoch [6/50], Val Losses: mse: 0.4119, mae: 0.4740, huber: 0.1925, swd: 0.1041, ept: 264.7464
    Epoch [6/50], Test Losses: mse: 0.2747, mae: 0.3778, huber: 0.1320, swd: 0.0782, ept: 306.4837
      Epoch 6 composite train-obj: 0.171128
            No improvement (0.1925), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.4782, mae: 0.3945, huber: 0.1636, swd: 0.2139, ept: 352.2141
    Epoch [7/50], Val Losses: mse: 0.4374, mae: 0.4910, huber: 0.2039, swd: 0.1038, ept: 261.3609
    Epoch [7/50], Test Losses: mse: 0.2994, mae: 0.3930, huber: 0.1429, swd: 0.0880, ept: 303.9484
      Epoch 7 composite train-obj: 0.163646
            No improvement (0.2039), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.4582, mae: 0.3826, huber: 0.1557, swd: 0.2037, ept: 356.6307
    Epoch [8/50], Val Losses: mse: 0.4086, mae: 0.4770, huber: 0.1922, swd: 0.0941, ept: 256.9301
    Epoch [8/50], Test Losses: mse: 0.2849, mae: 0.3846, huber: 0.1363, swd: 0.0813, ept: 302.5236
      Epoch 8 composite train-obj: 0.155671
            No improvement (0.1922), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.4561, mae: 0.3785, huber: 0.1536, swd: 0.2040, ept: 361.8719
    Epoch [9/50], Val Losses: mse: 0.4527, mae: 0.5021, huber: 0.2105, swd: 0.1060, ept: 251.1260
    Epoch [9/50], Test Losses: mse: 0.3514, mae: 0.4232, huber: 0.1642, swd: 0.1081, ept: 304.1591
      Epoch 9 composite train-obj: 0.153606
    Epoch [9/50], Test Losses: mse: 0.2562, mae: 0.3633, huber: 0.1236, swd: 0.0731, ept: 314.7275
    Best round's Test MSE: 0.2562, MAE: 0.3633, SWD: 0.0731
    Best round's Validation MSE: 0.4037, MAE: 0.4665, SWD: 0.0958
    Best round's Test verification MSE : 0.2562, MAE: 0.3633, SWD: 0.0731
    Time taken: 55.83 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq336_pred720_20250510_2128)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2340 ± 0.0164
      mae: 0.3450 ± 0.0135
      huber: 0.1133 ± 0.0076
      swd: 0.0659 ± 0.0086
      ept: 319.0136 ± 3.2479
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3815 ± 0.0177
      mae: 0.4526 ± 0.0118
      huber: 0.1800 ± 0.0074
      swd: 0.0977 ± 0.0145
      ept: 264.7949 ± 5.3495
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 179.50 seconds
    
    Experiment complete: TimeMixer_etth2_seq336_pred720_20250510_2128
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### PatchTST

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=336,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3405, mae: 0.3480, huber: 0.1303, swd: 0.1183, ept: 69.8469
    Epoch [1/50], Val Losses: mse: 0.2777, mae: 0.3664, huber: 0.1313, swd: 0.1096, ept: 68.1778
    Epoch [1/50], Test Losses: mse: 0.1532, mae: 0.2803, huber: 0.0756, swd: 0.0481, ept: 78.8415
      Epoch 1 composite train-obj: 0.130337
            Val objective improved inf → 0.1313, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2845, mae: 0.3165, huber: 0.1102, swd: 0.1079, ept: 74.7658
    Epoch [2/50], Val Losses: mse: 0.2747, mae: 0.3613, huber: 0.1289, swd: 0.1219, ept: 67.8026
    Epoch [2/50], Test Losses: mse: 0.1387, mae: 0.2627, huber: 0.0684, swd: 0.0465, ept: 79.3197
      Epoch 2 composite train-obj: 0.110180
            Val objective improved 0.1313 → 0.1289, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2643, mae: 0.3068, huber: 0.1036, swd: 0.1006, ept: 75.4393
    Epoch [3/50], Val Losses: mse: 0.2719, mae: 0.3631, huber: 0.1281, swd: 0.1129, ept: 67.7460
    Epoch [3/50], Test Losses: mse: 0.1601, mae: 0.2893, huber: 0.0789, swd: 0.0544, ept: 79.6866
      Epoch 3 composite train-obj: 0.103648
            Val objective improved 0.1289 → 0.1281, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2519, mae: 0.3018, huber: 0.1002, swd: 0.0960, ept: 75.7186
    Epoch [4/50], Val Losses: mse: 0.2822, mae: 0.3696, huber: 0.1322, swd: 0.1259, ept: 67.6353
    Epoch [4/50], Test Losses: mse: 0.1556, mae: 0.2808, huber: 0.0765, swd: 0.0544, ept: 78.9192
      Epoch 4 composite train-obj: 0.100157
            No improvement (0.1322), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2346, mae: 0.2944, huber: 0.0950, swd: 0.0874, ept: 76.1853
    Epoch [5/50], Val Losses: mse: 0.3021, mae: 0.3804, huber: 0.1405, swd: 0.1286, ept: 66.4772
    Epoch [5/50], Test Losses: mse: 0.1477, mae: 0.2692, huber: 0.0724, swd: 0.0509, ept: 79.4595
      Epoch 5 composite train-obj: 0.094961
            No improvement (0.1405), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.2267, mae: 0.2899, huber: 0.0922, swd: 0.0831, ept: 76.5075
    Epoch [6/50], Val Losses: mse: 0.3038, mae: 0.3849, huber: 0.1416, swd: 0.1267, ept: 66.3218
    Epoch [6/50], Test Losses: mse: 0.1548, mae: 0.2767, huber: 0.0759, swd: 0.0522, ept: 78.7994
      Epoch 6 composite train-obj: 0.092155
            No improvement (0.1416), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.2179, mae: 0.2847, huber: 0.0889, swd: 0.0792, ept: 76.8292
    Epoch [7/50], Val Losses: mse: 0.2839, mae: 0.3718, huber: 0.1330, swd: 0.1164, ept: 67.8221
    Epoch [7/50], Test Losses: mse: 0.1610, mae: 0.2839, huber: 0.0790, swd: 0.0566, ept: 78.7246
      Epoch 7 composite train-obj: 0.088946
            No improvement (0.1330), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.2097, mae: 0.2797, huber: 0.0859, swd: 0.0747, ept: 77.1039
    Epoch [8/50], Val Losses: mse: 0.2902, mae: 0.3795, huber: 0.1359, swd: 0.1217, ept: 66.7655
    Epoch [8/50], Test Losses: mse: 0.1597, mae: 0.2836, huber: 0.0784, swd: 0.0563, ept: 79.1207
      Epoch 8 composite train-obj: 0.085883
    Epoch [8/50], Test Losses: mse: 0.1601, mae: 0.2893, huber: 0.0789, swd: 0.0544, ept: 79.6866
    Best round's Test MSE: 0.1601, MAE: 0.2893, SWD: 0.0544
    Best round's Validation MSE: 0.2719, MAE: 0.3631, SWD: 0.1129
    Best round's Test verification MSE : 0.1601, MAE: 0.2893, SWD: 0.0544
    Time taken: 31.69 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3378, mae: 0.3465, huber: 0.1295, swd: 0.1161, ept: 69.9377
    Epoch [1/50], Val Losses: mse: 0.2733, mae: 0.3647, huber: 0.1292, swd: 0.1107, ept: 67.5208
    Epoch [1/50], Test Losses: mse: 0.1432, mae: 0.2698, huber: 0.0707, swd: 0.0454, ept: 79.5369
      Epoch 1 composite train-obj: 0.129519
            Val objective improved inf → 0.1292, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2834, mae: 0.3165, huber: 0.1101, swd: 0.1052, ept: 74.6596
    Epoch [2/50], Val Losses: mse: 0.2742, mae: 0.3703, huber: 0.1300, swd: 0.1140, ept: 67.3551
    Epoch [2/50], Test Losses: mse: 0.1502, mae: 0.2777, huber: 0.0742, swd: 0.0482, ept: 78.7273
      Epoch 2 composite train-obj: 0.110071
            No improvement (0.1300), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2618, mae: 0.3074, huber: 0.1036, swd: 0.0973, ept: 75.3724
    Epoch [3/50], Val Losses: mse: 0.2857, mae: 0.3720, huber: 0.1336, swd: 0.1204, ept: 67.6442
    Epoch [3/50], Test Losses: mse: 0.1450, mae: 0.2701, huber: 0.0714, swd: 0.0487, ept: 79.3543
      Epoch 3 composite train-obj: 0.103576
            No improvement (0.1336), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2461, mae: 0.3004, huber: 0.0989, swd: 0.0889, ept: 75.7573
    Epoch [4/50], Val Losses: mse: 0.2851, mae: 0.3710, huber: 0.1333, swd: 0.1183, ept: 67.4298
    Epoch [4/50], Test Losses: mse: 0.1460, mae: 0.2729, huber: 0.0720, swd: 0.0485, ept: 79.9112
      Epoch 4 composite train-obj: 0.098893
            No improvement (0.1333), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2362, mae: 0.2954, huber: 0.0956, swd: 0.0835, ept: 76.0668
    Epoch [5/50], Val Losses: mse: 0.3023, mae: 0.3852, huber: 0.1403, swd: 0.1274, ept: 66.5494
    Epoch [5/50], Test Losses: mse: 0.1481, mae: 0.2733, huber: 0.0729, swd: 0.0477, ept: 79.0071
      Epoch 5 composite train-obj: 0.095603
            No improvement (0.1403), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.2232, mae: 0.2880, huber: 0.0910, swd: 0.0784, ept: 76.5139
    Epoch [6/50], Val Losses: mse: 0.3064, mae: 0.3843, huber: 0.1408, swd: 0.1245, ept: 66.4827
    Epoch [6/50], Test Losses: mse: 0.1577, mae: 0.2839, huber: 0.0775, swd: 0.0530, ept: 79.0447
      Epoch 6 composite train-obj: 0.090991
    Epoch [6/50], Test Losses: mse: 0.1432, mae: 0.2698, huber: 0.0707, swd: 0.0454, ept: 79.5369
    Best round's Test MSE: 0.1432, MAE: 0.2698, SWD: 0.0454
    Best round's Validation MSE: 0.2733, MAE: 0.3647, SWD: 0.1107
    Best round's Test verification MSE : 0.1432, MAE: 0.2698, SWD: 0.0454
    Time taken: 23.53 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3345, mae: 0.3456, huber: 0.1285, swd: 0.1072, ept: 70.1026
    Epoch [1/50], Val Losses: mse: 0.2705, mae: 0.3617, huber: 0.1280, swd: 0.1021, ept: 68.1641
    Epoch [1/50], Test Losses: mse: 0.1419, mae: 0.2691, huber: 0.0702, swd: 0.0410, ept: 79.6277
      Epoch 1 composite train-obj: 0.128488
            Val objective improved inf → 0.1280, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2840, mae: 0.3167, huber: 0.1102, swd: 0.0973, ept: 74.7296
    Epoch [2/50], Val Losses: mse: 0.2765, mae: 0.3727, huber: 0.1316, swd: 0.1039, ept: 67.7777
    Epoch [2/50], Test Losses: mse: 0.1557, mae: 0.2838, huber: 0.0770, swd: 0.0461, ept: 79.1641
      Epoch 2 composite train-obj: 0.110161
            No improvement (0.1316), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2666, mae: 0.3087, huber: 0.1047, swd: 0.0910, ept: 75.3131
    Epoch [3/50], Val Losses: mse: 0.2762, mae: 0.3664, huber: 0.1306, swd: 0.1076, ept: 67.2838
    Epoch [3/50], Test Losses: mse: 0.1536, mae: 0.2791, huber: 0.0756, swd: 0.0470, ept: 78.6704
      Epoch 3 composite train-obj: 0.104658
            No improvement (0.1306), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2504, mae: 0.3024, huber: 0.1002, swd: 0.0829, ept: 75.7318
    Epoch [4/50], Val Losses: mse: 0.2904, mae: 0.3768, huber: 0.1361, swd: 0.1141, ept: 66.6606
    Epoch [4/50], Test Losses: mse: 0.1490, mae: 0.2735, huber: 0.0734, swd: 0.0460, ept: 78.5121
      Epoch 4 composite train-obj: 0.100199
            No improvement (0.1361), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2406, mae: 0.2966, huber: 0.0968, swd: 0.0792, ept: 76.0878
    Epoch [5/50], Val Losses: mse: 0.2751, mae: 0.3696, huber: 0.1305, swd: 0.1014, ept: 68.1480
    Epoch [5/50], Test Losses: mse: 0.1616, mae: 0.2896, huber: 0.0797, swd: 0.0490, ept: 78.5943
      Epoch 5 composite train-obj: 0.096796
            No improvement (0.1305), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.2310, mae: 0.2915, huber: 0.0935, swd: 0.0757, ept: 76.3358
    Epoch [6/50], Val Losses: mse: 0.2874, mae: 0.3723, huber: 0.1339, swd: 0.1086, ept: 68.2850
    Epoch [6/50], Test Losses: mse: 0.1515, mae: 0.2762, huber: 0.0745, swd: 0.0452, ept: 78.5698
      Epoch 6 composite train-obj: 0.093517
    Epoch [6/50], Test Losses: mse: 0.1419, mae: 0.2691, huber: 0.0702, swd: 0.0410, ept: 79.6277
    Best round's Test MSE: 0.1419, MAE: 0.2691, SWD: 0.0410
    Best round's Validation MSE: 0.2705, MAE: 0.3617, SWD: 0.1021
    Best round's Test verification MSE : 0.1419, MAE: 0.2691, SWD: 0.0410
    Time taken: 23.67 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq336_pred96_20250510_2131)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1484 ± 0.0083
      mae: 0.2761 ± 0.0094
      huber: 0.0732 ± 0.0040
      swd: 0.0469 ± 0.0056
      ept: 79.6171 ± 0.0616
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2719 ± 0.0012
      mae: 0.3632 ± 0.0013
      huber: 0.1284 ± 0.0005
      swd: 0.1086 ± 0.0047
      ept: 67.8103 ± 0.2665
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 78.96 seconds
    
    Experiment complete: PatchTST_etth2_seq336_pred96_20250510_2131
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=336,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4179, mae: 0.3855, huber: 0.1555, swd: 0.1553, ept: 118.9800
    Epoch [1/50], Val Losses: mse: 0.3477, mae: 0.4229, huber: 0.1617, swd: 0.1246, ept: 102.9164
    Epoch [1/50], Test Losses: mse: 0.1864, mae: 0.3084, huber: 0.0911, swd: 0.0576, ept: 130.6361
      Epoch 1 composite train-obj: 0.155481
            Val objective improved inf → 0.1617, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3575, mae: 0.3553, huber: 0.1346, swd: 0.1435, ept: 129.0627
    Epoch [2/50], Val Losses: mse: 0.3372, mae: 0.4134, huber: 0.1571, swd: 0.1340, ept: 105.2568
    Epoch [2/50], Test Losses: mse: 0.1766, mae: 0.3009, huber: 0.0869, swd: 0.0563, ept: 134.5509
      Epoch 2 composite train-obj: 0.134554
            Val objective improved 0.1617 → 0.1571, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3349, mae: 0.3441, huber: 0.1268, swd: 0.1369, ept: 130.5757
    Epoch [3/50], Val Losses: mse: 0.3473, mae: 0.4172, huber: 0.1617, swd: 0.1382, ept: 105.3414
    Epoch [3/50], Test Losses: mse: 0.1762, mae: 0.2978, huber: 0.0864, swd: 0.0555, ept: 133.4533
      Epoch 3 composite train-obj: 0.126759
            No improvement (0.1617), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3193, mae: 0.3356, huber: 0.1212, swd: 0.1310, ept: 132.1940
    Epoch [4/50], Val Losses: mse: 0.3430, mae: 0.4160, huber: 0.1595, swd: 0.1381, ept: 107.1672
    Epoch [4/50], Test Losses: mse: 0.1750, mae: 0.3006, huber: 0.0862, swd: 0.0581, ept: 136.5229
      Epoch 4 composite train-obj: 0.121215
            No improvement (0.1595), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3069, mae: 0.3285, huber: 0.1168, swd: 0.1265, ept: 133.3382
    Epoch [5/50], Val Losses: mse: 0.3888, mae: 0.4433, huber: 0.1787, swd: 0.1584, ept: 101.5583
    Epoch [5/50], Test Losses: mse: 0.1795, mae: 0.3033, huber: 0.0881, swd: 0.0596, ept: 135.1319
      Epoch 5 composite train-obj: 0.116776
            No improvement (0.1787), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.2961, mae: 0.3230, huber: 0.1132, swd: 0.1204, ept: 133.9308
    Epoch [6/50], Val Losses: mse: 0.3578, mae: 0.4247, huber: 0.1660, swd: 0.1452, ept: 105.3433
    Epoch [6/50], Test Losses: mse: 0.1873, mae: 0.3097, huber: 0.0919, swd: 0.0618, ept: 134.6414
      Epoch 6 composite train-obj: 0.113209
            No improvement (0.1660), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.2876, mae: 0.3182, huber: 0.1101, swd: 0.1165, ept: 134.5320
    Epoch [7/50], Val Losses: mse: 0.3618, mae: 0.4241, huber: 0.1673, swd: 0.1472, ept: 104.2605
    Epoch [7/50], Test Losses: mse: 0.1816, mae: 0.3037, huber: 0.0890, swd: 0.0586, ept: 134.8620
      Epoch 7 composite train-obj: 0.110057
    Epoch [7/50], Test Losses: mse: 0.1766, mae: 0.3009, huber: 0.0869, swd: 0.0563, ept: 134.5509
    Best round's Test MSE: 0.1766, MAE: 0.3009, SWD: 0.0563
    Best round's Validation MSE: 0.3372, MAE: 0.4134, SWD: 0.1340
    Best round's Test verification MSE : 0.1766, MAE: 0.3009, SWD: 0.0563
    Time taken: 27.64 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4166, mae: 0.3855, huber: 0.1553, swd: 0.1567, ept: 118.8375
    Epoch [1/50], Val Losses: mse: 0.3361, mae: 0.4142, huber: 0.1570, swd: 0.1354, ept: 105.0941
    Epoch [1/50], Test Losses: mse: 0.1692, mae: 0.2918, huber: 0.0832, swd: 0.0565, ept: 134.0801
      Epoch 1 composite train-obj: 0.155258
            Val objective improved inf → 0.1570, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3579, mae: 0.3555, huber: 0.1345, swd: 0.1426, ept: 128.6300
    Epoch [2/50], Val Losses: mse: 0.3331, mae: 0.4085, huber: 0.1554, swd: 0.1332, ept: 108.0987
    Epoch [2/50], Test Losses: mse: 0.1778, mae: 0.3001, huber: 0.0871, swd: 0.0599, ept: 135.3872
      Epoch 2 composite train-obj: 0.134471
            Val objective improved 0.1570 → 0.1554, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3351, mae: 0.3444, huber: 0.1270, swd: 0.1354, ept: 130.6321
    Epoch [3/50], Val Losses: mse: 0.3296, mae: 0.4084, huber: 0.1541, swd: 0.1334, ept: 106.6396
    Epoch [3/50], Test Losses: mse: 0.1741, mae: 0.2993, huber: 0.0857, swd: 0.0570, ept: 135.6672
      Epoch 3 composite train-obj: 0.126986
            Val objective improved 0.1554 → 0.1541, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.3181, mae: 0.3353, huber: 0.1212, swd: 0.1300, ept: 131.9751
    Epoch [4/50], Val Losses: mse: 0.3453, mae: 0.4165, huber: 0.1601, swd: 0.1484, ept: 106.5461
    Epoch [4/50], Test Losses: mse: 0.1683, mae: 0.2915, huber: 0.0827, swd: 0.0587, ept: 135.2013
      Epoch 4 composite train-obj: 0.121236
            No improvement (0.1601), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.3085, mae: 0.3297, huber: 0.1177, swd: 0.1270, ept: 132.9042
    Epoch [5/50], Val Losses: mse: 0.3737, mae: 0.4259, huber: 0.1698, swd: 0.1679, ept: 105.2026
    Epoch [5/50], Test Losses: mse: 0.1828, mae: 0.3057, huber: 0.0896, swd: 0.0621, ept: 134.4656
      Epoch 5 composite train-obj: 0.117706
            No improvement (0.1698), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.2918, mae: 0.3221, huber: 0.1125, swd: 0.1176, ept: 133.5087
    Epoch [6/50], Val Losses: mse: 0.3608, mae: 0.4219, huber: 0.1648, swd: 0.1609, ept: 105.8304
    Epoch [6/50], Test Losses: mse: 0.1862, mae: 0.3102, huber: 0.0915, swd: 0.0615, ept: 133.6319
      Epoch 6 composite train-obj: 0.112497
            No improvement (0.1648), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.2856, mae: 0.3182, huber: 0.1100, swd: 0.1152, ept: 134.2905
    Epoch [7/50], Val Losses: mse: 0.3791, mae: 0.4302, huber: 0.1713, swd: 0.1671, ept: 104.7489
    Epoch [7/50], Test Losses: mse: 0.1876, mae: 0.3115, huber: 0.0920, swd: 0.0630, ept: 134.6049
      Epoch 7 composite train-obj: 0.110016
            No improvement (0.1713), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.2728, mae: 0.3121, huber: 0.1058, swd: 0.1077, ept: 134.9104
    Epoch [8/50], Val Losses: mse: 0.3696, mae: 0.4277, huber: 0.1680, swd: 0.1592, ept: 104.4146
    Epoch [8/50], Test Losses: mse: 0.1845, mae: 0.3072, huber: 0.0905, swd: 0.0623, ept: 134.6913
      Epoch 8 composite train-obj: 0.105821
    Epoch [8/50], Test Losses: mse: 0.1741, mae: 0.2993, huber: 0.0857, swd: 0.0570, ept: 135.6672
    Best round's Test MSE: 0.1741, MAE: 0.2993, SWD: 0.0570
    Best round's Validation MSE: 0.3296, MAE: 0.4084, SWD: 0.1334
    Best round's Test verification MSE : 0.1741, MAE: 0.2993, SWD: 0.0570
    Time taken: 31.34 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4139, mae: 0.3849, huber: 0.1545, swd: 0.1401, ept: 119.2628
    Epoch [1/50], Val Losses: mse: 0.3252, mae: 0.4026, huber: 0.1522, swd: 0.1128, ept: 107.5623
    Epoch [1/50], Test Losses: mse: 0.1636, mae: 0.2856, huber: 0.0804, swd: 0.0468, ept: 134.9627
      Epoch 1 composite train-obj: 0.154455
            Val objective improved inf → 0.1522, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3627, mae: 0.3576, huber: 0.1361, swd: 0.1289, ept: 128.8075
    Epoch [2/50], Val Losses: mse: 0.3250, mae: 0.4055, huber: 0.1524, swd: 0.1145, ept: 109.6940
    Epoch [2/50], Test Losses: mse: 0.1758, mae: 0.3031, huber: 0.0866, swd: 0.0503, ept: 139.5105
      Epoch 2 composite train-obj: 0.136092
            No improvement (0.1524), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3389, mae: 0.3464, huber: 0.1283, swd: 0.1240, ept: 130.4339
    Epoch [3/50], Val Losses: mse: 0.3477, mae: 0.4163, huber: 0.1611, swd: 0.1298, ept: 105.4688
    Epoch [3/50], Test Losses: mse: 0.1682, mae: 0.2918, huber: 0.0827, swd: 0.0474, ept: 137.3724
      Epoch 3 composite train-obj: 0.128313
            No improvement (0.1611), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.3228, mae: 0.3389, huber: 0.1233, swd: 0.1191, ept: 131.3450
    Epoch [4/50], Val Losses: mse: 0.3458, mae: 0.4224, huber: 0.1618, swd: 0.1202, ept: 106.0993
    Epoch [4/50], Test Losses: mse: 0.1848, mae: 0.3107, huber: 0.0909, swd: 0.0486, ept: 137.7918
      Epoch 4 composite train-obj: 0.123320
            No improvement (0.1618), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.3070, mae: 0.3310, huber: 0.1180, swd: 0.1129, ept: 132.2645
    Epoch [5/50], Val Losses: mse: 0.3292, mae: 0.4111, huber: 0.1548, swd: 0.1125, ept: 108.3987
    Epoch [5/50], Test Losses: mse: 0.1761, mae: 0.3033, huber: 0.0868, swd: 0.0471, ept: 137.2879
      Epoch 5 composite train-obj: 0.117983
            No improvement (0.1548), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.2977, mae: 0.3250, huber: 0.1144, swd: 0.1092, ept: 133.7041
    Epoch [6/50], Val Losses: mse: 0.3389, mae: 0.4190, huber: 0.1593, swd: 0.1195, ept: 107.6827
    Epoch [6/50], Test Losses: mse: 0.1830, mae: 0.3099, huber: 0.0901, swd: 0.0513, ept: 137.2876
      Epoch 6 composite train-obj: 0.114389
    Epoch [6/50], Test Losses: mse: 0.1636, mae: 0.2856, huber: 0.0804, swd: 0.0468, ept: 134.9627
    Best round's Test MSE: 0.1636, MAE: 0.2856, SWD: 0.0468
    Best round's Validation MSE: 0.3252, MAE: 0.4026, SWD: 0.1128
    Best round's Test verification MSE : 0.1636, MAE: 0.2856, SWD: 0.0468
    Time taken: 23.45 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq336_pred196_20250510_2132)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1714 ± 0.0056
      mae: 0.2953 ± 0.0069
      huber: 0.0843 ± 0.0028
      swd: 0.0534 ± 0.0046
      ept: 135.0603 ± 0.4609
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3307 ± 0.0050
      mae: 0.4081 ± 0.0044
      huber: 0.1545 ± 0.0020
      swd: 0.1267 ± 0.0099
      ept: 106.4862 ± 0.9475
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 82.50 seconds
    
    Experiment complete: PatchTST_etth2_seq336_pred196_20250510_2132
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=336,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 91
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 91
    Validation Batches: 9
    Test Batches: 22
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4994, mae: 0.4239, huber: 0.1818, swd: 0.1842, ept: 169.3640
    Epoch [1/50], Val Losses: mse: 0.3571, mae: 0.4274, huber: 0.1671, swd: 0.1189, ept: 152.5339
    Epoch [1/50], Test Losses: mse: 0.2053, mae: 0.3229, huber: 0.1002, swd: 0.0578, ept: 192.6727
      Epoch 1 composite train-obj: 0.181784
            Val objective improved inf → 0.1671, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4425, mae: 0.3963, huber: 0.1617, swd: 0.1779, ept: 184.0112
    Epoch [2/50], Val Losses: mse: 0.5125, mae: 0.5237, huber: 0.2288, swd: 0.1924, ept: 136.2829
    Epoch [2/50], Test Losses: mse: 0.2113, mae: 0.3291, huber: 0.1026, swd: 0.0669, ept: 182.2845
      Epoch 2 composite train-obj: 0.161730
            No improvement (0.2288), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4402, mae: 0.3960, huber: 0.1612, swd: 0.1784, ept: 185.5654
    Epoch [3/50], Val Losses: mse: 0.3673, mae: 0.4392, huber: 0.1706, swd: 0.1342, ept: 153.8093
    Epoch [3/50], Test Losses: mse: 0.1916, mae: 0.3117, huber: 0.0940, swd: 0.0563, ept: 198.2589
      Epoch 3 composite train-obj: 0.161247
            No improvement (0.1706), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.4036, mae: 0.3754, huber: 0.1476, swd: 0.1646, ept: 189.4278
    Epoch [4/50], Val Losses: mse: 0.3845, mae: 0.4458, huber: 0.1774, swd: 0.1463, ept: 150.3406
    Epoch [4/50], Test Losses: mse: 0.2000, mae: 0.3195, huber: 0.0978, swd: 0.0593, ept: 194.3312
      Epoch 4 composite train-obj: 0.147560
            No improvement (0.1774), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.3918, mae: 0.3684, huber: 0.1432, swd: 0.1605, ept: 191.6344
    Epoch [5/50], Val Losses: mse: 0.3933, mae: 0.4489, huber: 0.1800, swd: 0.1531, ept: 152.1352
    Epoch [5/50], Test Losses: mse: 0.1863, mae: 0.3070, huber: 0.0914, swd: 0.0587, ept: 196.7339
      Epoch 5 composite train-obj: 0.143170
            No improvement (0.1800), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.3820, mae: 0.3622, huber: 0.1392, swd: 0.1570, ept: 192.5861
    Epoch [6/50], Val Losses: mse: 0.3998, mae: 0.4560, huber: 0.1834, swd: 0.1451, ept: 152.7502
    Epoch [6/50], Test Losses: mse: 0.2069, mae: 0.3270, huber: 0.1013, swd: 0.0625, ept: 196.5408
      Epoch 6 composite train-obj: 0.139230
    Epoch [6/50], Test Losses: mse: 0.2053, mae: 0.3229, huber: 0.1002, swd: 0.0578, ept: 192.6727
    Best round's Test MSE: 0.2053, MAE: 0.3229, SWD: 0.0578
    Best round's Validation MSE: 0.3571, MAE: 0.4274, SWD: 0.1189
    Best round's Test verification MSE : 0.2053, MAE: 0.3229, SWD: 0.0578
    Time taken: 23.46 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5011, mae: 0.4251, huber: 0.1824, swd: 0.1919, ept: 168.5649
    Epoch [1/50], Val Losses: mse: 0.4375, mae: 0.4770, huber: 0.1992, swd: 0.1690, ept: 139.2824
    Epoch [1/50], Test Losses: mse: 0.1920, mae: 0.3095, huber: 0.0935, swd: 0.0640, ept: 180.8947
      Epoch 1 composite train-obj: 0.182397
            Val objective improved inf → 0.1992, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4635, mae: 0.4066, huber: 0.1690, swd: 0.1850, ept: 179.9705
    Epoch [2/50], Val Losses: mse: 0.3732, mae: 0.4395, huber: 0.1728, swd: 0.1417, ept: 145.9820
    Epoch [2/50], Test Losses: mse: 0.1969, mae: 0.3161, huber: 0.0962, swd: 0.0598, ept: 190.7133
      Epoch 2 composite train-obj: 0.169042
            Val objective improved 0.1992 → 0.1728, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4237, mae: 0.3859, huber: 0.1546, swd: 0.1727, ept: 186.2518
    Epoch [3/50], Val Losses: mse: 0.3914, mae: 0.4485, huber: 0.1792, swd: 0.1551, ept: 146.0300
    Epoch [3/50], Test Losses: mse: 0.1932, mae: 0.3150, huber: 0.0945, swd: 0.0590, ept: 192.5148
      Epoch 3 composite train-obj: 0.154571
            No improvement (0.1792), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4062, mae: 0.3770, huber: 0.1487, swd: 0.1690, ept: 188.2839
    Epoch [4/50], Val Losses: mse: 0.3679, mae: 0.4404, huber: 0.1731, swd: 0.1148, ept: 147.2970
    Epoch [4/50], Test Losses: mse: 0.2559, mae: 0.3615, huber: 0.1232, swd: 0.0839, ept: 188.3035
      Epoch 4 composite train-obj: 0.148654
            No improvement (0.1731), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.4020, mae: 0.3740, huber: 0.1468, swd: 0.1686, ept: 189.6354
    Epoch [5/50], Val Losses: mse: 0.4349, mae: 0.4726, huber: 0.1968, swd: 0.1700, ept: 143.5531
    Epoch [5/50], Test Losses: mse: 0.2043, mae: 0.3233, huber: 0.0997, swd: 0.0636, ept: 191.9321
      Epoch 5 composite train-obj: 0.146778
            No improvement (0.1968), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.3912, mae: 0.3664, huber: 0.1422, swd: 0.1635, ept: 191.4200
    Epoch [6/50], Val Losses: mse: 0.3711, mae: 0.4370, huber: 0.1723, swd: 0.1377, ept: 154.7253
    Epoch [6/50], Test Losses: mse: 0.2040, mae: 0.3225, huber: 0.0998, swd: 0.0600, ept: 192.7241
      Epoch 6 composite train-obj: 0.142203
            Val objective improved 0.1728 → 0.1723, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.3728, mae: 0.3571, huber: 0.1360, swd: 0.1545, ept: 193.3271
    Epoch [7/50], Val Losses: mse: 0.3915, mae: 0.4533, huber: 0.1807, swd: 0.1434, ept: 146.4250
    Epoch [7/50], Test Losses: mse: 0.2080, mae: 0.3253, huber: 0.1014, swd: 0.0605, ept: 190.3211
      Epoch 7 composite train-obj: 0.136010
            No improvement (0.1807), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.3661, mae: 0.3536, huber: 0.1336, swd: 0.1500, ept: 192.9359
    Epoch [8/50], Val Losses: mse: 0.3659, mae: 0.4380, huber: 0.1702, swd: 0.1259, ept: 156.4508
    Epoch [8/50], Test Losses: mse: 0.2157, mae: 0.3339, huber: 0.1054, swd: 0.0667, ept: 194.5885
      Epoch 8 composite train-obj: 0.133597
            Val objective improved 0.1723 → 0.1702, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 0.3629, mae: 0.3503, huber: 0.1318, swd: 0.1515, ept: 193.6893
    Epoch [9/50], Val Losses: mse: 0.3970, mae: 0.4496, huber: 0.1816, swd: 0.1531, ept: 148.7130
    Epoch [9/50], Test Losses: mse: 0.2181, mae: 0.3338, huber: 0.1061, swd: 0.0676, ept: 189.0719
      Epoch 9 composite train-obj: 0.131785
            No improvement (0.1816), counter 1/5
    Epoch [10/50], Train Losses: mse: 0.3611, mae: 0.3520, huber: 0.1323, swd: 0.1505, ept: 194.0461
    Epoch [10/50], Val Losses: mse: 0.3894, mae: 0.4472, huber: 0.1789, swd: 0.1456, ept: 156.5896
    Epoch [10/50], Test Losses: mse: 0.2226, mae: 0.3360, huber: 0.1081, swd: 0.0682, ept: 193.6095
      Epoch 10 composite train-obj: 0.132282
            No improvement (0.1789), counter 2/5
    Epoch [11/50], Train Losses: mse: 0.3427, mae: 0.3408, huber: 0.1253, swd: 0.1383, ept: 195.8436
    Epoch [11/50], Val Losses: mse: 0.3995, mae: 0.4547, huber: 0.1835, swd: 0.1377, ept: 155.1673
    Epoch [11/50], Test Losses: mse: 0.2367, mae: 0.3481, huber: 0.1146, swd: 0.0761, ept: 189.8190
      Epoch 11 composite train-obj: 0.125279
            No improvement (0.1835), counter 3/5
    Epoch [12/50], Train Losses: mse: 0.3355, mae: 0.3380, huber: 0.1231, swd: 0.1335, ept: 195.2471
    Epoch [12/50], Val Losses: mse: 0.4326, mae: 0.4808, huber: 0.1981, swd: 0.1305, ept: 144.8914
    Epoch [12/50], Test Losses: mse: 0.2911, mae: 0.3826, huber: 0.1363, swd: 0.1111, ept: 177.5397
      Epoch 12 composite train-obj: 0.123100
            No improvement (0.1981), counter 4/5
    Epoch [13/50], Train Losses: mse: 0.3861, mae: 0.3636, huber: 0.1401, swd: 0.1640, ept: 191.4151
    Epoch [13/50], Val Losses: mse: 0.4561, mae: 0.4804, huber: 0.2040, swd: 0.1825, ept: 147.3489
    Epoch [13/50], Test Losses: mse: 0.2218, mae: 0.3369, huber: 0.1076, swd: 0.0710, ept: 189.9623
      Epoch 13 composite train-obj: 0.140106
    Epoch [13/50], Test Losses: mse: 0.2157, mae: 0.3339, huber: 0.1054, swd: 0.0667, ept: 194.5885
    Best round's Test MSE: 0.2157, MAE: 0.3339, SWD: 0.0667
    Best round's Validation MSE: 0.3659, MAE: 0.4380, SWD: 0.1259
    Best round's Test verification MSE : 0.2157, MAE: 0.3339, SWD: 0.0667
    Time taken: 50.72 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4986, mae: 0.4247, huber: 0.1817, swd: 0.1838, ept: 168.6737
    Epoch [1/50], Val Losses: mse: 0.3643, mae: 0.4401, huber: 0.1710, swd: 0.1069, ept: 146.9500
    Epoch [1/50], Test Losses: mse: 0.2223, mae: 0.3437, huber: 0.1088, swd: 0.0637, ept: 191.6473
      Epoch 1 composite train-obj: 0.181719
            Val objective improved inf → 0.1710, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4481, mae: 0.3990, huber: 0.1636, swd: 0.1761, ept: 182.4787
    Epoch [2/50], Val Losses: mse: 0.3712, mae: 0.4415, huber: 0.1739, swd: 0.1116, ept: 146.4111
    Epoch [2/50], Test Losses: mse: 0.2278, mae: 0.3479, huber: 0.1112, swd: 0.0627, ept: 187.8044
      Epoch 2 composite train-obj: 0.163618
            No improvement (0.1739), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4407, mae: 0.3976, huber: 0.1615, swd: 0.1741, ept: 181.8802
    Epoch [3/50], Val Losses: mse: 0.3685, mae: 0.4412, huber: 0.1723, swd: 0.1140, ept: 146.1966
    Epoch [3/50], Test Losses: mse: 0.2280, mae: 0.3497, huber: 0.1115, swd: 0.0642, ept: 188.6962
      Epoch 3 composite train-obj: 0.161538
            No improvement (0.1723), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.4194, mae: 0.3860, huber: 0.1539, swd: 0.1666, ept: 186.0284
    Epoch [4/50], Val Losses: mse: 0.3443, mae: 0.4232, huber: 0.1619, swd: 0.1038, ept: 153.1904
    Epoch [4/50], Test Losses: mse: 0.2180, mae: 0.3369, huber: 0.1067, swd: 0.0626, ept: 194.2323
      Epoch 4 composite train-obj: 0.153878
            Val objective improved 0.1710 → 0.1619, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.4026, mae: 0.3756, huber: 0.1472, swd: 0.1628, ept: 189.0695
    Epoch [5/50], Val Losses: mse: 0.3729, mae: 0.4337, huber: 0.1720, swd: 0.1402, ept: 150.0968
    Epoch [5/50], Test Losses: mse: 0.1896, mae: 0.3109, huber: 0.0931, swd: 0.0542, ept: 193.7072
      Epoch 5 composite train-obj: 0.147224
            No improvement (0.1720), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.3868, mae: 0.3672, huber: 0.1417, swd: 0.1577, ept: 190.4293
    Epoch [6/50], Val Losses: mse: 0.3606, mae: 0.4330, huber: 0.1674, swd: 0.1290, ept: 152.8089
    Epoch [6/50], Test Losses: mse: 0.1944, mae: 0.3156, huber: 0.0953, swd: 0.0570, ept: 196.4349
      Epoch 6 composite train-obj: 0.141750
            No improvement (0.1674), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.3771, mae: 0.3615, huber: 0.1381, swd: 0.1538, ept: 191.7832
    Epoch [7/50], Val Losses: mse: 0.3603, mae: 0.4294, huber: 0.1674, swd: 0.1250, ept: 156.7522
    Epoch [7/50], Test Losses: mse: 0.2101, mae: 0.3300, huber: 0.1029, swd: 0.0621, ept: 195.3911
      Epoch 7 composite train-obj: 0.138050
            No improvement (0.1674), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.3904, mae: 0.3624, huber: 0.1403, swd: 0.1660, ept: 192.1288
    Epoch [8/50], Val Losses: mse: 0.3862, mae: 0.4458, huber: 0.1773, swd: 0.1407, ept: 146.6286
    Epoch [8/50], Test Losses: mse: 0.2001, mae: 0.3217, huber: 0.0979, swd: 0.0577, ept: 191.6659
      Epoch 8 composite train-obj: 0.140279
            No improvement (0.1773), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.3814, mae: 0.3648, huber: 0.1401, swd: 0.1546, ept: 189.7274
    Epoch [9/50], Val Losses: mse: 0.4046, mae: 0.4600, huber: 0.1856, swd: 0.1323, ept: 140.7095
    Epoch [9/50], Test Losses: mse: 0.2321, mae: 0.3472, huber: 0.1124, swd: 0.0673, ept: 184.5640
      Epoch 9 composite train-obj: 0.140074
    Epoch [9/50], Test Losses: mse: 0.2180, mae: 0.3369, huber: 0.1067, swd: 0.0626, ept: 194.2323
    Best round's Test MSE: 0.2180, MAE: 0.3369, SWD: 0.0626
    Best round's Validation MSE: 0.3443, MAE: 0.4232, SWD: 0.1038
    Best round's Test verification MSE : 0.2180, MAE: 0.3369, SWD: 0.0626
    Time taken: 35.16 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq336_pred336_20250510_2134)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2130 ± 0.0055
      mae: 0.3313 ± 0.0060
      huber: 0.1041 ± 0.0028
      swd: 0.0624 ± 0.0036
      ept: 193.8312 ± 0.8320
      count: 9.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3558 ± 0.0089
      mae: 0.4296 ± 0.0062
      huber: 0.1664 ± 0.0034
      swd: 0.1162 ± 0.0092
      ept: 154.0584 ± 1.7128
      count: 9.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 109.42 seconds
    
    Experiment complete: PatchTST_etth2_seq336_pred336_20250510_2134
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=336,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7167, mae: 0.5197, huber: 0.2507, swd: 0.2705, ept: 260.7004
    Epoch [1/50], Val Losses: mse: 0.4303, mae: 0.4805, huber: 0.1996, swd: 0.0829, ept: 251.9685
    Epoch [1/50], Test Losses: mse: 0.2462, mae: 0.3555, huber: 0.1191, swd: 0.0648, ept: 311.6887
      Epoch 1 composite train-obj: 0.250672
            Val objective improved inf → 0.1996, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.6574, mae: 0.4936, huber: 0.2307, swd: 0.2638, ept: 280.7620
    Epoch [2/50], Val Losses: mse: 0.4519, mae: 0.5001, huber: 0.2097, swd: 0.0996, ept: 244.8797
    Epoch [2/50], Test Losses: mse: 0.2966, mae: 0.3955, huber: 0.1418, swd: 0.0785, ept: 306.9473
      Epoch 2 composite train-obj: 0.230683
            No improvement (0.2097), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.6269, mae: 0.4760, huber: 0.2183, swd: 0.2581, ept: 287.3513
    Epoch [3/50], Val Losses: mse: 0.4149, mae: 0.4792, huber: 0.1945, swd: 0.0968, ept: 255.3592
    Epoch [3/50], Test Losses: mse: 0.2507, mae: 0.3614, huber: 0.1211, swd: 0.0638, ept: 321.9180
      Epoch 3 composite train-obj: 0.218340
            Val objective improved 0.1996 → 0.1945, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.6063, mae: 0.4623, huber: 0.2096, swd: 0.2528, ept: 291.3207
    Epoch [4/50], Val Losses: mse: 0.4723, mae: 0.5179, huber: 0.2185, swd: 0.1339, ept: 245.5321
    Epoch [4/50], Test Losses: mse: 0.2590, mae: 0.3690, huber: 0.1246, swd: 0.0692, ept: 323.4874
      Epoch 4 composite train-obj: 0.209581
            No improvement (0.2185), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.5885, mae: 0.4531, huber: 0.2032, swd: 0.2445, ept: 293.1266
    Epoch [5/50], Val Losses: mse: 0.4241, mae: 0.4889, huber: 0.1985, swd: 0.1012, ept: 245.9816
    Epoch [5/50], Test Losses: mse: 0.2698, mae: 0.3729, huber: 0.1291, swd: 0.0766, ept: 319.5420
      Epoch 5 composite train-obj: 0.203201
            No improvement (0.1985), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.5621, mae: 0.4422, huber: 0.1950, swd: 0.2290, ept: 295.7262
    Epoch [6/50], Val Losses: mse: 0.4453, mae: 0.4978, huber: 0.2063, swd: 0.1026, ept: 245.8449
    Epoch [6/50], Test Losses: mse: 0.3293, mae: 0.4103, huber: 0.1545, swd: 0.1018, ept: 320.9057
      Epoch 6 composite train-obj: 0.194973
            No improvement (0.2063), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.5489, mae: 0.4343, huber: 0.1897, swd: 0.2240, ept: 298.3510
    Epoch [7/50], Val Losses: mse: 0.4013, mae: 0.4721, huber: 0.1885, swd: 0.0956, ept: 248.8004
    Epoch [7/50], Test Losses: mse: 0.2804, mae: 0.3783, huber: 0.1335, swd: 0.0828, ept: 316.0005
      Epoch 7 composite train-obj: 0.189712
            Val objective improved 0.1945 → 0.1885, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 0.5406, mae: 0.4294, huber: 0.1864, swd: 0.2194, ept: 297.7562
    Epoch [8/50], Val Losses: mse: 0.4470, mae: 0.5042, huber: 0.2089, swd: 0.1500, ept: 241.0028
    Epoch [8/50], Test Losses: mse: 0.2408, mae: 0.3514, huber: 0.1160, swd: 0.0732, ept: 314.0060
      Epoch 8 composite train-obj: 0.186417
            No improvement (0.2089), counter 1/5
    Epoch [9/50], Train Losses: mse: 0.5443, mae: 0.4304, huber: 0.1874, swd: 0.2199, ept: 297.6309
    Epoch [9/50], Val Losses: mse: 0.4111, mae: 0.4795, huber: 0.1931, swd: 0.0987, ept: 248.4987
    Epoch [9/50], Test Losses: mse: 0.2933, mae: 0.3890, huber: 0.1394, swd: 0.0891, ept: 318.2798
      Epoch 9 composite train-obj: 0.187405
            No improvement (0.1931), counter 2/5
    Epoch [10/50], Train Losses: mse: 0.5281, mae: 0.4215, huber: 0.1813, swd: 0.2136, ept: 299.2818
    Epoch [10/50], Val Losses: mse: 0.4134, mae: 0.4814, huber: 0.1942, swd: 0.1064, ept: 247.2077
    Epoch [10/50], Test Losses: mse: 0.2852, mae: 0.3830, huber: 0.1359, swd: 0.0850, ept: 316.7248
      Epoch 10 composite train-obj: 0.181305
            No improvement (0.1942), counter 3/5
    Epoch [11/50], Train Losses: mse: 0.5160, mae: 0.4129, huber: 0.1761, swd: 0.2084, ept: 300.2190
    Epoch [11/50], Val Losses: mse: 0.4270, mae: 0.4866, huber: 0.1992, swd: 0.1035, ept: 239.5216
    Epoch [11/50], Test Losses: mse: 0.3073, mae: 0.3952, huber: 0.1444, swd: 0.0990, ept: 307.0457
      Epoch 11 composite train-obj: 0.176096
            No improvement (0.1992), counter 4/5
    Epoch [12/50], Train Losses: mse: 0.5107, mae: 0.4112, huber: 0.1746, swd: 0.2065, ept: 302.1882
    Epoch [12/50], Val Losses: mse: 0.3935, mae: 0.4712, huber: 0.1858, swd: 0.1080, ept: 249.9810
    Epoch [12/50], Test Losses: mse: 0.2618, mae: 0.3670, huber: 0.1256, swd: 0.0798, ept: 314.3249
      Epoch 12 composite train-obj: 0.174579
            Val objective improved 0.1885 → 0.1858, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 0.5025, mae: 0.4062, huber: 0.1714, swd: 0.2031, ept: 303.0197
    Epoch [13/50], Val Losses: mse: 0.4241, mae: 0.4843, huber: 0.1976, swd: 0.1154, ept: 251.8920
    Epoch [13/50], Test Losses: mse: 0.3311, mae: 0.4097, huber: 0.1544, swd: 0.1112, ept: 312.8722
      Epoch 13 composite train-obj: 0.171415
            No improvement (0.1976), counter 1/5
    Epoch [14/50], Train Losses: mse: 0.4929, mae: 0.4001, huber: 0.1677, swd: 0.1991, ept: 303.8485
    Epoch [14/50], Val Losses: mse: 0.4046, mae: 0.4746, huber: 0.1900, swd: 0.0988, ept: 259.0393
    Epoch [14/50], Test Losses: mse: 0.3203, mae: 0.4048, huber: 0.1507, swd: 0.1030, ept: 315.6748
      Epoch 14 composite train-obj: 0.167685
            No improvement (0.1900), counter 2/5
    Epoch [15/50], Train Losses: mse: 0.4921, mae: 0.3995, huber: 0.1672, swd: 0.1976, ept: 304.2474
    Epoch [15/50], Val Losses: mse: 0.4559, mae: 0.4998, huber: 0.2101, swd: 0.0955, ept: 249.8320
    Epoch [15/50], Test Losses: mse: 0.3869, mae: 0.4477, huber: 0.1782, swd: 0.1381, ept: 301.1844
      Epoch 15 composite train-obj: 0.167244
            No improvement (0.2101), counter 3/5
    Epoch [16/50], Train Losses: mse: 0.5171, mae: 0.4157, huber: 0.1772, swd: 0.2080, ept: 300.2971
    Epoch [16/50], Val Losses: mse: 0.4213, mae: 0.4884, huber: 0.1974, swd: 0.1270, ept: 249.0839
    Epoch [16/50], Test Losses: mse: 0.2634, mae: 0.3668, huber: 0.1259, swd: 0.0804, ept: 311.7909
      Epoch 16 composite train-obj: 0.177198
            No improvement (0.1974), counter 4/5
    Epoch [17/50], Train Losses: mse: 0.4946, mae: 0.4015, huber: 0.1683, swd: 0.1982, ept: 303.4759
    Epoch [17/50], Val Losses: mse: 0.4228, mae: 0.4833, huber: 0.1968, swd: 0.1139, ept: 248.0891
    Epoch [17/50], Test Losses: mse: 0.3108, mae: 0.3993, huber: 0.1462, swd: 0.1012, ept: 308.7220
      Epoch 17 composite train-obj: 0.168323
    Epoch [17/50], Test Losses: mse: 0.2618, mae: 0.3670, huber: 0.1256, swd: 0.0798, ept: 314.3249
    Best round's Test MSE: 0.2618, MAE: 0.3670, SWD: 0.0798
    Best round's Validation MSE: 0.3935, MAE: 0.4712, SWD: 0.1080
    Best round's Test verification MSE : 0.2618, MAE: 0.3670, SWD: 0.0798
    Time taken: 66.12 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7110, mae: 0.5185, huber: 0.2494, swd: 0.2561, ept: 262.4651
    Epoch [1/50], Val Losses: mse: 0.4823, mae: 0.5156, huber: 0.2218, swd: 0.0909, ept: 252.9154
    Epoch [1/50], Test Losses: mse: 0.2864, mae: 0.3915, huber: 0.1379, swd: 0.0700, ept: 311.5513
      Epoch 1 composite train-obj: 0.249357
            Val objective improved inf → 0.2218, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.6592, mae: 0.4927, huber: 0.2304, swd: 0.2540, ept: 283.3558
    Epoch [2/50], Val Losses: mse: 0.4172, mae: 0.4762, huber: 0.1953, swd: 0.1013, ept: 262.3095
    Epoch [2/50], Test Losses: mse: 0.2437, mae: 0.3544, huber: 0.1177, swd: 0.0621, ept: 316.6763
      Epoch 2 composite train-obj: 0.230366
            Val objective improved 0.2218 → 0.1953, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.6162, mae: 0.4731, huber: 0.2157, swd: 0.2379, ept: 286.5027
    Epoch [3/50], Val Losses: mse: 0.4616, mae: 0.5057, huber: 0.2127, swd: 0.1009, ept: 247.7698
    Epoch [3/50], Test Losses: mse: 0.3458, mae: 0.4306, huber: 0.1634, swd: 0.1010, ept: 309.9734
      Epoch 3 composite train-obj: 0.215657
            No improvement (0.2127), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.5964, mae: 0.4617, huber: 0.2078, swd: 0.2303, ept: 288.1164
    Epoch [4/50], Val Losses: mse: 0.4282, mae: 0.4890, huber: 0.1994, swd: 0.1157, ept: 259.3605
    Epoch [4/50], Test Losses: mse: 0.2429, mae: 0.3503, huber: 0.1171, swd: 0.0640, ept: 319.9094
      Epoch 4 composite train-obj: 0.207816
            No improvement (0.1994), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.5691, mae: 0.4467, huber: 0.1976, swd: 0.2188, ept: 292.8071
    Epoch [5/50], Val Losses: mse: 0.4157, mae: 0.4791, huber: 0.1938, swd: 0.1085, ept: 261.3735
    Epoch [5/50], Test Losses: mse: 0.2592, mae: 0.3609, huber: 0.1235, swd: 0.0740, ept: 317.1250
      Epoch 5 composite train-obj: 0.197572
            Val objective improved 0.1953 → 0.1938, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.5544, mae: 0.4382, huber: 0.1920, swd: 0.2133, ept: 294.5011
    Epoch [6/50], Val Losses: mse: 0.4650, mae: 0.5016, huber: 0.2113, swd: 0.1347, ept: 264.9038
    Epoch [6/50], Test Losses: mse: 0.2918, mae: 0.3746, huber: 0.1349, swd: 0.0927, ept: 314.2447
      Epoch 6 composite train-obj: 0.191957
            No improvement (0.2113), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.5452, mae: 0.4336, huber: 0.1887, swd: 0.2090, ept: 296.4122
    Epoch [7/50], Val Losses: mse: 0.4358, mae: 0.4874, huber: 0.2007, swd: 0.1062, ept: 267.2735
    Epoch [7/50], Test Losses: mse: 0.3009, mae: 0.3866, huber: 0.1404, swd: 0.0901, ept: 317.0281
      Epoch 7 composite train-obj: 0.188654
            No improvement (0.2007), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.5288, mae: 0.4236, huber: 0.1821, swd: 0.2016, ept: 298.8529
    Epoch [8/50], Val Losses: mse: 0.4564, mae: 0.4977, huber: 0.2074, swd: 0.1261, ept: 274.0398
    Epoch [8/50], Test Losses: mse: 0.2914, mae: 0.3809, huber: 0.1366, swd: 0.0845, ept: 315.1581
      Epoch 8 composite train-obj: 0.182127
            No improvement (0.2074), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.5469, mae: 0.4328, huber: 0.1882, swd: 0.2063, ept: 294.9161
    Epoch [9/50], Val Losses: mse: 0.4641, mae: 0.5026, huber: 0.2108, swd: 0.1247, ept: 252.4400
    Epoch [9/50], Test Losses: mse: 0.2806, mae: 0.3739, huber: 0.1318, swd: 0.0804, ept: 319.2110
      Epoch 9 composite train-obj: 0.188246
            No improvement (0.2108), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.5152, mae: 0.4159, huber: 0.1770, swd: 0.1948, ept: 298.5673
    Epoch [10/50], Val Losses: mse: 0.4587, mae: 0.5050, huber: 0.2102, swd: 0.1132, ept: 244.0122
    Epoch [10/50], Test Losses: mse: 0.2908, mae: 0.3849, huber: 0.1375, swd: 0.0723, ept: 308.4195
      Epoch 10 composite train-obj: 0.177005
    Epoch [10/50], Test Losses: mse: 0.2592, mae: 0.3609, huber: 0.1235, swd: 0.0740, ept: 317.1250
    Best round's Test MSE: 0.2592, MAE: 0.3609, SWD: 0.0740
    Best round's Validation MSE: 0.4157, MAE: 0.4791, SWD: 0.1085
    Best round's Test verification MSE : 0.2592, MAE: 0.3609, SWD: 0.0740
    Time taken: 39.47 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7068, mae: 0.5168, huber: 0.2479, swd: 0.2826, ept: 261.9147
    Epoch [1/50], Val Losses: mse: 0.4863, mae: 0.5155, huber: 0.2230, swd: 0.1027, ept: 246.9305
    Epoch [1/50], Test Losses: mse: 0.2879, mae: 0.3853, huber: 0.1378, swd: 0.0894, ept: 305.4397
      Epoch 1 composite train-obj: 0.247892
            Val objective improved inf → 0.2230, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.6621, mae: 0.4967, huber: 0.2325, swd: 0.2763, ept: 280.3199
    Epoch [2/50], Val Losses: mse: 0.4262, mae: 0.4819, huber: 0.1992, swd: 0.0905, ept: 255.5779
    Epoch [2/50], Test Losses: mse: 0.2686, mae: 0.3771, huber: 0.1297, swd: 0.0757, ept: 320.5262
      Epoch 2 composite train-obj: 0.232529
            Val objective improved 0.2230 → 0.1992, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.6235, mae: 0.4791, huber: 0.2191, swd: 0.2647, ept: 285.1218
    Epoch [3/50], Val Losses: mse: 0.3934, mae: 0.4660, huber: 0.1852, swd: 0.0848, ept: 256.0587
    Epoch [3/50], Test Losses: mse: 0.2286, mae: 0.3436, huber: 0.1109, swd: 0.0583, ept: 325.2762
      Epoch 3 composite train-obj: 0.219061
            Val objective improved 0.1992 → 0.1852, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.6020, mae: 0.4679, huber: 0.2109, swd: 0.2555, ept: 288.5167
    Epoch [4/50], Val Losses: mse: 0.3971, mae: 0.4652, huber: 0.1865, swd: 0.0863, ept: 272.4796
    Epoch [4/50], Test Losses: mse: 0.2315, mae: 0.3464, huber: 0.1125, swd: 0.0612, ept: 329.0862
      Epoch 4 composite train-obj: 0.210919
            No improvement (0.1865), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.5932, mae: 0.4578, huber: 0.2051, swd: 0.2571, ept: 290.5820
    Epoch [5/50], Val Losses: mse: 0.3995, mae: 0.4709, huber: 0.1881, swd: 0.1025, ept: 259.1334
    Epoch [5/50], Test Losses: mse: 0.2446, mae: 0.3549, huber: 0.1180, swd: 0.0679, ept: 328.2508
      Epoch 5 composite train-obj: 0.205145
            No improvement (0.1881), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.5779, mae: 0.4477, huber: 0.1987, swd: 0.2462, ept: 291.9841
    Epoch [6/50], Val Losses: mse: 0.4032, mae: 0.4769, huber: 0.1900, swd: 0.1091, ept: 253.1623
    Epoch [6/50], Test Losses: mse: 0.2628, mae: 0.3697, huber: 0.1263, swd: 0.0783, ept: 321.2869
      Epoch 6 composite train-obj: 0.198678
            No improvement (0.1900), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.5427, mae: 0.4323, huber: 0.1874, swd: 0.2288, ept: 295.3087
    Epoch [7/50], Val Losses: mse: 0.4253, mae: 0.4893, huber: 0.1986, swd: 0.1045, ept: 240.3817
    Epoch [7/50], Test Losses: mse: 0.2664, mae: 0.3702, huber: 0.1272, swd: 0.0784, ept: 316.9183
      Epoch 7 composite train-obj: 0.187356
            No improvement (0.1986), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.5312, mae: 0.4253, huber: 0.1829, swd: 0.2227, ept: 296.9811
    Epoch [8/50], Val Losses: mse: 0.4420, mae: 0.4901, huber: 0.2037, swd: 0.1036, ept: 277.7996
    Epoch [8/50], Test Losses: mse: 0.3307, mae: 0.4114, huber: 0.1549, swd: 0.1138, ept: 322.0552
      Epoch 8 composite train-obj: 0.182905
    Epoch [8/50], Test Losses: mse: 0.2286, mae: 0.3436, huber: 0.1109, swd: 0.0583, ept: 325.2762
    Best round's Test MSE: 0.2286, MAE: 0.3436, SWD: 0.0583
    Best round's Validation MSE: 0.3934, MAE: 0.4660, SWD: 0.0848
    Best round's Test verification MSE : 0.2286, MAE: 0.3436, SWD: 0.0583
    Time taken: 31.53 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq336_pred720_20250510_2136)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2498 ± 0.0151
      mae: 0.3571 ± 0.0099
      huber: 0.1200 ± 0.0065
      swd: 0.0707 ± 0.0091
      ept: 318.9087 ± 4.6453
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.4009 ± 0.0105
      mae: 0.4721 ± 0.0054
      huber: 0.1882 ± 0.0039
      swd: 0.1004 ± 0.0111
      ept: 255.8044 ± 4.6544
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 137.24 seconds
    
    Experiment complete: PatchTST_etth2_seq336_pred720_20250510_2136
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### DLinear

#### pred=96


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=336,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3694, mae: 0.3683, huber: 0.1413, swd: 0.1406, ept: 68.9178
    Epoch [1/50], Val Losses: mse: 0.2783, mae: 0.3732, huber: 0.1325, swd: 0.1135, ept: 63.9532
    Epoch [1/50], Test Losses: mse: 0.1459, mae: 0.2713, huber: 0.0718, swd: 0.0477, ept: 78.0394
      Epoch 1 composite train-obj: 0.141316
            Val objective improved inf → 0.1325, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2786, mae: 0.3098, huber: 0.1074, swd: 0.1162, ept: 79.6215
    Epoch [2/50], Val Losses: mse: 0.2679, mae: 0.3597, huber: 0.1271, swd: 0.1097, ept: 67.3387
    Epoch [2/50], Test Losses: mse: 0.1421, mae: 0.2667, huber: 0.0699, swd: 0.0477, ept: 78.8200
      Epoch 2 composite train-obj: 0.107432
            Val objective improved 0.1325 → 0.1271, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2712, mae: 0.3032, huber: 0.1041, swd: 0.1110, ept: 80.6748
    Epoch [3/50], Val Losses: mse: 0.2703, mae: 0.3616, huber: 0.1280, swd: 0.1176, ept: 67.9718
    Epoch [3/50], Test Losses: mse: 0.1391, mae: 0.2628, huber: 0.0684, swd: 0.0502, ept: 78.7184
      Epoch 3 composite train-obj: 0.104102
            No improvement (0.1280), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2672, mae: 0.3004, huber: 0.1026, swd: 0.1091, ept: 80.9734
    Epoch [4/50], Val Losses: mse: 0.2616, mae: 0.3559, huber: 0.1247, swd: 0.1052, ept: 68.0305
    Epoch [4/50], Test Losses: mse: 0.1409, mae: 0.2644, huber: 0.0693, swd: 0.0491, ept: 79.2630
      Epoch 4 composite train-obj: 0.102627
            Val objective improved 0.1271 → 0.1247, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2655, mae: 0.2994, huber: 0.1020, swd: 0.1085, ept: 81.1187
    Epoch [5/50], Val Losses: mse: 0.2593, mae: 0.3542, huber: 0.1237, swd: 0.1033, ept: 67.5118
    Epoch [5/50], Test Losses: mse: 0.1398, mae: 0.2641, huber: 0.0689, swd: 0.0473, ept: 79.3901
      Epoch 5 composite train-obj: 0.101988
            Val objective improved 0.1247 → 0.1237, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.2651, mae: 0.2987, huber: 0.1018, swd: 0.1082, ept: 81.2443
    Epoch [6/50], Val Losses: mse: 0.2632, mae: 0.3585, huber: 0.1254, swd: 0.1090, ept: 68.6534
    Epoch [6/50], Test Losses: mse: 0.1388, mae: 0.2636, huber: 0.0683, swd: 0.0497, ept: 79.1711
      Epoch 6 composite train-obj: 0.101756
            No improvement (0.1254), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.2646, mae: 0.2995, huber: 0.1018, swd: 0.1081, ept: 81.2695
    Epoch [7/50], Val Losses: mse: 0.2673, mae: 0.3614, huber: 0.1278, swd: 0.1082, ept: 66.7915
    Epoch [7/50], Test Losses: mse: 0.1411, mae: 0.2658, huber: 0.0694, swd: 0.0495, ept: 79.2803
      Epoch 7 composite train-obj: 0.101784
            No improvement (0.1278), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.2641, mae: 0.2980, huber: 0.1014, swd: 0.1075, ept: 81.3963
    Epoch [8/50], Val Losses: mse: 0.2654, mae: 0.3584, huber: 0.1263, swd: 0.1050, ept: 68.3923
    Epoch [8/50], Test Losses: mse: 0.1349, mae: 0.2608, huber: 0.0666, swd: 0.0436, ept: 79.9337
      Epoch 8 composite train-obj: 0.101385
            No improvement (0.1263), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.2639, mae: 0.2981, huber: 0.1013, swd: 0.1070, ept: 81.4758
    Epoch [9/50], Val Losses: mse: 0.2637, mae: 0.3577, huber: 0.1254, swd: 0.1079, ept: 68.6029
    Epoch [9/50], Test Losses: mse: 0.1424, mae: 0.2663, huber: 0.0699, swd: 0.0506, ept: 79.2257
      Epoch 9 composite train-obj: 0.101322
            No improvement (0.1254), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.2637, mae: 0.2988, huber: 0.1013, swd: 0.1075, ept: 81.4688
    Epoch [10/50], Val Losses: mse: 0.2583, mae: 0.3540, huber: 0.1233, swd: 0.1046, ept: 68.0831
    Epoch [10/50], Test Losses: mse: 0.1435, mae: 0.2681, huber: 0.0705, swd: 0.0520, ept: 78.9851
      Epoch 10 composite train-obj: 0.101333
            Val objective improved 0.1237 → 0.1233, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 0.2642, mae: 0.2986, huber: 0.1014, swd: 0.1074, ept: 81.4617
    Epoch [11/50], Val Losses: mse: 0.2618, mae: 0.3586, huber: 0.1252, swd: 0.1074, ept: 68.6958
    Epoch [11/50], Test Losses: mse: 0.1422, mae: 0.2670, huber: 0.0699, swd: 0.0513, ept: 78.9424
      Epoch 11 composite train-obj: 0.101407
            No improvement (0.1252), counter 1/5
    Epoch [12/50], Train Losses: mse: 0.2636, mae: 0.2983, huber: 0.1013, swd: 0.1073, ept: 81.4195
    Epoch [12/50], Val Losses: mse: 0.2587, mae: 0.3528, huber: 0.1233, swd: 0.1027, ept: 69.2184
    Epoch [12/50], Test Losses: mse: 0.1389, mae: 0.2649, huber: 0.0684, swd: 0.0481, ept: 79.4139
      Epoch 12 composite train-obj: 0.101283
            Val objective improved 0.1233 → 0.1233, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 0.2639, mae: 0.2986, huber: 0.1014, swd: 0.1075, ept: 81.4733
    Epoch [13/50], Val Losses: mse: 0.2603, mae: 0.3549, huber: 0.1241, swd: 0.1030, ept: 68.6038
    Epoch [13/50], Test Losses: mse: 0.1412, mae: 0.2719, huber: 0.0697, swd: 0.0498, ept: 79.6338
      Epoch 13 composite train-obj: 0.101350
            No improvement (0.1241), counter 1/5
    Epoch [14/50], Train Losses: mse: 0.2638, mae: 0.2983, huber: 0.1013, swd: 0.1070, ept: 81.4503
    Epoch [14/50], Val Losses: mse: 0.2723, mae: 0.3632, huber: 0.1291, swd: 0.1143, ept: 67.9567
    Epoch [14/50], Test Losses: mse: 0.1372, mae: 0.2624, huber: 0.0676, swd: 0.0479, ept: 79.4054
      Epoch 14 composite train-obj: 0.101257
            No improvement (0.1291), counter 2/5
    Epoch [15/50], Train Losses: mse: 0.2634, mae: 0.2990, huber: 0.1013, swd: 0.1077, ept: 81.4152
    Epoch [15/50], Val Losses: mse: 0.2649, mae: 0.3573, huber: 0.1258, swd: 0.1063, ept: 68.7456
    Epoch [15/50], Test Losses: mse: 0.1366, mae: 0.2621, huber: 0.0673, swd: 0.0468, ept: 79.6004
      Epoch 15 composite train-obj: 0.101295
            No improvement (0.1258), counter 3/5
    Epoch [16/50], Train Losses: mse: 0.2640, mae: 0.2985, huber: 0.1013, swd: 0.1072, ept: 81.5332
    Epoch [16/50], Val Losses: mse: 0.2591, mae: 0.3518, huber: 0.1231, swd: 0.1029, ept: 69.4077
    Epoch [16/50], Test Losses: mse: 0.1401, mae: 0.2658, huber: 0.0690, swd: 0.0495, ept: 78.8005
      Epoch 16 composite train-obj: 0.101332
            Val objective improved 0.1233 → 0.1231, saving checkpoint.
    Epoch [17/50], Train Losses: mse: 0.2631, mae: 0.2980, huber: 0.1010, swd: 0.1071, ept: 81.4947
    Epoch [17/50], Val Losses: mse: 0.2614, mae: 0.3558, huber: 0.1249, swd: 0.1011, ept: 67.4416
    Epoch [17/50], Test Losses: mse: 0.1397, mae: 0.2660, huber: 0.0689, swd: 0.0470, ept: 79.3162
      Epoch 17 composite train-obj: 0.101045
            No improvement (0.1249), counter 1/5
    Epoch [18/50], Train Losses: mse: 0.2639, mae: 0.2994, huber: 0.1015, swd: 0.1073, ept: 81.4769
    Epoch [18/50], Val Losses: mse: 0.2656, mae: 0.3573, huber: 0.1259, swd: 0.1114, ept: 68.5390
    Epoch [18/50], Test Losses: mse: 0.1382, mae: 0.2624, huber: 0.0679, swd: 0.0490, ept: 79.2195
      Epoch 18 composite train-obj: 0.101466
            No improvement (0.1259), counter 2/5
    Epoch [19/50], Train Losses: mse: 0.2637, mae: 0.2986, huber: 0.1013, swd: 0.1072, ept: 81.4677
    Epoch [19/50], Val Losses: mse: 0.2643, mae: 0.3583, huber: 0.1259, swd: 0.1067, ept: 68.6075
    Epoch [19/50], Test Losses: mse: 0.1392, mae: 0.2664, huber: 0.0686, swd: 0.0479, ept: 79.7552
      Epoch 19 composite train-obj: 0.101307
            No improvement (0.1259), counter 3/5
    Epoch [20/50], Train Losses: mse: 0.2628, mae: 0.2980, huber: 0.1010, swd: 0.1073, ept: 81.5041
    Epoch [20/50], Val Losses: mse: 0.2602, mae: 0.3550, huber: 0.1241, swd: 0.1052, ept: 68.6425
    Epoch [20/50], Test Losses: mse: 0.1421, mae: 0.2661, huber: 0.0698, swd: 0.0520, ept: 78.8512
      Epoch 20 composite train-obj: 0.101018
            No improvement (0.1241), counter 4/5
    Epoch [21/50], Train Losses: mse: 0.2632, mae: 0.2980, huber: 0.1011, swd: 0.1069, ept: 81.5203
    Epoch [21/50], Val Losses: mse: 0.2650, mae: 0.3588, huber: 0.1263, swd: 0.1042, ept: 67.1893
    Epoch [21/50], Test Losses: mse: 0.1410, mae: 0.2667, huber: 0.0695, swd: 0.0485, ept: 79.3908
      Epoch 21 composite train-obj: 0.101088
    Epoch [21/50], Test Losses: mse: 0.1401, mae: 0.2658, huber: 0.0690, swd: 0.0495, ept: 78.8005
    Best round's Test MSE: 0.1401, MAE: 0.2658, SWD: 0.0495
    Best round's Validation MSE: 0.2591, MAE: 0.3518, SWD: 0.1029
    Best round's Test verification MSE : 0.1401, MAE: 0.2658, SWD: 0.0495
    Time taken: 20.63 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3728, mae: 0.3701, huber: 0.1424, swd: 0.1422, ept: 68.7470
    Epoch [1/50], Val Losses: mse: 0.2810, mae: 0.3738, huber: 0.1332, swd: 0.1150, ept: 63.6484
    Epoch [1/50], Test Losses: mse: 0.1480, mae: 0.2731, huber: 0.0727, swd: 0.0507, ept: 77.2813
      Epoch 1 composite train-obj: 0.142354
            Val objective improved inf → 0.1332, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2802, mae: 0.3104, huber: 0.1078, swd: 0.1155, ept: 79.6026
    Epoch [2/50], Val Losses: mse: 0.2639, mae: 0.3584, huber: 0.1257, swd: 0.1038, ept: 66.6361
    Epoch [2/50], Test Losses: mse: 0.1444, mae: 0.2686, huber: 0.0709, swd: 0.0489, ept: 78.6926
      Epoch 2 composite train-obj: 0.107755
            Val objective improved 0.1332 → 0.1257, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2710, mae: 0.3032, huber: 0.1041, swd: 0.1108, ept: 80.6047
    Epoch [3/50], Val Losses: mse: 0.2657, mae: 0.3577, huber: 0.1263, swd: 0.1052, ept: 68.1437
    Epoch [3/50], Test Losses: mse: 0.1412, mae: 0.2650, huber: 0.0694, swd: 0.0493, ept: 78.9217
      Epoch 3 composite train-obj: 0.104119
            No improvement (0.1263), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2678, mae: 0.3006, huber: 0.1028, swd: 0.1087, ept: 81.0016
    Epoch [4/50], Val Losses: mse: 0.2674, mae: 0.3587, huber: 0.1276, swd: 0.1005, ept: 66.9515
    Epoch [4/50], Test Losses: mse: 0.1411, mae: 0.2656, huber: 0.0695, swd: 0.0459, ept: 79.2280
      Epoch 4 composite train-obj: 0.102841
            No improvement (0.1276), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.2660, mae: 0.2994, huber: 0.1022, swd: 0.1078, ept: 81.1317
    Epoch [5/50], Val Losses: mse: 0.2613, mae: 0.3533, huber: 0.1242, swd: 0.1004, ept: 68.0031
    Epoch [5/50], Test Losses: mse: 0.1393, mae: 0.2645, huber: 0.0686, swd: 0.0454, ept: 79.6254
      Epoch 5 composite train-obj: 0.102154
            Val objective improved 0.1257 → 0.1242, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.2653, mae: 0.2989, huber: 0.1018, swd: 0.1069, ept: 81.2563
    Epoch [6/50], Val Losses: mse: 0.2619, mae: 0.3593, huber: 0.1246, swd: 0.1069, ept: 68.7903
    Epoch [6/50], Test Losses: mse: 0.1382, mae: 0.2612, huber: 0.0679, swd: 0.0484, ept: 78.8703
      Epoch 6 composite train-obj: 0.101842
            No improvement (0.1246), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.2646, mae: 0.2982, huber: 0.1015, swd: 0.1070, ept: 81.3269
    Epoch [7/50], Val Losses: mse: 0.2630, mae: 0.3573, huber: 0.1255, swd: 0.1013, ept: 68.2408
    Epoch [7/50], Test Losses: mse: 0.1378, mae: 0.2622, huber: 0.0679, swd: 0.0457, ept: 79.0880
      Epoch 7 composite train-obj: 0.101507
            No improvement (0.1255), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.2640, mae: 0.2986, huber: 0.1015, swd: 0.1070, ept: 81.3449
    Epoch [8/50], Val Losses: mse: 0.2671, mae: 0.3613, huber: 0.1272, swd: 0.1078, ept: 68.0648
    Epoch [8/50], Test Losses: mse: 0.1351, mae: 0.2597, huber: 0.0666, swd: 0.0451, ept: 79.4807
      Epoch 8 composite train-obj: 0.101451
            No improvement (0.1272), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.2638, mae: 0.2983, huber: 0.1013, swd: 0.1067, ept: 81.3753
    Epoch [9/50], Val Losses: mse: 0.2569, mae: 0.3518, huber: 0.1226, swd: 0.1007, ept: 68.4005
    Epoch [9/50], Test Losses: mse: 0.1441, mae: 0.2694, huber: 0.0708, swd: 0.0525, ept: 78.9561
      Epoch 9 composite train-obj: 0.101287
            Val objective improved 0.1242 → 0.1226, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 0.2630, mae: 0.2976, huber: 0.1011, swd: 0.1066, ept: 81.4015
    Epoch [10/50], Val Losses: mse: 0.2711, mae: 0.3622, huber: 0.1286, swd: 0.1076, ept: 67.9658
    Epoch [10/50], Test Losses: mse: 0.1373, mae: 0.2627, huber: 0.0676, swd: 0.0456, ept: 79.4233
      Epoch 10 composite train-obj: 0.101059
            No improvement (0.1286), counter 1/5
    Epoch [11/50], Train Losses: mse: 0.2639, mae: 0.2983, huber: 0.1013, swd: 0.1066, ept: 81.4918
    Epoch [11/50], Val Losses: mse: 0.2625, mae: 0.3560, huber: 0.1249, swd: 0.1045, ept: 67.5104
    Epoch [11/50], Test Losses: mse: 0.1476, mae: 0.2716, huber: 0.0724, swd: 0.0527, ept: 79.0944
      Epoch 11 composite train-obj: 0.101289
            No improvement (0.1249), counter 2/5
    Epoch [12/50], Train Losses: mse: 0.2635, mae: 0.2980, huber: 0.1011, swd: 0.1065, ept: 81.5005
    Epoch [12/50], Val Losses: mse: 0.2635, mae: 0.3575, huber: 0.1256, swd: 0.1008, ept: 68.1983
    Epoch [12/50], Test Losses: mse: 0.1380, mae: 0.2631, huber: 0.0681, swd: 0.0438, ept: 79.4241
      Epoch 12 composite train-obj: 0.101129
            No improvement (0.1256), counter 3/5
    Epoch [13/50], Train Losses: mse: 0.2632, mae: 0.2984, huber: 0.1012, swd: 0.1066, ept: 81.4527
    Epoch [13/50], Val Losses: mse: 0.2669, mae: 0.3586, huber: 0.1267, swd: 0.1084, ept: 67.9422
    Epoch [13/50], Test Losses: mse: 0.1470, mae: 0.2694, huber: 0.0719, swd: 0.0558, ept: 78.5548
      Epoch 13 composite train-obj: 0.101204
            No improvement (0.1267), counter 4/5
    Epoch [14/50], Train Losses: mse: 0.2636, mae: 0.2983, huber: 0.1013, swd: 0.1065, ept: 81.4832
    Epoch [14/50], Val Losses: mse: 0.2623, mae: 0.3567, huber: 0.1251, swd: 0.1002, ept: 68.1734
    Epoch [14/50], Test Losses: mse: 0.1382, mae: 0.2635, huber: 0.0681, swd: 0.0452, ept: 79.5315
      Epoch 14 composite train-obj: 0.101257
    Epoch [14/50], Test Losses: mse: 0.1441, mae: 0.2694, huber: 0.0708, swd: 0.0525, ept: 78.9561
    Best round's Test MSE: 0.1441, MAE: 0.2694, SWD: 0.0525
    Best round's Validation MSE: 0.2569, MAE: 0.3518, SWD: 0.1007
    Best round's Test verification MSE : 0.1441, MAE: 0.2694, SWD: 0.0525
    Time taken: 13.44 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3698, mae: 0.3675, huber: 0.1410, swd: 0.1282, ept: 68.6465
    Epoch [1/50], Val Losses: mse: 0.2809, mae: 0.3755, huber: 0.1336, swd: 0.1047, ept: 64.1918
    Epoch [1/50], Test Losses: mse: 0.1443, mae: 0.2695, huber: 0.0711, swd: 0.0436, ept: 77.7832
      Epoch 1 composite train-obj: 0.140989
            Val objective improved inf → 0.1336, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2797, mae: 0.3103, huber: 0.1076, swd: 0.1065, ept: 79.5403
    Epoch [2/50], Val Losses: mse: 0.2645, mae: 0.3590, huber: 0.1262, swd: 0.0946, ept: 67.2353
    Epoch [2/50], Test Losses: mse: 0.1448, mae: 0.2695, huber: 0.0712, swd: 0.0460, ept: 78.8629
      Epoch 2 composite train-obj: 0.107636
            Val objective improved 0.1336 → 0.1262, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2710, mae: 0.3031, huber: 0.1041, swd: 0.1023, ept: 80.6081
    Epoch [3/50], Val Losses: mse: 0.2632, mae: 0.3568, huber: 0.1253, swd: 0.0944, ept: 67.6277
    Epoch [3/50], Test Losses: mse: 0.1395, mae: 0.2643, huber: 0.0687, swd: 0.0418, ept: 79.2881
      Epoch 3 composite train-obj: 0.104120
            Val objective improved 0.1262 → 0.1253, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2676, mae: 0.3006, huber: 0.1028, swd: 0.1006, ept: 80.9966
    Epoch [4/50], Val Losses: mse: 0.2607, mae: 0.3554, huber: 0.1245, swd: 0.0927, ept: 67.7819
    Epoch [4/50], Test Losses: mse: 0.1409, mae: 0.2658, huber: 0.0694, swd: 0.0438, ept: 79.3251
      Epoch 4 composite train-obj: 0.102800
            Val objective improved 0.1253 → 0.1245, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2662, mae: 0.2995, huber: 0.1021, swd: 0.0998, ept: 81.1957
    Epoch [5/50], Val Losses: mse: 0.2645, mae: 0.3574, huber: 0.1257, swd: 0.0969, ept: 67.1059
    Epoch [5/50], Test Losses: mse: 0.1387, mae: 0.2636, huber: 0.0683, swd: 0.0435, ept: 79.6569
      Epoch 5 composite train-obj: 0.102140
            No improvement (0.1257), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.2657, mae: 0.2995, huber: 0.1020, swd: 0.0998, ept: 81.2220
    Epoch [6/50], Val Losses: mse: 0.2649, mae: 0.3591, huber: 0.1267, swd: 0.0931, ept: 68.0665
    Epoch [6/50], Test Losses: mse: 0.1389, mae: 0.2648, huber: 0.0686, swd: 0.0416, ept: 79.5468
      Epoch 6 composite train-obj: 0.102013
            No improvement (0.1267), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.2645, mae: 0.2989, huber: 0.1016, swd: 0.0997, ept: 81.2941
    Epoch [7/50], Val Losses: mse: 0.2603, mae: 0.3537, huber: 0.1236, swd: 0.0966, ept: 68.8408
    Epoch [7/50], Test Losses: mse: 0.1379, mae: 0.2627, huber: 0.0678, swd: 0.0443, ept: 79.3553
      Epoch 7 composite train-obj: 0.101634
            Val objective improved 0.1245 → 0.1236, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 0.2643, mae: 0.2989, huber: 0.1016, swd: 0.0992, ept: 81.3796
    Epoch [8/50], Val Losses: mse: 0.2600, mae: 0.3533, huber: 0.1239, swd: 0.0930, ept: 68.3876
    Epoch [8/50], Test Losses: mse: 0.1384, mae: 0.2629, huber: 0.0682, swd: 0.0431, ept: 79.3826
      Epoch 8 composite train-obj: 0.101559
            No improvement (0.1239), counter 1/5
    Epoch [9/50], Train Losses: mse: 0.2636, mae: 0.2981, huber: 0.1012, swd: 0.0990, ept: 81.3686
    Epoch [9/50], Val Losses: mse: 0.2691, mae: 0.3612, huber: 0.1277, swd: 0.1033, ept: 67.5222
    Epoch [9/50], Test Losses: mse: 0.1436, mae: 0.2667, huber: 0.0704, swd: 0.0493, ept: 79.0181
      Epoch 9 composite train-obj: 0.101222
            No improvement (0.1277), counter 2/5
    Epoch [10/50], Train Losses: mse: 0.2642, mae: 0.2982, huber: 0.1013, swd: 0.0989, ept: 81.4456
    Epoch [10/50], Val Losses: mse: 0.2664, mae: 0.3610, huber: 0.1270, swd: 0.1002, ept: 68.3799
    Epoch [10/50], Test Losses: mse: 0.1345, mae: 0.2596, huber: 0.0663, swd: 0.0419, ept: 79.5367
      Epoch 10 composite train-obj: 0.101334
            No improvement (0.1270), counter 3/5
    Epoch [11/50], Train Losses: mse: 0.2635, mae: 0.2980, huber: 0.1013, swd: 0.0987, ept: 81.4503
    Epoch [11/50], Val Losses: mse: 0.2631, mae: 0.3585, huber: 0.1255, swd: 0.0951, ept: 68.0362
    Epoch [11/50], Test Losses: mse: 0.1474, mae: 0.2744, huber: 0.0724, swd: 0.0464, ept: 79.7183
      Epoch 11 composite train-obj: 0.101271
            No improvement (0.1255), counter 4/5
    Epoch [12/50], Train Losses: mse: 0.2641, mae: 0.2988, huber: 0.1014, swd: 0.0992, ept: 81.4315
    Epoch [12/50], Val Losses: mse: 0.2618, mae: 0.3556, huber: 0.1248, swd: 0.0925, ept: 68.1603
    Epoch [12/50], Test Losses: mse: 0.1394, mae: 0.2642, huber: 0.0687, swd: 0.0431, ept: 79.4382
      Epoch 12 composite train-obj: 0.101435
    Epoch [12/50], Test Losses: mse: 0.1379, mae: 0.2627, huber: 0.0678, swd: 0.0443, ept: 79.3553
    Best round's Test MSE: 0.1379, MAE: 0.2627, SWD: 0.0443
    Best round's Validation MSE: 0.2603, MAE: 0.3537, SWD: 0.0966
    Best round's Test verification MSE : 0.1379, MAE: 0.2627, SWD: 0.0443
    Time taken: 11.59 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq336_pred96_20250510_2138)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1407 ± 0.0026
      mae: 0.2659 ± 0.0028
      huber: 0.0692 ± 0.0012
      swd: 0.0488 ± 0.0034
      ept: 79.0373 ± 0.2337
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2588 ± 0.0014
      mae: 0.3524 ± 0.0009
      huber: 0.1231 ± 0.0004
      swd: 0.1001 ± 0.0026
      ept: 68.8830 ± 0.4123
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 45.69 seconds
    
    Experiment complete: DLinear_etth2_seq336_pred96_20250510_2138
    Model: DLinear
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=336,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 10
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4313, mae: 0.4015, huber: 0.1629, swd: 0.1691, ept: 117.1350
    Epoch [1/50], Val Losses: mse: 0.3245, mae: 0.4084, huber: 0.1535, swd: 0.1209, ept: 102.5956
    Epoch [1/50], Test Losses: mse: 0.1731, mae: 0.2982, huber: 0.0849, swd: 0.0609, ept: 132.4814
      Epoch 1 composite train-obj: 0.162908
            Val objective improved inf → 0.1535, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3559, mae: 0.3535, huber: 0.1342, swd: 0.1533, ept: 139.9359
    Epoch [2/50], Val Losses: mse: 0.3183, mae: 0.4032, huber: 0.1512, swd: 0.1158, ept: 105.6171
    Epoch [2/50], Test Losses: mse: 0.1679, mae: 0.2932, huber: 0.0825, swd: 0.0560, ept: 136.0369
      Epoch 2 composite train-obj: 0.134158
            Val objective improved 0.1535 → 0.1512, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3482, mae: 0.3476, huber: 0.1311, swd: 0.1499, ept: 142.2270
    Epoch [3/50], Val Losses: mse: 0.3162, mae: 0.4005, huber: 0.1501, swd: 0.1128, ept: 108.2031
    Epoch [3/50], Test Losses: mse: 0.1655, mae: 0.2894, huber: 0.0814, swd: 0.0533, ept: 138.2820
      Epoch 3 composite train-obj: 0.131083
            Val objective improved 0.1512 → 0.1501, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.3459, mae: 0.3453, huber: 0.1299, swd: 0.1475, ept: 143.1924
    Epoch [4/50], Val Losses: mse: 0.3148, mae: 0.3979, huber: 0.1490, swd: 0.1194, ept: 107.1109
    Epoch [4/50], Test Losses: mse: 0.1682, mae: 0.2916, huber: 0.0824, swd: 0.0596, ept: 137.2946
      Epoch 4 composite train-obj: 0.129919
            Val objective improved 0.1501 → 0.1490, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.3475, mae: 0.3454, huber: 0.1302, swd: 0.1501, ept: 143.5492
    Epoch [5/50], Val Losses: mse: 0.3179, mae: 0.4025, huber: 0.1506, swd: 0.1236, ept: 108.8114
    Epoch [5/50], Test Losses: mse: 0.1630, mae: 0.2862, huber: 0.0800, swd: 0.0571, ept: 136.9117
      Epoch 5 composite train-obj: 0.130237
            No improvement (0.1506), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.3450, mae: 0.3447, huber: 0.1295, swd: 0.1482, ept: 143.6851
    Epoch [6/50], Val Losses: mse: 0.3151, mae: 0.4016, huber: 0.1493, swd: 0.1215, ept: 110.0135
    Epoch [6/50], Test Losses: mse: 0.1647, mae: 0.2873, huber: 0.0807, swd: 0.0594, ept: 137.5204
      Epoch 6 composite train-obj: 0.129534
            No improvement (0.1493), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.3427, mae: 0.3432, huber: 0.1287, swd: 0.1472, ept: 144.1840
    Epoch [7/50], Val Losses: mse: 0.3154, mae: 0.4011, huber: 0.1499, swd: 0.1167, ept: 109.9965
    Epoch [7/50], Test Losses: mse: 0.1674, mae: 0.2913, huber: 0.0823, swd: 0.0587, ept: 138.4079
      Epoch 7 composite train-obj: 0.128716
            No improvement (0.1499), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.3413, mae: 0.3424, huber: 0.1282, swd: 0.1459, ept: 144.5736
    Epoch [8/50], Val Losses: mse: 0.3127, mae: 0.3976, huber: 0.1484, swd: 0.1213, ept: 110.7519
    Epoch [8/50], Test Losses: mse: 0.1713, mae: 0.2974, huber: 0.0838, swd: 0.0652, ept: 138.7336
      Epoch 8 composite train-obj: 0.128181
            Val objective improved 0.1490 → 0.1484, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 0.3419, mae: 0.3434, huber: 0.1286, swd: 0.1474, ept: 144.4695
    Epoch [9/50], Val Losses: mse: 0.3235, mae: 0.4048, huber: 0.1531, swd: 0.1259, ept: 109.6346
    Epoch [9/50], Test Losses: mse: 0.1600, mae: 0.2839, huber: 0.0786, swd: 0.0546, ept: 139.3048
      Epoch 9 composite train-obj: 0.128572
            No improvement (0.1531), counter 1/5
    Epoch [10/50], Train Losses: mse: 0.3426, mae: 0.3434, huber: 0.1286, swd: 0.1466, ept: 144.7091
    Epoch [10/50], Val Losses: mse: 0.3122, mae: 0.3968, huber: 0.1481, swd: 0.1158, ept: 109.8630
    Epoch [10/50], Test Losses: mse: 0.1658, mae: 0.2886, huber: 0.0813, swd: 0.0593, ept: 138.3670
      Epoch 10 composite train-obj: 0.128643
            Val objective improved 0.1484 → 0.1481, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 0.3420, mae: 0.3429, huber: 0.1284, swd: 0.1462, ept: 144.6193
    Epoch [11/50], Val Losses: mse: 0.3102, mae: 0.3969, huber: 0.1468, swd: 0.1171, ept: 109.5977
    Epoch [11/50], Test Losses: mse: 0.1640, mae: 0.2877, huber: 0.0805, swd: 0.0569, ept: 138.0393
      Epoch 11 composite train-obj: 0.128423
            Val objective improved 0.1481 → 0.1468, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 0.3419, mae: 0.3432, huber: 0.1285, swd: 0.1469, ept: 144.6762
    Epoch [12/50], Val Losses: mse: 0.3152, mae: 0.4007, huber: 0.1496, swd: 0.1166, ept: 110.1752
    Epoch [12/50], Test Losses: mse: 0.1612, mae: 0.2856, huber: 0.0793, swd: 0.0551, ept: 137.9224
      Epoch 12 composite train-obj: 0.128539
            No improvement (0.1496), counter 1/5
    Epoch [13/50], Train Losses: mse: 0.3415, mae: 0.3427, huber: 0.1283, swd: 0.1463, ept: 144.7638
    Epoch [13/50], Val Losses: mse: 0.3111, mae: 0.3969, huber: 0.1469, swd: 0.1227, ept: 110.3417
    Epoch [13/50], Test Losses: mse: 0.1713, mae: 0.2966, huber: 0.0839, swd: 0.0664, ept: 137.2681
      Epoch 13 composite train-obj: 0.128321
            No improvement (0.1469), counter 2/5
    Epoch [14/50], Train Losses: mse: 0.3420, mae: 0.3434, huber: 0.1285, swd: 0.1473, ept: 144.5988
    Epoch [14/50], Val Losses: mse: 0.3137, mae: 0.4013, huber: 0.1487, swd: 0.1198, ept: 110.7931
    Epoch [14/50], Test Losses: mse: 0.1652, mae: 0.2872, huber: 0.0809, swd: 0.0599, ept: 137.8132
      Epoch 14 composite train-obj: 0.128542
            No improvement (0.1487), counter 3/5
    Epoch [15/50], Train Losses: mse: 0.3409, mae: 0.3424, huber: 0.1280, swd: 0.1462, ept: 144.8975
    Epoch [15/50], Val Losses: mse: 0.3122, mae: 0.3978, huber: 0.1482, swd: 0.1119, ept: 111.0258
    Epoch [15/50], Test Losses: mse: 0.1641, mae: 0.2896, huber: 0.0808, swd: 0.0546, ept: 138.5137
      Epoch 15 composite train-obj: 0.128035
            No improvement (0.1482), counter 4/5
    Epoch [16/50], Train Losses: mse: 0.3421, mae: 0.3430, huber: 0.1284, swd: 0.1461, ept: 144.8328
    Epoch [16/50], Val Losses: mse: 0.3201, mae: 0.4013, huber: 0.1513, swd: 0.1241, ept: 110.3269
    Epoch [16/50], Test Losses: mse: 0.1608, mae: 0.2855, huber: 0.0790, swd: 0.0549, ept: 138.9882
      Epoch 16 composite train-obj: 0.128411
    Epoch [16/50], Test Losses: mse: 0.1640, mae: 0.2877, huber: 0.0805, swd: 0.0569, ept: 138.0393
    Best round's Test MSE: 0.1640, MAE: 0.2877, SWD: 0.0569
    Best round's Validation MSE: 0.3102, MAE: 0.3969, SWD: 0.1171
    Best round's Test verification MSE : 0.1640, MAE: 0.2877, SWD: 0.0569
    Time taken: 15.74 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4370, mae: 0.4037, huber: 0.1644, swd: 0.1743, ept: 116.7566
    Epoch [1/50], Val Losses: mse: 0.3313, mae: 0.4137, huber: 0.1565, swd: 0.1251, ept: 100.9744
    Epoch [1/50], Test Losses: mse: 0.1661, mae: 0.2900, huber: 0.0816, swd: 0.0554, ept: 132.3405
      Epoch 1 composite train-obj: 0.164381
            Val objective improved inf → 0.1565, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3568, mae: 0.3532, huber: 0.1342, swd: 0.1564, ept: 139.8806
    Epoch [2/50], Val Losses: mse: 0.3170, mae: 0.4024, huber: 0.1504, swd: 0.1183, ept: 105.5427
    Epoch [2/50], Test Losses: mse: 0.1675, mae: 0.2910, huber: 0.0823, swd: 0.0594, ept: 136.3117
      Epoch 2 composite train-obj: 0.134150
            Val objective improved 0.1565 → 0.1504, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3569, mae: 0.3496, huber: 0.1329, swd: 0.1575, ept: 142.1479
    Epoch [3/50], Val Losses: mse: 0.3224, mae: 0.4070, huber: 0.1524, swd: 0.1315, ept: 107.7649
    Epoch [3/50], Test Losses: mse: 0.1626, mae: 0.2847, huber: 0.0796, swd: 0.0583, ept: 137.9980
      Epoch 3 composite train-obj: 0.132904
            No improvement (0.1524), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3459, mae: 0.3458, huber: 0.1301, swd: 0.1511, ept: 143.0898
    Epoch [4/50], Val Losses: mse: 0.3097, mae: 0.3964, huber: 0.1472, swd: 0.1184, ept: 109.2919
    Epoch [4/50], Test Losses: mse: 0.1683, mae: 0.2933, huber: 0.0826, swd: 0.0628, ept: 136.5444
      Epoch 4 composite train-obj: 0.130148
            Val objective improved 0.1504 → 0.1472, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.3468, mae: 0.3451, huber: 0.1300, swd: 0.1519, ept: 143.4922
    Epoch [5/50], Val Losses: mse: 0.3100, mae: 0.3969, huber: 0.1473, swd: 0.1168, ept: 109.5985
    Epoch [5/50], Test Losses: mse: 0.1632, mae: 0.2874, huber: 0.0802, swd: 0.0571, ept: 137.7029
      Epoch 5 composite train-obj: 0.130036
            No improvement (0.1473), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.3459, mae: 0.3443, huber: 0.1296, swd: 0.1512, ept: 144.0432
    Epoch [6/50], Val Losses: mse: 0.3100, mae: 0.3952, huber: 0.1471, swd: 0.1199, ept: 109.1337
    Epoch [6/50], Test Losses: mse: 0.1735, mae: 0.2964, huber: 0.0848, swd: 0.0687, ept: 137.4712
      Epoch 6 composite train-obj: 0.129574
            Val objective improved 0.1472 → 0.1471, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.3430, mae: 0.3435, huber: 0.1289, swd: 0.1493, ept: 144.2467
    Epoch [7/50], Val Losses: mse: 0.3116, mae: 0.3955, huber: 0.1477, swd: 0.1184, ept: 109.7914
    Epoch [7/50], Test Losses: mse: 0.1704, mae: 0.2938, huber: 0.0835, swd: 0.0674, ept: 137.4782
      Epoch 7 composite train-obj: 0.128879
            No improvement (0.1477), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.3442, mae: 0.3435, huber: 0.1290, swd: 0.1507, ept: 144.2169
    Epoch [8/50], Val Losses: mse: 0.3229, mae: 0.4034, huber: 0.1525, swd: 0.1250, ept: 108.8092
    Epoch [8/50], Test Losses: mse: 0.1607, mae: 0.2852, huber: 0.0790, swd: 0.0558, ept: 139.1360
      Epoch 8 composite train-obj: 0.129028
            No improvement (0.1525), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.3432, mae: 0.3437, huber: 0.1289, swd: 0.1501, ept: 144.3308
    Epoch [9/50], Val Losses: mse: 0.3125, mae: 0.3982, huber: 0.1485, swd: 0.1120, ept: 109.1597
    Epoch [9/50], Test Losses: mse: 0.1675, mae: 0.2907, huber: 0.0823, swd: 0.0587, ept: 138.7005
      Epoch 9 composite train-obj: 0.128933
            No improvement (0.1485), counter 3/5
    Epoch [10/50], Train Losses: mse: 0.3416, mae: 0.3426, huber: 0.1283, swd: 0.1487, ept: 144.6315
    Epoch [10/50], Val Losses: mse: 0.3210, mae: 0.4032, huber: 0.1517, swd: 0.1227, ept: 110.8195
    Epoch [10/50], Test Losses: mse: 0.1611, mae: 0.2870, huber: 0.0793, swd: 0.0556, ept: 137.7240
      Epoch 10 composite train-obj: 0.128273
            No improvement (0.1517), counter 4/5
    Epoch [11/50], Train Losses: mse: 0.3424, mae: 0.3438, huber: 0.1287, swd: 0.1496, ept: 144.3786
    Epoch [11/50], Val Losses: mse: 0.3165, mae: 0.4039, huber: 0.1503, swd: 0.1203, ept: 109.5521
    Epoch [11/50], Test Losses: mse: 0.1630, mae: 0.2879, huber: 0.0802, swd: 0.0577, ept: 138.8679
      Epoch 11 composite train-obj: 0.128685
    Epoch [11/50], Test Losses: mse: 0.1735, mae: 0.2964, huber: 0.0848, swd: 0.0687, ept: 137.4712
    Best round's Test MSE: 0.1735, MAE: 0.2964, SWD: 0.0687
    Best round's Validation MSE: 0.3100, MAE: 0.3952, SWD: 0.1199
    Best round's Test verification MSE : 0.1735, MAE: 0.2964, SWD: 0.0687
    Time taken: 10.89 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4385, mae: 0.4034, huber: 0.1646, swd: 0.1567, ept: 116.9065
    Epoch [1/50], Val Losses: mse: 0.3276, mae: 0.4101, huber: 0.1549, swd: 0.1073, ept: 101.3405
    Epoch [1/50], Test Losses: mse: 0.1709, mae: 0.2954, huber: 0.0838, swd: 0.0531, ept: 132.1212
      Epoch 1 composite train-obj: 0.164594
            Val objective improved inf → 0.1549, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3543, mae: 0.3525, huber: 0.1336, swd: 0.1398, ept: 139.8454
    Epoch [2/50], Val Losses: mse: 0.3211, mae: 0.4045, huber: 0.1520, swd: 0.1091, ept: 105.3343
    Epoch [2/50], Test Losses: mse: 0.1683, mae: 0.2925, huber: 0.0825, swd: 0.0547, ept: 136.6780
      Epoch 2 composite train-obj: 0.133645
            Val objective improved 0.1549 → 0.1520, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3484, mae: 0.3474, huber: 0.1311, swd: 0.1376, ept: 142.1897
    Epoch [3/50], Val Losses: mse: 0.3213, mae: 0.4044, huber: 0.1522, swd: 0.1101, ept: 107.2447
    Epoch [3/50], Test Losses: mse: 0.1637, mae: 0.2869, huber: 0.0803, swd: 0.0513, ept: 137.3217
      Epoch 3 composite train-obj: 0.131093
            No improvement (0.1522), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3473, mae: 0.3452, huber: 0.1301, swd: 0.1367, ept: 143.1667
    Epoch [4/50], Val Losses: mse: 0.3237, mae: 0.4064, huber: 0.1531, swd: 0.1119, ept: 109.2596
    Epoch [4/50], Test Losses: mse: 0.1579, mae: 0.2818, huber: 0.0777, swd: 0.0477, ept: 138.6605
      Epoch 4 composite train-obj: 0.130056
            No improvement (0.1531), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3466, mae: 0.3448, huber: 0.1298, swd: 0.1365, ept: 143.5888
    Epoch [5/50], Val Losses: mse: 0.3164, mae: 0.4005, huber: 0.1499, swd: 0.1077, ept: 108.0803
    Epoch [5/50], Test Losses: mse: 0.1660, mae: 0.2886, huber: 0.0814, swd: 0.0534, ept: 137.7335
      Epoch 5 composite train-obj: 0.129781
            Val objective improved 0.1520 → 0.1499, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.3431, mae: 0.3440, huber: 0.1291, swd: 0.1352, ept: 143.9354
    Epoch [6/50], Val Losses: mse: 0.3204, mae: 0.4026, huber: 0.1520, swd: 0.1005, ept: 107.5407
    Epoch [6/50], Test Losses: mse: 0.1661, mae: 0.2902, huber: 0.0817, swd: 0.0483, ept: 138.8101
      Epoch 6 composite train-obj: 0.129085
            No improvement (0.1520), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.3421, mae: 0.3437, huber: 0.1287, swd: 0.1349, ept: 143.8595
    Epoch [7/50], Val Losses: mse: 0.3192, mae: 0.4029, huber: 0.1518, swd: 0.1024, ept: 110.0944
    Epoch [7/50], Test Losses: mse: 0.1640, mae: 0.2881, huber: 0.0807, swd: 0.0484, ept: 139.0362
      Epoch 7 composite train-obj: 0.128658
            No improvement (0.1518), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.3463, mae: 0.3447, huber: 0.1296, swd: 0.1370, ept: 143.9772
    Epoch [8/50], Val Losses: mse: 0.3150, mae: 0.4017, huber: 0.1495, swd: 0.1068, ept: 109.6354
    Epoch [8/50], Test Losses: mse: 0.1612, mae: 0.2846, huber: 0.0792, swd: 0.0507, ept: 139.1547
      Epoch 8 composite train-obj: 0.129587
            Val objective improved 0.1499 → 0.1495, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 0.3427, mae: 0.3435, huber: 0.1287, swd: 0.1348, ept: 144.4410
    Epoch [9/50], Val Losses: mse: 0.3075, mae: 0.3931, huber: 0.1458, swd: 0.1044, ept: 110.4152
    Epoch [9/50], Test Losses: mse: 0.1743, mae: 0.2969, huber: 0.0851, swd: 0.0606, ept: 137.9166
      Epoch 9 composite train-obj: 0.128666
            Val objective improved 0.1495 → 0.1458, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 0.3416, mae: 0.3427, huber: 0.1283, swd: 0.1349, ept: 144.4757
    Epoch [10/50], Val Losses: mse: 0.3266, mae: 0.4112, huber: 0.1546, swd: 0.1132, ept: 109.6122
    Epoch [10/50], Test Losses: mse: 0.1643, mae: 0.2908, huber: 0.0807, swd: 0.0512, ept: 138.9128
      Epoch 10 composite train-obj: 0.128320
            No improvement (0.1546), counter 1/5
    Epoch [11/50], Train Losses: mse: 0.3425, mae: 0.3432, huber: 0.1285, swd: 0.1346, ept: 144.6585
    Epoch [11/50], Val Losses: mse: 0.3141, mae: 0.3981, huber: 0.1490, swd: 0.1015, ept: 109.0029
    Epoch [11/50], Test Losses: mse: 0.1719, mae: 0.2973, huber: 0.0843, swd: 0.0579, ept: 137.4773
      Epoch 11 composite train-obj: 0.128528
            No improvement (0.1490), counter 2/5
    Epoch [12/50], Train Losses: mse: 0.3414, mae: 0.3429, huber: 0.1283, swd: 0.1345, ept: 144.6654
    Epoch [12/50], Val Losses: mse: 0.3217, mae: 0.4020, huber: 0.1519, swd: 0.1081, ept: 109.6378
    Epoch [12/50], Test Losses: mse: 0.1637, mae: 0.2906, huber: 0.0805, swd: 0.0510, ept: 138.8396
      Epoch 12 composite train-obj: 0.128271
            No improvement (0.1519), counter 3/5
    Epoch [13/50], Train Losses: mse: 0.3441, mae: 0.3437, huber: 0.1290, swd: 0.1362, ept: 144.4927
    Epoch [13/50], Val Losses: mse: 0.3184, mae: 0.4006, huber: 0.1507, swd: 0.1101, ept: 109.0792
    Epoch [13/50], Test Losses: mse: 0.1701, mae: 0.2926, huber: 0.0832, swd: 0.0560, ept: 138.2753
      Epoch 13 composite train-obj: 0.128992
            No improvement (0.1507), counter 4/5
    Epoch [14/50], Train Losses: mse: 0.3468, mae: 0.3443, huber: 0.1295, swd: 0.1354, ept: 144.4775
    Epoch [14/50], Val Losses: mse: 0.3174, mae: 0.4025, huber: 0.1505, swd: 0.1060, ept: 109.7484
    Epoch [14/50], Test Losses: mse: 0.1610, mae: 0.2854, huber: 0.0791, swd: 0.0487, ept: 139.4741
      Epoch 14 composite train-obj: 0.129466
    Epoch [14/50], Test Losses: mse: 0.1743, mae: 0.2969, huber: 0.0851, swd: 0.0606, ept: 137.9166
    Best round's Test MSE: 0.1743, MAE: 0.2969, SWD: 0.0606
    Best round's Validation MSE: 0.3075, MAE: 0.3931, SWD: 0.1044
    Best round's Test verification MSE : 0.1743, MAE: 0.2969, SWD: 0.0606
    Time taken: 14.12 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq336_pred196_20250510_2139)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1706 ± 0.0047
      mae: 0.2936 ± 0.0042
      huber: 0.0835 ± 0.0021
      swd: 0.0621 ± 0.0049
      ept: 137.8090 ± 0.2441
      count: 10.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3093 ± 0.0012
      mae: 0.3951 ± 0.0015
      huber: 0.1466 ± 0.0005
      swd: 0.1138 ± 0.0067
      ept: 109.7155 ± 0.5297
      count: 10.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 40.78 seconds
    
    Experiment complete: DLinear_etth2_seq336_pred196_20250510_2139
    Model: DLinear
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=336,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 91
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 91
    Validation Batches: 9
    Test Batches: 22
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4961, mae: 0.4354, huber: 0.1850, swd: 0.1936, ept: 166.4503
    Epoch [1/50], Val Losses: mse: 0.3459, mae: 0.4249, huber: 0.1632, swd: 0.1140, ept: 142.1866
    Epoch [1/50], Test Losses: mse: 0.1945, mae: 0.3175, huber: 0.0951, swd: 0.0626, ept: 187.0044
      Epoch 1 composite train-obj: 0.185023
            Val objective improved inf → 0.1632, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4287, mae: 0.3938, huber: 0.1595, swd: 0.1812, ept: 201.0738
    Epoch [2/50], Val Losses: mse: 0.3433, mae: 0.4262, huber: 0.1626, swd: 0.1054, ept: 148.6059
    Epoch [2/50], Test Losses: mse: 0.1892, mae: 0.3102, huber: 0.0927, swd: 0.0555, ept: 193.6890
      Epoch 2 composite train-obj: 0.159472
            Val objective improved 0.1632 → 0.1626, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4240, mae: 0.3909, huber: 0.1577, swd: 0.1792, ept: 204.2294
    Epoch [3/50], Val Losses: mse: 0.3551, mae: 0.4341, huber: 0.1680, swd: 0.1118, ept: 147.3469
    Epoch [3/50], Test Losses: mse: 0.1872, mae: 0.3088, huber: 0.0917, swd: 0.0558, ept: 193.4471
      Epoch 3 composite train-obj: 0.157678
            No improvement (0.1680), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4204, mae: 0.3881, huber: 0.1562, swd: 0.1768, ept: 205.9917
    Epoch [4/50], Val Losses: mse: 0.3538, mae: 0.4335, huber: 0.1672, swd: 0.1286, ept: 146.5725
    Epoch [4/50], Test Losses: mse: 0.1932, mae: 0.3124, huber: 0.0940, swd: 0.0691, ept: 194.8210
      Epoch 4 composite train-obj: 0.156153
            No improvement (0.1672), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.4173, mae: 0.3867, huber: 0.1550, swd: 0.1780, ept: 208.2400
    Epoch [5/50], Val Losses: mse: 0.3550, mae: 0.4361, huber: 0.1686, swd: 0.1126, ept: 150.5877
    Epoch [5/50], Test Losses: mse: 0.1981, mae: 0.3217, huber: 0.0971, swd: 0.0652, ept: 195.5307
      Epoch 5 composite train-obj: 0.155049
            No improvement (0.1686), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.4226, mae: 0.3879, huber: 0.1563, swd: 0.1795, ept: 208.7811
    Epoch [6/50], Val Losses: mse: 0.3490, mae: 0.4294, huber: 0.1647, swd: 0.1117, ept: 152.4409
    Epoch [6/50], Test Losses: mse: 0.1893, mae: 0.3121, huber: 0.0927, swd: 0.0578, ept: 195.8580
      Epoch 6 composite train-obj: 0.156257
            No improvement (0.1647), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.4379, mae: 0.3929, huber: 0.1599, swd: 0.1901, ept: 208.4184
    Epoch [7/50], Val Losses: mse: 0.3572, mae: 0.4329, huber: 0.1685, swd: 0.1247, ept: 149.4074
    Epoch [7/50], Test Losses: mse: 0.1927, mae: 0.3118, huber: 0.0940, swd: 0.0650, ept: 192.3700
      Epoch 7 composite train-obj: 0.159950
    Epoch [7/50], Test Losses: mse: 0.1892, mae: 0.3102, huber: 0.0927, swd: 0.0555, ept: 193.6890
    Best round's Test MSE: 0.1892, MAE: 0.3102, SWD: 0.0555
    Best round's Validation MSE: 0.3433, MAE: 0.4262, SWD: 0.1054
    Best round's Test verification MSE : 0.1892, MAE: 0.3102, SWD: 0.0555
    Time taken: 7.29 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5052, mae: 0.4392, huber: 0.1880, swd: 0.2016, ept: 165.1967
    Epoch [1/50], Val Losses: mse: 0.3443, mae: 0.4258, huber: 0.1636, swd: 0.1077, ept: 141.6068
    Epoch [1/50], Test Losses: mse: 0.2019, mae: 0.3217, huber: 0.0985, swd: 0.0706, ept: 186.6728
      Epoch 1 composite train-obj: 0.188017
            Val objective improved inf → 0.1636, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4399, mae: 0.3982, huber: 0.1626, swd: 0.1943, ept: 199.2208
    Epoch [2/50], Val Losses: mse: 0.3568, mae: 0.4323, huber: 0.1673, swd: 0.1312, ept: 144.9602
    Epoch [2/50], Test Losses: mse: 0.1885, mae: 0.3088, huber: 0.0920, swd: 0.0616, ept: 192.4358
      Epoch 2 composite train-obj: 0.162619
            No improvement (0.1673), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4264, mae: 0.3921, huber: 0.1585, swd: 0.1847, ept: 203.9947
    Epoch [3/50], Val Losses: mse: 0.3331, mae: 0.4157, huber: 0.1572, swd: 0.1230, ept: 149.5538
    Epoch [3/50], Test Losses: mse: 0.2117, mae: 0.3280, huber: 0.1023, swd: 0.0862, ept: 191.7350
      Epoch 3 composite train-obj: 0.158550
            Val objective improved 0.1636 → 0.1572, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.4242, mae: 0.3903, huber: 0.1574, swd: 0.1849, ept: 205.7879
    Epoch [4/50], Val Losses: mse: 0.3562, mae: 0.4330, huber: 0.1689, swd: 0.1133, ept: 148.7772
    Epoch [4/50], Test Losses: mse: 0.1923, mae: 0.3138, huber: 0.0942, swd: 0.0632, ept: 196.4093
      Epoch 4 composite train-obj: 0.157411
            No improvement (0.1689), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.4212, mae: 0.3883, huber: 0.1564, swd: 0.1844, ept: 206.8404
    Epoch [5/50], Val Losses: mse: 0.3283, mae: 0.4150, huber: 0.1553, swd: 0.1072, ept: 150.6990
    Epoch [5/50], Test Losses: mse: 0.2019, mae: 0.3266, huber: 0.0989, swd: 0.0719, ept: 188.2194
      Epoch 5 composite train-obj: 0.156447
            Val objective improved 0.1572 → 0.1553, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.4300, mae: 0.3898, huber: 0.1583, swd: 0.1908, ept: 207.5801
    Epoch [6/50], Val Losses: mse: 0.3419, mae: 0.4277, huber: 0.1620, swd: 0.1154, ept: 152.7779
    Epoch [6/50], Test Losses: mse: 0.1855, mae: 0.3042, huber: 0.0906, swd: 0.0626, ept: 197.9486
      Epoch 6 composite train-obj: 0.158316
            No improvement (0.1620), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.4182, mae: 0.3857, huber: 0.1550, swd: 0.1823, ept: 209.0005
    Epoch [7/50], Val Losses: mse: 0.3397, mae: 0.4237, huber: 0.1606, swd: 0.1174, ept: 152.8147
    Epoch [7/50], Test Losses: mse: 0.1947, mae: 0.3191, huber: 0.0953, swd: 0.0674, ept: 196.2662
      Epoch 7 composite train-obj: 0.154999
            No improvement (0.1606), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.4214, mae: 0.3875, huber: 0.1561, swd: 0.1844, ept: 208.0269
    Epoch [8/50], Val Losses: mse: 0.3364, mae: 0.4193, huber: 0.1591, swd: 0.1106, ept: 154.0932
    Epoch [8/50], Test Losses: mse: 0.1830, mae: 0.3044, huber: 0.0897, swd: 0.0592, ept: 198.9486
      Epoch 8 composite train-obj: 0.156056
            No improvement (0.1591), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.4145, mae: 0.3840, huber: 0.1538, swd: 0.1817, ept: 210.2356
    Epoch [9/50], Val Losses: mse: 0.3469, mae: 0.4272, huber: 0.1634, swd: 0.1189, ept: 149.3448
    Epoch [9/50], Test Losses: mse: 0.1961, mae: 0.3142, huber: 0.0957, swd: 0.0663, ept: 193.8312
      Epoch 9 composite train-obj: 0.153788
            No improvement (0.1634), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.4166, mae: 0.3851, huber: 0.1546, swd: 0.1822, ept: 210.2289
    Epoch [10/50], Val Losses: mse: 0.3618, mae: 0.4406, huber: 0.1701, swd: 0.1473, ept: 151.5350
    Epoch [10/50], Test Losses: mse: 0.1888, mae: 0.3080, huber: 0.0919, swd: 0.0701, ept: 195.1740
      Epoch 10 composite train-obj: 0.154632
    Epoch [10/50], Test Losses: mse: 0.2019, mae: 0.3266, huber: 0.0989, swd: 0.0719, ept: 188.2194
    Best round's Test MSE: 0.2019, MAE: 0.3266, SWD: 0.0719
    Best round's Validation MSE: 0.3283, MAE: 0.4150, SWD: 0.1072
    Best round's Test verification MSE : 0.2019, MAE: 0.3266, SWD: 0.0719
    Time taken: 9.92 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5003, mae: 0.4374, huber: 0.1868, swd: 0.1938, ept: 165.9420
    Epoch [1/50], Val Losses: mse: 0.3521, mae: 0.4310, huber: 0.1661, swd: 0.1066, ept: 141.8028
    Epoch [1/50], Test Losses: mse: 0.1912, mae: 0.3130, huber: 0.0939, swd: 0.0538, ept: 185.3595
      Epoch 1 composite train-obj: 0.186777
            Val objective improved inf → 0.1661, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4298, mae: 0.3947, huber: 0.1600, swd: 0.1841, ept: 200.8638
    Epoch [2/50], Val Losses: mse: 0.3439, mae: 0.4270, huber: 0.1630, swd: 0.1062, ept: 146.2305
    Epoch [2/50], Test Losses: mse: 0.1904, mae: 0.3099, huber: 0.0930, swd: 0.0596, ept: 192.8749
      Epoch 2 composite train-obj: 0.160043
            Val objective improved 0.1661 → 0.1630, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4201, mae: 0.3881, huber: 0.1562, swd: 0.1794, ept: 205.0604
    Epoch [3/50], Val Losses: mse: 0.3565, mae: 0.4344, huber: 0.1685, swd: 0.1101, ept: 147.7333
    Epoch [3/50], Test Losses: mse: 0.1879, mae: 0.3104, huber: 0.0922, swd: 0.0566, ept: 195.0680
      Epoch 3 composite train-obj: 0.156198
            No improvement (0.1685), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4228, mae: 0.3894, huber: 0.1571, swd: 0.1803, ept: 206.4469
    Epoch [4/50], Val Losses: mse: 0.3439, mae: 0.4278, huber: 0.1627, swd: 0.1132, ept: 150.0750
    Epoch [4/50], Test Losses: mse: 0.1937, mae: 0.3115, huber: 0.0942, swd: 0.0648, ept: 193.9134
      Epoch 4 composite train-obj: 0.157127
            Val objective improved 0.1630 → 0.1627, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.4171, mae: 0.3859, huber: 0.1549, swd: 0.1784, ept: 207.3781
    Epoch [5/50], Val Losses: mse: 0.3372, mae: 0.4220, huber: 0.1598, swd: 0.1082, ept: 153.9184
    Epoch [5/50], Test Losses: mse: 0.1907, mae: 0.3096, huber: 0.0930, swd: 0.0622, ept: 197.0109
      Epoch 5 composite train-obj: 0.154866
            Val objective improved 0.1627 → 0.1598, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.4165, mae: 0.3852, huber: 0.1546, swd: 0.1784, ept: 209.0147
    Epoch [6/50], Val Losses: mse: 0.3569, mae: 0.4321, huber: 0.1684, swd: 0.1040, ept: 150.8538
    Epoch [6/50], Test Losses: mse: 0.1891, mae: 0.3116, huber: 0.0928, swd: 0.0547, ept: 193.2265
      Epoch 6 composite train-obj: 0.154570
            No improvement (0.1684), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.4225, mae: 0.3888, huber: 0.1564, swd: 0.1792, ept: 207.1750
    Epoch [7/50], Val Losses: mse: 0.3572, mae: 0.4335, huber: 0.1688, swd: 0.1121, ept: 145.4624
    Epoch [7/50], Test Losses: mse: 0.1879, mae: 0.3126, huber: 0.0921, swd: 0.0550, ept: 197.3961
      Epoch 7 composite train-obj: 0.156377
            No improvement (0.1688), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.4158, mae: 0.3851, huber: 0.1543, swd: 0.1774, ept: 209.5028
    Epoch [8/50], Val Losses: mse: 0.3426, mae: 0.4266, huber: 0.1618, swd: 0.1113, ept: 153.7439
    Epoch [8/50], Test Losses: mse: 0.1899, mae: 0.3089, huber: 0.0926, swd: 0.0589, ept: 196.6013
      Epoch 8 composite train-obj: 0.154304
            No improvement (0.1618), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.4168, mae: 0.3855, huber: 0.1547, swd: 0.1782, ept: 209.2393
    Epoch [9/50], Val Losses: mse: 0.3527, mae: 0.4295, huber: 0.1652, swd: 0.1199, ept: 149.9976
    Epoch [9/50], Test Losses: mse: 0.1951, mae: 0.3212, huber: 0.0956, swd: 0.0627, ept: 193.5964
      Epoch 9 composite train-obj: 0.154721
            No improvement (0.1652), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.4157, mae: 0.3856, huber: 0.1543, swd: 0.1775, ept: 209.5582
    Epoch [10/50], Val Losses: mse: 0.3504, mae: 0.4334, huber: 0.1663, swd: 0.1118, ept: 149.2957
    Epoch [10/50], Test Losses: mse: 0.1823, mae: 0.3044, huber: 0.0894, swd: 0.0559, ept: 198.4246
      Epoch 10 composite train-obj: 0.154295
    Epoch [10/50], Test Losses: mse: 0.1907, mae: 0.3096, huber: 0.0930, swd: 0.0622, ept: 197.0109
    Best round's Test MSE: 0.1907, MAE: 0.3096, SWD: 0.0622
    Best round's Validation MSE: 0.3372, MAE: 0.4220, SWD: 0.1082
    Best round's Test verification MSE : 0.1907, MAE: 0.3096, SWD: 0.0622
    Time taken: 9.96 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq336_pred336_20250510_2139)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1939 ± 0.0057
      mae: 0.3155 ± 0.0079
      huber: 0.0948 ± 0.0029
      swd: 0.0632 ± 0.0067
      ept: 192.9731 ± 3.6246
      count: 9.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3363 ± 0.0061
      mae: 0.4211 ± 0.0046
      huber: 0.1592 ± 0.0030
      swd: 0.1069 ± 0.0011
      ept: 151.0744 ± 2.1850
      count: 9.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 27.23 seconds
    
    Experiment complete: DLinear_etth2_seq336_pred336_20250510_2139
    Model: DLinear
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=336,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([336, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 336, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 336
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6238, mae: 0.5086, huber: 0.2318, swd: 0.2702, ept: 252.1049
    Epoch [1/50], Val Losses: mse: 0.4135, mae: 0.4747, huber: 0.1938, swd: 0.0997, ept: 237.5562
    Epoch [1/50], Test Losses: mse: 0.2261, mae: 0.3411, huber: 0.1094, swd: 0.0625, ept: 307.9731
      Epoch 1 composite train-obj: 0.231839
            Val objective improved inf → 0.1938, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5824, mae: 0.4777, huber: 0.2134, swd: 0.2741, ept: 303.9527
    Epoch [2/50], Val Losses: mse: 0.4004, mae: 0.4732, huber: 0.1885, swd: 0.1119, ept: 246.3906
    Epoch [2/50], Test Losses: mse: 0.2202, mae: 0.3330, huber: 0.1061, swd: 0.0699, ept: 315.6835
      Epoch 2 composite train-obj: 0.213368
            Val objective improved 0.1938 → 0.1885, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.5631, mae: 0.4684, huber: 0.2072, swd: 0.2596, ept: 312.4689
    Epoch [3/50], Val Losses: mse: 0.3644, mae: 0.4493, huber: 0.1724, swd: 0.0814, ept: 247.6879
    Epoch [3/50], Test Losses: mse: 0.2618, mae: 0.3787, huber: 0.1257, swd: 0.1048, ept: 299.4253
      Epoch 3 composite train-obj: 0.207214
            Val objective improved 0.1885 → 0.1724, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.5657, mae: 0.4685, huber: 0.2075, swd: 0.2657, ept: 313.4470
    Epoch [4/50], Val Losses: mse: 0.4031, mae: 0.4723, huber: 0.1896, swd: 0.1065, ept: 252.3478
    Epoch [4/50], Test Losses: mse: 0.2305, mae: 0.3438, huber: 0.1109, swd: 0.0750, ept: 315.9864
      Epoch 4 composite train-obj: 0.207546
            No improvement (0.1896), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.5518, mae: 0.4643, huber: 0.2040, swd: 0.2577, ept: 316.6645
    Epoch [5/50], Val Losses: mse: 0.4150, mae: 0.4829, huber: 0.1953, swd: 0.1392, ept: 237.7880
    Epoch [5/50], Test Losses: mse: 0.2461, mae: 0.3557, huber: 0.1174, swd: 0.0955, ept: 315.6783
      Epoch 5 composite train-obj: 0.204041
            No improvement (0.1953), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.5509, mae: 0.4630, huber: 0.2034, swd: 0.2580, ept: 318.3845
    Epoch [6/50], Val Losses: mse: 0.4037, mae: 0.4720, huber: 0.1898, swd: 0.1165, ept: 248.6510
    Epoch [6/50], Test Losses: mse: 0.2314, mae: 0.3435, huber: 0.1112, swd: 0.0774, ept: 315.6286
      Epoch 6 composite train-obj: 0.203403
            No improvement (0.1898), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.5502, mae: 0.4626, huber: 0.2032, swd: 0.2568, ept: 318.5959
    Epoch [7/50], Val Losses: mse: 0.3856, mae: 0.4672, huber: 0.1827, swd: 0.1121, ept: 257.1629
    Epoch [7/50], Test Losses: mse: 0.2298, mae: 0.3444, huber: 0.1105, swd: 0.0766, ept: 322.8363
      Epoch 7 composite train-obj: 0.203165
            No improvement (0.1827), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.5504, mae: 0.4625, huber: 0.2031, swd: 0.2576, ept: 322.3308
    Epoch [8/50], Val Losses: mse: 0.3746, mae: 0.4508, huber: 0.1777, swd: 0.0858, ept: 261.0695
    Epoch [8/50], Test Losses: mse: 0.2357, mae: 0.3477, huber: 0.1134, swd: 0.0764, ept: 322.3842
      Epoch 8 composite train-obj: 0.203132
    Epoch [8/50], Test Losses: mse: 0.2618, mae: 0.3787, huber: 0.1257, swd: 0.1048, ept: 299.4253
    Best round's Test MSE: 0.2618, MAE: 0.3787, SWD: 0.1048
    Best round's Validation MSE: 0.3644, MAE: 0.4493, SWD: 0.0814
    Best round's Test verification MSE : 0.2618, MAE: 0.3787, SWD: 0.1048
    Time taken: 7.89 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6220, mae: 0.5078, huber: 0.2313, swd: 0.2598, ept: 252.8664
    Epoch [1/50], Val Losses: mse: 0.3907, mae: 0.4665, huber: 0.1840, swd: 0.0795, ept: 234.5011
    Epoch [1/50], Test Losses: mse: 0.2314, mae: 0.3477, huber: 0.1119, swd: 0.0619, ept: 306.4946
      Epoch 1 composite train-obj: 0.231317
            Val objective improved inf → 0.1840, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5626, mae: 0.4706, huber: 0.2080, swd: 0.2529, ept: 305.6254
    Epoch [2/50], Val Losses: mse: 0.3847, mae: 0.4616, huber: 0.1825, swd: 0.0738, ept: 242.1064
    Epoch [2/50], Test Losses: mse: 0.2371, mae: 0.3529, huber: 0.1145, swd: 0.0650, ept: 315.5831
      Epoch 2 composite train-obj: 0.207977
            Val objective improved 0.1840 → 0.1825, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.5631, mae: 0.4685, huber: 0.2072, swd: 0.2547, ept: 312.1142
    Epoch [3/50], Val Losses: mse: 0.3934, mae: 0.4673, huber: 0.1858, swd: 0.0835, ept: 244.5320
    Epoch [3/50], Test Losses: mse: 0.2335, mae: 0.3478, huber: 0.1125, swd: 0.0695, ept: 317.4024
      Epoch 3 composite train-obj: 0.207222
            No improvement (0.1858), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.5531, mae: 0.4650, huber: 0.2045, swd: 0.2507, ept: 315.0305
    Epoch [4/50], Val Losses: mse: 0.3828, mae: 0.4571, huber: 0.1813, swd: 0.0778, ept: 252.2356
    Epoch [4/50], Test Losses: mse: 0.2323, mae: 0.3470, huber: 0.1120, swd: 0.0688, ept: 318.1130
      Epoch 4 composite train-obj: 0.204478
            Val objective improved 0.1825 → 0.1813, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.5534, mae: 0.4641, huber: 0.2043, swd: 0.2499, ept: 316.8621
    Epoch [5/50], Val Losses: mse: 0.3765, mae: 0.4514, huber: 0.1784, swd: 0.0609, ept: 256.0161
    Epoch [5/50], Test Losses: mse: 0.2396, mae: 0.3533, huber: 0.1158, swd: 0.0653, ept: 315.3527
      Epoch 5 composite train-obj: 0.204290
            Val objective improved 0.1813 → 0.1784, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.5546, mae: 0.4653, huber: 0.2049, swd: 0.2502, ept: 317.5796
    Epoch [6/50], Val Losses: mse: 0.3658, mae: 0.4504, huber: 0.1736, swd: 0.0730, ept: 253.3999
    Epoch [6/50], Test Losses: mse: 0.2268, mae: 0.3407, huber: 0.1094, swd: 0.0641, ept: 322.7115
      Epoch 6 composite train-obj: 0.204852
            Val objective improved 0.1784 → 0.1736, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.5730, mae: 0.4700, huber: 0.2094, swd: 0.2600, ept: 317.7017
    Epoch [7/50], Val Losses: mse: 0.3688, mae: 0.4527, huber: 0.1754, swd: 0.0823, ept: 251.1090
    Epoch [7/50], Test Losses: mse: 0.2431, mae: 0.3594, huber: 0.1170, swd: 0.0774, ept: 319.1841
      Epoch 7 composite train-obj: 0.209388
            No improvement (0.1754), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.5562, mae: 0.4670, huber: 0.2056, swd: 0.2524, ept: 317.4046
    Epoch [8/50], Val Losses: mse: 0.4227, mae: 0.4862, huber: 0.1980, swd: 0.1182, ept: 250.4408
    Epoch [8/50], Test Losses: mse: 0.2211, mae: 0.3344, huber: 0.1066, swd: 0.0662, ept: 319.2115
      Epoch 8 composite train-obj: 0.205623
            No improvement (0.1980), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.5603, mae: 0.4686, huber: 0.2065, swd: 0.2533, ept: 318.3917
    Epoch [9/50], Val Losses: mse: 0.3944, mae: 0.4695, huber: 0.1858, swd: 0.0893, ept: 269.6775
    Epoch [9/50], Test Losses: mse: 0.2338, mae: 0.3443, huber: 0.1123, swd: 0.0713, ept: 318.0858
      Epoch 9 composite train-obj: 0.206546
            No improvement (0.1858), counter 3/5
    Epoch [10/50], Train Losses: mse: 0.5716, mae: 0.4694, huber: 0.2086, swd: 0.2601, ept: 318.9845
    Epoch [10/50], Val Losses: mse: 0.3731, mae: 0.4584, huber: 0.1771, swd: 0.0811, ept: 252.3725
    Epoch [10/50], Test Losses: mse: 0.2408, mae: 0.3558, huber: 0.1158, swd: 0.0769, ept: 316.8524
      Epoch 10 composite train-obj: 0.208584
            No improvement (0.1771), counter 4/5
    Epoch [11/50], Train Losses: mse: 0.5517, mae: 0.4639, huber: 0.2038, swd: 0.2508, ept: 319.6504
    Epoch [11/50], Val Losses: mse: 0.3799, mae: 0.4579, huber: 0.1796, swd: 0.0823, ept: 259.1351
    Epoch [11/50], Test Losses: mse: 0.2226, mae: 0.3390, huber: 0.1076, swd: 0.0616, ept: 321.2526
      Epoch 11 composite train-obj: 0.203795
    Epoch [11/50], Test Losses: mse: 0.2268, mae: 0.3407, huber: 0.1094, swd: 0.0641, ept: 322.7115
    Best round's Test MSE: 0.2268, MAE: 0.3407, SWD: 0.0641
    Best round's Validation MSE: 0.3658, MAE: 0.4504, SWD: 0.0730
    Best round's Test verification MSE : 0.2268, MAE: 0.3407, SWD: 0.0641
    Time taken: 10.82 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6344, mae: 0.5109, huber: 0.2340, swd: 0.2915, ept: 252.2716
    Epoch [1/50], Val Losses: mse: 0.3856, mae: 0.4665, huber: 0.1825, swd: 0.0983, ept: 240.3095
    Epoch [1/50], Test Losses: mse: 0.2425, mae: 0.3511, huber: 0.1160, swd: 0.0819, ept: 305.6920
      Epoch 1 composite train-obj: 0.233977
            Val objective improved inf → 0.1825, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5645, mae: 0.4709, huber: 0.2083, swd: 0.2755, ept: 305.3115
    Epoch [2/50], Val Losses: mse: 0.3580, mae: 0.4467, huber: 0.1702, swd: 0.0748, ept: 249.5492
    Epoch [2/50], Test Losses: mse: 0.2523, mae: 0.3638, huber: 0.1209, swd: 0.0934, ept: 310.1488
      Epoch 2 composite train-obj: 0.208278
            Val objective improved 0.1825 → 0.1702, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.5571, mae: 0.4671, huber: 0.2059, swd: 0.2741, ept: 312.3170
    Epoch [3/50], Val Losses: mse: 0.3712, mae: 0.4500, huber: 0.1760, swd: 0.0844, ept: 245.6949
    Epoch [3/50], Test Losses: mse: 0.2349, mae: 0.3553, huber: 0.1137, swd: 0.0784, ept: 315.9644
      Epoch 3 composite train-obj: 0.205864
            No improvement (0.1760), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.5560, mae: 0.4667, huber: 0.2057, swd: 0.2741, ept: 315.8317
    Epoch [4/50], Val Losses: mse: 0.4042, mae: 0.4669, huber: 0.1900, swd: 0.1053, ept: 256.0639
    Epoch [4/50], Test Losses: mse: 0.2236, mae: 0.3385, huber: 0.1082, swd: 0.0699, ept: 318.9627
      Epoch 4 composite train-obj: 0.205703
            No improvement (0.1900), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.5529, mae: 0.4645, huber: 0.2044, swd: 0.2725, ept: 316.4416
    Epoch [5/50], Val Losses: mse: 0.3820, mae: 0.4580, huber: 0.1806, swd: 0.0767, ept: 254.0133
    Epoch [5/50], Test Losses: mse: 0.2354, mae: 0.3465, huber: 0.1133, swd: 0.0745, ept: 315.6019
      Epoch 5 composite train-obj: 0.204411
            No improvement (0.1806), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.5549, mae: 0.4650, huber: 0.2048, swd: 0.2723, ept: 317.8213
    Epoch [6/50], Val Losses: mse: 0.3724, mae: 0.4573, huber: 0.1773, swd: 0.0911, ept: 248.7197
    Epoch [6/50], Test Losses: mse: 0.2498, mae: 0.3607, huber: 0.1198, swd: 0.0889, ept: 309.7244
      Epoch 6 composite train-obj: 0.204843
            No improvement (0.1773), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.5550, mae: 0.4654, huber: 0.2049, swd: 0.2731, ept: 318.2729
    Epoch [7/50], Val Losses: mse: 0.3914, mae: 0.4627, huber: 0.1846, swd: 0.1008, ept: 249.1792
    Epoch [7/50], Test Losses: mse: 0.2303, mae: 0.3507, huber: 0.1114, swd: 0.0781, ept: 319.0898
      Epoch 7 composite train-obj: 0.204906
    Epoch [7/50], Test Losses: mse: 0.2523, mae: 0.3638, huber: 0.1209, swd: 0.0934, ept: 310.1488
    Best round's Test MSE: 0.2523, MAE: 0.3638, SWD: 0.0934
    Best round's Validation MSE: 0.3580, MAE: 0.4467, SWD: 0.0748
    Best round's Test verification MSE : 0.2523, MAE: 0.3638, SWD: 0.0934
    Time taken: 6.81 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq336_pred720_20250510_2140)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2470 ± 0.0148
      mae: 0.3610 ± 0.0156
      huber: 0.1187 ± 0.0068
      swd: 0.0874 ± 0.0171
      ept: 310.7619 ± 9.5164
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3627 ± 0.0034
      mae: 0.4488 ± 0.0016
      huber: 0.1721 ± 0.0014
      swd: 0.0764 ± 0.0036
      ept: 250.2123 ± 2.3786
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 25.60 seconds
    
    Experiment complete: DLinear_etth2_seq336_pred720_20250510_2140
    Model: DLinear
    Dataset: etth2
    Sequence Length: 336
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    


