# data


```python
import torch 
import importlib
import monotonic
import data_manager
import metrics
import utils
importlib.reload(utils)
import train as Train
from train import execute_model_evaluation
import train_config
from data_manager import DatasetManager
data_mgr = DatasetManager(device='cuda')

# Load a synthetic dataset
data_mgr.load_csv('etth2', './etth2.csv')
```

    
    ==================================================
    Dataset: etth2 (csv)
    ==================================================
    Shape: torch.Size([17420, 7])
    Channels: 7
    Length: 17420
    Source: ./etth2.csv
    
    Sample data (first 2 rows):
    tensor([[41.1300, 12.4810, 36.5360,  9.3550,  4.4240,  1.3110, 38.6620],
            [37.5280, 10.1360, 33.9360,  7.5320,  4.4350,  1.2150, 37.1240]])
    ==================================================
    




    <data_manager.DatasetManager at 0x1e616ac1e50>



## Seq=720

### EigenACL

#### pred=96


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4109, mae: 0.4011, huber: 0.1594, swd: 0.2402, ept: 69.4718
    Epoch [1/50], Val Losses: mse: 0.2648, mae: 0.3698, huber: 0.1271, swd: 0.1263, ept: 63.0773
    Epoch [1/50], Test Losses: mse: 0.1744, mae: 0.3011, huber: 0.0854, swd: 0.0701, ept: 75.2032
      Epoch 1 composite train-obj: 0.159434
            Val objective improved inf → 0.1271, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2846, mae: 0.3291, huber: 0.1127, swd: 0.1377, ept: 77.1956
    Epoch [2/50], Val Losses: mse: 0.2798, mae: 0.3911, huber: 0.1338, swd: 0.1402, ept: 62.6988
    Epoch [2/50], Test Losses: mse: 0.1692, mae: 0.3000, huber: 0.0830, swd: 0.0710, ept: 75.6026
      Epoch 2 composite train-obj: 0.112748
            No improvement (0.1338), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2340, mae: 0.2957, huber: 0.0936, swd: 0.1111, ept: 80.5576
    Epoch [3/50], Val Losses: mse: 0.2758, mae: 0.3791, huber: 0.1315, swd: 0.1101, ept: 64.5932
    Epoch [3/50], Test Losses: mse: 0.1610, mae: 0.2879, huber: 0.0790, swd: 0.0623, ept: 76.3297
      Epoch 3 composite train-obj: 0.093618
            No improvement (0.1315), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.1921, mae: 0.2699, huber: 0.0786, swd: 0.0792, ept: 83.6792
    Epoch [4/50], Val Losses: mse: 0.2993, mae: 0.3978, huber: 0.1429, swd: 0.1171, ept: 61.2418
    Epoch [4/50], Test Losses: mse: 0.1720, mae: 0.3031, huber: 0.0847, swd: 0.0593, ept: 77.2654
      Epoch 4 composite train-obj: 0.078559
            No improvement (0.1429), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.1680, mae: 0.2553, huber: 0.0701, swd: 0.0624, ept: 85.1088
    Epoch [5/50], Val Losses: mse: 0.3007, mae: 0.4010, huber: 0.1437, swd: 0.1192, ept: 62.2327
    Epoch [5/50], Test Losses: mse: 0.1693, mae: 0.2997, huber: 0.0832, swd: 0.0585, ept: 77.2327
      Epoch 5 composite train-obj: 0.070107
            No improvement (0.1437), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1517, mae: 0.2454, huber: 0.0643, swd: 0.0521, ept: 85.6436
    Epoch [6/50], Val Losses: mse: 0.3129, mae: 0.4097, huber: 0.1487, swd: 0.1324, ept: 63.5901
    Epoch [6/50], Test Losses: mse: 0.1812, mae: 0.3109, huber: 0.0887, swd: 0.0725, ept: 76.9802
      Epoch 6 composite train-obj: 0.064306
    Epoch [6/50], Test Losses: mse: 0.1744, mae: 0.3011, huber: 0.0854, swd: 0.0701, ept: 75.2032
    Best round's Test MSE: 0.1744, MAE: 0.3011, SWD: 0.0701
    Best round's Validation MSE: 0.2648, MAE: 0.3698, SWD: 0.1263
    Best round's Test verification MSE : 0.1744, MAE: 0.3011, SWD: 0.0701
    Time taken: 15.25 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4150, mae: 0.4047, huber: 0.1617, swd: 0.2355, ept: 68.7775
    Epoch [1/50], Val Losses: mse: 0.2626, mae: 0.3658, huber: 0.1259, swd: 0.1163, ept: 62.8050
    Epoch [1/50], Test Losses: mse: 0.1711, mae: 0.2992, huber: 0.0838, swd: 0.0604, ept: 76.1859
      Epoch 1 composite train-obj: 0.161690
            Val objective improved inf → 0.1259, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2764, mae: 0.3243, huber: 0.1097, swd: 0.1292, ept: 77.9250
    Epoch [2/50], Val Losses: mse: 0.2555, mae: 0.3625, huber: 0.1225, swd: 0.1049, ept: 64.1418
    Epoch [2/50], Test Losses: mse: 0.1557, mae: 0.2840, huber: 0.0766, swd: 0.0514, ept: 76.6785
      Epoch 2 composite train-obj: 0.109689
            Val objective improved 0.1259 → 0.1225, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2297, mae: 0.2917, huber: 0.0917, swd: 0.1047, ept: 81.1962
    Epoch [3/50], Val Losses: mse: 0.2748, mae: 0.3736, huber: 0.1306, swd: 0.0984, ept: 64.6714
    Epoch [3/50], Test Losses: mse: 0.1551, mae: 0.2845, huber: 0.0763, swd: 0.0509, ept: 77.5234
      Epoch 3 composite train-obj: 0.091690
            No improvement (0.1306), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.1923, mae: 0.2698, huber: 0.0786, swd: 0.0807, ept: 83.5605
    Epoch [4/50], Val Losses: mse: 0.2845, mae: 0.3784, huber: 0.1345, swd: 0.0925, ept: 63.9500
    Epoch [4/50], Test Losses: mse: 0.1643, mae: 0.2927, huber: 0.0804, swd: 0.0522, ept: 78.0084
      Epoch 4 composite train-obj: 0.078603
            No improvement (0.1345), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.1684, mae: 0.2565, huber: 0.0706, swd: 0.0631, ept: 84.7975
    Epoch [5/50], Val Losses: mse: 0.2895, mae: 0.3934, huber: 0.1378, swd: 0.1186, ept: 64.0401
    Epoch [5/50], Test Losses: mse: 0.1931, mae: 0.3207, huber: 0.0940, swd: 0.0830, ept: 76.9570
      Epoch 5 composite train-obj: 0.070627
            No improvement (0.1378), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.1499, mae: 0.2431, huber: 0.0635, swd: 0.0508, ept: 85.7470
    Epoch [6/50], Val Losses: mse: 0.2961, mae: 0.3913, huber: 0.1409, swd: 0.1051, ept: 63.9725
    Epoch [6/50], Test Losses: mse: 0.2061, mae: 0.3367, huber: 0.1003, swd: 0.0769, ept: 76.9539
      Epoch 6 composite train-obj: 0.063540
            No improvement (0.1409), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.1405, mae: 0.2362, huber: 0.0598, swd: 0.0455, ept: 86.2788
    Epoch [7/50], Val Losses: mse: 0.3080, mae: 0.3996, huber: 0.1460, swd: 0.1193, ept: 64.0658
    Epoch [7/50], Test Losses: mse: 0.2196, mae: 0.3491, huber: 0.1070, swd: 0.0935, ept: 76.3683
      Epoch 7 composite train-obj: 0.059819
    Epoch [7/50], Test Losses: mse: 0.1557, mae: 0.2840, huber: 0.0766, swd: 0.0514, ept: 76.6801
    Best round's Test MSE: 0.1557, MAE: 0.2840, SWD: 0.0514
    Best round's Validation MSE: 0.2555, MAE: 0.3625, SWD: 0.1049
    Best round's Test verification MSE : 0.1557, MAE: 0.2840, SWD: 0.0514
    Time taken: 17.46 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4079, mae: 0.4003, huber: 0.1587, swd: 0.2186, ept: 69.5184
    Epoch [1/50], Val Losses: mse: 0.2621, mae: 0.3649, huber: 0.1258, swd: 0.1122, ept: 63.1972
    Epoch [1/50], Test Losses: mse: 0.1709, mae: 0.2989, huber: 0.0838, swd: 0.0586, ept: 75.9904
      Epoch 1 composite train-obj: 0.158717
            Val objective improved inf → 0.1258, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2751, mae: 0.3237, huber: 0.1094, swd: 0.1208, ept: 77.9734
    Epoch [2/50], Val Losses: mse: 0.2583, mae: 0.3665, huber: 0.1239, swd: 0.1085, ept: 63.7445
    Epoch [2/50], Test Losses: mse: 0.1613, mae: 0.2885, huber: 0.0792, swd: 0.0590, ept: 75.8321
      Epoch 2 composite train-obj: 0.109369
            Val objective improved 0.1258 → 0.1239, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2266, mae: 0.2918, huber: 0.0909, swd: 0.0986, ept: 80.8022
    Epoch [3/50], Val Losses: mse: 0.2713, mae: 0.3745, huber: 0.1297, swd: 0.0972, ept: 62.9590
    Epoch [3/50], Test Losses: mse: 0.1589, mae: 0.2846, huber: 0.0781, swd: 0.0512, ept: 76.6721
      Epoch 3 composite train-obj: 0.090936
            No improvement (0.1297), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.1872, mae: 0.2674, huber: 0.0768, swd: 0.0720, ept: 83.9390
    Epoch [4/50], Val Losses: mse: 0.2802, mae: 0.3816, huber: 0.1334, swd: 0.0954, ept: 64.1158
    Epoch [4/50], Test Losses: mse: 0.1700, mae: 0.2984, huber: 0.0833, swd: 0.0535, ept: 77.1017
      Epoch 4 composite train-obj: 0.076837
            No improvement (0.1334), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.1603, mae: 0.2511, huber: 0.0676, swd: 0.0545, ept: 85.2688
    Epoch [5/50], Val Losses: mse: 0.2874, mae: 0.3877, huber: 0.1366, swd: 0.1066, ept: 65.7246
    Epoch [5/50], Test Losses: mse: 0.1698, mae: 0.2989, huber: 0.0833, swd: 0.0586, ept: 77.2090
      Epoch 5 composite train-obj: 0.067612
            No improvement (0.1366), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.1454, mae: 0.2405, huber: 0.0619, swd: 0.0458, ept: 85.9498
    Epoch [6/50], Val Losses: mse: 0.3003, mae: 0.3973, huber: 0.1427, swd: 0.1121, ept: 64.8295
    Epoch [6/50], Test Losses: mse: 0.1940, mae: 0.3262, huber: 0.0952, swd: 0.0730, ept: 76.8276
      Epoch 6 composite train-obj: 0.061865
            No improvement (0.1427), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.1348, mae: 0.2309, huber: 0.0574, swd: 0.0403, ept: 86.6130
    Epoch [7/50], Val Losses: mse: 0.3048, mae: 0.3969, huber: 0.1445, swd: 0.1062, ept: 65.1397
    Epoch [7/50], Test Losses: mse: 0.2009, mae: 0.3329, huber: 0.0987, swd: 0.0737, ept: 76.2940
      Epoch 7 composite train-obj: 0.057428
    Epoch [7/50], Test Losses: mse: 0.1613, mae: 0.2885, huber: 0.0792, swd: 0.0590, ept: 75.8321
    Best round's Test MSE: 0.1613, MAE: 0.2885, SWD: 0.0590
    Best round's Validation MSE: 0.2583, MAE: 0.3665, SWD: 0.1085
    Best round's Test verification MSE : 0.1613, MAE: 0.2885, SWD: 0.0590
    Time taken: 17.40 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred96_20250510_2145)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1638 ± 0.0078
      mae: 0.2912 ± 0.0072
      huber: 0.0804 ± 0.0037
      swd: 0.0602 ± 0.0077
      ept: 75.9046 ± 0.6045
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2595 ± 0.0039
      mae: 0.3663 ± 0.0030
      huber: 0.1245 ± 0.0019
      swd: 0.1132 ± 0.0093
      ept: 63.6545 ± 0.4392
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 51.53 seconds
    
    Experiment complete: ACL_etth2_seq720_pred96_20250510_2145
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 115.1287, mae: 5.6302, huber: 5.1865, swd: 89.2881, ept: 52.4215
    Epoch [1/50], Val Losses: mse: 21.8463, mae: 3.2123, huber: 2.7649, swd: 7.9786, ept: 59.2045
    Epoch [1/50], Test Losses: mse: 17.8323, mae: 2.7655, huber: 2.3294, swd: 8.0789, ept: 73.1269
      Epoch 1 composite train-obj: 5.186452
            Val objective improved inf → 2.7649, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 27.4601, mae: 2.9925, huber: 2.5658, swd: 13.6823, ept: 72.7850
    Epoch [2/50], Val Losses: mse: 21.6677, mae: 3.1613, huber: 2.7179, swd: 8.3154, ept: 61.5175
    Epoch [2/50], Test Losses: mse: 16.5945, mae: 2.6539, huber: 2.2189, swd: 7.2671, ept: 74.3885
      Epoch 2 composite train-obj: 2.565751
            Val objective improved 2.7649 → 2.7179, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 25.8063, mae: 2.8786, huber: 2.4547, swd: 12.8872, ept: 74.6947
    Epoch [3/50], Val Losses: mse: 21.1977, mae: 3.1167, huber: 2.6747, swd: 8.1992, ept: 61.8075
    Epoch [3/50], Test Losses: mse: 16.6875, mae: 2.6761, huber: 2.2409, swd: 7.5661, ept: 73.7432
      Epoch 3 composite train-obj: 2.454652
            Val objective improved 2.7179 → 2.6747, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 25.3387, mae: 2.8598, huber: 2.4352, swd: 12.9397, ept: 74.5916
    Epoch [4/50], Val Losses: mse: 20.9242, mae: 3.1133, huber: 2.6699, swd: 9.0431, ept: 64.3420
    Epoch [4/50], Test Losses: mse: 15.9621, mae: 2.6027, huber: 2.1688, swd: 7.7549, ept: 73.9756
      Epoch 4 composite train-obj: 2.435234
            Val objective improved 2.6747 → 2.6699, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 23.9230, mae: 2.7304, huber: 2.3081, swd: 12.0777, ept: 76.9281
    Epoch [5/50], Val Losses: mse: 19.5267, mae: 3.0000, huber: 2.5605, swd: 8.0306, ept: 64.1290
    Epoch [5/50], Test Losses: mse: 15.1718, mae: 2.5813, huber: 2.1453, swd: 7.0432, ept: 75.1124
      Epoch 5 composite train-obj: 2.308130
            Val objective improved 2.6699 → 2.5605, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 23.0659, mae: 2.6606, huber: 2.2396, swd: 11.8411, ept: 77.9988
    Epoch [6/50], Val Losses: mse: 18.1897, mae: 2.8931, huber: 2.4568, swd: 7.8236, ept: 66.2752
    Epoch [6/50], Test Losses: mse: 14.1249, mae: 2.4649, huber: 2.0325, swd: 6.8133, ept: 76.3489
      Epoch 6 composite train-obj: 2.239642
            Val objective improved 2.5605 → 2.4568, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 22.2006, mae: 2.5878, huber: 2.1683, swd: 11.4926, ept: 79.0282
    Epoch [7/50], Val Losses: mse: 18.1586, mae: 2.8876, huber: 2.4497, swd: 8.1641, ept: 67.5769
    Epoch [7/50], Test Losses: mse: 13.8715, mae: 2.4599, huber: 2.0274, swd: 6.8149, ept: 76.6671
      Epoch 7 composite train-obj: 2.168263
            Val objective improved 2.4568 → 2.4497, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 21.8173, mae: 2.5597, huber: 2.1411, swd: 11.3510, ept: 79.3342
    Epoch [8/50], Val Losses: mse: 18.1689, mae: 2.8934, huber: 2.4540, swd: 8.0558, ept: 66.9041
    Epoch [8/50], Test Losses: mse: 13.8013, mae: 2.4518, huber: 2.0198, swd: 6.6996, ept: 76.6373
      Epoch 8 composite train-obj: 2.141083
            No improvement (2.4540), counter 1/5
    Epoch [9/50], Train Losses: mse: 21.3732, mae: 2.5169, huber: 2.0998, swd: 11.0985, ept: 79.7967
    Epoch [9/50], Val Losses: mse: 18.8563, mae: 2.9476, huber: 2.5085, swd: 9.4718, ept: 66.1013
    Epoch [9/50], Test Losses: mse: 14.7477, mae: 2.6319, huber: 2.1920, swd: 8.1573, ept: 76.7196
      Epoch 9 composite train-obj: 2.099770
            No improvement (2.5085), counter 2/5
    Epoch [10/50], Train Losses: mse: 21.2618, mae: 2.5076, huber: 2.0913, swd: 11.1065, ept: 79.9305
    Epoch [10/50], Val Losses: mse: 18.5589, mae: 2.9368, huber: 2.4930, swd: 8.5975, ept: 66.1197
    Epoch [10/50], Test Losses: mse: 13.9499, mae: 2.5138, huber: 2.0785, swd: 7.0567, ept: 76.9486
      Epoch 10 composite train-obj: 2.091298
            No improvement (2.4930), counter 3/5
    Epoch [11/50], Train Losses: mse: 20.9007, mae: 2.4773, huber: 2.0614, swd: 10.7720, ept: 80.2572
    Epoch [11/50], Val Losses: mse: 18.5427, mae: 2.9667, huber: 2.5206, swd: 8.6679, ept: 65.9975
    Epoch [11/50], Test Losses: mse: 13.8751, mae: 2.4809, huber: 2.0478, swd: 7.0084, ept: 77.0894
      Epoch 11 composite train-obj: 2.061375
            No improvement (2.5206), counter 4/5
    Epoch [12/50], Train Losses: mse: 20.7286, mae: 2.4656, huber: 2.0502, swd: 10.6934, ept: 80.3219
    Epoch [12/50], Val Losses: mse: 18.4414, mae: 2.9391, huber: 2.4975, swd: 8.2635, ept: 66.0203
    Epoch [12/50], Test Losses: mse: 14.6151, mae: 2.5540, huber: 2.1179, swd: 7.5463, ept: 75.2617
      Epoch 12 composite train-obj: 2.050174
    Epoch [12/50], Test Losses: mse: 13.8715, mae: 2.4599, huber: 2.0274, swd: 6.8149, ept: 76.6671
    Best round's Test MSE: 13.8715, MAE: 2.4599, SWD: 6.8149
    Best round's Validation MSE: 18.1586, MAE: 2.8876, SWD: 8.1641
    Best round's Test verification MSE : 13.8715, MAE: 2.4599, SWD: 6.8149
    Time taken: 32.25 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 115.0944, mae: 5.5423, huber: 5.1001, swd: 84.6102, ept: 54.6172
    Epoch [1/50], Val Losses: mse: 22.1518, mae: 3.2197, huber: 2.7763, swd: 8.7476, ept: 61.4133
    Epoch [1/50], Test Losses: mse: 17.1647, mae: 2.7452, huber: 2.3055, swd: 7.7142, ept: 73.8540
      Epoch 1 composite train-obj: 5.100087
            Val objective improved inf → 2.7763, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 26.2211, mae: 2.9431, huber: 2.5166, swd: 12.7666, ept: 73.6023
    Epoch [2/50], Val Losses: mse: 23.1933, mae: 3.2504, huber: 2.8073, swd: 10.3130, ept: 62.2190
    Epoch [2/50], Test Losses: mse: 17.0330, mae: 2.7789, huber: 2.3365, swd: 7.9307, ept: 74.2653
      Epoch 2 composite train-obj: 2.516567
            No improvement (2.8073), counter 1/5
    Epoch [3/50], Train Losses: mse: 25.6482, mae: 2.9011, huber: 2.4760, swd: 12.4438, ept: 74.2787
    Epoch [3/50], Val Losses: mse: 22.5577, mae: 3.1905, huber: 2.7499, swd: 9.9157, ept: 62.7318
    Epoch [3/50], Test Losses: mse: 17.5237, mae: 2.7982, huber: 2.3565, swd: 8.6747, ept: 73.6347
      Epoch 3 composite train-obj: 2.475988
            Val objective improved 2.7763 → 2.7499, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 24.2426, mae: 2.7752, huber: 2.3527, swd: 11.5355, ept: 76.0784
    Epoch [4/50], Val Losses: mse: 19.9377, mae: 3.0209, huber: 2.5796, swd: 7.9504, ept: 64.1832
    Epoch [4/50], Test Losses: mse: 15.4772, mae: 2.6207, huber: 2.1828, swd: 6.9526, ept: 75.0944
      Epoch 4 composite train-obj: 2.352683
            Val objective improved 2.7499 → 2.5796, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 22.8798, mae: 2.6657, huber: 2.2443, swd: 11.1730, ept: 77.9842
    Epoch [5/50], Val Losses: mse: 19.1893, mae: 2.9764, huber: 2.5368, swd: 8.6449, ept: 65.2955
    Epoch [5/50], Test Losses: mse: 14.8000, mae: 2.5912, huber: 2.1541, swd: 7.2505, ept: 76.4974
      Epoch 5 composite train-obj: 2.244307
            Val objective improved 2.5796 → 2.5368, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 22.0141, mae: 2.6032, huber: 2.1832, swd: 10.8016, ept: 78.9656
    Epoch [6/50], Val Losses: mse: 17.6655, mae: 2.8426, huber: 2.4043, swd: 7.3722, ept: 66.8742
    Epoch [6/50], Test Losses: mse: 14.5574, mae: 2.5726, huber: 2.1328, swd: 7.1549, ept: 77.0086
      Epoch 6 composite train-obj: 2.183173
            Val objective improved 2.5368 → 2.4043, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 21.0617, mae: 2.5230, huber: 2.1049, swd: 10.3048, ept: 80.0122
    Epoch [7/50], Val Losses: mse: 17.6139, mae: 2.8465, huber: 2.4087, swd: 7.3601, ept: 66.5985
    Epoch [7/50], Test Losses: mse: 14.3149, mae: 2.5508, huber: 2.1127, swd: 6.8673, ept: 76.9242
      Epoch 7 composite train-obj: 2.104864
            No improvement (2.4087), counter 1/5
    Epoch [8/50], Train Losses: mse: 20.2507, mae: 2.4675, huber: 2.0507, swd: 9.7299, ept: 80.4881
    Epoch [8/50], Val Losses: mse: 18.0636, mae: 2.9033, huber: 2.4647, swd: 8.2606, ept: 66.1463
    Epoch [8/50], Test Losses: mse: 14.3163, mae: 2.5796, huber: 2.1400, swd: 7.2418, ept: 77.6793
      Epoch 8 composite train-obj: 2.050682
            No improvement (2.4647), counter 2/5
    Epoch [9/50], Train Losses: mse: 19.8128, mae: 2.4424, huber: 2.0261, swd: 9.4809, ept: 80.8418
    Epoch [9/50], Val Losses: mse: 17.6260, mae: 2.8516, huber: 2.4111, swd: 7.3858, ept: 66.2922
    Epoch [9/50], Test Losses: mse: 14.8412, mae: 2.6223, huber: 2.1821, swd: 7.3299, ept: 75.9619
      Epoch 9 composite train-obj: 2.026052
            No improvement (2.4111), counter 3/5
    Epoch [10/50], Train Losses: mse: 19.4625, mae: 2.4178, huber: 2.0019, swd: 9.2383, ept: 80.8824
    Epoch [10/50], Val Losses: mse: 18.2752, mae: 2.9229, huber: 2.4807, swd: 8.3211, ept: 67.4698
    Epoch [10/50], Test Losses: mse: 13.6292, mae: 2.5364, huber: 2.0978, swd: 6.5302, ept: 78.2202
      Epoch 10 composite train-obj: 2.001890
            No improvement (2.4807), counter 4/5
    Epoch [11/50], Train Losses: mse: 19.3098, mae: 2.4082, huber: 1.9931, swd: 9.1319, ept: 80.9993
    Epoch [11/50], Val Losses: mse: 18.1103, mae: 2.8779, huber: 2.4368, swd: 7.7868, ept: 66.8826
    Epoch [11/50], Test Losses: mse: 14.2962, mae: 2.5465, huber: 2.1092, swd: 6.9520, ept: 76.9133
      Epoch 11 composite train-obj: 1.993135
    Epoch [11/50], Test Losses: mse: 14.5573, mae: 2.5726, huber: 2.1328, swd: 7.1548, ept: 77.0050
    Best round's Test MSE: 14.5574, MAE: 2.5726, SWD: 7.1549
    Best round's Validation MSE: 17.6655, MAE: 2.8426, SWD: 7.3722
    Best round's Test verification MSE : 14.5573, MAE: 2.5726, SWD: 7.1548
    Time taken: 29.32 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 112.7479, mae: 5.4763, huber: 5.0336, swd: 77.6696, ept: 55.6023
    Epoch [1/50], Val Losses: mse: 21.4384, mae: 3.1673, huber: 2.7198, swd: 7.3731, ept: 60.9993
    Epoch [1/50], Test Losses: mse: 16.7274, mae: 2.6823, huber: 2.2442, swd: 6.7410, ept: 75.4138
      Epoch 1 composite train-obj: 5.033602
            Val objective improved inf → 2.7198, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 25.7530, mae: 2.9055, huber: 2.4794, swd: 11.5024, ept: 74.7956
    Epoch [2/50], Val Losses: mse: 21.3476, mae: 3.1237, huber: 2.6793, swd: 7.7788, ept: 63.0353
    Epoch [2/50], Test Losses: mse: 16.0961, mae: 2.6417, huber: 2.2042, swd: 6.3839, ept: 75.5256
      Epoch 2 composite train-obj: 2.479395
            Val objective improved 2.7198 → 2.6793, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 25.2088, mae: 2.8589, huber: 2.4354, swd: 11.2399, ept: 75.1736
    Epoch [3/50], Val Losses: mse: 22.8363, mae: 3.2113, huber: 2.7682, swd: 9.8376, ept: 63.1853
    Epoch [3/50], Test Losses: mse: 17.7282, mae: 2.7749, huber: 2.3354, swd: 8.4869, ept: 73.4548
      Epoch 3 composite train-obj: 2.435397
            No improvement (2.7682), counter 1/5
    Epoch [4/50], Train Losses: mse: 24.2476, mae: 2.7787, huber: 2.3568, swd: 10.6258, ept: 76.0987
    Epoch [4/50], Val Losses: mse: 20.1461, mae: 3.0206, huber: 2.5807, swd: 7.2064, ept: 64.2935
    Epoch [4/50], Test Losses: mse: 15.8770, mae: 2.6517, huber: 2.2142, swd: 6.4303, ept: 75.0910
      Epoch 4 composite train-obj: 2.356795
            Val objective improved 2.6793 → 2.5807, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 22.9034, mae: 2.6662, huber: 2.2453, swd: 10.2580, ept: 77.8694
    Epoch [5/50], Val Losses: mse: 19.3217, mae: 2.9826, huber: 2.5418, swd: 8.4233, ept: 66.6946
    Epoch [5/50], Test Losses: mse: 14.4773, mae: 2.5328, huber: 2.0981, swd: 6.5240, ept: 76.7522
      Epoch 5 composite train-obj: 2.245323
            Val objective improved 2.5807 → 2.5418, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 21.4071, mae: 2.5484, huber: 2.1305, swd: 9.7316, ept: 79.6742
    Epoch [6/50], Val Losses: mse: 17.9957, mae: 2.8712, huber: 2.4331, swd: 7.3372, ept: 67.2452
    Epoch [6/50], Test Losses: mse: 13.6806, mae: 2.4466, huber: 2.0135, swd: 5.9021, ept: 77.9160
      Epoch 6 composite train-obj: 2.130480
            Val objective improved 2.5418 → 2.4331, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 20.6479, mae: 2.4960, huber: 2.0792, swd: 9.3795, ept: 80.3531
    Epoch [7/50], Val Losses: mse: 18.5428, mae: 2.8862, huber: 2.4514, swd: 7.3004, ept: 66.8389
    Epoch [7/50], Test Losses: mse: 17.1092, mae: 2.7686, huber: 2.3280, swd: 8.4903, ept: 73.3214
      Epoch 7 composite train-obj: 2.079245
            No improvement (2.4514), counter 1/5
    Epoch [8/50], Train Losses: mse: 20.3913, mae: 2.4823, huber: 2.0662, swd: 9.2797, ept: 80.3168
    Epoch [8/50], Val Losses: mse: 17.2422, mae: 2.8108, huber: 2.3750, swd: 6.6892, ept: 67.8291
    Epoch [8/50], Test Losses: mse: 13.8970, mae: 2.4930, huber: 2.0564, swd: 6.1387, ept: 77.6282
      Epoch 8 composite train-obj: 2.066231
            Val objective improved 2.4331 → 2.3750, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 19.8768, mae: 2.4480, huber: 2.0329, swd: 8.9605, ept: 80.5847
    Epoch [9/50], Val Losses: mse: 18.7342, mae: 2.9384, huber: 2.4995, swd: 7.5803, ept: 66.9749
    Epoch [9/50], Test Losses: mse: 15.1715, mae: 2.5685, huber: 2.1335, swd: 6.9992, ept: 75.2520
      Epoch 9 composite train-obj: 2.032864
            No improvement (2.4995), counter 1/5
    Epoch [10/50], Train Losses: mse: 19.2776, mae: 2.3995, huber: 1.9854, swd: 8.4750, ept: 80.9608
    Epoch [10/50], Val Losses: mse: 17.7311, mae: 2.8554, huber: 2.4179, swd: 7.4579, ept: 68.3815
    Epoch [10/50], Test Losses: mse: 13.3677, mae: 2.4312, huber: 1.9988, swd: 5.7545, ept: 78.1718
      Epoch 10 composite train-obj: 1.985433
            No improvement (2.4179), counter 2/5
    Epoch [11/50], Train Losses: mse: 18.7014, mae: 2.3513, huber: 1.9378, swd: 8.0641, ept: 81.4138
    Epoch [11/50], Val Losses: mse: 19.2931, mae: 2.9834, huber: 2.5416, swd: 7.9611, ept: 66.9271
    Epoch [11/50], Test Losses: mse: 15.4344, mae: 2.6076, huber: 2.1720, swd: 7.2907, ept: 75.0071
      Epoch 11 composite train-obj: 1.937840
            No improvement (2.5416), counter 3/5
    Epoch [12/50], Train Losses: mse: 18.4972, mae: 2.3424, huber: 1.9292, swd: 7.9496, ept: 81.4812
    Epoch [12/50], Val Losses: mse: 17.8745, mae: 2.9276, huber: 2.4835, swd: 7.4867, ept: 67.6597
    Epoch [12/50], Test Losses: mse: 14.0433, mae: 2.5741, huber: 2.1346, swd: 6.4949, ept: 77.1266
      Epoch 12 composite train-obj: 1.929228
            No improvement (2.4835), counter 4/5
    Epoch [13/50], Train Losses: mse: 17.9385, mae: 2.3003, huber: 1.8876, swd: 7.5084, ept: 81.7493
    Epoch [13/50], Val Losses: mse: 17.8165, mae: 2.8881, huber: 2.4467, swd: 7.1614, ept: 68.1961
    Epoch [13/50], Test Losses: mse: 14.0559, mae: 2.5311, huber: 2.0941, swd: 6.3625, ept: 77.5885
      Epoch 13 composite train-obj: 1.887622
    Epoch [13/50], Test Losses: mse: 13.8965, mae: 2.4930, huber: 2.0563, swd: 6.1386, ept: 77.6280
    Best round's Test MSE: 13.8970, MAE: 2.4930, SWD: 6.1387
    Best round's Validation MSE: 17.2422, MAE: 2.8108, SWD: 6.6892
    Best round's Test verification MSE : 13.8965, MAE: 2.4930, SWD: 6.1386
    Time taken: 33.24 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred96_20250510_2224)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 14.1086 ± 0.3175
      mae: 2.5085 ± 0.0473
      huber: 2.0722 ± 0.0445
      swd: 6.7028 ± 0.4224
      ept: 77.1013 ± 0.3978
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 17.6887 ± 0.3745
      mae: 2.8470 ± 0.0315
      huber: 2.4097 ± 0.0307
      swd: 7.4085 ± 0.6027
      ept: 67.4267 ± 0.4040
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 94.90 seconds
    
    Experiment complete: ACL_etth2_seq720_pred96_20250510_2224
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4562, mae: 0.4273, huber: 0.1761, swd: 0.2689, ept: 119.6060
    Epoch [1/50], Val Losses: mse: 0.4606, mae: 0.5132, huber: 0.2139, swd: 0.3168, ept: 86.5811
    Epoch [1/50], Test Losses: mse: 0.2620, mae: 0.3847, huber: 0.1277, swd: 0.1717, ept: 114.3947
      Epoch 1 composite train-obj: 0.176139
            Val objective improved inf → 0.2139, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3419, mae: 0.3619, huber: 0.1332, swd: 0.1805, ept: 134.6308
    Epoch [2/50], Val Losses: mse: 0.3501, mae: 0.4362, huber: 0.1650, swd: 0.1633, ept: 96.0127
    Epoch [2/50], Test Losses: mse: 0.1928, mae: 0.3189, huber: 0.0942, swd: 0.0750, ept: 133.7215
      Epoch 2 composite train-obj: 0.133193
            Val objective improved 0.2139 → 0.1650, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2984, mae: 0.3351, huber: 0.1162, swd: 0.1538, ept: 137.9244
    Epoch [3/50], Val Losses: mse: 0.3833, mae: 0.4560, huber: 0.1804, swd: 0.1548, ept: 94.0486
    Epoch [3/50], Test Losses: mse: 0.2152, mae: 0.3388, huber: 0.1049, swd: 0.0650, ept: 125.6637
      Epoch 3 composite train-obj: 0.116228
            No improvement (0.1804), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2607, mae: 0.3069, huber: 0.1007, swd: 0.1219, ept: 145.5134
    Epoch [4/50], Val Losses: mse: 0.3386, mae: 0.4288, huber: 0.1603, swd: 0.1251, ept: 95.1329
    Epoch [4/50], Test Losses: mse: 0.2155, mae: 0.3414, huber: 0.1050, swd: 0.0863, ept: 127.7058
      Epoch 4 composite train-obj: 0.100712
            Val objective improved 0.1650 → 0.1603, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2310, mae: 0.2880, huber: 0.0899, swd: 0.0973, ept: 150.9908
    Epoch [5/50], Val Losses: mse: 0.3341, mae: 0.4281, huber: 0.1591, swd: 0.1325, ept: 98.1439
    Epoch [5/50], Test Losses: mse: 0.2033, mae: 0.3349, huber: 0.0996, swd: 0.0734, ept: 131.0528
      Epoch 5 composite train-obj: 0.089880
            Val objective improved 0.1603 → 0.1591, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.2146, mae: 0.2777, huber: 0.0840, swd: 0.0854, ept: 153.7986
    Epoch [6/50], Val Losses: mse: 0.3529, mae: 0.4392, huber: 0.1674, swd: 0.1378, ept: 99.5049
    Epoch [6/50], Test Losses: mse: 0.2311, mae: 0.3637, huber: 0.1134, swd: 0.0993, ept: 129.0718
      Epoch 6 composite train-obj: 0.084015
            No improvement (0.1674), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.1994, mae: 0.2686, huber: 0.0789, swd: 0.0738, ept: 155.7245
    Epoch [7/50], Val Losses: mse: 0.3442, mae: 0.4296, huber: 0.1626, swd: 0.1369, ept: 102.5070
    Epoch [7/50], Test Losses: mse: 0.2343, mae: 0.3698, huber: 0.1154, swd: 0.0974, ept: 128.2313
      Epoch 7 composite train-obj: 0.078942
            No improvement (0.1626), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.1896, mae: 0.2634, huber: 0.0756, swd: 0.0673, ept: 157.0472
    Epoch [8/50], Val Losses: mse: 0.3770, mae: 0.4565, huber: 0.1773, swd: 0.1518, ept: 96.4708
    Epoch [8/50], Test Losses: mse: 0.2707, mae: 0.3903, huber: 0.1328, swd: 0.1293, ept: 115.3517
      Epoch 8 composite train-obj: 0.075563
            No improvement (0.1773), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.1765, mae: 0.2571, huber: 0.0714, swd: 0.0586, ept: 158.2811
    Epoch [9/50], Val Losses: mse: 0.3739, mae: 0.4537, huber: 0.1758, swd: 0.1522, ept: 97.3036
    Epoch [9/50], Test Losses: mse: 0.2392, mae: 0.3693, huber: 0.1175, swd: 0.1113, ept: 123.4565
      Epoch 9 composite train-obj: 0.071440
            No improvement (0.1758), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.1655, mae: 0.2489, huber: 0.0671, swd: 0.0518, ept: 160.2290
    Epoch [10/50], Val Losses: mse: 0.3787, mae: 0.4553, huber: 0.1782, swd: 0.1473, ept: 96.3316
    Epoch [10/50], Test Losses: mse: 0.2880, mae: 0.4008, huber: 0.1410, swd: 0.1305, ept: 114.8606
      Epoch 10 composite train-obj: 0.067095
    Epoch [10/50], Test Losses: mse: 0.2033, mae: 0.3349, huber: 0.0996, swd: 0.0735, ept: 131.0145
    Best round's Test MSE: 0.2033, MAE: 0.3349, SWD: 0.0734
    Best round's Validation MSE: 0.3341, MAE: 0.4281, SWD: 0.1325
    Best round's Test verification MSE : 0.2033, MAE: 0.3349, SWD: 0.0735
    Time taken: 24.27 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4720, mae: 0.4335, huber: 0.1809, swd: 0.2879, ept: 118.6296
    Epoch [1/50], Val Losses: mse: 0.3586, mae: 0.4452, huber: 0.1687, swd: 0.1938, ept: 94.9472
    Epoch [1/50], Test Losses: mse: 0.2063, mae: 0.3315, huber: 0.1005, swd: 0.0978, ept: 129.3950
      Epoch 1 composite train-obj: 0.180862
            Val objective improved inf → 0.1687, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3450, mae: 0.3641, huber: 0.1346, swd: 0.1802, ept: 133.8005
    Epoch [2/50], Val Losses: mse: 0.3735, mae: 0.4495, huber: 0.1756, swd: 0.1777, ept: 95.5813
    Epoch [2/50], Test Losses: mse: 0.1999, mae: 0.3271, huber: 0.0976, swd: 0.0706, ept: 130.8101
      Epoch 2 composite train-obj: 0.134571
            No improvement (0.1756), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3019, mae: 0.3396, huber: 0.1181, swd: 0.1607, ept: 137.1093
    Epoch [3/50], Val Losses: mse: 0.3809, mae: 0.4521, huber: 0.1774, swd: 0.1538, ept: 95.8815
    Epoch [3/50], Test Losses: mse: 0.2111, mae: 0.3404, huber: 0.1035, swd: 0.0793, ept: 128.9530
      Epoch 3 composite train-obj: 0.118104
            No improvement (0.1774), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2611, mae: 0.3091, huber: 0.1013, swd: 0.1255, ept: 144.9914
    Epoch [4/50], Val Losses: mse: 0.3646, mae: 0.4444, huber: 0.1706, swd: 0.1541, ept: 95.1780
    Epoch [4/50], Test Losses: mse: 0.2414, mae: 0.3654, huber: 0.1180, swd: 0.1210, ept: 122.0768
      Epoch 4 composite train-obj: 0.101299
            No improvement (0.1706), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2313, mae: 0.2885, huber: 0.0899, swd: 0.0994, ept: 151.6397
    Epoch [5/50], Val Losses: mse: 0.3652, mae: 0.4432, huber: 0.1709, swd: 0.1452, ept: 98.6379
    Epoch [5/50], Test Losses: mse: 0.2443, mae: 0.3701, huber: 0.1198, swd: 0.1155, ept: 121.5455
      Epoch 5 composite train-obj: 0.089890
            No improvement (0.1709), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.2099, mae: 0.2746, huber: 0.0822, swd: 0.0827, ept: 154.8749
    Epoch [6/50], Val Losses: mse: 0.3645, mae: 0.4354, huber: 0.1694, swd: 0.1485, ept: 100.5343
    Epoch [6/50], Test Losses: mse: 0.2490, mae: 0.3761, huber: 0.1226, swd: 0.1168, ept: 119.2531
      Epoch 6 composite train-obj: 0.082244
    Epoch [6/50], Test Losses: mse: 0.2063, mae: 0.3315, huber: 0.1005, swd: 0.0978, ept: 129.4057
    Best round's Test MSE: 0.2063, MAE: 0.3315, SWD: 0.0978
    Best round's Validation MSE: 0.3586, MAE: 0.4452, SWD: 0.1938
    Best round's Test verification MSE : 0.2063, MAE: 0.3315, SWD: 0.0978
    Time taken: 14.48 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4557, mae: 0.4253, huber: 0.1753, swd: 0.2455, ept: 121.0743
    Epoch [1/50], Val Losses: mse: 0.3500, mae: 0.4330, huber: 0.1653, swd: 0.1396, ept: 97.9862
    Epoch [1/50], Test Losses: mse: 0.2021, mae: 0.3273, huber: 0.0986, swd: 0.0654, ept: 132.6434
      Epoch 1 composite train-obj: 0.175265
            Val objective improved inf → 0.1653, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3406, mae: 0.3620, huber: 0.1328, swd: 0.1669, ept: 134.3495
    Epoch [2/50], Val Losses: mse: 0.3705, mae: 0.4594, huber: 0.1747, swd: 0.1884, ept: 90.2092
    Epoch [2/50], Test Losses: mse: 0.2122, mae: 0.3432, huber: 0.1036, swd: 0.0937, ept: 131.4387
      Epoch 2 composite train-obj: 0.132825
            No improvement (0.1747), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2947, mae: 0.3333, huber: 0.1147, swd: 0.1432, ept: 138.8565
    Epoch [3/50], Val Losses: mse: 0.3560, mae: 0.4428, huber: 0.1677, swd: 0.1444, ept: 94.0353
    Epoch [3/50], Test Losses: mse: 0.2208, mae: 0.3518, huber: 0.1082, swd: 0.0897, ept: 124.7910
      Epoch 3 composite train-obj: 0.114695
            No improvement (0.1677), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2505, mae: 0.3027, huber: 0.0975, swd: 0.1086, ept: 148.9703
    Epoch [4/50], Val Losses: mse: 0.3370, mae: 0.4234, huber: 0.1589, swd: 0.1152, ept: 102.6240
    Epoch [4/50], Test Losses: mse: 0.2000, mae: 0.3363, huber: 0.0983, swd: 0.0653, ept: 130.6601
      Epoch 4 composite train-obj: 0.097462
            Val objective improved 0.1653 → 0.1589, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2249, mae: 0.2835, huber: 0.0874, swd: 0.0893, ept: 153.8518
    Epoch [5/50], Val Losses: mse: 0.3429, mae: 0.4238, huber: 0.1611, swd: 0.1129, ept: 101.7912
    Epoch [5/50], Test Losses: mse: 0.2232, mae: 0.3585, huber: 0.1099, swd: 0.0832, ept: 129.1194
      Epoch 5 composite train-obj: 0.087424
            No improvement (0.1611), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.2091, mae: 0.2739, huber: 0.0820, swd: 0.0798, ept: 155.7604
    Epoch [6/50], Val Losses: mse: 0.3476, mae: 0.4296, huber: 0.1633, swd: 0.1138, ept: 99.4656
    Epoch [6/50], Test Losses: mse: 0.2792, mae: 0.3968, huber: 0.1370, swd: 0.1237, ept: 116.7181
      Epoch 6 composite train-obj: 0.082008
            No improvement (0.1633), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.1966, mae: 0.2674, huber: 0.0780, swd: 0.0707, ept: 156.8933
    Epoch [7/50], Val Losses: mse: 0.3756, mae: 0.4440, huber: 0.1749, swd: 0.1202, ept: 101.3241
    Epoch [7/50], Test Losses: mse: 0.2343, mae: 0.3716, huber: 0.1152, swd: 0.0817, ept: 130.3081
      Epoch 7 composite train-obj: 0.078029
            No improvement (0.1749), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.1846, mae: 0.2618, huber: 0.0742, swd: 0.0614, ept: 157.9729
    Epoch [8/50], Val Losses: mse: 0.3789, mae: 0.4499, huber: 0.1766, swd: 0.1311, ept: 99.1002
    Epoch [8/50], Test Losses: mse: 0.3051, mae: 0.4108, huber: 0.1487, swd: 0.1396, ept: 115.7338
      Epoch 8 composite train-obj: 0.074187
            No improvement (0.1766), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.1721, mae: 0.2530, huber: 0.0694, swd: 0.0545, ept: 159.7559
    Epoch [9/50], Val Losses: mse: 0.3698, mae: 0.4421, huber: 0.1723, swd: 0.1175, ept: 100.7363
    Epoch [9/50], Test Losses: mse: 0.2892, mae: 0.4053, huber: 0.1419, swd: 0.1263, ept: 115.9785
      Epoch 9 composite train-obj: 0.069384
    Epoch [9/50], Test Losses: mse: 0.2000, mae: 0.3363, huber: 0.0982, swd: 0.0653, ept: 130.6614
    Best round's Test MSE: 0.2000, MAE: 0.3363, SWD: 0.0653
    Best round's Validation MSE: 0.3370, MAE: 0.4234, SWD: 0.1152
    Best round's Test verification MSE : 0.2000, MAE: 0.3363, SWD: 0.0653
    Time taken: 22.07 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred196_20250510_2146)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2032 ± 0.0026
      mae: 0.3342 ± 0.0020
      huber: 0.0995 ± 0.0009
      swd: 0.0788 ± 0.0138
      ept: 130.3693 ± 0.7074
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3432 ± 0.0109
      mae: 0.4322 ± 0.0094
      huber: 0.1623 ± 0.0046
      swd: 0.1472 ± 0.0337
      ept: 98.5717 ± 3.1486
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 60.91 seconds
    
    Experiment complete: ACL_etth2_seq720_pred196_20250510_2146
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 109.8736, mae: 5.5376, huber: 5.0931, swd: 83.7578, ept: 93.0545
    Epoch [1/50], Val Losses: mse: 29.3423, mae: 3.7326, huber: 3.2849, swd: 13.9675, ept: 95.4399
    Epoch [1/50], Test Losses: mse: 21.4346, mae: 3.1258, huber: 2.6791, swd: 10.5373, ept: 124.9417
      Epoch 1 composite train-obj: 5.093053
            Val objective improved inf → 3.2849, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 32.7890, mae: 3.2645, huber: 2.8333, swd: 16.0077, ept: 124.7848
    Epoch [2/50], Val Losses: mse: 29.7387, mae: 3.7683, huber: 3.3163, swd: 14.1392, ept: 95.3154
    Epoch [2/50], Test Losses: mse: 21.6445, mae: 3.1189, huber: 2.6736, swd: 10.9534, ept: 123.3433
      Epoch 2 composite train-obj: 2.833332
            No improvement (3.3163), counter 1/5
    Epoch [3/50], Train Losses: mse: 31.8856, mae: 3.1865, huber: 2.7577, swd: 15.4414, ept: 127.4851
    Epoch [3/50], Val Losses: mse: 26.8457, mae: 3.6388, huber: 3.1839, swd: 10.1986, ept: 90.8860
    Epoch [3/50], Test Losses: mse: 19.2669, mae: 2.8871, huber: 2.4481, swd: 7.7025, ept: 126.0816
      Epoch 3 composite train-obj: 2.757711
            Val objective improved 3.2849 → 3.1839, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 30.9732, mae: 3.1103, huber: 2.6829, swd: 14.6322, ept: 130.3353
    Epoch [4/50], Val Losses: mse: 26.2769, mae: 3.5815, huber: 3.1293, swd: 9.9919, ept: 94.8219
    Epoch [4/50], Test Losses: mse: 19.1394, mae: 2.9494, huber: 2.5047, swd: 7.9908, ept: 126.8597
      Epoch 4 composite train-obj: 2.682861
            Val objective improved 3.1839 → 3.1293, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 29.5780, mae: 3.0312, huber: 2.6041, swd: 13.7625, ept: 131.7146
    Epoch [5/50], Val Losses: mse: 27.4812, mae: 3.6799, huber: 3.2300, swd: 13.5974, ept: 99.0982
    Epoch [5/50], Test Losses: mse: 20.2589, mae: 3.1199, huber: 2.6720, swd: 10.6403, ept: 122.2760
      Epoch 5 composite train-obj: 2.604096
            No improvement (3.2300), counter 1/5
    Epoch [6/50], Train Losses: mse: 28.4547, mae: 2.9496, huber: 2.5231, swd: 13.5712, ept: 134.2967
    Epoch [6/50], Val Losses: mse: 23.6367, mae: 3.4021, huber: 2.9566, swd: 9.9201, ept: 99.6611
    Epoch [6/50], Test Losses: mse: 18.4389, mae: 3.0149, huber: 2.5683, swd: 8.6699, ept: 121.7009
      Epoch 6 composite train-obj: 2.523126
            Val objective improved 3.1293 → 2.9566, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 27.2445, mae: 2.8381, huber: 2.4134, swd: 12.9809, ept: 139.6017
    Epoch [7/50], Val Losses: mse: 23.1034, mae: 3.3781, huber: 2.9287, swd: 9.7067, ept: 101.9393
    Epoch [7/50], Test Losses: mse: 17.4969, mae: 2.9025, huber: 2.4583, swd: 8.1566, ept: 128.2671
      Epoch 7 composite train-obj: 2.413404
            Val objective improved 2.9566 → 2.9287, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 26.6283, mae: 2.7681, huber: 2.3453, swd: 12.5258, ept: 142.3819
    Epoch [8/50], Val Losses: mse: 23.2006, mae: 3.3205, huber: 2.8763, swd: 9.7188, ept: 101.2057
    Epoch [8/50], Test Losses: mse: 19.4497, mae: 3.1198, huber: 2.6726, swd: 9.7729, ept: 113.7150
      Epoch 8 composite train-obj: 2.345279
            Val objective improved 2.9287 → 2.8763, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 25.7193, mae: 2.7348, huber: 2.3121, swd: 11.8940, ept: 142.5716
    Epoch [9/50], Val Losses: mse: 23.0179, mae: 3.3726, huber: 2.9235, swd: 9.7570, ept: 102.9337
    Epoch [9/50], Test Losses: mse: 18.5161, mae: 3.0133, huber: 2.5677, swd: 9.4104, ept: 121.4871
      Epoch 9 composite train-obj: 2.312077
            No improvement (2.9235), counter 1/5
    Epoch [10/50], Train Losses: mse: 25.4181, mae: 2.7132, huber: 2.2910, swd: 11.7023, ept: 142.7115
    Epoch [10/50], Val Losses: mse: 22.5468, mae: 3.3266, huber: 2.8787, swd: 9.5131, ept: 102.7651
    Epoch [10/50], Test Losses: mse: 17.3052, mae: 2.9314, huber: 2.4843, swd: 8.2206, ept: 126.0980
      Epoch 10 composite train-obj: 2.290971
            No improvement (2.8787), counter 2/5
    Epoch [11/50], Train Losses: mse: 24.8123, mae: 2.6555, huber: 2.2347, swd: 11.1762, ept: 144.4159
    Epoch [11/50], Val Losses: mse: 25.1938, mae: 3.6140, huber: 3.1638, swd: 12.5842, ept: 100.3917
    Epoch [11/50], Test Losses: mse: 18.9652, mae: 3.1043, huber: 2.6561, swd: 10.2363, ept: 118.9765
      Epoch 11 composite train-obj: 2.234744
            No improvement (3.1638), counter 3/5
    Epoch [12/50], Train Losses: mse: 24.9779, mae: 2.6747, huber: 2.2535, swd: 11.3952, ept: 143.5330
    Epoch [12/50], Val Losses: mse: 25.4106, mae: 3.5283, huber: 3.0818, swd: 12.8462, ept: 103.2709
    Epoch [12/50], Test Losses: mse: 19.2848, mae: 3.1713, huber: 2.7259, swd: 10.5895, ept: 112.9874
      Epoch 12 composite train-obj: 2.253499
            No improvement (3.0818), counter 4/5
    Epoch [13/50], Train Losses: mse: 25.0266, mae: 2.6628, huber: 2.2422, swd: 11.4729, ept: 143.8304
    Epoch [13/50], Val Losses: mse: 23.4740, mae: 3.3701, huber: 2.9288, swd: 10.7437, ept: 101.3151
    Epoch [13/50], Test Losses: mse: 17.5805, mae: 2.9806, huber: 2.5320, swd: 8.4165, ept: 125.2753
      Epoch 13 composite train-obj: 2.242154
    Epoch [13/50], Test Losses: mse: 19.4515, mae: 3.1199, huber: 2.6727, swd: 9.7740, ept: 113.7061
    Best round's Test MSE: 19.4497, MAE: 3.1198, SWD: 9.7729
    Best round's Validation MSE: 23.2006, MAE: 3.3205, SWD: 9.7188
    Best round's Test verification MSE : 19.4515, MAE: 3.1199, SWD: 9.7740
    Time taken: 34.56 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 118.2891, mae: 5.7583, huber: 5.3125, swd: 94.2319, ept: 90.8436
    Epoch [1/50], Val Losses: mse: 26.8840, mae: 3.5653, huber: 3.1176, swd: 11.6869, ept: 98.4011
    Epoch [1/50], Test Losses: mse: 20.8354, mae: 3.1560, huber: 2.7060, swd: 10.2267, ept: 123.3679
      Epoch 1 composite train-obj: 5.312531
            Val objective improved inf → 3.1176, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 32.1582, mae: 3.2388, huber: 2.8071, swd: 15.8698, ept: 125.4926
    Epoch [2/50], Val Losses: mse: 28.9371, mae: 3.7068, huber: 3.2566, swd: 13.8720, ept: 97.6425
    Epoch [2/50], Test Losses: mse: 22.1800, mae: 3.2779, huber: 2.8266, swd: 11.8594, ept: 114.0960
      Epoch 2 composite train-obj: 2.807126
            No improvement (3.2566), counter 1/5
    Epoch [3/50], Train Losses: mse: 30.7956, mae: 3.1279, huber: 2.6993, swd: 14.8599, ept: 129.8257
    Epoch [3/50], Val Losses: mse: 27.2069, mae: 3.6344, huber: 3.1794, swd: 11.1291, ept: 94.2999
    Epoch [3/50], Test Losses: mse: 18.8649, mae: 2.9357, huber: 2.4917, swd: 7.7421, ept: 128.9365
      Epoch 3 composite train-obj: 2.699298
            No improvement (3.1794), counter 2/5
    Epoch [4/50], Train Losses: mse: 30.2648, mae: 3.0775, huber: 2.6504, swd: 14.4259, ept: 130.5000
    Epoch [4/50], Val Losses: mse: 26.5125, mae: 3.5821, huber: 3.1289, swd: 10.2584, ept: 93.4473
    Epoch [4/50], Test Losses: mse: 20.5038, mae: 3.1474, huber: 2.6993, swd: 9.2242, ept: 115.4989
      Epoch 4 composite train-obj: 2.650420
            No improvement (3.1289), counter 3/5
    Epoch [5/50], Train Losses: mse: 28.9572, mae: 2.9886, huber: 2.5620, swd: 13.8162, ept: 133.5263
    Epoch [5/50], Val Losses: mse: 24.4883, mae: 3.4552, huber: 3.0031, swd: 9.8500, ept: 97.3224
    Epoch [5/50], Test Losses: mse: 19.8852, mae: 3.1296, huber: 2.6807, swd: 9.2454, ept: 116.0032
      Epoch 5 composite train-obj: 2.562003
            Val objective improved 3.1176 → 3.0031, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 27.2784, mae: 2.8774, huber: 2.4521, swd: 13.0093, ept: 137.8846
    Epoch [6/50], Val Losses: mse: 23.1083, mae: 3.3706, huber: 2.9202, swd: 9.7724, ept: 100.1695
    Epoch [6/50], Test Losses: mse: 18.2217, mae: 2.9807, huber: 2.5346, swd: 8.9141, ept: 120.0389
      Epoch 6 composite train-obj: 2.452138
            Val objective improved 3.0031 → 2.9202, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 26.3113, mae: 2.8028, huber: 2.3791, swd: 12.5288, ept: 140.5668
    Epoch [7/50], Val Losses: mse: 22.6134, mae: 3.3241, huber: 2.8734, swd: 9.6605, ept: 101.7667
    Epoch [7/50], Test Losses: mse: 18.0855, mae: 2.9854, huber: 2.5394, swd: 9.0380, ept: 121.1553
      Epoch 7 composite train-obj: 2.379126
            Val objective improved 2.9202 → 2.8734, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 26.4828, mae: 2.8238, huber: 2.3992, swd: 12.7537, ept: 139.5311
    Epoch [8/50], Val Losses: mse: 22.9176, mae: 3.3700, huber: 2.9159, swd: 9.8703, ept: 101.6609
    Epoch [8/50], Test Losses: mse: 17.6968, mae: 2.9045, huber: 2.4614, swd: 8.3627, ept: 122.9832
      Epoch 8 composite train-obj: 2.399188
            No improvement (2.9159), counter 1/5
    Epoch [9/50], Train Losses: mse: 25.1099, mae: 2.7003, huber: 2.2788, swd: 11.7788, ept: 143.4903
    Epoch [9/50], Val Losses: mse: 23.9644, mae: 3.4590, huber: 3.0073, swd: 11.6267, ept: 100.8343
    Epoch [9/50], Test Losses: mse: 18.1704, mae: 3.0257, huber: 2.5812, swd: 9.3386, ept: 118.5966
      Epoch 9 composite train-obj: 2.278822
            No improvement (3.0073), counter 2/5
    Epoch [10/50], Train Losses: mse: 25.0237, mae: 2.6704, huber: 2.2494, swd: 11.6090, ept: 144.1453
    Epoch [10/50], Val Losses: mse: 23.7925, mae: 3.4611, huber: 3.0050, swd: 11.4015, ept: 101.9513
    Epoch [10/50], Test Losses: mse: 17.4251, mae: 2.9634, huber: 2.5193, swd: 8.7531, ept: 122.3384
      Epoch 10 composite train-obj: 2.249406
            No improvement (3.0050), counter 3/5
    Epoch [11/50], Train Losses: mse: 24.3842, mae: 2.6400, huber: 2.2194, swd: 11.1814, ept: 144.8165
    Epoch [11/50], Val Losses: mse: 23.1230, mae: 3.4561, huber: 2.9994, swd: 10.0796, ept: 101.2116
    Epoch [11/50], Test Losses: mse: 18.0491, mae: 2.9721, huber: 2.5287, swd: 8.7297, ept: 119.5032
      Epoch 11 composite train-obj: 2.219425
            No improvement (2.9994), counter 4/5
    Epoch [12/50], Train Losses: mse: 24.2272, mae: 2.6317, huber: 2.2113, swd: 11.0910, ept: 144.9241
    Epoch [12/50], Val Losses: mse: 22.5292, mae: 3.3559, huber: 2.9028, swd: 9.5872, ept: 103.1435
    Epoch [12/50], Test Losses: mse: 17.2262, mae: 2.9019, huber: 2.4566, swd: 8.4708, ept: 123.5153
      Epoch 12 composite train-obj: 2.211330
    Epoch [12/50], Test Losses: mse: 18.0854, mae: 2.9854, huber: 2.5394, swd: 9.0379, ept: 121.1541
    Best round's Test MSE: 18.0855, MAE: 2.9854, SWD: 9.0380
    Best round's Validation MSE: 22.6134, MAE: 3.3241, SWD: 9.6605
    Best round's Test verification MSE : 18.0854, MAE: 2.9854, SWD: 9.0379
    Time taken: 30.41 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 108.6591, mae: 5.4898, huber: 5.0455, swd: 73.7673, ept: 95.9251
    Epoch [1/50], Val Losses: mse: 26.6501, mae: 3.5987, huber: 3.1472, swd: 9.6459, ept: 95.8209
    Epoch [1/50], Test Losses: mse: 19.2546, mae: 2.9746, huber: 2.5277, swd: 7.2148, ept: 131.6786
      Epoch 1 composite train-obj: 5.045485
            Val objective improved inf → 3.1472, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 31.3886, mae: 3.1772, huber: 2.7468, swd: 13.3102, ept: 129.7657
    Epoch [2/50], Val Losses: mse: 28.1711, mae: 3.6454, huber: 3.1969, swd: 9.7866, ept: 90.7201
    Epoch [2/50], Test Losses: mse: 22.7201, mae: 3.3391, huber: 2.8882, swd: 9.4047, ept: 114.6332
      Epoch 2 composite train-obj: 2.746766
            No improvement (3.1969), counter 1/5
    Epoch [3/50], Train Losses: mse: 30.8718, mae: 3.1235, huber: 2.6956, swd: 12.9715, ept: 130.8155
    Epoch [3/50], Val Losses: mse: 31.1704, mae: 3.8802, huber: 3.4248, swd: 11.6873, ept: 86.4875
    Epoch [3/50], Test Losses: mse: 24.5696, mae: 3.3321, huber: 2.8856, swd: 10.5194, ept: 115.8737
      Epoch 3 composite train-obj: 2.695586
            No improvement (3.4248), counter 2/5
    Epoch [4/50], Train Losses: mse: 30.2698, mae: 3.0915, huber: 2.6639, swd: 12.4735, ept: 131.2760
    Epoch [4/50], Val Losses: mse: 26.5186, mae: 3.6015, huber: 3.1476, swd: 8.5914, ept: 93.4824
    Epoch [4/50], Test Losses: mse: 20.1397, mae: 3.0672, huber: 2.6195, swd: 7.4281, ept: 126.8410
      Epoch 4 composite train-obj: 2.663918
            No improvement (3.1476), counter 3/5
    Epoch [5/50], Train Losses: mse: 29.5403, mae: 3.0429, huber: 2.6156, swd: 11.8732, ept: 131.9296
    Epoch [5/50], Val Losses: mse: 27.3698, mae: 3.6830, huber: 3.2304, swd: 9.9138, ept: 97.4422
    Epoch [5/50], Test Losses: mse: 18.9559, mae: 2.9538, huber: 2.5088, swd: 6.8229, ept: 129.9740
      Epoch 5 composite train-obj: 2.615566
            No improvement (3.2304), counter 4/5
    Epoch [6/50], Train Losses: mse: 28.4100, mae: 2.9802, huber: 2.5540, swd: 11.1123, ept: 133.0986
    Epoch [6/50], Val Losses: mse: 29.0092, mae: 3.7237, huber: 3.2720, swd: 10.5515, ept: 89.5515
    Epoch [6/50], Test Losses: mse: 22.8474, mae: 3.3619, huber: 2.9131, swd: 9.3940, ept: 108.0915
      Epoch 6 composite train-obj: 2.553980
    Epoch [6/50], Test Losses: mse: 19.2614, mae: 2.9753, huber: 2.5283, swd: 7.2197, ept: 131.6241
    Best round's Test MSE: 19.2546, MAE: 2.9746, SWD: 7.2148
    Best round's Validation MSE: 26.6501, MAE: 3.5987, SWD: 9.6459
    Best round's Test verification MSE : 19.2614, MAE: 2.9753, SWD: 7.2197
    Time taken: 17.12 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred196_20250510_2222)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 18.9299 ± 0.6024
      mae: 3.0266 ± 0.0660
      huber: 2.5799 ± 0.0657
      swd: 8.6752 ± 1.0754
      ept: 122.1830 ± 7.3695
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 24.1547 ± 1.7807
      mae: 3.4144 ± 0.1303
      huber: 2.9656 ± 0.1284
      swd: 9.6751 ± 0.0315
      ept: 99.5978 ± 2.6805
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 82.17 seconds
    
    Experiment complete: ACL_etth2_seq720_pred196_20250510_2222
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5171, mae: 0.4580, huber: 0.1970, swd: 0.2966, ept: 170.2929
    Epoch [1/50], Val Losses: mse: 0.4081, mae: 0.4791, huber: 0.1906, swd: 0.1892, ept: 127.3314
    Epoch [1/50], Test Losses: mse: 0.2193, mae: 0.3391, huber: 0.1065, swd: 0.0895, ept: 189.9015
      Epoch 1 composite train-obj: 0.196982
            Val objective improved inf → 0.1906, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4015, mae: 0.3937, huber: 0.1540, swd: 0.2105, ept: 191.6968
    Epoch [2/50], Val Losses: mse: 0.4235, mae: 0.4971, huber: 0.1987, swd: 0.2136, ept: 113.4094
    Epoch [2/50], Test Losses: mse: 0.2712, mae: 0.3912, huber: 0.1322, swd: 0.1490, ept: 160.9624
      Epoch 2 composite train-obj: 0.153974
            No improvement (0.1987), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3599, mae: 0.3698, huber: 0.1376, swd: 0.1876, ept: 194.0358
    Epoch [3/50], Val Losses: mse: 0.4294, mae: 0.4967, huber: 0.2004, swd: 0.1985, ept: 113.7550
    Epoch [3/50], Test Losses: mse: 0.3013, mae: 0.4133, huber: 0.1466, swd: 0.1741, ept: 150.6151
      Epoch 3 composite train-obj: 0.137605
            No improvement (0.2004), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.3189, mae: 0.3427, huber: 0.1210, swd: 0.1533, ept: 204.0535
    Epoch [4/50], Val Losses: mse: 0.3882, mae: 0.4603, huber: 0.1817, swd: 0.1469, ept: 124.4700
    Epoch [4/50], Test Losses: mse: 0.3248, mae: 0.4308, huber: 0.1584, swd: 0.1706, ept: 146.9288
      Epoch 4 composite train-obj: 0.121037
            Val objective improved 0.1906 → 0.1817, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2804, mae: 0.3149, huber: 0.1056, swd: 0.1221, ept: 218.4275
    Epoch [5/50], Val Losses: mse: 0.4079, mae: 0.4624, huber: 0.1885, swd: 0.1143, ept: 135.4679
    Epoch [5/50], Test Losses: mse: 0.3037, mae: 0.4187, huber: 0.1484, swd: 0.1508, ept: 155.1197
      Epoch 5 composite train-obj: 0.105574
            No improvement (0.1885), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.2633, mae: 0.3022, huber: 0.0987, swd: 0.1116, ept: 226.6014
    Epoch [6/50], Val Losses: mse: 0.3742, mae: 0.4478, huber: 0.1760, swd: 0.1298, ept: 133.4118
    Epoch [6/50], Test Losses: mse: 0.3716, mae: 0.4547, huber: 0.1799, swd: 0.2058, ept: 146.2174
      Epoch 6 composite train-obj: 0.098662
            Val objective improved 0.1817 → 0.1760, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.2505, mae: 0.2929, huber: 0.0938, swd: 0.1041, ept: 228.7027
    Epoch [7/50], Val Losses: mse: 0.4473, mae: 0.4920, huber: 0.2063, swd: 0.1485, ept: 129.4239
    Epoch [7/50], Test Losses: mse: 0.3523, mae: 0.4463, huber: 0.1711, swd: 0.1722, ept: 151.1262
      Epoch 7 composite train-obj: 0.093754
            No improvement (0.2063), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.2426, mae: 0.2893, huber: 0.0913, swd: 0.0977, ept: 231.2705
    Epoch [8/50], Val Losses: mse: 0.4758, mae: 0.5080, huber: 0.2165, swd: 0.1633, ept: 118.3476
    Epoch [8/50], Test Losses: mse: 0.4130, mae: 0.4820, huber: 0.1975, swd: 0.1835, ept: 147.5827
      Epoch 8 composite train-obj: 0.091252
            No improvement (0.2165), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.2309, mae: 0.2825, huber: 0.0870, swd: 0.0902, ept: 233.8055
    Epoch [9/50], Val Losses: mse: 0.4029, mae: 0.4678, huber: 0.1876, swd: 0.1442, ept: 130.4087
    Epoch [9/50], Test Losses: mse: 0.4084, mae: 0.4751, huber: 0.1953, swd: 0.2275, ept: 144.7968
      Epoch 9 composite train-obj: 0.086987
            No improvement (0.1876), counter 3/5
    Epoch [10/50], Train Losses: mse: 0.2222, mae: 0.2772, huber: 0.0840, swd: 0.0839, ept: 236.4500
    Epoch [10/50], Val Losses: mse: 0.4196, mae: 0.4779, huber: 0.1957, swd: 0.1321, ept: 128.3462
    Epoch [10/50], Test Losses: mse: 0.3982, mae: 0.4725, huber: 0.1915, swd: 0.2134, ept: 140.1677
      Epoch 10 composite train-obj: 0.083951
            No improvement (0.1957), counter 4/5
    Epoch [11/50], Train Losses: mse: 0.2085, mae: 0.2684, huber: 0.0790, swd: 0.0755, ept: 239.3809
    Epoch [11/50], Val Losses: mse: 0.4214, mae: 0.4735, huber: 0.1947, swd: 0.1440, ept: 129.5538
    Epoch [11/50], Test Losses: mse: 0.3957, mae: 0.4694, huber: 0.1902, swd: 0.2246, ept: 137.9671
      Epoch 11 composite train-obj: 0.079044
    Epoch [11/50], Test Losses: mse: 0.3716, mae: 0.4547, huber: 0.1799, swd: 0.2058, ept: 146.1746
    Best round's Test MSE: 0.3716, MAE: 0.4547, SWD: 0.2058
    Best round's Validation MSE: 0.3742, MAE: 0.4478, SWD: 0.1298
    Best round's Test verification MSE : 0.3716, MAE: 0.4547, SWD: 0.2058
    Time taken: 26.95 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5178, mae: 0.4597, huber: 0.1978, swd: 0.3129, ept: 167.9469
    Epoch [1/50], Val Losses: mse: 0.4117, mae: 0.4789, huber: 0.1928, swd: 0.1810, ept: 129.8592
    Epoch [1/50], Test Losses: mse: 0.2158, mae: 0.3365, huber: 0.1049, swd: 0.0826, ept: 191.3781
      Epoch 1 composite train-obj: 0.197822
            Val objective improved inf → 0.1928, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3980, mae: 0.3912, huber: 0.1525, swd: 0.2105, ept: 192.5680
    Epoch [2/50], Val Losses: mse: 0.4100, mae: 0.4822, huber: 0.1921, swd: 0.1846, ept: 116.0343
    Epoch [2/50], Test Losses: mse: 0.2291, mae: 0.3445, huber: 0.1109, swd: 0.1180, ept: 176.8550
      Epoch 2 composite train-obj: 0.152536
            Val objective improved 0.1928 → 0.1921, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3531, mae: 0.3650, huber: 0.1347, swd: 0.1857, ept: 197.6620
    Epoch [3/50], Val Losses: mse: 0.3812, mae: 0.4608, huber: 0.1799, swd: 0.1528, ept: 122.1095
    Epoch [3/50], Test Losses: mse: 0.2593, mae: 0.3859, huber: 0.1267, swd: 0.1336, ept: 170.6920
      Epoch 3 composite train-obj: 0.134667
            Val objective improved 0.1921 → 0.1799, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.3055, mae: 0.3317, huber: 0.1153, swd: 0.1449, ept: 211.8120
    Epoch [4/50], Val Losses: mse: 0.3839, mae: 0.4564, huber: 0.1808, swd: 0.1242, ept: 127.0802
    Epoch [4/50], Test Losses: mse: 0.2797, mae: 0.4022, huber: 0.1372, swd: 0.1479, ept: 154.7053
      Epoch 4 composite train-obj: 0.115286
            No improvement (0.1808), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2758, mae: 0.3117, huber: 0.1036, swd: 0.1225, ept: 220.6625
    Epoch [5/50], Val Losses: mse: 0.3777, mae: 0.4499, huber: 0.1778, swd: 0.1357, ept: 130.8333
    Epoch [5/50], Test Losses: mse: 0.3199, mae: 0.4238, huber: 0.1562, swd: 0.1966, ept: 144.7863
      Epoch 5 composite train-obj: 0.103648
            Val objective improved 0.1799 → 0.1778, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.2596, mae: 0.2990, huber: 0.0970, swd: 0.1119, ept: 225.5870
    Epoch [6/50], Val Losses: mse: 0.3877, mae: 0.4574, huber: 0.1817, swd: 0.1335, ept: 138.5141
    Epoch [6/50], Test Losses: mse: 0.3248, mae: 0.4271, huber: 0.1582, swd: 0.1868, ept: 154.4147
      Epoch 6 composite train-obj: 0.097041
            No improvement (0.1817), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.2497, mae: 0.2921, huber: 0.0932, swd: 0.1044, ept: 227.5414
    Epoch [7/50], Val Losses: mse: 0.4327, mae: 0.4838, huber: 0.2007, swd: 0.1465, ept: 129.4447
    Epoch [7/50], Test Losses: mse: 0.3527, mae: 0.4460, huber: 0.1710, swd: 0.1858, ept: 147.4003
      Epoch 7 composite train-obj: 0.093208
            No improvement (0.2007), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.2408, mae: 0.2874, huber: 0.0899, swd: 0.0975, ept: 228.4805
    Epoch [8/50], Val Losses: mse: 0.4749, mae: 0.4906, huber: 0.2129, swd: 0.1826, ept: 139.3670
    Epoch [8/50], Test Losses: mse: 0.3211, mae: 0.4297, huber: 0.1573, swd: 0.1768, ept: 144.2650
      Epoch 8 composite train-obj: 0.089883
            No improvement (0.2129), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.2323, mae: 0.2817, huber: 0.0867, swd: 0.0931, ept: 231.9315
    Epoch [9/50], Val Losses: mse: 0.4104, mae: 0.4780, huber: 0.1919, swd: 0.1361, ept: 129.4328
    Epoch [9/50], Test Losses: mse: 0.3955, mae: 0.4679, huber: 0.1899, swd: 0.2486, ept: 138.8060
      Epoch 9 composite train-obj: 0.086659
            No improvement (0.1919), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.2215, mae: 0.2742, huber: 0.0827, swd: 0.0862, ept: 234.3439
    Epoch [10/50], Val Losses: mse: 0.4703, mae: 0.5297, huber: 0.2185, swd: 0.2683, ept: 117.3266
    Epoch [10/50], Test Losses: mse: 0.6475, mae: 0.5666, huber: 0.2808, swd: 0.4027, ept: 130.8947
      Epoch 10 composite train-obj: 0.082676
    Epoch [10/50], Test Losses: mse: 0.3199, mae: 0.4238, huber: 0.1562, swd: 0.1966, ept: 144.7938
    Best round's Test MSE: 0.3199, MAE: 0.4238, SWD: 0.1966
    Best round's Validation MSE: 0.3777, MAE: 0.4499, SWD: 0.1357
    Best round's Test verification MSE : 0.3199, MAE: 0.4238, SWD: 0.1966
    Time taken: 23.72 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5285, mae: 0.4586, huber: 0.1986, swd: 0.3085, ept: 172.6146
    Epoch [1/50], Val Losses: mse: 0.4037, mae: 0.4766, huber: 0.1891, swd: 0.1893, ept: 129.2477
    Epoch [1/50], Test Losses: mse: 0.2103, mae: 0.3280, huber: 0.1021, swd: 0.0879, ept: 188.9286
      Epoch 1 composite train-obj: 0.198618
            Val objective improved inf → 0.1891, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3965, mae: 0.3907, huber: 0.1520, swd: 0.2113, ept: 192.0033
    Epoch [2/50], Val Losses: mse: 0.4495, mae: 0.5160, huber: 0.2096, swd: 0.2604, ept: 113.4160
    Epoch [2/50], Test Losses: mse: 0.2832, mae: 0.3986, huber: 0.1373, swd: 0.1769, ept: 148.9280
      Epoch 2 composite train-obj: 0.152021
            No improvement (0.2096), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3441, mae: 0.3590, huber: 0.1311, swd: 0.1787, ept: 198.9876
    Epoch [3/50], Val Losses: mse: 0.4401, mae: 0.4836, huber: 0.2028, swd: 0.1442, ept: 126.2259
    Epoch [3/50], Test Losses: mse: 0.2357, mae: 0.3606, huber: 0.1151, swd: 0.0848, ept: 182.4373
      Epoch 3 composite train-obj: 0.131130
            No improvement (0.2028), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.3019, mae: 0.3291, huber: 0.1139, swd: 0.1435, ept: 212.4505
    Epoch [4/50], Val Losses: mse: 0.3938, mae: 0.4641, huber: 0.1844, swd: 0.1146, ept: 128.9295
    Epoch [4/50], Test Losses: mse: 0.2482, mae: 0.3782, huber: 0.1214, swd: 0.0849, ept: 181.2181
      Epoch 4 composite train-obj: 0.113877
            Val objective improved 0.1891 → 0.1844, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2772, mae: 0.3097, huber: 0.1036, swd: 0.1224, ept: 223.4801
    Epoch [5/50], Val Losses: mse: 0.3681, mae: 0.4521, huber: 0.1743, swd: 0.1199, ept: 128.2403
    Epoch [5/50], Test Losses: mse: 0.2863, mae: 0.4111, huber: 0.1406, swd: 0.1412, ept: 151.4786
      Epoch 5 composite train-obj: 0.103607
            Val objective improved 0.1844 → 0.1743, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.2760, mae: 0.3117, huber: 0.1040, swd: 0.1237, ept: 223.1804
    Epoch [6/50], Val Losses: mse: 0.3729, mae: 0.4564, huber: 0.1762, swd: 0.1229, ept: 130.6429
    Epoch [6/50], Test Losses: mse: 0.3477, mae: 0.4405, huber: 0.1690, swd: 0.1825, ept: 151.2964
      Epoch 6 composite train-obj: 0.103967
            No improvement (0.1762), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.2556, mae: 0.2961, huber: 0.0956, swd: 0.1099, ept: 228.2441
    Epoch [7/50], Val Losses: mse: 0.3785, mae: 0.4652, huber: 0.1787, swd: 0.1280, ept: 125.6646
    Epoch [7/50], Test Losses: mse: 0.3290, mae: 0.4302, huber: 0.1605, swd: 0.1821, ept: 141.8061
      Epoch 7 composite train-obj: 0.095619
            No improvement (0.1787), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.2514, mae: 0.2962, huber: 0.0947, swd: 0.1061, ept: 227.0472
    Epoch [8/50], Val Losses: mse: 0.3998, mae: 0.4692, huber: 0.1875, swd: 0.1198, ept: 136.7530
    Epoch [8/50], Test Losses: mse: 0.3553, mae: 0.4456, huber: 0.1717, swd: 0.1751, ept: 149.9874
      Epoch 8 composite train-obj: 0.094726
            No improvement (0.1875), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.2370, mae: 0.2845, huber: 0.0888, swd: 0.0960, ept: 232.9206
    Epoch [9/50], Val Losses: mse: 0.4016, mae: 0.4665, huber: 0.1875, swd: 0.1187, ept: 132.1711
    Epoch [9/50], Test Losses: mse: 0.3762, mae: 0.4585, huber: 0.1816, swd: 0.1961, ept: 145.0504
      Epoch 9 composite train-obj: 0.088836
            No improvement (0.1875), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.2406, mae: 0.2821, huber: 0.0882, swd: 0.0995, ept: 234.7446
    Epoch [10/50], Val Losses: mse: 0.4081, mae: 0.4781, huber: 0.1900, swd: 0.1224, ept: 128.9199
    Epoch [10/50], Test Losses: mse: 0.4044, mae: 0.4739, huber: 0.1937, swd: 0.2214, ept: 143.2545
      Epoch 10 composite train-obj: 0.088236
    Epoch [10/50], Test Losses: mse: 0.2863, mae: 0.4111, huber: 0.1406, swd: 0.1412, ept: 151.4747
    Best round's Test MSE: 0.2863, MAE: 0.4111, SWD: 0.1412
    Best round's Validation MSE: 0.3681, MAE: 0.4521, SWD: 0.1199
    Best round's Test verification MSE : 0.2863, MAE: 0.4111, SWD: 0.1412
    Time taken: 23.38 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred336_20250510_2147)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.3260 ± 0.0351
      mae: 0.4299 ± 0.0183
      huber: 0.1589 ± 0.0161
      swd: 0.1812 ± 0.0285
      ept: 147.4941 ± 2.8774
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3733 ± 0.0039
      mae: 0.4499 ± 0.0017
      huber: 0.1761 ± 0.0014
      swd: 0.1285 ± 0.0065
      ept: 130.8285 ± 2.1113
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 74.15 seconds
    
    Experiment complete: ACL_etth2_seq720_pred336_20250510_2147
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 119.1173, mae: 5.8893, huber: 5.4409, swd: 91.8408, ept: 133.5943
    Epoch [1/50], Val Losses: mse: 27.2862, mae: 3.7001, huber: 3.2449, swd: 6.8962, ept: 121.6648
    Epoch [1/50], Test Losses: mse: 21.1897, mae: 3.0950, huber: 2.6502, swd: 8.5303, ept: 186.2454
      Epoch 1 composite train-obj: 5.440885
            Val objective improved inf → 3.2449, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 38.4921, mae: 3.5285, huber: 3.0922, swd: 18.1066, ept: 179.3865
    Epoch [2/50], Val Losses: mse: 28.4383, mae: 3.7967, huber: 3.3387, swd: 7.4382, ept: 116.8541
    Epoch [2/50], Test Losses: mse: 21.5634, mae: 3.1324, huber: 2.6874, swd: 8.1571, ept: 178.7680
      Epoch 2 composite train-obj: 3.092205
            No improvement (3.3387), counter 1/5
    Epoch [3/50], Train Losses: mse: 37.4742, mae: 3.4383, huber: 3.0049, swd: 17.3629, ept: 184.4503
    Epoch [3/50], Val Losses: mse: 37.9962, mae: 4.2563, huber: 3.8006, swd: 15.1152, ept: 105.9702
    Epoch [3/50], Test Losses: mse: 37.1788, mae: 4.2508, huber: 3.7929, swd: 21.7511, ept: 137.2686
      Epoch 3 composite train-obj: 3.004861
            No improvement (3.8006), counter 2/5
    Epoch [4/50], Train Losses: mse: 37.1277, mae: 3.4125, huber: 2.9800, swd: 17.1545, ept: 185.3029
    Epoch [4/50], Val Losses: mse: 27.7787, mae: 3.7741, huber: 3.3177, swd: 8.1065, ept: 130.8927
    Epoch [4/50], Test Losses: mse: 22.0990, mae: 3.2161, huber: 2.7672, swd: 10.1646, ept: 182.0365
      Epoch 4 composite train-obj: 2.980023
            No improvement (3.3177), counter 3/5
    Epoch [5/50], Train Losses: mse: 35.7285, mae: 3.3347, huber: 2.9028, swd: 16.0816, ept: 187.0486
    Epoch [5/50], Val Losses: mse: 34.8468, mae: 4.0745, huber: 3.6245, swd: 12.8230, ept: 109.5161
    Epoch [5/50], Test Losses: mse: 31.2643, mae: 3.8882, huber: 3.4339, swd: 16.5370, ept: 142.4616
      Epoch 5 composite train-obj: 2.902827
            No improvement (3.6245), counter 4/5
    Epoch [6/50], Train Losses: mse: 35.3435, mae: 3.3254, huber: 2.8934, swd: 15.9547, ept: 186.3195
    Epoch [6/50], Val Losses: mse: 27.7068, mae: 3.7698, huber: 3.3168, swd: 8.4799, ept: 131.7453
    Epoch [6/50], Test Losses: mse: 21.2188, mae: 3.1792, huber: 2.7325, swd: 9.0553, ept: 166.3188
      Epoch 6 composite train-obj: 2.893428
    Epoch [6/50], Test Losses: mse: 21.1831, mae: 3.0938, huber: 2.6491, swd: 8.5240, ept: 186.3373
    Best round's Test MSE: 21.1897, MAE: 3.0950, SWD: 8.5303
    Best round's Validation MSE: 27.2862, MAE: 3.7001, SWD: 6.8962
    Best round's Test verification MSE : 21.1831, MAE: 3.0938, SWD: 8.5240
    Time taken: 15.72 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 121.6335, mae: 5.9531, huber: 5.5040, swd: 95.7299, ept: 132.8330
    Epoch [1/50], Val Losses: mse: 28.5347, mae: 3.7862, huber: 3.3313, swd: 10.2945, ept: 129.7917
    Epoch [1/50], Test Losses: mse: 25.8031, mae: 3.6005, huber: 3.1460, swd: 14.8199, ept: 144.6018
      Epoch 1 composite train-obj: 5.504038
            Val objective improved inf → 3.3313, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 37.9831, mae: 3.5080, huber: 3.0724, swd: 18.4159, ept: 180.6235
    Epoch [2/50], Val Losses: mse: 28.4351, mae: 3.7472, huber: 3.2915, swd: 7.8063, ept: 121.2321
    Epoch [2/50], Test Losses: mse: 23.2554, mae: 3.3742, huber: 2.9246, swd: 10.3851, ept: 158.0277
      Epoch 2 composite train-obj: 3.072393
            Val objective improved 3.3313 → 3.2915, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 36.9444, mae: 3.4265, huber: 2.9934, swd: 17.6568, ept: 184.6608
    Epoch [3/50], Val Losses: mse: 38.6143, mae: 4.3263, huber: 3.8692, swd: 16.3675, ept: 106.9971
    Epoch [3/50], Test Losses: mse: 37.7945, mae: 4.3420, huber: 3.8810, swd: 23.8752, ept: 121.1294
      Epoch 3 composite train-obj: 2.993448
            No improvement (3.8692), counter 1/5
    Epoch [4/50], Train Losses: mse: 36.6654, mae: 3.4001, huber: 2.9677, swd: 17.3750, ept: 184.2294
    Epoch [4/50], Val Losses: mse: 27.5365, mae: 3.7622, huber: 3.3073, swd: 7.3778, ept: 126.5977
    Epoch [4/50], Test Losses: mse: 22.2273, mae: 3.3084, huber: 2.8580, swd: 9.4081, ept: 156.0751
      Epoch 4 composite train-obj: 2.967707
            No improvement (3.3073), counter 2/5
    Epoch [5/50], Train Losses: mse: 35.3030, mae: 3.3236, huber: 2.8920, swd: 16.2619, ept: 187.8609
    Epoch [5/50], Val Losses: mse: 30.4658, mae: 3.8549, huber: 3.4044, swd: 9.7611, ept: 116.8005
    Epoch [5/50], Test Losses: mse: 27.3711, mae: 3.7543, huber: 3.3004, swd: 14.2175, ept: 129.6685
      Epoch 5 composite train-obj: 2.892040
            No improvement (3.4044), counter 3/5
    Epoch [6/50], Train Losses: mse: 34.6431, mae: 3.2975, huber: 2.8664, swd: 15.8799, ept: 187.4370
    Epoch [6/50], Val Losses: mse: 29.9841, mae: 3.9187, huber: 3.4656, swd: 11.8785, ept: 128.8443
    Epoch [6/50], Test Losses: mse: 22.3309, mae: 3.2939, huber: 2.8450, swd: 11.0605, ept: 154.7066
      Epoch 6 composite train-obj: 2.866351
            No improvement (3.4656), counter 4/5
    Epoch [7/50], Train Losses: mse: 33.6104, mae: 3.2170, huber: 2.7868, swd: 15.1700, ept: 190.3898
    Epoch [7/50], Val Losses: mse: 27.8150, mae: 3.7556, huber: 3.3035, swd: 9.0170, ept: 129.1368
    Epoch [7/50], Test Losses: mse: 19.5356, mae: 3.0079, huber: 2.5638, swd: 7.7676, ept: 185.3472
      Epoch 7 composite train-obj: 2.786816
    Epoch [7/50], Test Losses: mse: 23.2355, mae: 3.3729, huber: 2.9233, swd: 10.3644, ept: 157.9968
    Best round's Test MSE: 23.2554, MAE: 3.3742, SWD: 10.3851
    Best round's Validation MSE: 28.4351, MAE: 3.7472, SWD: 7.8063
    Best round's Test verification MSE : 23.2355, MAE: 3.3729, SWD: 10.3644
    Time taken: 18.68 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 111.0135, mae: 5.6699, huber: 5.2215, swd: 79.6433, ept: 137.6076
    Epoch [1/50], Val Losses: mse: 43.1753, mae: 4.5507, huber: 4.0910, swd: 18.8054, ept: 101.9429
    Epoch [1/50], Test Losses: mse: 31.4524, mae: 3.7905, huber: 3.3391, swd: 15.9648, ept: 158.7723
      Epoch 1 composite train-obj: 5.221517
            Val objective improved inf → 4.0910, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 38.5864, mae: 3.5190, huber: 3.0835, swd: 17.5949, ept: 179.0721
    Epoch [2/50], Val Losses: mse: 26.9481, mae: 3.6922, huber: 3.2359, swd: 7.1549, ept: 130.6733
    Epoch [2/50], Test Losses: mse: 22.0876, mae: 3.3073, huber: 2.8566, swd: 9.3407, ept: 154.3879
      Epoch 2 composite train-obj: 3.083502
            Val objective improved 4.0910 → 3.2359, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 37.5747, mae: 3.4279, huber: 2.9949, swd: 16.9967, ept: 185.4129
    Epoch [3/50], Val Losses: mse: 28.1971, mae: 3.7952, huber: 3.3380, swd: 7.3690, ept: 128.4068
    Epoch [3/50], Test Losses: mse: 22.1875, mae: 3.2937, huber: 2.8435, swd: 8.9939, ept: 153.0519
      Epoch 3 composite train-obj: 2.994922
            No improvement (3.3380), counter 1/5
    Epoch [4/50], Train Losses: mse: 36.0345, mae: 3.3269, huber: 2.8948, swd: 15.6740, ept: 189.9267
    Epoch [4/50], Val Losses: mse: 31.8996, mae: 4.0516, huber: 3.5935, swd: 13.0964, ept: 128.4944
    Epoch [4/50], Test Losses: mse: 24.7671, mae: 3.4517, huber: 2.9981, swd: 12.9233, ept: 179.9864
      Epoch 4 composite train-obj: 2.894795
            No improvement (3.5935), counter 2/5
    Epoch [5/50], Train Losses: mse: 38.0936, mae: 3.4009, huber: 2.9677, swd: 17.5101, ept: 185.6119
    Epoch [5/50], Val Losses: mse: 39.7072, mae: 4.4648, huber: 4.0059, swd: 21.1776, ept: 115.0173
    Epoch [5/50], Test Losses: mse: 29.2229, mae: 3.8015, huber: 3.3482, swd: 17.6382, ept: 142.9879
      Epoch 5 composite train-obj: 2.967734
            No improvement (4.0059), counter 3/5
    Epoch [6/50], Train Losses: mse: 37.7980, mae: 3.4387, huber: 3.0062, swd: 17.6516, ept: 183.2968
    Epoch [6/50], Val Losses: mse: 28.4609, mae: 3.8000, huber: 3.3430, swd: 8.2854, ept: 125.7622
    Epoch [6/50], Test Losses: mse: 21.8136, mae: 3.2851, huber: 2.8351, swd: 8.4653, ept: 156.4123
      Epoch 6 composite train-obj: 3.006205
            No improvement (3.3430), counter 4/5
    Epoch [7/50], Train Losses: mse: 35.2305, mae: 3.3347, huber: 2.9030, swd: 15.3775, ept: 186.3400
    Epoch [7/50], Val Losses: mse: 27.9187, mae: 3.6891, huber: 3.2329, swd: 7.6951, ept: 125.6235
    Epoch [7/50], Test Losses: mse: 24.5400, mae: 3.5811, huber: 3.1284, swd: 11.0965, ept: 144.5751
      Epoch 7 composite train-obj: 2.902974
            Val objective improved 3.2359 → 3.2329, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 34.2317, mae: 3.2556, huber: 2.8240, swd: 14.7647, ept: 190.3829
    Epoch [8/50], Val Losses: mse: 28.0480, mae: 3.7468, huber: 3.2870, swd: 9.0755, ept: 136.5640
    Epoch [8/50], Test Losses: mse: 22.3948, mae: 3.3959, huber: 2.9358, swd: 10.0917, ept: 153.8041
      Epoch 8 composite train-obj: 2.823954
            No improvement (3.2870), counter 1/5
    Epoch [9/50], Train Losses: mse: 33.0515, mae: 3.1729, huber: 2.7436, swd: 13.8656, ept: 194.1211
    Epoch [9/50], Val Losses: mse: 29.6958, mae: 3.9086, huber: 3.4452, swd: 10.2470, ept: 129.8505
    Epoch [9/50], Test Losses: mse: 21.3653, mae: 3.2828, huber: 2.8281, swd: 9.3458, ept: 163.1200
      Epoch 9 composite train-obj: 2.743626
            No improvement (3.4452), counter 2/5
    Epoch [10/50], Train Losses: mse: 33.2762, mae: 3.1375, huber: 2.7090, swd: 14.5981, ept: 197.2185
    Epoch [10/50], Val Losses: mse: 38.1035, mae: 4.3263, huber: 3.8611, swd: 16.1790, ept: 112.9244
    Epoch [10/50], Test Losses: mse: 32.1593, mae: 3.9958, huber: 3.5370, swd: 18.0910, ept: 138.6586
      Epoch 10 composite train-obj: 2.709029
            No improvement (3.8611), counter 3/5
    Epoch [11/50], Train Losses: mse: 31.1448, mae: 3.0448, huber: 2.6172, swd: 13.3165, ept: 202.9117
    Epoch [11/50], Val Losses: mse: 40.9292, mae: 4.5970, huber: 4.1309, swd: 23.3522, ept: 124.6678
    Epoch [11/50], Test Losses: mse: 31.6814, mae: 4.1680, huber: 3.6995, swd: 21.0611, ept: 143.6652
      Epoch 11 composite train-obj: 2.617223
            No improvement (4.1309), counter 4/5
    Epoch [12/50], Train Losses: mse: 32.1129, mae: 3.0973, huber: 2.6691, swd: 14.5003, ept: 201.3581
    Epoch [12/50], Val Losses: mse: 27.0521, mae: 3.7641, huber: 3.3020, swd: 7.6945, ept: 134.2997
    Epoch [12/50], Test Losses: mse: 21.4295, mae: 3.3860, huber: 2.9278, swd: 9.6004, ept: 149.1145
      Epoch 12 composite train-obj: 2.669074
    Epoch [12/50], Test Losses: mse: 24.5400, mae: 3.5811, huber: 3.1284, swd: 11.0966, ept: 144.6048
    Best round's Test MSE: 24.5400, MAE: 3.5811, SWD: 11.0965
    Best round's Validation MSE: 27.9187, MAE: 3.6891, SWD: 7.6951
    Best round's Test verification MSE : 24.5400, MAE: 3.5811, SWD: 11.0966
    Time taken: 31.82 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred336_20250510_2221)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 22.9951 ± 1.3801
      mae: 3.3501 ± 0.1992
      huber: 2.9011 ± 0.1959
      swd: 10.0040 ± 1.0818
      ept: 162.9494 ± 17.3642
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 27.8800 ± 0.4698
      mae: 3.7121 ± 0.0252
      huber: 3.2565 ± 0.0253
      swd: 7.4659 ± 0.4054
      ept: 122.8401 ± 1.9760
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 66.31 seconds
    
    Experiment complete: ACL_etth2_seq720_pred336_20250510_2221
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6154, mae: 0.5082, huber: 0.2311, swd: 0.3692, ept: 261.0768
    Epoch [1/50], Val Losses: mse: 0.4131, mae: 0.4885, huber: 0.1953, swd: 0.1282, ept: 215.8601
    Epoch [1/50], Test Losses: mse: 0.2523, mae: 0.3565, huber: 0.1204, swd: 0.1022, ept: 315.3196
      Epoch 1 composite train-obj: 0.231084
            Val objective improved inf → 0.1953, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5164, mae: 0.4466, huber: 0.1901, swd: 0.2919, ept: 286.8456
    Epoch [2/50], Val Losses: mse: 0.5135, mae: 0.5668, huber: 0.2377, swd: 0.3039, ept: 189.7142
    Epoch [2/50], Test Losses: mse: 0.3827, mae: 0.4595, huber: 0.1827, swd: 0.2546, ept: 207.1891
      Epoch 2 composite train-obj: 0.190126
            No improvement (0.2377), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4456, mae: 0.4124, huber: 0.1656, swd: 0.2472, ept: 301.0897
    Epoch [3/50], Val Losses: mse: 0.3962, mae: 0.4756, huber: 0.1885, swd: 0.1263, ept: 216.9272
    Epoch [3/50], Test Losses: mse: 0.3621, mae: 0.4566, huber: 0.1737, swd: 0.1968, ept: 238.7404
      Epoch 3 composite train-obj: 0.165645
            Val objective improved 0.1953 → 0.1885, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.3768, mae: 0.3749, huber: 0.1403, swd: 0.1898, ept: 318.3150
    Epoch [4/50], Val Losses: mse: 0.5247, mae: 0.5525, huber: 0.2421, swd: 0.1660, ept: 208.6856
    Epoch [4/50], Test Losses: mse: 0.3329, mae: 0.4405, huber: 0.1599, swd: 0.1382, ept: 254.0877
      Epoch 4 composite train-obj: 0.140276
            No improvement (0.2421), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.3374, mae: 0.3468, huber: 0.1240, swd: 0.1587, ept: 340.5350
    Epoch [5/50], Val Losses: mse: 0.4658, mae: 0.5276, huber: 0.2197, swd: 0.1001, ept: 211.8883
    Epoch [5/50], Test Losses: mse: 0.3934, mae: 0.4766, huber: 0.1871, swd: 0.1838, ept: 236.9229
      Epoch 5 composite train-obj: 0.124024
            No improvement (0.2197), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.3207, mae: 0.3327, huber: 0.1166, swd: 0.1473, ept: 353.3112
    Epoch [6/50], Val Losses: mse: 0.4537, mae: 0.5230, huber: 0.2128, swd: 0.1314, ept: 203.5121
    Epoch [6/50], Test Losses: mse: 0.4751, mae: 0.5162, huber: 0.2221, swd: 0.2720, ept: 203.8571
      Epoch 6 composite train-obj: 0.116613
            No improvement (0.2128), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.3015, mae: 0.3231, huber: 0.1108, swd: 0.1318, ept: 356.3227
    Epoch [7/50], Val Losses: mse: 0.4632, mae: 0.5238, huber: 0.2167, swd: 0.1061, ept: 209.5358
    Epoch [7/50], Test Losses: mse: 0.4467, mae: 0.5086, huber: 0.2107, swd: 0.2384, ept: 204.8022
      Epoch 7 composite train-obj: 0.110844
            No improvement (0.2167), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.2959, mae: 0.3234, huber: 0.1099, swd: 0.1230, ept: 355.8377
    Epoch [8/50], Val Losses: mse: 0.4776, mae: 0.5376, huber: 0.2230, swd: 0.1034, ept: 167.8792
    Epoch [8/50], Test Losses: mse: 0.3579, mae: 0.4614, huber: 0.1703, swd: 0.1716, ept: 201.6106
      Epoch 8 composite train-obj: 0.109858
    Epoch [8/50], Test Losses: mse: 0.3621, mae: 0.4566, huber: 0.1737, swd: 0.1968, ept: 238.8996
    Best round's Test MSE: 0.3621, MAE: 0.4566, SWD: 0.1968
    Best round's Validation MSE: 0.3962, MAE: 0.4756, SWD: 0.1263
    Best round's Test verification MSE : 0.3621, MAE: 0.4566, SWD: 0.1968
    Time taken: 19.72 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6315, mae: 0.5163, huber: 0.2367, swd: 0.3764, ept: 258.2745
    Epoch [1/50], Val Losses: mse: 0.4574, mae: 0.5345, huber: 0.2140, swd: 0.1916, ept: 196.3953
    Epoch [1/50], Test Losses: mse: 0.2948, mae: 0.4011, huber: 0.1413, swd: 0.1485, ept: 253.1749
      Epoch 1 composite train-obj: 0.236692
            Val objective improved inf → 0.2140, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5174, mae: 0.4516, huber: 0.1930, swd: 0.2855, ept: 284.7613
    Epoch [2/50], Val Losses: mse: 0.4283, mae: 0.4972, huber: 0.2027, swd: 0.1185, ept: 208.4235
    Epoch [2/50], Test Losses: mse: 0.3063, mae: 0.4121, huber: 0.1475, swd: 0.1440, ept: 256.8178
      Epoch 2 composite train-obj: 0.192958
            Val objective improved 0.2140 → 0.2027, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4707, mae: 0.4218, huber: 0.1732, swd: 0.2630, ept: 293.1049
    Epoch [3/50], Val Losses: mse: 0.3945, mae: 0.4765, huber: 0.1882, swd: 0.1324, ept: 196.2735
    Epoch [3/50], Test Losses: mse: 0.3892, mae: 0.4739, huber: 0.1862, swd: 0.2110, ept: 205.2804
      Epoch 3 composite train-obj: 0.173206
            Val objective improved 0.2027 → 0.1882, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.3964, mae: 0.3866, huber: 0.1477, swd: 0.2065, ept: 312.5723
    Epoch [4/50], Val Losses: mse: 0.3914, mae: 0.4788, huber: 0.1864, swd: 0.1138, ept: 200.2163
    Epoch [4/50], Test Losses: mse: 0.3872, mae: 0.4701, huber: 0.1857, swd: 0.2132, ept: 203.4477
      Epoch 4 composite train-obj: 0.147684
            Val objective improved 0.1882 → 0.1864, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.3400, mae: 0.3492, huber: 0.1254, swd: 0.1581, ept: 336.0011
    Epoch [5/50], Val Losses: mse: 0.4410, mae: 0.5116, huber: 0.2083, swd: 0.1153, ept: 193.6920
    Epoch [5/50], Test Losses: mse: 0.3680, mae: 0.4535, huber: 0.1718, swd: 0.1741, ept: 211.5702
      Epoch 5 composite train-obj: 0.125416
            No improvement (0.2083), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.3115, mae: 0.3324, huber: 0.1157, swd: 0.1330, ept: 348.0679
    Epoch [6/50], Val Losses: mse: 0.4193, mae: 0.4978, huber: 0.1992, swd: 0.0897, ept: 198.5405
    Epoch [6/50], Test Losses: mse: 0.4125, mae: 0.4801, huber: 0.1895, swd: 0.1659, ept: 212.4673
      Epoch 6 composite train-obj: 0.115722
            No improvement (0.1992), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.2964, mae: 0.3276, huber: 0.1117, swd: 0.1155, ept: 351.7091
    Epoch [7/50], Val Losses: mse: 0.4299, mae: 0.5009, huber: 0.2023, swd: 0.1066, ept: 202.5525
    Epoch [7/50], Test Losses: mse: 0.4553, mae: 0.5108, huber: 0.2136, swd: 0.2298, ept: 201.2619
      Epoch 7 composite train-obj: 0.111738
            No improvement (0.2023), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.2719, mae: 0.3129, huber: 0.1035, swd: 0.0934, ept: 359.5352
    Epoch [8/50], Val Losses: mse: 0.4478, mae: 0.5053, huber: 0.2088, swd: 0.1015, ept: 201.3308
    Epoch [8/50], Test Losses: mse: 0.4168, mae: 0.4835, huber: 0.1946, swd: 0.1938, ept: 207.1153
      Epoch 8 composite train-obj: 0.103505
            No improvement (0.2088), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.3088, mae: 0.3293, huber: 0.1138, swd: 0.1359, ept: 356.0500
    Epoch [9/50], Val Losses: mse: 0.4103, mae: 0.4851, huber: 0.1924, swd: 0.0919, ept: 221.9543
    Epoch [9/50], Test Losses: mse: 0.4685, mae: 0.5134, huber: 0.2152, swd: 0.2080, ept: 202.8087
      Epoch 9 composite train-obj: 0.113794
    Epoch [9/50], Test Losses: mse: 0.3872, mae: 0.4701, huber: 0.1858, swd: 0.2132, ept: 203.4232
    Best round's Test MSE: 0.3872, MAE: 0.4701, SWD: 0.2132
    Best round's Validation MSE: 0.3914, MAE: 0.4788, SWD: 0.1138
    Best round's Test verification MSE : 0.3872, MAE: 0.4701, SWD: 0.2132
    Time taken: 23.62 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6224, mae: 0.5129, huber: 0.2337, swd: 0.3848, ept: 259.8186
    Epoch [1/50], Val Losses: mse: 0.5120, mae: 0.5654, huber: 0.2373, swd: 0.2994, ept: 206.1548
    Epoch [1/50], Test Losses: mse: 0.3640, mae: 0.4478, huber: 0.1733, swd: 0.2477, ept: 213.6717
      Epoch 1 composite train-obj: 0.233708
            Val objective improved inf → 0.2373, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5114, mae: 0.4482, huber: 0.1904, swd: 0.2944, ept: 285.5139
    Epoch [2/50], Val Losses: mse: 0.4218, mae: 0.4963, huber: 0.2008, swd: 0.1595, ept: 207.5737
    Epoch [2/50], Test Losses: mse: 0.3002, mae: 0.4062, huber: 0.1442, swd: 0.1694, ept: 258.2394
      Epoch 2 composite train-obj: 0.190433
            Val objective improved 0.2373 → 0.2008, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4542, mae: 0.4147, huber: 0.1678, swd: 0.2644, ept: 294.7711
    Epoch [3/50], Val Losses: mse: 0.5275, mae: 0.5696, huber: 0.2449, swd: 0.2045, ept: 204.5758
    Epoch [3/50], Test Losses: mse: 0.3114, mae: 0.4165, huber: 0.1489, swd: 0.1419, ept: 275.0950
      Epoch 3 composite train-obj: 0.167810
            No improvement (0.2449), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4006, mae: 0.3830, huber: 0.1473, swd: 0.2209, ept: 315.9413
    Epoch [4/50], Val Losses: mse: 0.3854, mae: 0.4715, huber: 0.1839, swd: 0.1103, ept: 227.6220
    Epoch [4/50], Test Losses: mse: 0.4254, mae: 0.4959, huber: 0.2027, swd: 0.2545, ept: 210.3019
      Epoch 4 composite train-obj: 0.147319
            Val objective improved 0.2008 → 0.1839, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.3486, mae: 0.3523, huber: 0.1277, swd: 0.1758, ept: 339.0061
    Epoch [5/50], Val Losses: mse: 0.3768, mae: 0.4674, huber: 0.1799, swd: 0.1155, ept: 219.0952
    Epoch [5/50], Test Losses: mse: 0.5115, mae: 0.5367, huber: 0.2373, swd: 0.3119, ept: 211.1274
      Epoch 5 composite train-obj: 0.127733
            Val objective improved 0.1839 → 0.1799, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.3191, mae: 0.3326, huber: 0.1164, swd: 0.1515, ept: 354.8142
    Epoch [6/50], Val Losses: mse: 0.4380, mae: 0.5020, huber: 0.2063, swd: 0.1301, ept: 203.5515
    Epoch [6/50], Test Losses: mse: 0.5070, mae: 0.5293, huber: 0.2351, swd: 0.3132, ept: 206.4169
      Epoch 6 composite train-obj: 0.116425
            No improvement (0.2063), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.3028, mae: 0.3234, huber: 0.1110, swd: 0.1377, ept: 358.9389
    Epoch [7/50], Val Losses: mse: 0.5256, mae: 0.5508, huber: 0.2402, swd: 0.1114, ept: 209.5762
    Epoch [7/50], Test Losses: mse: 0.5163, mae: 0.5335, huber: 0.2354, swd: 0.2231, ept: 223.1604
      Epoch 7 composite train-obj: 0.111048
            No improvement (0.2402), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.2913, mae: 0.3213, huber: 0.1089, swd: 0.1200, ept: 360.2961
    Epoch [8/50], Val Losses: mse: 0.4581, mae: 0.5155, huber: 0.2122, swd: 0.1008, ept: 197.3611
    Epoch [8/50], Test Losses: mse: 0.5224, mae: 0.5487, huber: 0.2411, swd: 0.2919, ept: 199.4470
      Epoch 8 composite train-obj: 0.108925
            No improvement (0.2122), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.3126, mae: 0.3337, huber: 0.1158, swd: 0.1482, ept: 354.3920
    Epoch [9/50], Val Losses: mse: 0.4592, mae: 0.5176, huber: 0.2157, swd: 0.0978, ept: 204.6765
    Epoch [9/50], Test Losses: mse: 0.4802, mae: 0.5234, huber: 0.2242, swd: 0.2780, ept: 203.9873
      Epoch 9 composite train-obj: 0.115808
            No improvement (0.2157), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.2701, mae: 0.3108, huber: 0.1023, swd: 0.1025, ept: 364.4008
    Epoch [10/50], Val Losses: mse: 0.4721, mae: 0.5165, huber: 0.2184, swd: 0.0971, ept: 222.7193
    Epoch [10/50], Test Losses: mse: 0.5406, mae: 0.5466, huber: 0.2457, swd: 0.2846, ept: 201.6577
      Epoch 10 composite train-obj: 0.102266
    Epoch [10/50], Test Losses: mse: 0.5115, mae: 0.5367, huber: 0.2373, swd: 0.3118, ept: 211.0270
    Best round's Test MSE: 0.5115, MAE: 0.5367, SWD: 0.3119
    Best round's Validation MSE: 0.3768, MAE: 0.4674, SWD: 0.1155
    Best round's Test verification MSE : 0.5115, MAE: 0.5367, SWD: 0.3118
    Time taken: 25.62 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred720_20250510_2218)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.4203 ± 0.0653
      mae: 0.4878 ± 0.0350
      huber: 0.1989 ± 0.0276
      swd: 0.2406 ± 0.0508
      ept: 217.7718 ± 15.1549
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3881 ± 0.0083
      mae: 0.4740 ± 0.0048
      huber: 0.1850 ± 0.0037
      swd: 0.1185 ± 0.0055
      ept: 212.0796 ± 8.4352
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 69.09 seconds
    
    Experiment complete: ACL_etth2_seq720_pred720_20250510_2218
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 121.9988, mae: 6.1137, huber: 5.6598, swd: 89.1429, ept: 218.1792
    Epoch [1/50], Val Losses: mse: 27.8645, mae: 3.8060, huber: 3.3655, swd: 7.6899, ept: 219.3283
    Epoch [1/50], Test Losses: mse: 27.6852, mae: 3.6623, huber: 3.2095, swd: 13.3770, ept: 225.9365
      Epoch 1 composite train-obj: 5.659773
            Val objective improved inf → 3.3655, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 53.6344, mae: 4.1174, huber: 3.6733, swd: 27.2102, ept: 273.7653
    Epoch [2/50], Val Losses: mse: 36.6548, mae: 4.3353, huber: 3.8852, swd: 17.0740, ept: 212.6715
    Epoch [2/50], Test Losses: mse: 30.1365, mae: 3.7009, huber: 3.2482, swd: 16.9981, ept: 298.6821
      Epoch 2 composite train-obj: 3.673278
            No improvement (3.8852), counter 1/5
    Epoch [3/50], Train Losses: mse: 51.3530, mae: 4.0080, huber: 3.5658, swd: 25.2823, ept: 278.8721
    Epoch [3/50], Val Losses: mse: 28.7028, mae: 3.8551, huber: 3.4092, swd: 6.0770, ept: 194.8358
    Epoch [3/50], Test Losses: mse: 33.2437, mae: 3.9651, huber: 3.5108, swd: 16.6060, ept: 229.6654
      Epoch 3 composite train-obj: 3.565785
            No improvement (3.4092), counter 2/5
    Epoch [4/50], Train Losses: mse: 49.3101, mae: 3.8915, huber: 3.4516, swd: 23.8804, ept: 281.0369
    Epoch [4/50], Val Losses: mse: 29.6632, mae: 3.9292, huber: 3.4815, swd: 8.6938, ept: 217.7572
    Epoch [4/50], Test Losses: mse: 25.5545, mae: 3.4989, huber: 3.0482, swd: 11.0899, ept: 250.0781
      Epoch 4 composite train-obj: 3.451603
            No improvement (3.4815), counter 3/5
    Epoch [5/50], Train Losses: mse: 47.4338, mae: 3.7555, huber: 3.3174, swd: 22.1331, ept: 287.8470
    Epoch [5/50], Val Losses: mse: 31.7831, mae: 4.0439, huber: 3.5957, swd: 11.5495, ept: 216.2123
    Epoch [5/50], Test Losses: mse: 24.2814, mae: 3.4568, huber: 3.0042, swd: 9.8674, ept: 243.1480
      Epoch 5 composite train-obj: 3.317353
            No improvement (3.5957), counter 4/5
    Epoch [6/50], Train Losses: mse: 46.5799, mae: 3.6835, huber: 3.2460, swd: 21.5152, ept: 291.0964
    Epoch [6/50], Val Losses: mse: 38.6175, mae: 4.3685, huber: 3.9149, swd: 14.4669, ept: 181.0975
    Epoch [6/50], Test Losses: mse: 60.5945, mae: 5.6290, huber: 5.1604, swd: 41.9648, ept: 157.5716
      Epoch 6 composite train-obj: 3.246004
    Epoch [6/50], Test Losses: mse: 27.6977, mae: 3.6634, huber: 3.2106, swd: 13.3882, ept: 225.9975
    Best round's Test MSE: 27.6852, MAE: 3.6623, SWD: 13.3770
    Best round's Validation MSE: 27.8645, MAE: 3.8060, SWD: 7.6899
    Best round's Test verification MSE : 27.6977, MAE: 3.6634, SWD: 13.3882
    Time taken: 15.43 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 130.9947, mae: 6.2894, huber: 5.8351, swd: 90.8970, ept: 217.9759
    Epoch [1/50], Val Losses: mse: 30.1864, mae: 3.9996, huber: 3.5578, swd: 6.5652, ept: 192.1885
    Epoch [1/50], Test Losses: mse: 33.0737, mae: 3.9189, huber: 3.4642, swd: 15.3032, ept: 250.0257
      Epoch 1 composite train-obj: 5.835095
            Val objective improved inf → 3.5578, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 52.4199, mae: 4.0897, huber: 3.6451, swd: 24.6761, ept: 275.4678
    Epoch [2/50], Val Losses: mse: 27.0128, mae: 3.7565, huber: 3.3061, swd: 5.0005, ept: 208.1101
    Epoch [2/50], Test Losses: mse: 27.5932, mae: 3.6580, huber: 3.2058, swd: 11.6746, ept: 222.3185
      Epoch 2 composite train-obj: 3.645147
            Val objective improved 3.5578 → 3.3061, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 50.3653, mae: 3.9485, huber: 3.5067, swd: 22.6674, ept: 282.2213
    Epoch [3/50], Val Losses: mse: 29.1011, mae: 3.8814, huber: 3.4316, swd: 5.8435, ept: 195.0084
    Epoch [3/50], Test Losses: mse: 33.4164, mae: 4.0161, huber: 3.5603, swd: 15.6842, ept: 205.0285
      Epoch 3 composite train-obj: 3.506688
            No improvement (3.4316), counter 1/5
    Epoch [4/50], Train Losses: mse: 48.0445, mae: 3.8226, huber: 3.3831, swd: 21.1112, ept: 284.5605
    Epoch [4/50], Val Losses: mse: 40.1452, mae: 4.4939, huber: 4.0454, swd: 20.1231, ept: 203.2183
    Epoch [4/50], Test Losses: mse: 30.3268, mae: 3.7982, huber: 3.3449, swd: 16.1121, ept: 266.0937
      Epoch 4 composite train-obj: 3.383077
            No improvement (4.0454), counter 2/5
    Epoch [5/50], Train Losses: mse: 48.0875, mae: 3.8184, huber: 3.3787, swd: 21.5607, ept: 283.0802
    Epoch [5/50], Val Losses: mse: 31.6559, mae: 4.0513, huber: 3.6096, swd: 10.3664, ept: 220.6605
    Epoch [5/50], Test Losses: mse: 26.0634, mae: 3.5097, huber: 3.0596, swd: 11.1002, ept: 266.9809
      Epoch 5 composite train-obj: 3.378659
            No improvement (3.6096), counter 3/5
    Epoch [6/50], Train Losses: mse: 46.0595, mae: 3.6877, huber: 3.2492, swd: 19.9830, ept: 289.2452
    Epoch [6/50], Val Losses: mse: 44.8368, mae: 4.6976, huber: 4.2570, swd: 19.2524, ept: 172.8862
    Epoch [6/50], Test Losses: mse: 69.8728, mae: 5.9133, huber: 5.4474, swd: 48.3986, ept: 165.5814
      Epoch 6 composite train-obj: 3.249174
            No improvement (4.2570), counter 4/5
    Epoch [7/50], Train Losses: mse: 48.1342, mae: 3.8307, huber: 3.3906, swd: 22.4813, ept: 286.0477
    Epoch [7/50], Val Losses: mse: 47.4259, mae: 4.8682, huber: 4.4239, swd: 27.7707, ept: 199.7455
    Epoch [7/50], Test Losses: mse: 30.2694, mae: 3.8556, huber: 3.3996, swd: 16.6952, ept: 223.8245
      Epoch 7 composite train-obj: 3.390567
    Epoch [7/50], Test Losses: mse: 27.5891, mae: 3.6574, huber: 3.2052, swd: 11.6713, ept: 222.1271
    Best round's Test MSE: 27.5932, MAE: 3.6580, SWD: 11.6746
    Best round's Validation MSE: 27.0128, MAE: 3.7565, SWD: 5.0005
    Best round's Test verification MSE : 27.5891, MAE: 3.6574, SWD: 11.6713
    Time taken: 17.68 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 125.9820, mae: 6.1864, huber: 5.7320, swd: 95.5260, ept: 222.0302
    Epoch [1/50], Val Losses: mse: 36.5926, mae: 4.3182, huber: 3.8759, swd: 16.8729, ept: 207.3139
    Epoch [1/50], Test Losses: mse: 29.5061, mae: 3.7876, huber: 3.3319, swd: 16.7064, ept: 228.1390
      Epoch 1 composite train-obj: 5.731970
            Val objective improved inf → 3.8759, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 51.8321, mae: 4.0815, huber: 3.6369, swd: 26.7040, ept: 276.0520
    Epoch [2/50], Val Losses: mse: 28.4434, mae: 3.8716, huber: 3.4228, swd: 5.7622, ept: 211.9353
    Epoch [2/50], Test Losses: mse: 27.8200, mae: 3.5278, huber: 3.0788, swd: 12.9500, ept: 308.0401
      Epoch 2 composite train-obj: 3.636863
            Val objective improved 3.8759 → 3.4228, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 50.1992, mae: 3.9629, huber: 3.5205, swd: 25.1138, ept: 281.8503
    Epoch [3/50], Val Losses: mse: 30.8217, mae: 3.9908, huber: 3.5450, swd: 10.4072, ept: 223.1949
    Epoch [3/50], Test Losses: mse: 26.9873, mae: 3.6010, huber: 3.1468, swd: 13.6686, ept: 265.1607
      Epoch 3 composite train-obj: 3.520482
            No improvement (3.5450), counter 1/5
    Epoch [4/50], Train Losses: mse: 48.5201, mae: 3.8395, huber: 3.3986, swd: 23.6982, ept: 286.0479
    Epoch [4/50], Val Losses: mse: 27.2562, mae: 3.7326, huber: 3.2848, swd: 5.9959, ept: 218.2606
    Epoch [4/50], Test Losses: mse: 29.1836, mae: 3.8413, huber: 3.3783, swd: 13.8844, ept: 207.8737
      Epoch 4 composite train-obj: 3.398611
            Val objective improved 3.4228 → 3.2848, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 47.8345, mae: 3.7881, huber: 3.3481, swd: 22.9167, ept: 285.5442
    Epoch [5/50], Val Losses: mse: 39.2870, mae: 4.3703, huber: 3.9274, swd: 20.1507, ept: 204.8284
    Epoch [5/50], Test Losses: mse: 29.1954, mae: 3.8563, huber: 3.3970, swd: 16.3524, ept: 230.0969
      Epoch 5 composite train-obj: 3.348076
            No improvement (3.9274), counter 1/5
    Epoch [6/50], Train Losses: mse: 46.8160, mae: 3.7532, huber: 3.3136, swd: 22.6102, ept: 286.7407
    Epoch [6/50], Val Losses: mse: 29.0809, mae: 3.8667, huber: 3.4293, swd: 7.0178, ept: 203.3411
    Epoch [6/50], Test Losses: mse: 29.2106, mae: 3.8194, huber: 3.3645, swd: 14.0376, ept: 216.0763
      Epoch 6 composite train-obj: 3.313617
            No improvement (3.4293), counter 2/5
    Epoch [7/50], Train Losses: mse: 45.4457, mae: 3.6571, huber: 3.2192, swd: 21.5855, ept: 288.9157
    Epoch [7/50], Val Losses: mse: 33.5312, mae: 4.1382, huber: 3.6965, swd: 11.8129, ept: 215.7028
    Epoch [7/50], Test Losses: mse: 24.3995, mae: 3.4955, huber: 3.0409, swd: 9.5973, ept: 238.1599
      Epoch 7 composite train-obj: 3.219158
            No improvement (3.6965), counter 3/5
    Epoch [8/50], Train Losses: mse: 45.8196, mae: 3.6455, huber: 3.2075, swd: 22.2049, ept: 291.9483
    Epoch [8/50], Val Losses: mse: 26.2693, mae: 3.7238, huber: 3.2902, swd: 5.8480, ept: 214.7123
    Epoch [8/50], Test Losses: mse: 28.0219, mae: 3.6895, huber: 3.2384, swd: 13.0129, ept: 236.4927
      Epoch 8 composite train-obj: 3.207474
            No improvement (3.2902), counter 4/5
    Epoch [9/50], Train Losses: mse: 43.5712, mae: 3.5639, huber: 3.1265, swd: 20.8430, ept: 294.6401
    Epoch [9/50], Val Losses: mse: 33.6476, mae: 4.1120, huber: 3.6775, swd: 14.4408, ept: 225.8021
    Epoch [9/50], Test Losses: mse: 23.1032, mae: 3.3908, huber: 2.9393, swd: 9.8411, ept: 238.8322
      Epoch 9 composite train-obj: 3.126452
    Epoch [9/50], Test Losses: mse: 29.1829, mae: 3.8412, huber: 3.3782, swd: 13.8837, ept: 207.9926
    Best round's Test MSE: 29.1836, MAE: 3.8413, SWD: 13.8844
    Best round's Validation MSE: 27.2562, MAE: 3.7326, SWD: 5.9959
    Best round's Test verification MSE : 29.1829, MAE: 3.8412, SWD: 13.8837
    Time taken: 22.52 seconds
    
    ==================================================
    Experiment Summary (ACL_etth2_seq720_pred720_20250510_2220)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 28.1540 ± 0.7290
      mae: 3.7205 ± 0.0854
      huber: 3.2645 ± 0.0805
      swd: 12.9787 ± 0.9451
      ept: 218.7096 ± 7.8032
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 27.3778 ± 0.3582
      mae: 3.7650 ± 0.0305
      huber: 3.3188 ± 0.0341
      swd: 6.2288 ± 1.1102
      ept: 215.2330 ± 5.0555
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 55.78 seconds
    
    Experiment complete: ACL_etth2_seq720_pred720_20250510_2220
    Model: ACL
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### Timemixer

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3073, mae: 0.3298, huber: 0.1180, swd: 0.1288, ept: 75.6559
    Epoch [1/50], Val Losses: mse: 0.2444, mae: 0.3479, huber: 0.1173, swd: 0.0996, ept: 70.6820
    Epoch [1/50], Test Losses: mse: 0.1506, mae: 0.2741, huber: 0.0742, swd: 0.0478, ept: 79.0775
      Epoch 1 composite train-obj: 0.117995
            Val objective improved inf → 0.1173, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2120, mae: 0.2753, huber: 0.0838, swd: 0.0903, ept: 83.1346
    Epoch [2/50], Val Losses: mse: 0.2616, mae: 0.3640, huber: 0.1248, swd: 0.1113, ept: 70.6596
    Epoch [2/50], Test Losses: mse: 0.1684, mae: 0.2873, huber: 0.0824, swd: 0.0590, ept: 77.5182
      Epoch 2 composite train-obj: 0.083773
            No improvement (0.1248), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.1595, mae: 0.2456, huber: 0.0660, swd: 0.0617, ept: 85.5791
    Epoch [3/50], Val Losses: mse: 0.2442, mae: 0.3590, huber: 0.1170, swd: 0.1042, ept: 72.8813
    Epoch [3/50], Test Losses: mse: 0.1695, mae: 0.2865, huber: 0.0830, swd: 0.0621, ept: 76.9036
      Epoch 3 composite train-obj: 0.065981
            Val objective improved 0.1173 → 0.1170, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.1258, mae: 0.2192, huber: 0.0522, swd: 0.0406, ept: 87.7251
    Epoch [4/50], Val Losses: mse: 0.2497, mae: 0.3615, huber: 0.1199, swd: 0.1048, ept: 71.8741
    Epoch [4/50], Test Losses: mse: 0.1823, mae: 0.2976, huber: 0.0889, swd: 0.0665, ept: 76.6022
      Epoch 4 composite train-obj: 0.052183
            No improvement (0.1199), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.1062, mae: 0.2002, huber: 0.0436, swd: 0.0323, ept: 89.6682
    Epoch [5/50], Val Losses: mse: 0.2522, mae: 0.3637, huber: 0.1207, swd: 0.1018, ept: 71.8601
    Epoch [5/50], Test Losses: mse: 0.1818, mae: 0.2965, huber: 0.0886, swd: 0.0661, ept: 75.8659
      Epoch 5 composite train-obj: 0.043574
            No improvement (0.1207), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.0932, mae: 0.1861, huber: 0.0378, swd: 0.0275, ept: 90.8116
    Epoch [6/50], Val Losses: mse: 0.2527, mae: 0.3628, huber: 0.1209, swd: 0.1025, ept: 70.7102
    Epoch [6/50], Test Losses: mse: 0.1787, mae: 0.2945, huber: 0.0871, swd: 0.0628, ept: 75.8577
      Epoch 6 composite train-obj: 0.037841
            No improvement (0.1209), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.0855, mae: 0.1770, huber: 0.0346, swd: 0.0251, ept: 91.5032
    Epoch [7/50], Val Losses: mse: 0.2516, mae: 0.3635, huber: 0.1207, swd: 0.1000, ept: 69.9786
    Epoch [7/50], Test Losses: mse: 0.1840, mae: 0.2992, huber: 0.0895, swd: 0.0634, ept: 75.7191
      Epoch 7 composite train-obj: 0.034561
            No improvement (0.1207), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.0782, mae: 0.1680, huber: 0.0314, swd: 0.0222, ept: 92.1146
    Epoch [8/50], Val Losses: mse: 0.2574, mae: 0.3672, huber: 0.1232, swd: 0.1030, ept: 69.1915
    Epoch [8/50], Test Losses: mse: 0.1818, mae: 0.2957, huber: 0.0884, swd: 0.0630, ept: 75.6630
      Epoch 8 composite train-obj: 0.031384
    Epoch [8/50], Test Losses: mse: 0.1695, mae: 0.2865, huber: 0.0830, swd: 0.0621, ept: 76.9036
    Best round's Test MSE: 0.1695, MAE: 0.2865, SWD: 0.0621
    Best round's Validation MSE: 0.2442, MAE: 0.3590, SWD: 0.1042
    Best round's Test verification MSE : 0.1695, MAE: 0.2865, SWD: 0.0621
    Time taken: 89.55 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3314, mae: 0.3455, huber: 0.1273, swd: 0.1166, ept: 71.1009
    Epoch [1/50], Val Losses: mse: 0.2510, mae: 0.3548, huber: 0.1211, swd: 0.1029, ept: 69.0261
    Epoch [1/50], Test Losses: mse: 0.1666, mae: 0.2895, huber: 0.0819, swd: 0.0548, ept: 78.1692
      Epoch 1 composite train-obj: 0.127293
            Val objective improved inf → 0.1211, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2103, mae: 0.2729, huber: 0.0831, swd: 0.0882, ept: 83.1740
    Epoch [2/50], Val Losses: mse: 0.2426, mae: 0.3488, huber: 0.1169, swd: 0.1010, ept: 69.8251
    Epoch [2/50], Test Losses: mse: 0.1610, mae: 0.2824, huber: 0.0791, swd: 0.0558, ept: 78.0570
      Epoch 2 composite train-obj: 0.083140
            Val objective improved 0.1211 → 0.1169, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.1552, mae: 0.2406, huber: 0.0640, swd: 0.0590, ept: 86.0223
    Epoch [3/50], Val Losses: mse: 0.2540, mae: 0.3596, huber: 0.1218, swd: 0.1022, ept: 68.5496
    Epoch [3/50], Test Losses: mse: 0.1755, mae: 0.2961, huber: 0.0860, swd: 0.0584, ept: 77.4986
      Epoch 3 composite train-obj: 0.063970
            No improvement (0.1218), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.1248, mae: 0.2172, huber: 0.0516, swd: 0.0403, ept: 88.0124
    Epoch [4/50], Val Losses: mse: 0.2674, mae: 0.3710, huber: 0.1281, swd: 0.1093, ept: 67.2281
    Epoch [4/50], Test Losses: mse: 0.1761, mae: 0.2973, huber: 0.0862, swd: 0.0576, ept: 77.1093
      Epoch 4 composite train-obj: 0.051581
            No improvement (0.1281), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.1074, mae: 0.2008, huber: 0.0441, swd: 0.0321, ept: 89.4431
    Epoch [5/50], Val Losses: mse: 0.2634, mae: 0.3682, huber: 0.1260, swd: 0.1049, ept: 67.3476
    Epoch [5/50], Test Losses: mse: 0.1773, mae: 0.2975, huber: 0.0867, swd: 0.0568, ept: 76.1858
      Epoch 5 composite train-obj: 0.044064
            No improvement (0.1260), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.0965, mae: 0.1895, huber: 0.0393, swd: 0.0278, ept: 90.5173
    Epoch [6/50], Val Losses: mse: 0.2601, mae: 0.3660, huber: 0.1247, swd: 0.1038, ept: 67.4669
    Epoch [6/50], Test Losses: mse: 0.1722, mae: 0.2930, huber: 0.0843, swd: 0.0536, ept: 76.4366
      Epoch 6 composite train-obj: 0.039338
            No improvement (0.1247), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.0884, mae: 0.1804, huber: 0.0358, swd: 0.0250, ept: 91.2814
    Epoch [7/50], Val Losses: mse: 0.2704, mae: 0.3747, huber: 0.1295, swd: 0.1075, ept: 66.0942
    Epoch [7/50], Test Losses: mse: 0.1826, mae: 0.3020, huber: 0.0892, swd: 0.0582, ept: 75.8999
      Epoch 7 composite train-obj: 0.035806
    Epoch [7/50], Test Losses: mse: 0.1610, mae: 0.2824, huber: 0.0791, swd: 0.0558, ept: 78.0570
    Best round's Test MSE: 0.1610, MAE: 0.2824, SWD: 0.0558
    Best round's Validation MSE: 0.2426, MAE: 0.3488, SWD: 0.1010
    Best round's Test verification MSE : 0.1610, MAE: 0.2824, SWD: 0.0558
    Time taken: 81.07 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3044, mae: 0.3280, huber: 0.1164, swd: 0.1177, ept: 76.7737
    Epoch [1/50], Val Losses: mse: 0.2321, mae: 0.3440, huber: 0.1127, swd: 0.0867, ept: 71.7187
    Epoch [1/50], Test Losses: mse: 0.1517, mae: 0.2777, huber: 0.0748, swd: 0.0437, ept: 79.7095
      Epoch 1 composite train-obj: 0.116408
            Val objective improved inf → 0.1127, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2274, mae: 0.2817, huber: 0.0883, swd: 0.0889, ept: 82.8685
    Epoch [2/50], Val Losses: mse: 0.2540, mae: 0.3581, huber: 0.1216, swd: 0.1008, ept: 70.5639
    Epoch [2/50], Test Losses: mse: 0.1584, mae: 0.2778, huber: 0.0778, swd: 0.0504, ept: 77.9889
      Epoch 2 composite train-obj: 0.088263
            No improvement (0.1216), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.1812, mae: 0.2564, huber: 0.0730, swd: 0.0716, ept: 85.1045
    Epoch [3/50], Val Losses: mse: 0.2516, mae: 0.3576, huber: 0.1206, swd: 0.0929, ept: 70.1569
    Epoch [3/50], Test Losses: mse: 0.1699, mae: 0.2881, huber: 0.0832, swd: 0.0564, ept: 77.2903
      Epoch 3 composite train-obj: 0.072997
            No improvement (0.1206), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.1421, mae: 0.2324, huber: 0.0589, swd: 0.0481, ept: 86.8428
    Epoch [4/50], Val Losses: mse: 0.2534, mae: 0.3605, huber: 0.1217, swd: 0.0967, ept: 70.6313
    Epoch [4/50], Test Losses: mse: 0.1795, mae: 0.2946, huber: 0.0874, swd: 0.0601, ept: 76.2442
      Epoch 4 composite train-obj: 0.058948
            No improvement (0.1217), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.1189, mae: 0.2123, huber: 0.0490, swd: 0.0355, ept: 88.5624
    Epoch [5/50], Val Losses: mse: 0.2530, mae: 0.3606, huber: 0.1208, swd: 0.0937, ept: 71.5587
    Epoch [5/50], Test Losses: mse: 0.1896, mae: 0.2988, huber: 0.0913, swd: 0.0665, ept: 75.1337
      Epoch 5 composite train-obj: 0.049010
            No improvement (0.1208), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1050, mae: 0.1982, huber: 0.0429, swd: 0.0302, ept: 89.7956
    Epoch [6/50], Val Losses: mse: 0.2626, mae: 0.3710, huber: 0.1259, swd: 0.0971, ept: 70.2192
    Epoch [6/50], Test Losses: mse: 0.1851, mae: 0.2967, huber: 0.0894, swd: 0.0626, ept: 75.3580
      Epoch 6 composite train-obj: 0.042881
    Epoch [6/50], Test Losses: mse: 0.1517, mae: 0.2777, huber: 0.0748, swd: 0.0437, ept: 79.7095
    Best round's Test MSE: 0.1517, MAE: 0.2777, SWD: 0.0437
    Best round's Validation MSE: 0.2321, MAE: 0.3440, SWD: 0.0867
    Best round's Test verification MSE : 0.1517, MAE: 0.2777, SWD: 0.0437
    Time taken: 69.76 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred96_20250510_2149)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1607 ± 0.0073
      mae: 0.2822 ± 0.0036
      huber: 0.0790 ± 0.0033
      swd: 0.0539 ± 0.0076
      ept: 78.2234 ± 1.1515
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2396 ± 0.0053
      mae: 0.3506 ± 0.0063
      huber: 0.1155 ± 0.0020
      swd: 0.0973 ± 0.0076
      ept: 71.4750 ± 1.2595
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 240.49 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred96_20250510_2149
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 25.0355, mae: 2.7474, huber: 2.3236, swd: 13.4745, ept: 75.7352
    Epoch [1/50], Val Losses: mse: 16.8414, mae: 2.7730, huber: 2.3381, swd: 7.5818, ept: 71.3754
    Epoch [1/50], Test Losses: mse: 13.3707, mae: 2.3332, huber: 1.9158, swd: 6.8855, ept: 79.4852
      Epoch 1 composite train-obj: 2.323558
            Val objective improved inf → 2.3381, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 17.7225, mae: 2.2554, huber: 1.8402, swd: 8.3744, ept: 82.7901
    Epoch [2/50], Val Losses: mse: 17.8324, mae: 2.8686, huber: 2.4306, swd: 7.8958, ept: 71.9161
    Epoch [2/50], Test Losses: mse: 14.8623, mae: 2.4246, huber: 2.0064, swd: 8.0035, ept: 77.7043
      Epoch 2 composite train-obj: 1.840237
            No improvement (2.4306), counter 1/5
    Epoch [3/50], Train Losses: mse: 13.8106, mae: 1.9785, huber: 1.5690, swd: 5.7184, ept: 85.0853
    Epoch [3/50], Val Losses: mse: 16.5131, mae: 2.8256, huber: 2.3802, swd: 6.9182, ept: 73.5136
    Epoch [3/50], Test Losses: mse: 15.4350, mae: 2.4894, huber: 2.0684, swd: 8.5110, ept: 78.3023
      Epoch 3 composite train-obj: 1.569010
            No improvement (2.3802), counter 2/5
    Epoch [4/50], Train Losses: mse: 10.9215, mae: 1.7742, huber: 1.3699, swd: 3.9596, ept: 86.6441
    Epoch [4/50], Val Losses: mse: 16.9822, mae: 2.8747, huber: 2.4310, swd: 6.9365, ept: 72.0909
    Epoch [4/50], Test Losses: mse: 16.4624, mae: 2.5552, huber: 2.1334, swd: 9.1277, ept: 77.0993
      Epoch 4 composite train-obj: 1.369867
            No improvement (2.4310), counter 3/5
    Epoch [5/50], Train Losses: mse: 9.0880, mae: 1.6173, huber: 1.2178, swd: 3.0642, ept: 87.7421
    Epoch [5/50], Val Losses: mse: 16.4646, mae: 2.8300, huber: 2.3861, swd: 6.4935, ept: 71.9612
    Epoch [5/50], Test Losses: mse: 16.0514, mae: 2.5179, huber: 2.0979, swd: 8.6516, ept: 76.8048
      Epoch 5 composite train-obj: 1.217847
            No improvement (2.3861), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.9362, mae: 1.4908, huber: 1.0962, swd: 2.6753, ept: 88.7675
    Epoch [6/50], Val Losses: mse: 17.1369, mae: 2.8889, huber: 2.4449, swd: 6.7294, ept: 70.8785
    Epoch [6/50], Test Losses: mse: 16.1709, mae: 2.5371, huber: 2.1161, swd: 8.6618, ept: 76.1232
      Epoch 6 composite train-obj: 1.096216
    Epoch [6/50], Test Losses: mse: 13.3707, mae: 2.3332, huber: 1.9158, swd: 6.8855, ept: 79.4852
    Best round's Test MSE: 13.3707, MAE: 2.3332, SWD: 6.8855
    Best round's Validation MSE: 16.8414, MAE: 2.7730, SWD: 7.5818
    Best round's Test verification MSE : 13.3707, MAE: 2.3332, SWD: 6.8855
    Time taken: 69.68 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 26.6398, mae: 2.8541, huber: 2.4277, swd: 12.6198, ept: 71.8737
    Epoch [1/50], Val Losses: mse: 17.3544, mae: 2.8006, huber: 2.3676, swd: 7.6189, ept: 70.8226
    Epoch [1/50], Test Losses: mse: 13.8072, mae: 2.3513, huber: 1.9356, swd: 6.9265, ept: 78.2835
      Epoch 1 composite train-obj: 2.427697
            Val objective improved inf → 2.3676, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 16.9079, mae: 2.1867, huber: 1.7730, swd: 7.4996, ept: 83.4179
    Epoch [2/50], Val Losses: mse: 18.4105, mae: 2.8716, huber: 2.4357, swd: 8.1068, ept: 70.3393
    Epoch [2/50], Test Losses: mse: 14.5016, mae: 2.4183, huber: 1.9995, swd: 7.5054, ept: 77.8308
      Epoch 2 composite train-obj: 1.773020
            No improvement (2.4357), counter 1/5
    Epoch [3/50], Train Losses: mse: 12.4993, mae: 1.8791, huber: 1.4722, swd: 4.6582, ept: 85.8570
    Epoch [3/50], Val Losses: mse: 18.2132, mae: 2.8793, huber: 2.4420, swd: 7.9060, ept: 69.2760
    Epoch [3/50], Test Losses: mse: 15.4568, mae: 2.4880, huber: 2.0677, swd: 7.9766, ept: 77.3053
      Epoch 3 composite train-obj: 1.472202
            No improvement (2.4420), counter 2/5
    Epoch [4/50], Train Losses: mse: 10.2493, mae: 1.7203, huber: 1.3176, swd: 3.4103, ept: 87.0328
    Epoch [4/50], Val Losses: mse: 18.8919, mae: 2.9292, huber: 2.4915, swd: 8.1097, ept: 69.2226
    Epoch [4/50], Test Losses: mse: 15.2998, mae: 2.4820, huber: 2.0621, swd: 7.7200, ept: 77.5856
      Epoch 4 composite train-obj: 1.317650
            No improvement (2.4915), counter 3/5
    Epoch [5/50], Train Losses: mse: 8.8548, mae: 1.5943, huber: 1.1957, swd: 2.8146, ept: 87.9077
    Epoch [5/50], Val Losses: mse: 18.2517, mae: 2.8869, huber: 2.4478, swd: 7.4471, ept: 68.6411
    Epoch [5/50], Test Losses: mse: 15.4474, mae: 2.5059, huber: 2.0847, swd: 7.7946, ept: 77.1418
      Epoch 5 composite train-obj: 1.195728
            No improvement (2.4478), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.9738, mae: 1.4998, huber: 1.1048, swd: 2.5677, ept: 88.6855
    Epoch [6/50], Val Losses: mse: 18.0195, mae: 2.8792, huber: 2.4401, swd: 7.4123, ept: 69.4382
    Epoch [6/50], Test Losses: mse: 15.5358, mae: 2.5143, huber: 2.0927, swd: 7.6890, ept: 76.8054
      Epoch 6 composite train-obj: 1.104752
    Epoch [6/50], Test Losses: mse: 13.8072, mae: 2.3513, huber: 1.9356, swd: 6.9265, ept: 78.2835
    Best round's Test MSE: 13.8072, MAE: 2.3513, SWD: 6.9265
    Best round's Validation MSE: 17.3544, MAE: 2.8006, SWD: 7.6189
    Best round's Test verification MSE : 13.8072, MAE: 2.3513, SWD: 6.9265
    Time taken: 71.41 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 24.7954, mae: 2.7290, huber: 2.3059, swd: 12.2516, ept: 77.0433
    Epoch [1/50], Val Losses: mse: 17.1734, mae: 2.7850, huber: 2.3523, swd: 7.2772, ept: 70.4807
    Epoch [1/50], Test Losses: mse: 12.9033, mae: 2.2986, huber: 1.8818, swd: 5.9834, ept: 79.7906
      Epoch 1 composite train-obj: 2.305910
            Val objective improved inf → 2.3523, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 19.1512, mae: 2.3199, huber: 1.9043, swd: 8.5954, ept: 82.5051
    Epoch [2/50], Val Losses: mse: 18.1340, mae: 2.8857, huber: 2.4502, swd: 7.5583, ept: 71.9073
    Epoch [2/50], Test Losses: mse: 13.8958, mae: 2.3532, huber: 1.9369, swd: 6.4991, ept: 78.9679
      Epoch 2 composite train-obj: 1.904331
            No improvement (2.4502), counter 1/5
    Epoch [3/50], Train Losses: mse: 15.4867, mae: 2.0671, huber: 1.6560, swd: 6.2483, ept: 84.6020
    Epoch [3/50], Val Losses: mse: 17.3424, mae: 2.8270, huber: 2.3888, swd: 6.6160, ept: 71.2267
    Epoch [3/50], Test Losses: mse: 13.9197, mae: 2.3522, huber: 1.9351, swd: 6.5932, ept: 78.3517
      Epoch 3 composite train-obj: 1.656035
            No improvement (2.3888), counter 2/5
    Epoch [4/50], Train Losses: mse: 12.3876, mae: 1.8603, huber: 1.4545, swd: 4.3918, ept: 86.0402
    Epoch [4/50], Val Losses: mse: 17.0474, mae: 2.8554, huber: 2.4145, swd: 6.4488, ept: 69.9016
    Epoch [4/50], Test Losses: mse: 15.1462, mae: 2.4530, huber: 2.0329, swd: 7.3440, ept: 76.9414
      Epoch 4 composite train-obj: 1.454458
            No improvement (2.4145), counter 3/5
    Epoch [5/50], Train Losses: mse: 10.0737, mae: 1.6952, huber: 1.2939, swd: 3.1810, ept: 87.2279
    Epoch [5/50], Val Losses: mse: 17.5769, mae: 2.9130, huber: 2.4695, swd: 6.8305, ept: 70.4468
    Epoch [5/50], Test Losses: mse: 15.0104, mae: 2.4605, huber: 2.0407, swd: 7.1661, ept: 77.3104
      Epoch 5 composite train-obj: 1.293894
            No improvement (2.4695), counter 4/5
    Epoch [6/50], Train Losses: mse: 8.7880, mae: 1.5816, huber: 1.1839, swd: 2.7023, ept: 88.0614
    Epoch [6/50], Val Losses: mse: 18.4567, mae: 2.9970, huber: 2.5530, swd: 7.2271, ept: 68.7784
    Epoch [6/50], Test Losses: mse: 15.4260, mae: 2.4923, huber: 2.0708, swd: 7.3289, ept: 76.1314
      Epoch 6 composite train-obj: 1.183883
    Epoch [6/50], Test Losses: mse: 12.9033, mae: 2.2986, huber: 1.8818, swd: 5.9834, ept: 79.7906
    Best round's Test MSE: 12.9033, MAE: 2.2986, SWD: 5.9834
    Best round's Validation MSE: 17.1734, MAE: 2.7850, SWD: 7.2772
    Best round's Test verification MSE : 12.9033, MAE: 2.2986, SWD: 5.9834
    Time taken: 72.64 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred96_20250510_2225)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 13.3604 ± 0.3691
      mae: 2.3277 ± 0.0219
      huber: 1.9110 ± 0.0222
      swd: 6.5985 ± 0.4353
      ept: 79.1864 ± 0.6505
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 17.1231 ± 0.2124
      mae: 2.7862 ± 0.0113
      huber: 2.3527 ± 0.0120
      swd: 7.4926 ± 0.1531
      ept: 70.8929 ± 0.3686
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 213.85 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred96_20250510_2225
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4102, mae: 0.3818, huber: 0.1517, swd: 0.1569, ept: 123.5954
    Epoch [1/50], Val Losses: mse: 0.3144, mae: 0.4017, huber: 0.1488, swd: 0.1318, ept: 113.9797
    Epoch [1/50], Test Losses: mse: 0.1818, mae: 0.3046, huber: 0.0893, swd: 0.0557, ept: 134.1385
      Epoch 1 composite train-obj: 0.151694
            Val objective improved inf → 0.1488, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2865, mae: 0.3134, huber: 0.1073, swd: 0.1276, ept: 146.8104
    Epoch [2/50], Val Losses: mse: 0.3242, mae: 0.4108, huber: 0.1533, swd: 0.1280, ept: 117.3011
    Epoch [2/50], Test Losses: mse: 0.1939, mae: 0.3110, huber: 0.0949, swd: 0.0617, ept: 131.6944
      Epoch 2 composite train-obj: 0.107282
            No improvement (0.1533), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2334, mae: 0.2844, huber: 0.0894, swd: 0.1044, ept: 154.2288
    Epoch [3/50], Val Losses: mse: 0.3358, mae: 0.4169, huber: 0.1582, swd: 0.1297, ept: 114.8494
    Epoch [3/50], Test Losses: mse: 0.2221, mae: 0.3279, huber: 0.1072, swd: 0.0714, ept: 128.6440
      Epoch 3 composite train-obj: 0.089353
            No improvement (0.1582), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.1911, mae: 0.2589, huber: 0.0744, swd: 0.0771, ept: 159.4250
    Epoch [4/50], Val Losses: mse: 0.3458, mae: 0.4224, huber: 0.1615, swd: 0.1276, ept: 112.2128
    Epoch [4/50], Test Losses: mse: 0.2489, mae: 0.3448, huber: 0.1185, swd: 0.0826, ept: 125.3108
      Epoch 4 composite train-obj: 0.074422
            No improvement (0.1615), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.1606, mae: 0.2377, huber: 0.0627, swd: 0.0559, ept: 164.4024
    Epoch [5/50], Val Losses: mse: 0.3420, mae: 0.4262, huber: 0.1612, swd: 0.1239, ept: 111.2354
    Epoch [5/50], Test Losses: mse: 0.2368, mae: 0.3397, huber: 0.1137, swd: 0.0746, ept: 126.5869
      Epoch 5 composite train-obj: 0.062663
            No improvement (0.1612), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1429, mae: 0.2221, huber: 0.0553, swd: 0.0461, ept: 168.6748
    Epoch [6/50], Val Losses: mse: 0.3550, mae: 0.4362, huber: 0.1672, swd: 0.1348, ept: 106.2696
    Epoch [6/50], Test Losses: mse: 0.2312, mae: 0.3347, huber: 0.1107, swd: 0.0728, ept: 126.2655
      Epoch 6 composite train-obj: 0.055328
    Epoch [6/50], Test Losses: mse: 0.1818, mae: 0.3046, huber: 0.0893, swd: 0.0557, ept: 134.1385
    Best round's Test MSE: 0.1818, MAE: 0.3046, SWD: 0.0557
    Best round's Validation MSE: 0.3144, MAE: 0.4017, SWD: 0.1318
    Best round's Test verification MSE : 0.1818, MAE: 0.3046, SWD: 0.0557
    Time taken: 70.01 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4264, mae: 0.3934, huber: 0.1586, swd: 0.1529, ept: 115.7060
    Epoch [1/50], Val Losses: mse: 0.3505, mae: 0.4233, huber: 0.1638, swd: 0.1432, ept: 104.3747
    Epoch [1/50], Test Losses: mse: 0.1806, mae: 0.3029, huber: 0.0886, swd: 0.0553, ept: 130.4823
      Epoch 1 composite train-obj: 0.158576
            Val objective improved inf → 0.1638, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2696, mae: 0.3064, huber: 0.1023, swd: 0.1203, ept: 147.1935
    Epoch [2/50], Val Losses: mse: 0.3561, mae: 0.4264, huber: 0.1642, swd: 0.1456, ept: 110.3647
    Epoch [2/50], Test Losses: mse: 0.1969, mae: 0.3093, huber: 0.0957, swd: 0.0656, ept: 127.5837
      Epoch 2 composite train-obj: 0.102262
            No improvement (0.1642), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2122, mae: 0.2722, huber: 0.0820, swd: 0.0925, ept: 156.4733
    Epoch [3/50], Val Losses: mse: 0.3408, mae: 0.4207, huber: 0.1590, swd: 0.1299, ept: 110.8505
    Epoch [3/50], Test Losses: mse: 0.2030, mae: 0.3160, huber: 0.0986, swd: 0.0636, ept: 129.5752
      Epoch 3 composite train-obj: 0.082032
            Val objective improved 0.1638 → 0.1590, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.1716, mae: 0.2467, huber: 0.0672, swd: 0.0653, ept: 162.3456
    Epoch [4/50], Val Losses: mse: 0.3582, mae: 0.4306, huber: 0.1664, swd: 0.1321, ept: 106.4273
    Epoch [4/50], Test Losses: mse: 0.2232, mae: 0.3293, huber: 0.1075, swd: 0.0704, ept: 127.1495
      Epoch 4 composite train-obj: 0.067223
            No improvement (0.1664), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.1488, mae: 0.2269, huber: 0.0576, swd: 0.0518, ept: 168.1355
    Epoch [5/50], Val Losses: mse: 0.3624, mae: 0.4358, huber: 0.1686, swd: 0.1381, ept: 105.3237
    Epoch [5/50], Test Losses: mse: 0.2199, mae: 0.3268, huber: 0.1061, swd: 0.0668, ept: 126.4002
      Epoch 5 composite train-obj: 0.057572
            No improvement (0.1686), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.1330, mae: 0.2139, huber: 0.0513, swd: 0.0436, ept: 171.4180
    Epoch [6/50], Val Losses: mse: 0.3587, mae: 0.4343, huber: 0.1674, swd: 0.1343, ept: 104.2266
    Epoch [6/50], Test Losses: mse: 0.2242, mae: 0.3288, huber: 0.1078, swd: 0.0691, ept: 126.6430
      Epoch 6 composite train-obj: 0.051345
            No improvement (0.1674), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.1218, mae: 0.2026, huber: 0.0465, swd: 0.0391, ept: 174.7177
    Epoch [7/50], Val Losses: mse: 0.3655, mae: 0.4393, huber: 0.1705, swd: 0.1395, ept: 102.9659
    Epoch [7/50], Test Losses: mse: 0.2234, mae: 0.3289, huber: 0.1074, swd: 0.0687, ept: 125.7823
      Epoch 7 composite train-obj: 0.046544
            No improvement (0.1705), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.1141, mae: 0.1951, huber: 0.0434, swd: 0.0371, ept: 177.1919
    Epoch [8/50], Val Losses: mse: 0.3655, mae: 0.4404, huber: 0.1709, swd: 0.1338, ept: 101.5874
    Epoch [8/50], Test Losses: mse: 0.2274, mae: 0.3310, huber: 0.1091, swd: 0.0697, ept: 124.7322
      Epoch 8 composite train-obj: 0.043364
    Epoch [8/50], Test Losses: mse: 0.2030, mae: 0.3160, huber: 0.0986, swd: 0.0636, ept: 129.5752
    Best round's Test MSE: 0.2030, MAE: 0.3160, SWD: 0.0636
    Best round's Validation MSE: 0.3408, MAE: 0.4207, SWD: 0.1299
    Best round's Test verification MSE : 0.2030, MAE: 0.3160, SWD: 0.0636
    Time taken: 96.27 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3745, mae: 0.3595, huber: 0.1386, swd: 0.1478, ept: 137.5457
    Epoch [1/50], Val Losses: mse: 0.3172, mae: 0.4027, huber: 0.1496, swd: 0.1152, ept: 110.5758
    Epoch [1/50], Test Losses: mse: 0.1769, mae: 0.2954, huber: 0.0865, swd: 0.0498, ept: 133.4895
      Epoch 1 composite train-obj: 0.138563
            Val objective improved inf → 0.1496, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2809, mae: 0.3112, huber: 0.1057, swd: 0.1176, ept: 149.8273
    Epoch [2/50], Val Losses: mse: 0.3560, mae: 0.4274, huber: 0.1653, swd: 0.1346, ept: 107.6611
    Epoch [2/50], Test Losses: mse: 0.1959, mae: 0.3097, huber: 0.0952, swd: 0.0554, ept: 128.7504
      Epoch 2 composite train-obj: 0.105687
            No improvement (0.1653), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2248, mae: 0.2796, huber: 0.0862, swd: 0.0941, ept: 156.2436
    Epoch [3/50], Val Losses: mse: 0.3533, mae: 0.4299, huber: 0.1641, swd: 0.1294, ept: 114.0639
    Epoch [3/50], Test Losses: mse: 0.1960, mae: 0.3098, huber: 0.0953, swd: 0.0528, ept: 128.8334
      Epoch 3 composite train-obj: 0.086191
            No improvement (0.1641), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.1826, mae: 0.2524, huber: 0.0708, swd: 0.0678, ept: 162.0342
    Epoch [4/50], Val Losses: mse: 0.3863, mae: 0.4476, huber: 0.1782, swd: 0.1462, ept: 108.5553
    Epoch [4/50], Test Losses: mse: 0.2131, mae: 0.3221, huber: 0.1031, swd: 0.0564, ept: 127.0374
      Epoch 4 composite train-obj: 0.070843
            No improvement (0.1782), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.1512, mae: 0.2280, huber: 0.0583, swd: 0.0490, ept: 167.8565
    Epoch [5/50], Val Losses: mse: 0.3815, mae: 0.4444, huber: 0.1762, swd: 0.1337, ept: 106.0575
    Epoch [5/50], Test Losses: mse: 0.2168, mae: 0.3242, huber: 0.1045, swd: 0.0544, ept: 127.4866
      Epoch 5 composite train-obj: 0.058287
            No improvement (0.1762), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1325, mae: 0.2116, huber: 0.0507, swd: 0.0397, ept: 172.3647
    Epoch [6/50], Val Losses: mse: 0.3683, mae: 0.4376, huber: 0.1706, swd: 0.1277, ept: 105.4571
    Epoch [6/50], Test Losses: mse: 0.2178, mae: 0.3259, huber: 0.1050, swd: 0.0545, ept: 126.2953
      Epoch 6 composite train-obj: 0.050716
    Epoch [6/50], Test Losses: mse: 0.1769, mae: 0.2954, huber: 0.0865, swd: 0.0498, ept: 133.4895
    Best round's Test MSE: 0.1769, MAE: 0.2954, SWD: 0.0498
    Best round's Validation MSE: 0.3172, MAE: 0.4027, SWD: 0.1152
    Best round's Test verification MSE : 0.1769, MAE: 0.2954, SWD: 0.0498
    Time taken: 72.32 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred196_20250510_2153)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1872 ± 0.0113
      mae: 0.3053 ± 0.0084
      huber: 0.0915 ± 0.0052
      swd: 0.0564 ± 0.0056
      ept: 132.4011 ± 2.0157
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3241 ± 0.0118
      mae: 0.4084 ± 0.0087
      huber: 0.1525 ± 0.0046
      swd: 0.1257 ± 0.0074
      ept: 111.8020 ± 1.5439
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 238.72 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred196_20250510_2153
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 33.5216, mae: 3.1698, huber: 2.7378, swd: 16.1140, ept: 125.1578
    Epoch [1/50], Val Losses: mse: 21.9028, mae: 3.2432, huber: 2.7988, swd: 9.3837, ept: 113.5913
    Epoch [1/50], Test Losses: mse: 16.0168, mae: 2.5674, huber: 2.1442, swd: 7.5504, ept: 134.8418
      Epoch 1 composite train-obj: 2.737798
            Val objective improved inf → 2.7988, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 23.9074, mae: 2.5577, huber: 2.1351, swd: 10.5270, ept: 148.1324
    Epoch [2/50], Val Losses: mse: 23.7415, mae: 3.3559, huber: 2.9107, swd: 10.4917, ept: 110.8093
    Epoch [2/50], Test Losses: mse: 18.3971, mae: 2.7035, huber: 2.2815, swd: 8.9881, ept: 130.3733
      Epoch 2 composite train-obj: 2.135076
            No improvement (2.9107), counter 1/5
    Epoch [3/50], Train Losses: mse: 19.7033, mae: 2.2873, huber: 1.8695, swd: 8.0970, ept: 154.6881
    Epoch [3/50], Val Losses: mse: 23.0566, mae: 3.3256, huber: 2.8793, swd: 9.6935, ept: 113.7134
    Epoch [3/50], Test Losses: mse: 21.1555, mae: 2.8485, huber: 2.4246, swd: 10.5050, ept: 128.4433
      Epoch 3 composite train-obj: 1.869467
            No improvement (2.8793), counter 2/5
    Epoch [4/50], Train Losses: mse: 16.8547, mae: 2.0995, huber: 1.6861, swd: 6.6871, ept: 158.6964
    Epoch [4/50], Val Losses: mse: 23.2852, mae: 3.3595, huber: 2.9124, swd: 9.8435, ept: 113.5539
    Epoch [4/50], Test Losses: mse: 21.1662, mae: 2.8526, huber: 2.4278, swd: 10.3046, ept: 128.6032
      Epoch 4 composite train-obj: 1.686079
            No improvement (2.9124), counter 3/5
    Epoch [5/50], Train Losses: mse: 14.1925, mae: 1.9197, huber: 1.5107, swd: 5.3364, ept: 162.7903
    Epoch [5/50], Val Losses: mse: 23.1419, mae: 3.3593, huber: 2.9114, swd: 9.6466, ept: 109.9168
    Epoch [5/50], Test Losses: mse: 21.5889, mae: 2.8814, huber: 2.4554, swd: 10.4036, ept: 127.9567
      Epoch 5 composite train-obj: 1.510673
            No improvement (2.9114), counter 4/5
    Epoch [6/50], Train Losses: mse: 12.7662, mae: 1.8086, huber: 1.4028, swd: 4.7533, ept: 164.5739
    Epoch [6/50], Val Losses: mse: 22.9204, mae: 3.3902, huber: 2.9383, swd: 9.2390, ept: 109.0447
    Epoch [6/50], Test Losses: mse: 20.7223, mae: 2.8349, huber: 2.4085, swd: 9.6557, ept: 127.7047
      Epoch 6 composite train-obj: 1.402754
    Epoch [6/50], Test Losses: mse: 16.0168, mae: 2.5674, huber: 2.1442, swd: 7.5504, ept: 134.8418
    Best round's Test MSE: 16.0168, MAE: 2.5674, SWD: 7.5504
    Best round's Validation MSE: 21.9028, MAE: 3.2432, SWD: 9.3837
    Best round's Test verification MSE : 16.0168, MAE: 2.5674, SWD: 7.5504
    Time taken: 72.63 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 34.7766, mae: 3.2515, huber: 2.8180, swd: 16.1951, ept: 118.7678
    Epoch [1/50], Val Losses: mse: 24.3875, mae: 3.4324, huber: 2.9852, swd: 11.7796, ept: 108.9739
    Epoch [1/50], Test Losses: mse: 16.3187, mae: 2.5972, huber: 2.1742, swd: 7.7704, ept: 132.5603
      Epoch 1 composite train-obj: 2.818004
            Val objective improved inf → 2.9852, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 22.3819, mae: 2.4704, huber: 2.0493, swd: 9.8867, ept: 149.7050
    Epoch [2/50], Val Losses: mse: 24.8040, mae: 3.4268, huber: 2.9801, swd: 11.4565, ept: 107.7848
    Epoch [2/50], Test Losses: mse: 17.9638, mae: 2.6361, huber: 2.2162, swd: 8.4703, ept: 127.8516
      Epoch 2 composite train-obj: 2.049269
            Val objective improved 2.9852 → 2.9801, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 18.0982, mae: 2.1607, huber: 1.7462, swd: 7.6688, ept: 157.9681
    Epoch [3/50], Val Losses: mse: 24.7069, mae: 3.4402, huber: 2.9908, swd: 11.9447, ept: 111.1874
    Epoch [3/50], Test Losses: mse: 18.7363, mae: 2.7225, huber: 2.2989, swd: 9.3665, ept: 129.8512
      Epoch 3 composite train-obj: 1.746165
            No improvement (2.9908), counter 1/5
    Epoch [4/50], Train Losses: mse: 14.7663, mae: 1.9428, huber: 1.5335, swd: 5.9487, ept: 162.6499
    Epoch [4/50], Val Losses: mse: 25.4022, mae: 3.4720, huber: 3.0214, swd: 12.1430, ept: 112.0087
    Epoch [4/50], Test Losses: mse: 19.3874, mae: 2.7811, huber: 2.3561, swd: 9.6330, ept: 129.5166
      Epoch 4 composite train-obj: 1.533541
            No improvement (3.0214), counter 2/5
    Epoch [5/50], Train Losses: mse: 13.0919, mae: 1.8220, huber: 1.4161, swd: 5.2342, ept: 165.1064
    Epoch [5/50], Val Losses: mse: 25.5292, mae: 3.4884, huber: 3.0387, swd: 11.8138, ept: 107.9146
    Epoch [5/50], Test Losses: mse: 18.9738, mae: 2.7615, huber: 2.3352, swd: 9.0296, ept: 128.4471
      Epoch 5 composite train-obj: 1.416111
            No improvement (3.0387), counter 3/5
    Epoch [6/50], Train Losses: mse: 11.5902, mae: 1.6997, huber: 1.2976, swd: 4.6076, ept: 167.3463
    Epoch [6/50], Val Losses: mse: 25.8700, mae: 3.4966, huber: 3.0474, swd: 11.8291, ept: 104.9024
    Epoch [6/50], Test Losses: mse: 19.1057, mae: 2.7486, huber: 2.3236, swd: 9.0120, ept: 128.1580
      Epoch 6 composite train-obj: 1.297635
            No improvement (3.0474), counter 4/5
    Epoch [7/50], Train Losses: mse: 10.7623, mae: 1.6151, huber: 1.2162, swd: 4.3858, ept: 169.3016
    Epoch [7/50], Val Losses: mse: 25.8395, mae: 3.5207, huber: 3.0702, swd: 11.7449, ept: 103.0157
    Epoch [7/50], Test Losses: mse: 18.3672, mae: 2.7219, huber: 2.2965, swd: 8.3585, ept: 129.2847
      Epoch 7 composite train-obj: 1.216225
    Epoch [7/50], Test Losses: mse: 17.9638, mae: 2.6361, huber: 2.2162, swd: 8.4703, ept: 127.8516
    Best round's Test MSE: 17.9638, MAE: 2.6361, SWD: 8.4703
    Best round's Validation MSE: 24.8040, MAE: 3.4268, SWD: 11.4565
    Best round's Test verification MSE : 17.9638, MAE: 2.6361, SWD: 8.4703
    Time taken: 85.24 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 31.1117, mae: 3.0028, huber: 2.5751, swd: 14.6181, ept: 137.5848
    Epoch [1/50], Val Losses: mse: 23.8612, mae: 3.3263, huber: 2.8824, swd: 9.3192, ept: 108.1734
    Epoch [1/50], Test Losses: mse: 16.0409, mae: 2.5190, huber: 2.1002, swd: 6.2698, ept: 133.7622
      Epoch 1 composite train-obj: 2.575070
            Val objective improved inf → 2.8824, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 24.5603, mae: 2.5915, huber: 2.1689, swd: 10.1800, ept: 149.2784
    Epoch [2/50], Val Losses: mse: 23.3775, mae: 3.3491, huber: 2.9005, swd: 8.8687, ept: 111.8368
    Epoch [2/50], Test Losses: mse: 16.8776, mae: 2.5713, huber: 2.1526, swd: 6.7401, ept: 132.0905
      Epoch 2 composite train-obj: 2.168881
            No improvement (2.9005), counter 1/5
    Epoch [3/50], Train Losses: mse: 20.4438, mae: 2.3104, huber: 1.8921, swd: 7.8737, ept: 155.0246
    Epoch [3/50], Val Losses: mse: 21.7342, mae: 3.2503, huber: 2.8005, swd: 7.7755, ept: 115.3214
    Epoch [3/50], Test Losses: mse: 19.0424, mae: 2.7065, huber: 2.2862, swd: 7.9688, ept: 130.9274
      Epoch 3 composite train-obj: 1.892123
            Val objective improved 2.8824 → 2.8005, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 17.2765, mae: 2.0779, huber: 1.6652, swd: 6.4072, ept: 160.0735
    Epoch [4/50], Val Losses: mse: 22.1310, mae: 3.2786, huber: 2.8277, swd: 7.8107, ept: 112.7317
    Epoch [4/50], Test Losses: mse: 18.9816, mae: 2.6973, huber: 2.2762, swd: 7.5921, ept: 129.2921
      Epoch 4 composite train-obj: 1.665238
            No improvement (2.8277), counter 1/5
    Epoch [5/50], Train Losses: mse: 14.1390, mae: 1.8811, huber: 1.4734, swd: 4.8896, ept: 163.9537
    Epoch [5/50], Val Losses: mse: 22.2837, mae: 3.3072, huber: 2.8556, swd: 7.7571, ept: 111.9273
    Epoch [5/50], Test Losses: mse: 17.8997, mae: 2.6580, huber: 2.2358, swd: 6.8592, ept: 130.3290
      Epoch 5 composite train-obj: 1.473414
            No improvement (2.8556), counter 2/5
    Epoch [6/50], Train Losses: mse: 12.1891, mae: 1.7330, huber: 1.3297, swd: 4.1062, ept: 166.2633
    Epoch [6/50], Val Losses: mse: 24.2523, mae: 3.4242, huber: 2.9733, swd: 8.6049, ept: 107.6824
    Epoch [6/50], Test Losses: mse: 19.2810, mae: 2.7652, huber: 2.3406, swd: 7.5724, ept: 127.7531
      Epoch 6 composite train-obj: 1.329713
            No improvement (2.9733), counter 3/5
    Epoch [7/50], Train Losses: mse: 10.8358, mae: 1.6149, huber: 1.2158, swd: 3.7271, ept: 168.7107
    Epoch [7/50], Val Losses: mse: 23.3749, mae: 3.3941, huber: 2.9424, swd: 7.7451, ept: 108.0939
    Epoch [7/50], Test Losses: mse: 18.5454, mae: 2.7239, huber: 2.2997, swd: 6.9075, ept: 128.2882
      Epoch 7 composite train-obj: 1.215760
            No improvement (2.9424), counter 4/5
    Epoch [8/50], Train Losses: mse: 9.8516, mae: 1.5145, huber: 1.1197, swd: 3.5262, ept: 170.8551
    Epoch [8/50], Val Losses: mse: 23.0489, mae: 3.3778, huber: 2.9260, swd: 7.9106, ept: 105.9082
    Epoch [8/50], Test Losses: mse: 18.7783, mae: 2.7539, huber: 2.3285, swd: 6.8693, ept: 127.9996
      Epoch 8 composite train-obj: 1.119674
    Epoch [8/50], Test Losses: mse: 19.0424, mae: 2.7065, huber: 2.2862, swd: 7.9688, ept: 130.9274
    Best round's Test MSE: 19.0424, MAE: 2.7065, SWD: 7.9688
    Best round's Validation MSE: 21.7342, MAE: 3.2503, SWD: 7.7755
    Best round's Test verification MSE : 19.0424, MAE: 2.7065, SWD: 7.9688
    Time taken: 96.70 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred196_20250510_2229)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 17.6743 ± 1.2521
      mae: 2.6366 ± 0.0568
      huber: 2.2155 ± 0.0580
      swd: 7.9965 ± 0.3761
      ept: 131.2069 ± 2.8606
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 22.8137 ± 1.4091
      mae: 3.3068 ± 0.0849
      huber: 2.8598 ± 0.0851
      swd: 9.5386 ± 1.5067
      ept: 112.2325 ± 3.2233
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 254.71 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred196_20250510_2229
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4782, mae: 0.4146, huber: 0.1740, swd: 0.1857, ept: 178.9265
    Epoch [1/50], Val Losses: mse: 0.3691, mae: 0.4463, huber: 0.1741, swd: 0.1163, ept: 152.4858
    Epoch [1/50], Test Losses: mse: 0.1918, mae: 0.3131, huber: 0.0941, swd: 0.0501, ept: 194.3427
      Epoch 1 composite train-obj: 0.174028
            Val objective improved inf → 0.1741, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3621, mae: 0.3518, huber: 0.1322, swd: 0.1553, ept: 211.3154
    Epoch [2/50], Val Losses: mse: 0.4336, mae: 0.4740, huber: 0.1983, swd: 0.1630, ept: 148.8040
    Epoch [2/50], Test Losses: mse: 0.2137, mae: 0.3320, huber: 0.1045, swd: 0.0629, ept: 189.5535
      Epoch 2 composite train-obj: 0.132162
            No improvement (0.1983), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2981, mae: 0.3132, huber: 0.1083, swd: 0.1346, ept: 228.4468
    Epoch [3/50], Val Losses: mse: 0.4121, mae: 0.4710, huber: 0.1916, swd: 0.1356, ept: 150.8764
    Epoch [3/50], Test Losses: mse: 0.2435, mae: 0.3544, huber: 0.1182, swd: 0.0721, ept: 185.4879
      Epoch 3 composite train-obj: 0.108341
            No improvement (0.1916), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2492, mae: 0.2883, huber: 0.0922, swd: 0.1037, ept: 240.1032
    Epoch [4/50], Val Losses: mse: 0.4211, mae: 0.4771, huber: 0.1950, swd: 0.1334, ept: 142.2760
    Epoch [4/50], Test Losses: mse: 0.2602, mae: 0.3589, huber: 0.1236, swd: 0.0790, ept: 179.9956
      Epoch 4 composite train-obj: 0.092241
            No improvement (0.1950), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2023, mae: 0.2565, huber: 0.0743, swd: 0.0738, ept: 255.4746
    Epoch [5/50], Val Losses: mse: 0.4016, mae: 0.4674, huber: 0.1872, swd: 0.1292, ept: 144.8159
    Epoch [5/50], Test Losses: mse: 0.2386, mae: 0.3420, huber: 0.1140, swd: 0.0676, ept: 180.6450
      Epoch 5 composite train-obj: 0.074273
            No improvement (0.1872), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1775, mae: 0.2368, huber: 0.0645, swd: 0.0607, ept: 264.9157
    Epoch [6/50], Val Losses: mse: 0.4017, mae: 0.4683, huber: 0.1880, swd: 0.1236, ept: 142.0304
    Epoch [6/50], Test Losses: mse: 0.2416, mae: 0.3438, huber: 0.1151, swd: 0.0664, ept: 179.3137
      Epoch 6 composite train-obj: 0.064483
    Epoch [6/50], Test Losses: mse: 0.1918, mae: 0.3131, huber: 0.0941, swd: 0.0501, ept: 194.3427
    Best round's Test MSE: 0.1918, MAE: 0.3131, SWD: 0.0501
    Best round's Validation MSE: 0.3691, MAE: 0.4463, SWD: 0.1163
    Best round's Test verification MSE : 0.1918, MAE: 0.3131, SWD: 0.0501
    Time taken: 72.39 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5291, mae: 0.4433, huber: 0.1926, swd: 0.1851, ept: 153.3528
    Epoch [1/50], Val Losses: mse: 0.4081, mae: 0.4644, huber: 0.1896, swd: 0.1511, ept: 141.2155
    Epoch [1/50], Test Losses: mse: 0.1993, mae: 0.3160, huber: 0.0972, swd: 0.0566, ept: 184.2338
      Epoch 1 composite train-obj: 0.192619
            Val objective improved inf → 0.1896, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3485, mae: 0.3467, huber: 0.1280, swd: 0.1543, ept: 207.4426
    Epoch [2/50], Val Losses: mse: 0.4290, mae: 0.4799, huber: 0.1984, swd: 0.1577, ept: 140.2877
    Epoch [2/50], Test Losses: mse: 0.2221, mae: 0.3341, huber: 0.1077, swd: 0.0661, ept: 183.9964
      Epoch 2 composite train-obj: 0.128048
            No improvement (0.1984), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2811, mae: 0.3044, huber: 0.1025, swd: 0.1267, ept: 229.4051
    Epoch [3/50], Val Losses: mse: 0.4125, mae: 0.4686, huber: 0.1902, swd: 0.1543, ept: 146.6181
    Epoch [3/50], Test Losses: mse: 0.2331, mae: 0.3409, huber: 0.1125, swd: 0.0690, ept: 182.1876
      Epoch 3 composite train-obj: 0.102540
            No improvement (0.1902), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2321, mae: 0.2755, huber: 0.0852, swd: 0.0982, ept: 244.9532
    Epoch [4/50], Val Losses: mse: 0.4282, mae: 0.4812, huber: 0.1975, swd: 0.1333, ept: 141.6225
    Epoch [4/50], Test Losses: mse: 0.2507, mae: 0.3549, huber: 0.1206, swd: 0.0708, ept: 180.2593
      Epoch 4 composite train-obj: 0.085243
            No improvement (0.1975), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.1970, mae: 0.2531, huber: 0.0724, swd: 0.0746, ept: 255.4539
    Epoch [5/50], Val Losses: mse: 0.4435, mae: 0.4960, huber: 0.2048, swd: 0.1225, ept: 131.5348
    Epoch [5/50], Test Losses: mse: 0.2914, mae: 0.3872, huber: 0.1390, swd: 0.0874, ept: 179.3286
      Epoch 5 composite train-obj: 0.072365
            No improvement (0.2048), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1934, mae: 0.2446, huber: 0.0692, swd: 0.0725, ept: 262.4746
    Epoch [6/50], Val Losses: mse: 0.4287, mae: 0.4838, huber: 0.1984, swd: 0.1260, ept: 133.7580
    Epoch [6/50], Test Losses: mse: 0.2515, mae: 0.3526, huber: 0.1200, swd: 0.0669, ept: 178.7459
      Epoch 6 composite train-obj: 0.069169
    Epoch [6/50], Test Losses: mse: 0.1993, mae: 0.3160, huber: 0.0972, swd: 0.0566, ept: 184.2338
    Best round's Test MSE: 0.1993, MAE: 0.3160, SWD: 0.0566
    Best round's Validation MSE: 0.4081, MAE: 0.4644, SWD: 0.1511
    Best round's Test verification MSE : 0.1993, MAE: 0.3160, SWD: 0.0566
    Time taken: 72.27 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4721, mae: 0.4092, huber: 0.1709, swd: 0.1919, ept: 188.9391
    Epoch [1/50], Val Losses: mse: 0.3742, mae: 0.4555, huber: 0.1773, swd: 0.1023, ept: 151.9671
    Epoch [1/50], Test Losses: mse: 0.1987, mae: 0.3185, huber: 0.0972, swd: 0.0487, ept: 193.8849
      Epoch 1 composite train-obj: 0.170882
            Val objective improved inf → 0.1773, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3647, mae: 0.3559, huber: 0.1339, swd: 0.1579, ept: 211.8198
    Epoch [2/50], Val Losses: mse: 0.3978, mae: 0.4605, huber: 0.1853, swd: 0.1209, ept: 151.7161
    Epoch [2/50], Test Losses: mse: 0.2047, mae: 0.3227, huber: 0.1000, swd: 0.0556, ept: 189.9177
      Epoch 2 composite train-obj: 0.133873
            No improvement (0.1853), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3055, mae: 0.3203, huber: 0.1116, swd: 0.1375, ept: 226.6299
    Epoch [3/50], Val Losses: mse: 0.4260, mae: 0.4737, huber: 0.1970, swd: 0.1454, ept: 140.3317
    Epoch [3/50], Test Losses: mse: 0.2215, mae: 0.3345, huber: 0.1076, swd: 0.0595, ept: 183.0555
      Epoch 3 composite train-obj: 0.111624
            No improvement (0.1970), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2579, mae: 0.2914, huber: 0.0944, swd: 0.1127, ept: 240.5238
    Epoch [4/50], Val Losses: mse: 0.4423, mae: 0.4858, huber: 0.2029, swd: 0.1507, ept: 137.3886
    Epoch [4/50], Test Losses: mse: 0.2354, mae: 0.3410, huber: 0.1134, swd: 0.0635, ept: 177.5610
      Epoch 4 composite train-obj: 0.094389
            No improvement (0.2029), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2184, mae: 0.2681, huber: 0.0805, swd: 0.0874, ept: 250.4526
    Epoch [5/50], Val Losses: mse: 0.4383, mae: 0.4898, huber: 0.2029, swd: 0.1408, ept: 136.1691
    Epoch [5/50], Test Losses: mse: 0.2425, mae: 0.3472, huber: 0.1167, swd: 0.0616, ept: 184.3020
      Epoch 5 composite train-obj: 0.080528
            No improvement (0.2029), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.1867, mae: 0.2446, huber: 0.0682, swd: 0.0672, ept: 262.1997
    Epoch [6/50], Val Losses: mse: 0.4359, mae: 0.4862, huber: 0.2019, swd: 0.1449, ept: 134.7722
    Epoch [6/50], Test Losses: mse: 0.2485, mae: 0.3507, huber: 0.1195, swd: 0.0614, ept: 176.2342
      Epoch 6 composite train-obj: 0.068194
    Epoch [6/50], Test Losses: mse: 0.1987, mae: 0.3185, huber: 0.0972, swd: 0.0487, ept: 193.8849
    Best round's Test MSE: 0.1987, MAE: 0.3185, SWD: 0.0487
    Best round's Validation MSE: 0.3742, MAE: 0.4555, SWD: 0.1023
    Best round's Test verification MSE : 0.1987, MAE: 0.3185, SWD: 0.0487
    Time taken: 72.27 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred336_20250510_2157)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1966 ± 0.0034
      mae: 0.3159 ± 0.0022
      huber: 0.0961 ± 0.0015
      swd: 0.0518 ± 0.0035
      ept: 190.8205 ± 4.6612
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3838 ± 0.0173
      mae: 0.4554 ± 0.0074
      huber: 0.1803 ± 0.0067
      swd: 0.1232 ± 0.0205
      ept: 148.5561 ± 5.1949
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 217.09 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred336_20250510_2157
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 41.0058, mae: 3.4686, huber: 3.0318, swd: 20.5028, ept: 180.6930
    Epoch [1/50], Val Losses: mse: 24.7642, mae: 3.5140, huber: 3.0586, swd: 8.2423, ept: 151.4992
    Epoch [1/50], Test Losses: mse: 16.9587, mae: 2.6524, huber: 2.2294, swd: 6.8274, ept: 194.2318
      Epoch 1 composite train-obj: 3.031798
            Val objective improved inf → 3.0586, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 31.3957, mae: 2.8928, huber: 2.4639, swd: 14.2322, ept: 214.9548
    Epoch [2/50], Val Losses: mse: 27.4687, mae: 3.6795, huber: 3.2258, swd: 10.8079, ept: 152.1429
    Epoch [2/50], Test Losses: mse: 18.3318, mae: 2.7436, huber: 2.3184, swd: 7.3825, ept: 190.6293
      Epoch 2 composite train-obj: 2.463928
            No improvement (3.2258), counter 1/5
    Epoch [3/50], Train Losses: mse: 25.7147, mae: 2.5326, huber: 2.1100, swd: 10.7941, ept: 230.8082
    Epoch [3/50], Val Losses: mse: 25.2575, mae: 3.6006, huber: 3.1460, swd: 8.2550, ept: 149.0217
    Epoch [3/50], Test Losses: mse: 21.0857, mae: 2.9432, huber: 2.5143, swd: 9.1453, ept: 187.2215
      Epoch 3 composite train-obj: 2.109978
            No improvement (3.1460), counter 2/5
    Epoch [4/50], Train Losses: mse: 21.5576, mae: 2.2989, huber: 1.8802, swd: 8.5269, ept: 241.0654
    Epoch [4/50], Val Losses: mse: 27.6999, mae: 3.7490, huber: 3.2931, swd: 8.0977, ept: 146.6968
    Epoch [4/50], Test Losses: mse: 22.7379, mae: 2.9758, huber: 2.5465, swd: 10.0777, ept: 184.7584
      Epoch 4 composite train-obj: 1.880223
            No improvement (3.2931), counter 3/5
    Epoch [5/50], Train Losses: mse: 18.5319, mae: 2.0872, huber: 1.6734, swd: 7.3086, ept: 251.2917
    Epoch [5/50], Val Losses: mse: 26.6139, mae: 3.6937, huber: 3.2350, swd: 7.8022, ept: 145.6972
    Epoch [5/50], Test Losses: mse: 23.3034, mae: 3.0046, huber: 2.5741, swd: 10.6769, ept: 185.4421
      Epoch 5 composite train-obj: 1.673375
            No improvement (3.2350), counter 4/5
    Epoch [6/50], Train Losses: mse: 16.9130, mae: 1.9694, huber: 1.5587, swd: 6.8876, ept: 255.8747
    Epoch [6/50], Val Losses: mse: 27.4681, mae: 3.7411, huber: 3.2842, swd: 7.9825, ept: 141.9500
    Epoch [6/50], Test Losses: mse: 23.6770, mae: 3.0277, huber: 2.5970, swd: 10.5724, ept: 180.6494
      Epoch 6 composite train-obj: 1.558664
    Epoch [6/50], Test Losses: mse: 16.9587, mae: 2.6524, huber: 2.2294, swd: 6.8274, ept: 194.2318
    Best round's Test MSE: 16.9587, MAE: 2.6524, SWD: 6.8274
    Best round's Validation MSE: 24.7642, MAE: 3.5140, SWD: 8.2423
    Best round's Test verification MSE : 16.9587, MAE: 2.6524, SWD: 6.8274
    Time taken: 72.43 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 44.1861, mae: 3.6795, huber: 3.2389, swd: 20.2573, ept: 157.9826
    Epoch [1/50], Val Losses: mse: 26.9569, mae: 3.6548, huber: 3.2014, swd: 10.7111, ept: 144.2992
    Epoch [1/50], Test Losses: mse: 17.8123, mae: 2.7171, huber: 2.2912, swd: 7.5726, ept: 187.0838
      Epoch 1 composite train-obj: 3.238946
            Val objective improved inf → 3.2014, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 29.8983, mae: 2.8310, huber: 2.4025, swd: 13.0118, ept: 213.0326
    Epoch [2/50], Val Losses: mse: 27.4863, mae: 3.7274, huber: 3.2695, swd: 10.5133, ept: 144.2817
    Epoch [2/50], Test Losses: mse: 18.3535, mae: 2.7372, huber: 2.3113, swd: 7.3806, ept: 188.7180
      Epoch 2 composite train-obj: 2.402549
            No improvement (3.2695), counter 1/5
    Epoch [3/50], Train Losses: mse: 24.4076, mae: 2.4540, huber: 2.0324, swd: 10.3283, ept: 232.9478
    Epoch [3/50], Val Losses: mse: 26.5347, mae: 3.6625, huber: 3.2057, swd: 9.2871, ept: 145.6302
    Epoch [3/50], Test Losses: mse: 20.1416, mae: 2.8252, huber: 2.3986, swd: 8.5728, ept: 182.6867
      Epoch 3 composite train-obj: 2.032437
            No improvement (3.2057), counter 2/5
    Epoch [4/50], Train Losses: mse: 20.7851, mae: 2.2170, huber: 1.8003, swd: 8.7446, ept: 244.9166
    Epoch [4/50], Val Losses: mse: 27.6537, mae: 3.7153, huber: 3.2594, swd: 9.9496, ept: 142.3356
    Epoch [4/50], Test Losses: mse: 20.8234, mae: 2.8915, huber: 2.4631, swd: 8.9488, ept: 180.7940
      Epoch 4 composite train-obj: 1.800316
            No improvement (3.2594), counter 3/5
    Epoch [5/50], Train Losses: mse: 18.0053, mae: 2.0381, huber: 1.6254, swd: 7.5590, ept: 252.3660
    Epoch [5/50], Val Losses: mse: 34.0316, mae: 4.1000, huber: 3.6403, swd: 10.7999, ept: 138.8048
    Epoch [5/50], Test Losses: mse: 24.6785, mae: 3.2130, huber: 2.7753, swd: 11.2778, ept: 181.4568
      Epoch 5 composite train-obj: 1.625369
            No improvement (3.6403), counter 4/5
    Epoch [6/50], Train Losses: mse: 17.5230, mae: 1.9774, huber: 1.5669, swd: 7.5648, ept: 255.6393
    Epoch [6/50], Val Losses: mse: 29.7726, mae: 3.8467, huber: 3.3869, swd: 9.4617, ept: 138.9632
    Epoch [6/50], Test Losses: mse: 22.2627, mae: 3.0120, huber: 2.5793, swd: 9.6041, ept: 182.6357
      Epoch 6 composite train-obj: 1.566869
    Epoch [6/50], Test Losses: mse: 17.8123, mae: 2.7171, huber: 2.2912, swd: 7.5726, ept: 187.0838
    Best round's Test MSE: 17.8123, MAE: 2.7171, SWD: 7.5726
    Best round's Validation MSE: 26.9569, MAE: 3.6548, SWD: 10.7111
    Best round's Test verification MSE : 17.8123, MAE: 2.7171, SWD: 7.5726
    Time taken: 73.29 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 40.3915, mae: 3.4302, huber: 2.9947, swd: 20.1990, ept: 190.0596
    Epoch [1/50], Val Losses: mse: 24.6122, mae: 3.5183, huber: 3.0640, swd: 8.0773, ept: 155.4090
    Epoch [1/50], Test Losses: mse: 17.3621, mae: 2.6659, huber: 2.2436, swd: 6.7124, ept: 191.6858
      Epoch 1 composite train-obj: 2.994707
            Val objective improved inf → 3.0640, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 32.8794, mae: 2.9959, huber: 2.5653, swd: 14.8577, ept: 212.9182
    Epoch [2/50], Val Losses: mse: 26.9609, mae: 3.6336, huber: 3.1820, swd: 10.0807, ept: 149.7944
    Epoch [2/50], Test Losses: mse: 18.9709, mae: 2.7819, huber: 2.3573, swd: 7.5438, ept: 189.9948
      Epoch 2 composite train-obj: 2.565285
            No improvement (3.1820), counter 1/5
    Epoch [3/50], Train Losses: mse: 27.6413, mae: 2.6710, huber: 2.2446, swd: 11.6406, ept: 225.4543
    Epoch [3/50], Val Losses: mse: 26.9855, mae: 3.6408, huber: 3.1860, swd: 9.4068, ept: 142.5940
    Epoch [3/50], Test Losses: mse: 19.7872, mae: 2.8268, huber: 2.4012, swd: 7.6003, ept: 184.3793
      Epoch 3 composite train-obj: 2.244564
            No improvement (3.1860), counter 2/5
    Epoch [4/50], Train Losses: mse: 23.3827, mae: 2.3862, huber: 1.9648, swd: 9.5128, ept: 237.3890
    Epoch [4/50], Val Losses: mse: 27.4101, mae: 3.6922, huber: 3.2362, swd: 8.6961, ept: 142.7968
    Epoch [4/50], Test Losses: mse: 20.8510, mae: 2.8942, huber: 2.4668, swd: 8.2784, ept: 179.5760
      Epoch 4 composite train-obj: 1.964766
            No improvement (3.2362), counter 3/5
    Epoch [5/50], Train Losses: mse: 19.8155, mae: 2.1752, huber: 1.7582, swd: 7.7942, ept: 248.4090
    Epoch [5/50], Val Losses: mse: 27.6813, mae: 3.7425, huber: 3.2850, swd: 8.5334, ept: 137.1948
    Epoch [5/50], Test Losses: mse: 21.1091, mae: 2.9103, huber: 2.4811, swd: 8.3512, ept: 181.4509
      Epoch 5 composite train-obj: 1.758210
            No improvement (3.2850), counter 4/5
    Epoch [6/50], Train Losses: mse: 17.7802, mae: 2.0338, huber: 1.6202, swd: 7.0272, ept: 253.9138
    Epoch [6/50], Val Losses: mse: 27.2405, mae: 3.7138, huber: 3.2550, swd: 7.5166, ept: 140.6608
    Epoch [6/50], Test Losses: mse: 20.1735, mae: 2.8756, huber: 2.4459, swd: 7.5314, ept: 181.0426
      Epoch 6 composite train-obj: 1.620180
    Epoch [6/50], Test Losses: mse: 17.3621, mae: 2.6659, huber: 2.2436, swd: 6.7124, ept: 191.6858
    Best round's Test MSE: 17.3621, MAE: 2.6659, SWD: 6.7124
    Best round's Validation MSE: 24.6122, MAE: 3.5183, SWD: 8.0773
    Best round's Test verification MSE : 17.3621, MAE: 2.6659, SWD: 6.7124
    Time taken: 73.13 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred336_20250510_2233)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 17.3777 ± 0.3486
      mae: 2.6785 ± 0.0279
      huber: 2.2547 ± 0.0264
      swd: 7.0375 ± 0.3813
      ept: 191.0005 ± 2.9581
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 25.4444 ± 1.0713
      mae: 3.5624 ± 0.0654
      huber: 3.1080 ± 0.0661
      swd: 9.0102 ± 1.2046
      ept: 150.4024 ± 4.6014
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 218.99 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred336_20250510_2233
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7089, mae: 0.5185, huber: 0.2487, swd: 0.2642, ept: 259.2769
    Epoch [1/50], Val Losses: mse: 0.3927, mae: 0.4677, huber: 0.1884, swd: 0.1080, ept: 233.4243
    Epoch [1/50], Test Losses: mse: 0.2186, mae: 0.3324, huber: 0.1059, swd: 0.0652, ept: 313.4443
      Epoch 1 composite train-obj: 0.248724
            Val objective improved inf → 0.1884, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5580, mae: 0.4444, huber: 0.1953, swd: 0.2360, ept: 308.8768
    Epoch [2/50], Val Losses: mse: 0.4369, mae: 0.4923, huber: 0.2081, swd: 0.1152, ept: 240.5102
    Epoch [2/50], Test Losses: mse: 0.2633, mae: 0.3690, huber: 0.1270, swd: 0.0681, ept: 312.8616
      Epoch 2 composite train-obj: 0.195337
            No improvement (0.2081), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4722, mae: 0.4016, huber: 0.1656, swd: 0.2026, ept: 328.5965
    Epoch [3/50], Val Losses: mse: 0.4601, mae: 0.5120, huber: 0.2174, swd: 0.1064, ept: 243.2109
    Epoch [3/50], Test Losses: mse: 0.2885, mae: 0.3860, huber: 0.1383, swd: 0.0863, ept: 304.2733
      Epoch 3 composite train-obj: 0.165551
            No improvement (0.2174), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.4071, mae: 0.3648, huber: 0.1415, swd: 0.1751, ept: 346.1077
    Epoch [4/50], Val Losses: mse: 0.4384, mae: 0.5048, huber: 0.2088, swd: 0.1087, ept: 230.6502
    Epoch [4/50], Test Losses: mse: 0.2890, mae: 0.3839, huber: 0.1377, swd: 0.0878, ept: 305.9359
      Epoch 4 composite train-obj: 0.141509
            No improvement (0.2088), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.3803, mae: 0.3452, huber: 0.1296, swd: 0.1666, ept: 364.1939
    Epoch [5/50], Val Losses: mse: 0.6856, mae: 0.6213, huber: 0.3022, swd: 0.1478, ept: 231.2910
    Epoch [5/50], Test Losses: mse: 0.4956, mae: 0.4962, huber: 0.2180, swd: 0.1638, ept: 286.4899
      Epoch 5 composite train-obj: 0.129586
            No improvement (0.3022), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.3303, mae: 0.3226, huber: 0.1141, swd: 0.1383, ept: 381.5309
    Epoch [6/50], Val Losses: mse: 0.4835, mae: 0.5318, huber: 0.2272, swd: 0.1096, ept: 221.2496
    Epoch [6/50], Test Losses: mse: 0.3324, mae: 0.4102, huber: 0.1552, swd: 0.0989, ept: 291.1346
      Epoch 6 composite train-obj: 0.114133
    Epoch [6/50], Test Losses: mse: 0.2186, mae: 0.3324, huber: 0.1059, swd: 0.0652, ept: 313.4443
    Best round's Test MSE: 0.2186, MAE: 0.3324, SWD: 0.0652
    Best round's Validation MSE: 0.3927, MAE: 0.4677, SWD: 0.1080
    Best round's Test verification MSE : 0.2186, MAE: 0.3324, SWD: 0.0652
    Time taken: 73.99 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7605, mae: 0.5387, huber: 0.2642, swd: 0.2662, ept: 242.3624
    Epoch [1/50], Val Losses: mse: 0.4483, mae: 0.4969, huber: 0.2099, swd: 0.0769, ept: 238.7768
    Epoch [1/50], Test Losses: mse: 0.2665, mae: 0.3692, huber: 0.1282, swd: 0.0737, ept: 304.1405
      Epoch 1 composite train-obj: 0.264169
            Val objective improved inf → 0.2099, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5401, mae: 0.4421, huber: 0.1920, swd: 0.2178, ept: 307.2842
    Epoch [2/50], Val Losses: mse: 0.5741, mae: 0.5661, huber: 0.2611, swd: 0.1223, ept: 243.3156
    Epoch [2/50], Test Losses: mse: 0.3721, mae: 0.4393, huber: 0.1738, swd: 0.1119, ept: 303.6869
      Epoch 2 composite train-obj: 0.191995
            No improvement (0.2611), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4620, mae: 0.3954, huber: 0.1618, swd: 0.1933, ept: 335.7940
    Epoch [3/50], Val Losses: mse: 0.4692, mae: 0.5152, huber: 0.2201, swd: 0.1043, ept: 249.1725
    Epoch [3/50], Test Losses: mse: 0.2956, mae: 0.3871, huber: 0.1399, swd: 0.0870, ept: 308.9441
      Epoch 3 composite train-obj: 0.161840
            No improvement (0.2201), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.3971, mae: 0.3576, huber: 0.1376, swd: 0.1693, ept: 359.5588
    Epoch [4/50], Val Losses: mse: 0.4931, mae: 0.5313, huber: 0.2295, swd: 0.1132, ept: 240.0647
    Epoch [4/50], Test Losses: mse: 0.3378, mae: 0.4071, huber: 0.1555, swd: 0.1085, ept: 303.7130
      Epoch 4 composite train-obj: 0.137575
            No improvement (0.2295), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.3449, mae: 0.3298, huber: 0.1192, swd: 0.1463, ept: 380.8548
    Epoch [5/50], Val Losses: mse: 0.5508, mae: 0.5598, huber: 0.2509, swd: 0.1049, ept: 236.0627
    Epoch [5/50], Test Losses: mse: 0.3599, mae: 0.4294, huber: 0.1673, swd: 0.1107, ept: 302.7089
      Epoch 5 composite train-obj: 0.119178
            No improvement (0.2509), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.3173, mae: 0.3134, huber: 0.1089, swd: 0.1303, ept: 395.6267
    Epoch [6/50], Val Losses: mse: 0.5556, mae: 0.5613, huber: 0.2522, swd: 0.0962, ept: 224.8429
    Epoch [6/50], Test Losses: mse: 0.3725, mae: 0.4336, huber: 0.1714, swd: 0.1119, ept: 296.1662
      Epoch 6 composite train-obj: 0.108893
    Epoch [6/50], Test Losses: mse: 0.2665, mae: 0.3692, huber: 0.1282, swd: 0.0737, ept: 304.1405
    Best round's Test MSE: 0.2665, MAE: 0.3692, SWD: 0.0737
    Best round's Validation MSE: 0.4483, MAE: 0.4969, SWD: 0.0769
    Best round's Test verification MSE : 0.2665, MAE: 0.3692, SWD: 0.0737
    Time taken: 74.08 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7265, mae: 0.5241, huber: 0.2539, swd: 0.2877, ept: 269.1426
    Epoch [1/50], Val Losses: mse: 0.4057, mae: 0.4811, huber: 0.1945, swd: 0.1178, ept: 217.6778
    Epoch [1/50], Test Losses: mse: 0.2672, mae: 0.3738, huber: 0.1291, swd: 0.0824, ept: 310.3799
      Epoch 1 composite train-obj: 0.253939
            Val objective improved inf → 0.1945, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5570, mae: 0.4492, huber: 0.1980, swd: 0.2408, ept: 310.0725
    Epoch [2/50], Val Losses: mse: 0.4466, mae: 0.5059, huber: 0.2119, swd: 0.1358, ept: 236.6802
    Epoch [2/50], Test Losses: mse: 0.2577, mae: 0.3671, huber: 0.1247, swd: 0.0773, ept: 315.4907
      Epoch 2 composite train-obj: 0.197980
            No improvement (0.2119), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4875, mae: 0.4108, huber: 0.1716, swd: 0.2166, ept: 326.7078
    Epoch [3/50], Val Losses: mse: 0.4276, mae: 0.4950, huber: 0.2040, swd: 0.1134, ept: 237.5782
    Epoch [3/50], Test Losses: mse: 0.2346, mae: 0.3457, huber: 0.1137, swd: 0.0607, ept: 314.3911
      Epoch 3 composite train-obj: 0.171603
            No improvement (0.2040), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.4751, mae: 0.4018, huber: 0.1662, swd: 0.2133, ept: 335.1232
    Epoch [4/50], Val Losses: mse: 0.4591, mae: 0.5119, huber: 0.2171, swd: 0.1302, ept: 242.5950
    Epoch [4/50], Test Losses: mse: 0.2843, mae: 0.3817, huber: 0.1356, swd: 0.0878, ept: 310.6165
      Epoch 4 composite train-obj: 0.166245
            No improvement (0.2171), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.4255, mae: 0.3713, huber: 0.1468, swd: 0.1954, ept: 351.6376
    Epoch [5/50], Val Losses: mse: 0.4407, mae: 0.5055, huber: 0.2097, swd: 0.1134, ept: 245.1165
    Epoch [5/50], Test Losses: mse: 0.3077, mae: 0.3974, huber: 0.1456, swd: 0.1005, ept: 306.6960
      Epoch 5 composite train-obj: 0.146836
            No improvement (0.2097), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.3758, mae: 0.3496, huber: 0.1309, swd: 0.1704, ept: 362.7766
    Epoch [6/50], Val Losses: mse: 0.4919, mae: 0.5404, huber: 0.2310, swd: 0.1325, ept: 233.0096
    Epoch [6/50], Test Losses: mse: 0.3817, mae: 0.4399, huber: 0.1761, swd: 0.1418, ept: 298.4717
      Epoch 6 composite train-obj: 0.130898
    Epoch [6/50], Test Losses: mse: 0.2672, mae: 0.3738, huber: 0.1291, swd: 0.0824, ept: 310.3799
    Best round's Test MSE: 0.2672, MAE: 0.3738, SWD: 0.0824
    Best round's Validation MSE: 0.4057, MAE: 0.4811, SWD: 0.1178
    Best round's Test verification MSE : 0.2672, MAE: 0.3738, SWD: 0.0824
    Time taken: 73.55 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred720_20250510_2200)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2508 ± 0.0227
      mae: 0.3585 ± 0.0185
      huber: 0.1211 ± 0.0107
      swd: 0.0738 ± 0.0070
      ept: 309.3216 ± 3.8713
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.4156 ± 0.0237
      mae: 0.4819 ± 0.0119
      huber: 0.1976 ± 0.0090
      swd: 0.1009 ± 0.0175
      ept: 229.9596 ± 8.9553
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 221.74 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred720_20250510_2200
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 64.1516, mae: 4.3711, huber: 3.9222, swd: 33.4824, ept: 264.8445
    Epoch [1/50], Val Losses: mse: 27.4636, mae: 3.7715, huber: 3.3198, swd: 9.4013, ept: 258.6894
    Epoch [1/50], Test Losses: mse: 20.4436, mae: 2.8953, huber: 2.4664, swd: 8.0159, ept: 319.5890
      Epoch 1 composite train-obj: 3.922192
            Val objective improved inf → 3.3198, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 50.7576, mae: 3.6761, huber: 3.2329, swd: 24.9211, ept: 321.0505
    Epoch [2/50], Val Losses: mse: 31.8584, mae: 4.1294, huber: 3.6678, swd: 13.6300, ept: 245.2600
    Epoch [2/50], Test Losses: mse: 20.9020, mae: 2.9708, huber: 2.5368, swd: 7.9416, ept: 319.4757
      Epoch 2 composite train-obj: 3.232948
            No improvement (3.6678), counter 1/5
    Epoch [3/50], Train Losses: mse: 41.6114, mae: 3.2417, huber: 2.8034, swd: 19.1611, ept: 345.1196
    Epoch [3/50], Val Losses: mse: 33.1338, mae: 4.1278, huber: 3.6667, swd: 12.3384, ept: 243.3418
    Epoch [3/50], Test Losses: mse: 21.3568, mae: 2.9512, huber: 2.5179, swd: 7.8346, ept: 313.6639
      Epoch 3 composite train-obj: 2.803373
            No improvement (3.6667), counter 2/5
    Epoch [4/50], Train Losses: mse: 36.4111, mae: 2.9765, huber: 2.5430, swd: 16.1927, ept: 358.3031
    Epoch [4/50], Val Losses: mse: 32.6772, mae: 4.1702, huber: 3.7076, swd: 12.4895, ept: 241.1061
    Epoch [4/50], Test Losses: mse: 23.5498, mae: 3.1619, huber: 2.7248, swd: 9.3633, ept: 305.3222
      Epoch 4 composite train-obj: 2.542989
            No improvement (3.7076), counter 3/5
    Epoch [5/50], Train Losses: mse: 33.7810, mae: 2.7872, huber: 2.3586, swd: 15.0294, ept: 377.5452
    Epoch [5/50], Val Losses: mse: 35.7755, mae: 4.2994, huber: 3.8364, swd: 12.2619, ept: 227.7437
    Epoch [5/50], Test Losses: mse: 25.4080, mae: 3.2816, huber: 2.8397, swd: 9.9087, ept: 300.7723
      Epoch 5 composite train-obj: 2.358573
            No improvement (3.8364), counter 4/5
    Epoch [6/50], Train Losses: mse: 28.9634, mae: 2.5811, huber: 2.1551, swd: 12.9983, ept: 394.5699
    Epoch [6/50], Val Losses: mse: 38.4175, mae: 4.4463, huber: 3.9817, swd: 13.9272, ept: 230.1026
    Epoch [6/50], Test Losses: mse: 26.2861, mae: 3.3510, huber: 2.9079, swd: 10.3341, ept: 300.9211
      Epoch 6 composite train-obj: 2.155072
    Epoch [6/50], Test Losses: mse: 20.4436, mae: 2.8953, huber: 2.4664, swd: 8.0159, ept: 319.5890
    Best round's Test MSE: 20.4436, MAE: 2.8953, SWD: 8.0159
    Best round's Validation MSE: 27.4636, MAE: 3.7715, SWD: 9.4013
    Best round's Test verification MSE : 20.4436, MAE: 2.8953, SWD: 8.0159
    Time taken: 74.25 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 68.2278, mae: 4.5372, huber: 4.0877, swd: 31.6537, ept: 248.7906
    Epoch [1/50], Val Losses: mse: 33.5205, mae: 4.0791, huber: 3.6229, swd: 12.4085, ept: 243.7817
    Epoch [1/50], Test Losses: mse: 22.2542, mae: 3.0356, huber: 2.6045, swd: 8.6685, ept: 309.0555
      Epoch 1 composite train-obj: 4.087731
            Val objective improved inf → 3.6229, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 48.8027, mae: 3.6431, huber: 3.2003, swd: 21.8225, ept: 318.6535
    Epoch [2/50], Val Losses: mse: 41.4606, mae: 4.5459, huber: 4.0862, swd: 18.8742, ept: 251.6144
    Epoch [2/50], Test Losses: mse: 23.8649, mae: 3.1925, huber: 2.7557, swd: 9.6355, ept: 314.8486
      Epoch 2 composite train-obj: 3.200320
            No improvement (4.0862), counter 1/5
    Epoch [3/50], Train Losses: mse: 40.5367, mae: 3.1900, huber: 2.7529, swd: 17.2750, ept: 348.4570
    Epoch [3/50], Val Losses: mse: 36.4184, mae: 4.2931, huber: 3.8329, swd: 13.3584, ept: 237.8170
    Epoch [3/50], Test Losses: mse: 24.3166, mae: 3.1563, huber: 2.7227, swd: 9.4242, ept: 318.1962
      Epoch 3 composite train-obj: 2.752943
            No improvement (3.8329), counter 2/5
    Epoch [4/50], Train Losses: mse: 34.6846, mae: 2.8954, huber: 2.4632, swd: 14.4362, ept: 372.5270
    Epoch [4/50], Val Losses: mse: 40.6970, mae: 4.3564, huber: 3.8959, swd: 14.7556, ept: 234.0912
    Epoch [4/50], Test Losses: mse: 27.9649, mae: 3.2836, huber: 2.8483, swd: 11.8684, ept: 312.4019
      Epoch 4 composite train-obj: 2.463197
            No improvement (3.8959), counter 3/5
    Epoch [5/50], Train Losses: mse: 29.7892, mae: 2.6734, huber: 2.2445, swd: 12.1829, ept: 388.8103
    Epoch [5/50], Val Losses: mse: 35.9817, mae: 4.2650, huber: 3.8011, swd: 10.9385, ept: 229.6695
    Epoch [5/50], Test Losses: mse: 26.1057, mae: 3.3394, huber: 2.9005, swd: 9.7189, ept: 301.1895
      Epoch 5 composite train-obj: 2.244535
            No improvement (3.8011), counter 4/5
    Epoch [6/50], Train Losses: mse: 28.2050, mae: 2.5312, huber: 2.1054, swd: 12.1690, ept: 399.6752
    Epoch [6/50], Val Losses: mse: 43.2586, mae: 4.5447, huber: 4.0784, swd: 12.0344, ept: 230.1467
    Epoch [6/50], Test Losses: mse: 26.1025, mae: 3.2891, huber: 2.8499, swd: 9.8830, ept: 303.5578
      Epoch 6 composite train-obj: 2.105425
    Epoch [6/50], Test Losses: mse: 22.2542, mae: 3.0356, huber: 2.6045, swd: 8.6685, ept: 309.0555
    Best round's Test MSE: 22.2542, MAE: 3.0356, SWD: 8.6685
    Best round's Validation MSE: 33.5205, MAE: 4.0791, SWD: 12.4085
    Best round's Test verification MSE : 22.2542, MAE: 3.0356, SWD: 8.6685
    Time taken: 74.89 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 64.9214, mae: 4.4267, huber: 3.9782, swd: 36.3853, ept: 272.9684
    Epoch [1/50], Val Losses: mse: 28.4400, mae: 3.8729, huber: 3.4110, swd: 10.7949, ept: 220.6946
    Epoch [1/50], Test Losses: mse: 23.2673, mae: 3.1562, huber: 2.7201, swd: 11.3660, ept: 312.0386
      Epoch 1 composite train-obj: 3.978240
            Val objective improved inf → 3.4110, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 51.6505, mae: 3.7707, huber: 3.3271, swd: 27.1950, ept: 318.2616
    Epoch [2/50], Val Losses: mse: 31.4035, mae: 4.0956, huber: 3.6292, swd: 12.9494, ept: 232.0609
    Epoch [2/50], Test Losses: mse: 21.0993, mae: 3.0059, huber: 2.5690, swd: 9.1248, ept: 312.5621
      Epoch 2 composite train-obj: 3.327116
            No improvement (3.6292), counter 1/5
    Epoch [3/50], Train Losses: mse: 44.1763, mae: 3.3856, huber: 2.9459, swd: 21.6785, ept: 337.2885
    Epoch [3/50], Val Losses: mse: 33.9837, mae: 4.2169, huber: 3.7475, swd: 13.5032, ept: 223.3963
    Epoch [3/50], Test Losses: mse: 22.2778, mae: 3.0262, huber: 2.5915, swd: 9.0536, ept: 313.9055
      Epoch 3 composite train-obj: 2.945876
            No improvement (3.7475), counter 2/5
    Epoch [4/50], Train Losses: mse: 41.4156, mae: 3.2294, huber: 2.7923, swd: 20.4051, ept: 349.0902
    Epoch [4/50], Val Losses: mse: 35.4819, mae: 4.3093, huber: 3.8410, swd: 14.1997, ept: 232.1294
    Epoch [4/50], Test Losses: mse: 25.1136, mae: 3.2551, huber: 2.8151, swd: 11.2688, ept: 313.8899
      Epoch 4 composite train-obj: 2.792324
            No improvement (3.8410), counter 3/5
    Epoch [5/50], Train Losses: mse: 38.9344, mae: 3.0698, huber: 2.6361, swd: 19.1065, ept: 359.9192
    Epoch [5/50], Val Losses: mse: 36.8622, mae: 4.3110, huber: 3.8452, swd: 14.6421, ept: 246.8392
    Epoch [5/50], Test Losses: mse: 26.9304, mae: 3.3250, huber: 2.8842, swd: 12.6578, ept: 312.7302
      Epoch 5 composite train-obj: 2.636128
            No improvement (3.8452), counter 4/5
    Epoch [6/50], Train Losses: mse: 32.1541, mae: 2.7919, huber: 2.3615, swd: 14.9526, ept: 376.5144
    Epoch [6/50], Val Losses: mse: 33.0372, mae: 4.0945, huber: 3.6278, swd: 9.7298, ept: 230.2440
    Epoch [6/50], Test Losses: mse: 26.9654, mae: 3.2754, huber: 2.8377, swd: 11.7062, ept: 303.9649
      Epoch 6 composite train-obj: 2.361538
    Epoch [6/50], Test Losses: mse: 23.2673, mae: 3.1562, huber: 2.7201, swd: 11.3660, ept: 312.0386
    Best round's Test MSE: 23.2673, MAE: 3.1562, SWD: 11.3660
    Best round's Validation MSE: 28.4400, MAE: 3.8729, SWD: 10.7949
    Best round's Test verification MSE : 23.2673, MAE: 3.1562, SWD: 11.3660
    Time taken: 73.99 seconds
    
    ==================================================
    Experiment Summary (TimeMixer_etth2_seq720_pred720_20250510_2237)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 21.9884 ± 1.1680
      mae: 3.0291 ± 0.1066
      huber: 2.5970 ± 0.1037
      swd: 9.3501 ± 1.4501
      ept: 313.5610 ± 4.4330
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 29.8080 ± 2.6552
      mae: 3.9078 ± 0.1280
      huber: 3.4512 ± 0.1270
      swd: 10.8682 ± 1.2288
      ept: 241.0552 ± 15.6307
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 223.27 seconds
    
    Experiment complete: TimeMixer_etth2_seq720_pred720_20250510_2237
    Model: TimeMixer
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### PatchTST

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5204, mae: 0.4412, huber: 0.1915, swd: 0.1756, ept: 55.3103
    Epoch [1/50], Val Losses: mse: 0.2511, mae: 0.3574, huber: 0.1206, swd: 0.0861, ept: 65.3657
    Epoch [1/50], Test Losses: mse: 0.1618, mae: 0.2845, huber: 0.0793, swd: 0.0492, ept: 75.2418
      Epoch 1 composite train-obj: 0.191453
            Val objective improved inf → 0.1206, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3203, mae: 0.3430, huber: 0.1242, swd: 0.1146, ept: 69.8024
    Epoch [2/50], Val Losses: mse: 0.2462, mae: 0.3524, huber: 0.1188, swd: 0.1005, ept: 69.5125
    Epoch [2/50], Test Losses: mse: 0.1667, mae: 0.2936, huber: 0.0820, swd: 0.0506, ept: 77.8363
      Epoch 2 composite train-obj: 0.124246
            Val objective improved 0.1206 → 0.1188, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2839, mae: 0.3250, huber: 0.1120, swd: 0.1034, ept: 71.7415
    Epoch [3/50], Val Losses: mse: 0.2493, mae: 0.3534, huber: 0.1199, swd: 0.1039, ept: 70.1637
    Epoch [3/50], Test Losses: mse: 0.1629, mae: 0.2883, huber: 0.0801, swd: 0.0534, ept: 77.9191
      Epoch 3 composite train-obj: 0.112023
            No improvement (0.1199), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2628, mae: 0.3147, huber: 0.1052, swd: 0.0936, ept: 72.5532
    Epoch [4/50], Val Losses: mse: 0.2469, mae: 0.3539, huber: 0.1191, swd: 0.1026, ept: 69.6071
    Epoch [4/50], Test Losses: mse: 0.1758, mae: 0.3019, huber: 0.0863, swd: 0.0581, ept: 77.0998
      Epoch 4 composite train-obj: 0.105219
            No improvement (0.1191), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.2408, mae: 0.3030, huber: 0.0976, swd: 0.0824, ept: 73.4505
    Epoch [5/50], Val Losses: mse: 0.2571, mae: 0.3635, huber: 0.1236, swd: 0.1115, ept: 68.8661
    Epoch [5/50], Test Losses: mse: 0.1785, mae: 0.3011, huber: 0.0871, swd: 0.0626, ept: 76.6032
      Epoch 5 composite train-obj: 0.097627
            No improvement (0.1236), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.2269, mae: 0.2951, huber: 0.0925, swd: 0.0759, ept: 74.0043
    Epoch [6/50], Val Losses: mse: 0.2607, mae: 0.3645, huber: 0.1248, swd: 0.1117, ept: 68.6726
    Epoch [6/50], Test Losses: mse: 0.1780, mae: 0.3032, huber: 0.0871, swd: 0.0614, ept: 76.0427
      Epoch 6 composite train-obj: 0.092545
            No improvement (0.1248), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.2159, mae: 0.2883, huber: 0.0883, swd: 0.0716, ept: 74.5744
    Epoch [7/50], Val Losses: mse: 0.2579, mae: 0.3625, huber: 0.1234, swd: 0.1055, ept: 67.9948
    Epoch [7/50], Test Losses: mse: 0.1879, mae: 0.3145, huber: 0.0920, swd: 0.0658, ept: 76.0782
      Epoch 7 composite train-obj: 0.088254
    Epoch [7/50], Test Losses: mse: 0.1667, mae: 0.2936, huber: 0.0820, swd: 0.0506, ept: 77.8363
    Best round's Test MSE: 0.1667, MAE: 0.2936, SWD: 0.0506
    Best round's Validation MSE: 0.2462, MAE: 0.3524, SWD: 0.1005
    Best round's Test verification MSE : 0.1667, MAE: 0.2936, SWD: 0.0506
    Time taken: 59.98 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5431, mae: 0.4494, huber: 0.1970, swd: 0.1803, ept: 53.9885
    Epoch [1/50], Val Losses: mse: 0.2285, mae: 0.3403, huber: 0.1107, swd: 0.0782, ept: 67.3669
    Epoch [1/50], Test Losses: mse: 0.1517, mae: 0.2764, huber: 0.0747, swd: 0.0446, ept: 77.2313
      Epoch 1 composite train-obj: 0.197034
            Val objective improved inf → 0.1107, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3315, mae: 0.3501, huber: 0.1287, swd: 0.1143, ept: 68.9501
    Epoch [2/50], Val Losses: mse: 0.2426, mae: 0.3482, huber: 0.1160, swd: 0.0922, ept: 69.7491
    Epoch [2/50], Test Losses: mse: 0.1598, mae: 0.2828, huber: 0.0782, swd: 0.0482, ept: 76.4121
      Epoch 2 composite train-obj: 0.128660
            No improvement (0.1160), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2897, mae: 0.3269, huber: 0.1133, swd: 0.1070, ept: 72.0841
    Epoch [3/50], Val Losses: mse: 0.2336, mae: 0.3459, huber: 0.1129, swd: 0.0982, ept: 71.4112
    Epoch [3/50], Test Losses: mse: 0.1606, mae: 0.2890, huber: 0.0790, swd: 0.0509, ept: 78.2262
      Epoch 3 composite train-obj: 0.113292
            No improvement (0.1129), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.2604, mae: 0.3134, huber: 0.1042, swd: 0.0921, ept: 72.7988
    Epoch [4/50], Val Losses: mse: 0.2491, mae: 0.3577, huber: 0.1202, swd: 0.0973, ept: 69.4682
    Epoch [4/50], Test Losses: mse: 0.1726, mae: 0.3029, huber: 0.0847, swd: 0.0528, ept: 77.2237
      Epoch 4 composite train-obj: 0.104182
            No improvement (0.1202), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2418, mae: 0.3034, huber: 0.0977, swd: 0.0835, ept: 73.4529
    Epoch [5/50], Val Losses: mse: 0.2334, mae: 0.3458, huber: 0.1128, swd: 0.0965, ept: 70.5262
    Epoch [5/50], Test Losses: mse: 0.1657, mae: 0.2954, huber: 0.0815, swd: 0.0549, ept: 78.1440
      Epoch 5 composite train-obj: 0.097722
            No improvement (0.1128), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.2249, mae: 0.2939, huber: 0.0917, swd: 0.0745, ept: 74.0320
    Epoch [6/50], Val Losses: mse: 0.2756, mae: 0.3746, huber: 0.1315, swd: 0.1160, ept: 67.5840
    Epoch [6/50], Test Losses: mse: 0.1815, mae: 0.3061, huber: 0.0887, swd: 0.0640, ept: 76.3623
      Epoch 6 composite train-obj: 0.091688
    Epoch [6/50], Test Losses: mse: 0.1517, mae: 0.2764, huber: 0.0747, swd: 0.0446, ept: 77.2313
    Best round's Test MSE: 0.1517, MAE: 0.2764, SWD: 0.0446
    Best round's Validation MSE: 0.2285, MAE: 0.3403, SWD: 0.0782
    Best round's Test verification MSE : 0.1517, MAE: 0.2764, SWD: 0.0446
    Time taken: 51.32 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.5343, mae: 0.4439, huber: 0.1934, swd: 0.1736, ept: 54.9512
    Epoch [1/50], Val Losses: mse: 0.2488, mae: 0.3552, huber: 0.1196, swd: 0.0665, ept: 65.0091
    Epoch [1/50], Test Losses: mse: 0.1731, mae: 0.2927, huber: 0.0844, swd: 0.0477, ept: 73.9487
      Epoch 1 composite train-obj: 0.193415
            Val objective improved inf → 0.1196, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3217, mae: 0.3445, huber: 0.1248, swd: 0.1061, ept: 69.8411
    Epoch [2/50], Val Losses: mse: 0.2439, mae: 0.3590, huber: 0.1183, swd: 0.0902, ept: 68.6183
    Epoch [2/50], Test Losses: mse: 0.1685, mae: 0.2990, huber: 0.0829, swd: 0.0475, ept: 78.3168
      Epoch 2 composite train-obj: 0.124834
            Val objective improved 0.1196 → 0.1183, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2843, mae: 0.3253, huber: 0.1117, swd: 0.0986, ept: 72.1948
    Epoch [3/50], Val Losses: mse: 0.2427, mae: 0.3525, huber: 0.1173, swd: 0.0894, ept: 70.2029
    Epoch [3/50], Test Losses: mse: 0.1756, mae: 0.3048, huber: 0.0864, swd: 0.0509, ept: 77.3197
      Epoch 3 composite train-obj: 0.111714
            Val objective improved 0.1183 → 0.1173, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2581, mae: 0.3118, huber: 0.1030, swd: 0.0860, ept: 73.0435
    Epoch [4/50], Val Losses: mse: 0.2489, mae: 0.3546, huber: 0.1197, swd: 0.0957, ept: 70.1400
    Epoch [4/50], Test Losses: mse: 0.1735, mae: 0.3035, huber: 0.0854, swd: 0.0493, ept: 77.9196
      Epoch 4 composite train-obj: 0.103027
            No improvement (0.1197), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2396, mae: 0.3033, huber: 0.0972, swd: 0.0763, ept: 73.4253
    Epoch [5/50], Val Losses: mse: 0.2783, mae: 0.3775, huber: 0.1318, swd: 0.1068, ept: 67.5160
    Epoch [5/50], Test Losses: mse: 0.1700, mae: 0.2974, huber: 0.0832, swd: 0.0515, ept: 77.6462
      Epoch 5 composite train-obj: 0.097156
            No improvement (0.1318), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.2256, mae: 0.2944, huber: 0.0919, swd: 0.0702, ept: 74.0876
    Epoch [6/50], Val Losses: mse: 0.2692, mae: 0.3685, huber: 0.1271, swd: 0.0959, ept: 68.8755
    Epoch [6/50], Test Losses: mse: 0.1698, mae: 0.2991, huber: 0.0834, swd: 0.0502, ept: 77.6127
      Epoch 6 composite train-obj: 0.091905
            No improvement (0.1271), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.2129, mae: 0.2867, huber: 0.0872, swd: 0.0649, ept: 74.4263
    Epoch [7/50], Val Losses: mse: 0.2698, mae: 0.3743, huber: 0.1281, swd: 0.0977, ept: 67.9653
    Epoch [7/50], Test Losses: mse: 0.1703, mae: 0.2993, huber: 0.0836, swd: 0.0497, ept: 77.0274
      Epoch 7 composite train-obj: 0.087192
            No improvement (0.1281), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.2059, mae: 0.2814, huber: 0.0843, swd: 0.0622, ept: 74.6801
    Epoch [8/50], Val Losses: mse: 0.2752, mae: 0.3733, huber: 0.1300, swd: 0.0950, ept: 68.8594
    Epoch [8/50], Test Losses: mse: 0.1750, mae: 0.3044, huber: 0.0858, swd: 0.0495, ept: 77.7429
      Epoch 8 composite train-obj: 0.084313
    Epoch [8/50], Test Losses: mse: 0.1756, mae: 0.3048, huber: 0.0864, swd: 0.0509, ept: 77.3197
    Best round's Test MSE: 0.1756, MAE: 0.3048, SWD: 0.0509
    Best round's Validation MSE: 0.2427, MAE: 0.3525, SWD: 0.0894
    Best round's Test verification MSE : 0.1756, MAE: 0.3048, SWD: 0.0509
    Time taken: 69.19 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred96_20250510_2204)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1647 ± 0.0098
      mae: 0.2916 ± 0.0117
      huber: 0.0810 ± 0.0048
      swd: 0.0487 ± 0.0029
      ept: 77.4624 ± 0.2668
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2391 ± 0.0077
      mae: 0.3484 ± 0.0057
      huber: 0.1156 ± 0.0035
      swd: 0.0894 ± 0.0091
      ept: 69.0274 ± 1.2075
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 180.57 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred96_20250510_2204
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 43.1953, mae: 3.7046, huber: 3.2650, swd: 17.3908, ept: 55.1162
    Epoch [1/50], Val Losses: mse: 18.1634, mae: 2.9054, huber: 2.4642, swd: 7.2652, ept: 64.3888
    Epoch [1/50], Test Losses: mse: 14.5870, mae: 2.4711, huber: 2.0474, swd: 7.0627, ept: 74.5499
      Epoch 1 composite train-obj: 3.265001
            Val objective improved inf → 2.4642, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 26.3151, mae: 2.8937, huber: 2.4645, swd: 11.7720, ept: 68.4751
    Epoch [2/50], Val Losses: mse: 18.7583, mae: 2.9179, huber: 2.4828, swd: 8.5337, ept: 68.1807
    Epoch [2/50], Test Losses: mse: 14.1524, mae: 2.4334, huber: 2.0091, swd: 6.7864, ept: 76.2350
      Epoch 2 composite train-obj: 2.464495
            No improvement (2.4828), counter 1/5
    Epoch [3/50], Train Losses: mse: 23.1447, mae: 2.6951, huber: 2.2679, swd: 9.9451, ept: 71.1894
    Epoch [3/50], Val Losses: mse: 17.2171, mae: 2.8472, huber: 2.4096, swd: 7.4464, ept: 70.3203
    Epoch [3/50], Test Losses: mse: 13.8512, mae: 2.4301, huber: 2.0024, swd: 6.8392, ept: 77.4375
      Epoch 3 composite train-obj: 2.267922
            Val objective improved 2.4642 → 2.4096, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 21.0977, mae: 2.5659, huber: 2.1397, swd: 8.6388, ept: 72.4551
    Epoch [4/50], Val Losses: mse: 18.7145, mae: 2.9391, huber: 2.4976, swd: 8.8724, ept: 69.3464
    Epoch [4/50], Test Losses: mse: 14.0241, mae: 2.4654, huber: 2.0348, swd: 7.0610, ept: 77.2820
      Epoch 4 composite train-obj: 2.139746
            No improvement (2.4976), counter 1/5
    Epoch [5/50], Train Losses: mse: 19.7198, mae: 2.4742, huber: 2.0492, swd: 7.6757, ept: 73.2412
    Epoch [5/50], Val Losses: mse: 19.2110, mae: 2.9933, huber: 2.5486, swd: 9.0650, ept: 68.6676
    Epoch [5/50], Test Losses: mse: 13.7796, mae: 2.4148, huber: 1.9885, swd: 6.9742, ept: 77.9616
      Epoch 5 composite train-obj: 2.049177
            No improvement (2.5486), counter 2/5
    Epoch [6/50], Train Losses: mse: 18.8860, mae: 2.4123, huber: 1.9883, swd: 7.1766, ept: 73.6460
    Epoch [6/50], Val Losses: mse: 18.4956, mae: 2.9255, huber: 2.4840, swd: 8.4064, ept: 69.1758
    Epoch [6/50], Test Losses: mse: 14.1786, mae: 2.4398, huber: 2.0130, swd: 7.1877, ept: 77.4212
      Epoch 6 composite train-obj: 1.988339
            No improvement (2.4840), counter 3/5
    Epoch [7/50], Train Losses: mse: 18.1484, mae: 2.3613, huber: 1.9382, swd: 6.7291, ept: 74.1735
    Epoch [7/50], Val Losses: mse: 16.9776, mae: 2.8203, huber: 2.3789, swd: 7.4054, ept: 70.9170
    Epoch [7/50], Test Losses: mse: 14.5492, mae: 2.5009, huber: 2.0701, swd: 7.6652, ept: 77.7134
      Epoch 7 composite train-obj: 1.938207
            Val objective improved 2.4096 → 2.3789, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 17.4829, mae: 2.3049, huber: 1.8830, swd: 6.3413, ept: 74.4823
    Epoch [8/50], Val Losses: mse: 17.3584, mae: 2.8731, huber: 2.4268, swd: 7.7162, ept: 70.1542
    Epoch [8/50], Test Losses: mse: 14.0190, mae: 2.4574, huber: 2.0282, swd: 7.2758, ept: 78.3942
      Epoch 8 composite train-obj: 1.882953
            No improvement (2.4268), counter 1/5
    Epoch [9/50], Train Losses: mse: 17.0171, mae: 2.2698, huber: 1.8484, swd: 6.0881, ept: 74.7987
    Epoch [9/50], Val Losses: mse: 18.0083, mae: 2.8979, huber: 2.4543, swd: 7.9695, ept: 69.2910
    Epoch [9/50], Test Losses: mse: 14.7384, mae: 2.5160, huber: 2.0841, swd: 7.6109, ept: 77.3586
      Epoch 9 composite train-obj: 1.848387
            No improvement (2.4543), counter 2/5
    Epoch [10/50], Train Losses: mse: 16.4455, mae: 2.2223, huber: 1.8020, swd: 5.6787, ept: 74.9202
    Epoch [10/50], Val Losses: mse: 18.2254, mae: 2.9159, huber: 2.4714, swd: 8.0765, ept: 69.6754
    Epoch [10/50], Test Losses: mse: 14.9364, mae: 2.5262, huber: 2.0941, swd: 7.7429, ept: 76.9109
      Epoch 10 composite train-obj: 1.801998
            No improvement (2.4714), counter 3/5
    Epoch [11/50], Train Losses: mse: 15.9834, mae: 2.1878, huber: 1.7681, swd: 5.3791, ept: 75.0764
    Epoch [11/50], Val Losses: mse: 17.0938, mae: 2.8284, huber: 2.3865, swd: 7.5118, ept: 70.2667
    Epoch [11/50], Test Losses: mse: 14.6377, mae: 2.5011, huber: 2.0709, swd: 7.7311, ept: 77.8295
      Epoch 11 composite train-obj: 1.768137
            No improvement (2.3865), counter 4/5
    Epoch [12/50], Train Losses: mse: 15.4880, mae: 2.1622, huber: 1.7428, swd: 5.0435, ept: 75.2783
    Epoch [12/50], Val Losses: mse: 17.8331, mae: 2.8799, huber: 2.4378, swd: 7.7498, ept: 69.4469
    Epoch [12/50], Test Losses: mse: 15.2179, mae: 2.5316, huber: 2.1009, swd: 8.1388, ept: 77.0272
      Epoch 12 composite train-obj: 1.742819
    Epoch [12/50], Test Losses: mse: 14.5492, mae: 2.5009, huber: 2.0701, swd: 7.6652, ept: 77.7134
    Best round's Test MSE: 14.5492, MAE: 2.5009, SWD: 7.6652
    Best round's Validation MSE: 16.9776, MAE: 2.8203, SWD: 7.4054
    Best round's Test verification MSE : 14.5492, MAE: 2.5009, SWD: 7.6652
    Time taken: 102.77 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 44.3692, mae: 3.7507, huber: 3.3105, swd: 17.0858, ept: 54.5293
    Epoch [1/50], Val Losses: mse: 17.3373, mae: 2.8444, huber: 2.4043, swd: 6.4016, ept: 64.5045
    Epoch [1/50], Test Losses: mse: 13.9770, mae: 2.4105, huber: 1.9891, swd: 6.2995, ept: 75.1840
      Epoch 1 composite train-obj: 3.310506
            Val objective improved inf → 2.4043, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 27.2233, mae: 2.9436, huber: 2.5134, swd: 11.8189, ept: 68.0700
    Epoch [2/50], Val Losses: mse: 17.2861, mae: 2.8533, huber: 2.4113, swd: 6.8719, ept: 68.5059
    Epoch [2/50], Test Losses: mse: 13.4863, mae: 2.3865, huber: 1.9620, swd: 6.1062, ept: 77.3191
      Epoch 2 composite train-obj: 2.513438
            No improvement (2.4113), counter 1/5
    Epoch [3/50], Train Losses: mse: 23.8667, mae: 2.7193, huber: 2.2906, swd: 10.3799, ept: 71.6828
    Epoch [3/50], Val Losses: mse: 17.2555, mae: 2.8456, huber: 2.4055, swd: 7.2186, ept: 71.3394
    Epoch [3/50], Test Losses: mse: 13.4097, mae: 2.3961, huber: 1.9696, swd: 6.3837, ept: 78.4796
      Epoch 3 composite train-obj: 2.290601
            No improvement (2.4055), counter 2/5
    Epoch [4/50], Train Losses: mse: 21.8661, mae: 2.5858, huber: 2.1590, swd: 9.1305, ept: 72.7436
    Epoch [4/50], Val Losses: mse: 19.5781, mae: 2.9894, huber: 2.5502, swd: 8.9825, ept: 68.8397
    Epoch [4/50], Test Losses: mse: 14.0860, mae: 2.5064, huber: 2.0729, swd: 6.8495, ept: 78.1612
      Epoch 4 composite train-obj: 2.158993
            No improvement (2.5502), counter 3/5
    Epoch [5/50], Train Losses: mse: 20.5987, mae: 2.4990, huber: 2.0735, swd: 8.3950, ept: 73.4718
    Epoch [5/50], Val Losses: mse: 17.7933, mae: 2.8938, huber: 2.4477, swd: 7.5854, ept: 70.4768
    Epoch [5/50], Test Losses: mse: 13.4621, mae: 2.4115, huber: 1.9812, swd: 6.2460, ept: 78.2998
      Epoch 5 composite train-obj: 2.073512
            No improvement (2.4477), counter 4/5
    Epoch [6/50], Train Losses: mse: 19.1819, mae: 2.4106, huber: 1.9863, swd: 7.4077, ept: 74.0368
    Epoch [6/50], Val Losses: mse: 19.4807, mae: 3.0375, huber: 2.5922, swd: 8.7286, ept: 68.7457
    Epoch [6/50], Test Losses: mse: 15.0162, mae: 2.5649, huber: 2.1285, swd: 7.3939, ept: 76.8344
      Epoch 6 composite train-obj: 1.986323
    Epoch [6/50], Test Losses: mse: 13.9770, mae: 2.4105, huber: 1.9891, swd: 6.2995, ept: 75.1840
    Best round's Test MSE: 13.9770, MAE: 2.4105, SWD: 6.2995
    Best round's Validation MSE: 17.3373, MAE: 2.8444, SWD: 6.4016
    Best round's Test verification MSE : 13.9770, MAE: 2.4105, SWD: 6.2995
    Time taken: 51.57 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 43.5835, mae: 3.7132, huber: 3.2735, swd: 16.0980, ept: 55.0579
    Epoch [1/50], Val Losses: mse: 17.1013, mae: 2.7888, huber: 2.3518, swd: 6.3471, ept: 67.6030
    Epoch [1/50], Test Losses: mse: 14.0667, mae: 2.3840, huber: 1.9646, swd: 6.2304, ept: 76.6168
      Epoch 1 composite train-obj: 3.273457
            Val objective improved inf → 2.3518, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 26.8936, mae: 2.9279, huber: 2.4982, swd: 10.7598, ept: 68.3336
    Epoch [2/50], Val Losses: mse: 19.2667, mae: 2.9838, huber: 2.5434, swd: 8.1863, ept: 66.4297
    Epoch [2/50], Test Losses: mse: 14.7142, mae: 2.4984, huber: 2.0736, swd: 6.8146, ept: 76.5867
      Epoch 2 composite train-obj: 2.498151
            No improvement (2.5434), counter 1/5
    Epoch [3/50], Train Losses: mse: 23.6146, mae: 2.7192, huber: 2.2901, swd: 9.3944, ept: 71.3803
    Epoch [3/50], Val Losses: mse: 17.0813, mae: 2.8474, huber: 2.4058, swd: 6.4797, ept: 70.3044
    Epoch [3/50], Test Losses: mse: 13.6231, mae: 2.4057, huber: 1.9801, swd: 5.9501, ept: 77.7249
      Epoch 3 composite train-obj: 2.290078
            No improvement (2.4058), counter 2/5
    Epoch [4/50], Train Losses: mse: 20.6477, mae: 2.5449, huber: 2.1185, swd: 7.5123, ept: 72.9203
    Epoch [4/50], Val Losses: mse: 17.8706, mae: 2.8851, huber: 2.4445, swd: 7.3598, ept: 70.8424
    Epoch [4/50], Test Losses: mse: 13.9705, mae: 2.4699, huber: 2.0403, swd: 6.3690, ept: 78.1276
      Epoch 4 composite train-obj: 2.118528
            No improvement (2.4445), counter 3/5
    Epoch [5/50], Train Losses: mse: 19.1341, mae: 2.4450, huber: 2.0201, swd: 6.6124, ept: 73.5666
    Epoch [5/50], Val Losses: mse: 18.0124, mae: 2.9025, huber: 2.4604, swd: 7.3518, ept: 70.4356
    Epoch [5/50], Test Losses: mse: 14.2580, mae: 2.4973, huber: 2.0657, swd: 6.4718, ept: 77.2708
      Epoch 5 composite train-obj: 2.020076
            No improvement (2.4604), counter 4/5
    Epoch [6/50], Train Losses: mse: 18.1727, mae: 2.3648, huber: 1.9414, swd: 6.0520, ept: 74.1675
    Epoch [6/50], Val Losses: mse: 20.0515, mae: 3.0414, huber: 2.5959, swd: 8.9364, ept: 69.3177
    Epoch [6/50], Test Losses: mse: 14.0149, mae: 2.4807, huber: 2.0507, swd: 6.4393, ept: 78.3500
      Epoch 6 composite train-obj: 1.941436
    Epoch [6/50], Test Losses: mse: 14.0667, mae: 2.3840, huber: 1.9646, swd: 6.2304, ept: 76.6168
    Best round's Test MSE: 14.0667, MAE: 2.3840, SWD: 6.2304
    Best round's Validation MSE: 17.1013, MAE: 2.7888, SWD: 6.3471
    Best round's Test verification MSE : 14.0667, MAE: 2.3840, SWD: 6.2304
    Time taken: 51.55 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred96_20250510_2240)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 14.1976 ± 0.2513
      mae: 2.4318 ± 0.0500
      huber: 2.0079 ± 0.0451
      swd: 6.7317 ± 0.6607
      ept: 76.5048 ± 1.0357
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 17.1387 ± 0.1492
      mae: 2.8178 ± 0.0228
      huber: 2.3783 ± 0.0215
      swd: 6.7180 ± 0.4865
      ept: 67.6748 ± 2.6184
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 205.97 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred96_20250510_2240
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6078, mae: 0.4781, huber: 0.2178, swd: 0.2055, ept: 89.0188
    Epoch [1/50], Val Losses: mse: 0.3287, mae: 0.4141, huber: 0.1554, swd: 0.1243, ept: 102.5393
    Epoch [1/50], Test Losses: mse: 0.1786, mae: 0.2975, huber: 0.0874, swd: 0.0560, ept: 131.1098
      Epoch 1 composite train-obj: 0.217757
            Val objective improved inf → 0.1554, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4127, mae: 0.3905, huber: 0.1554, swd: 0.1515, ept: 116.3946
    Epoch [2/50], Val Losses: mse: 0.3449, mae: 0.4236, huber: 0.1608, swd: 0.1413, ept: 107.8830
    Epoch [2/50], Test Losses: mse: 0.1828, mae: 0.3031, huber: 0.0893, swd: 0.0547, ept: 128.9445
      Epoch 2 composite train-obj: 0.155378
            No improvement (0.1608), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3576, mae: 0.3627, huber: 0.1357, swd: 0.1435, ept: 123.5588
    Epoch [3/50], Val Losses: mse: 0.3302, mae: 0.4173, huber: 0.1570, swd: 0.1332, ept: 110.8172
    Epoch [3/50], Test Losses: mse: 0.1906, mae: 0.3190, huber: 0.0935, swd: 0.0545, ept: 135.3483
      Epoch 3 composite train-obj: 0.135740
            No improvement (0.1570), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.3269, mae: 0.3464, huber: 0.1248, swd: 0.1334, ept: 126.5461
    Epoch [4/50], Val Losses: mse: 0.3292, mae: 0.4222, huber: 0.1567, swd: 0.1364, ept: 109.1773
    Epoch [4/50], Test Losses: mse: 0.1959, mae: 0.3269, huber: 0.0962, swd: 0.0556, ept: 131.6242
      Epoch 4 composite train-obj: 0.124798
            No improvement (0.1567), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.3067, mae: 0.3340, huber: 0.1173, swd: 0.1234, ept: 127.4295
    Epoch [5/50], Val Losses: mse: 0.3511, mae: 0.4291, huber: 0.1654, swd: 0.1445, ept: 107.5167
    Epoch [5/50], Test Losses: mse: 0.2014, mae: 0.3296, huber: 0.0987, swd: 0.0552, ept: 130.4748
      Epoch 5 composite train-obj: 0.117297
            No improvement (0.1654), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.2921, mae: 0.3277, huber: 0.1125, swd: 0.1156, ept: 128.3344
    Epoch [6/50], Val Losses: mse: 0.3465, mae: 0.4257, huber: 0.1638, swd: 0.1401, ept: 105.2172
    Epoch [6/50], Test Losses: mse: 0.2245, mae: 0.3489, huber: 0.1096, swd: 0.0658, ept: 129.4364
      Epoch 6 composite train-obj: 0.112544
    Epoch [6/50], Test Losses: mse: 0.1786, mae: 0.2975, huber: 0.0874, swd: 0.0560, ept: 131.1098
    Best round's Test MSE: 0.1786, MAE: 0.2975, SWD: 0.0560
    Best round's Validation MSE: 0.3287, MAE: 0.4141, SWD: 0.1243
    Best round's Test verification MSE : 0.1786, MAE: 0.2975, SWD: 0.0560
    Time taken: 52.19 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6011, mae: 0.4749, huber: 0.2157, swd: 0.2110, ept: 91.0930
    Epoch [1/50], Val Losses: mse: 0.3134, mae: 0.4078, huber: 0.1492, swd: 0.1061, ept: 103.3327
    Epoch [1/50], Test Losses: mse: 0.2083, mae: 0.3309, huber: 0.1016, swd: 0.0627, ept: 128.3001
      Epoch 1 composite train-obj: 0.215681
            Val objective improved inf → 0.1492, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3891, mae: 0.3777, huber: 0.1465, swd: 0.1540, ept: 119.7596
    Epoch [2/50], Val Losses: mse: 0.3222, mae: 0.4127, huber: 0.1532, swd: 0.1415, ept: 107.4922
    Epoch [2/50], Test Losses: mse: 0.1881, mae: 0.3145, huber: 0.0923, swd: 0.0569, ept: 133.8829
      Epoch 2 composite train-obj: 0.146454
            No improvement (0.1532), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.3426, mae: 0.3558, huber: 0.1306, swd: 0.1401, ept: 124.4942
    Epoch [3/50], Val Losses: mse: 0.3379, mae: 0.4226, huber: 0.1596, swd: 0.1439, ept: 102.0592
    Epoch [3/50], Test Losses: mse: 0.2072, mae: 0.3354, huber: 0.1013, swd: 0.0652, ept: 129.4284
      Epoch 3 composite train-obj: 0.130622
            No improvement (0.1596), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.3184, mae: 0.3424, huber: 0.1219, swd: 0.1306, ept: 126.2431
    Epoch [4/50], Val Losses: mse: 0.3765, mae: 0.4396, huber: 0.1746, swd: 0.1695, ept: 104.6943
    Epoch [4/50], Test Losses: mse: 0.1983, mae: 0.3224, huber: 0.0969, swd: 0.0629, ept: 131.0550
      Epoch 4 composite train-obj: 0.121899
            No improvement (0.1746), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.2969, mae: 0.3315, huber: 0.1147, swd: 0.1179, ept: 127.3253
    Epoch [5/50], Val Losses: mse: 0.3961, mae: 0.4507, huber: 0.1833, swd: 0.1680, ept: 105.6267
    Epoch [5/50], Test Losses: mse: 0.2191, mae: 0.3447, huber: 0.1069, swd: 0.0653, ept: 130.9089
      Epoch 5 composite train-obj: 0.114708
            No improvement (0.1833), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.2851, mae: 0.3257, huber: 0.1108, swd: 0.1115, ept: 128.0228
    Epoch [6/50], Val Losses: mse: 0.3686, mae: 0.4452, huber: 0.1735, swd: 0.1414, ept: 101.9891
    Epoch [6/50], Test Losses: mse: 0.2490, mae: 0.3724, huber: 0.1208, swd: 0.0766, ept: 120.6230
      Epoch 6 composite train-obj: 0.110828
    Epoch [6/50], Test Losses: mse: 0.2083, mae: 0.3309, huber: 0.1016, swd: 0.0627, ept: 128.3001
    Best round's Test MSE: 0.2083, MAE: 0.3309, SWD: 0.0627
    Best round's Validation MSE: 0.3134, MAE: 0.4078, SWD: 0.1061
    Best round's Test verification MSE : 0.2083, MAE: 0.3309, SWD: 0.0627
    Time taken: 51.89 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6084, mae: 0.4780, huber: 0.2177, swd: 0.1940, ept: 89.4034
    Epoch [1/50], Val Losses: mse: 0.3230, mae: 0.4074, huber: 0.1521, swd: 0.0917, ept: 100.9184
    Epoch [1/50], Test Losses: mse: 0.1913, mae: 0.3092, huber: 0.0933, swd: 0.0497, ept: 125.7329
      Epoch 1 composite train-obj: 0.217709
            Val objective improved inf → 0.1521, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4021, mae: 0.3868, huber: 0.1522, swd: 0.1365, ept: 116.8954
    Epoch [2/50], Val Losses: mse: 0.3081, mae: 0.4075, huber: 0.1461, swd: 0.1082, ept: 107.4355
    Epoch [2/50], Test Losses: mse: 0.1821, mae: 0.3058, huber: 0.0891, swd: 0.0555, ept: 132.3034
      Epoch 2 composite train-obj: 0.152239
            Val objective improved 0.1521 → 0.1461, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3524, mae: 0.3610, huber: 0.1342, swd: 0.1291, ept: 123.9297
    Epoch [3/50], Val Losses: mse: 0.3359, mae: 0.4234, huber: 0.1596, swd: 0.1250, ept: 105.6943
    Epoch [3/50], Test Losses: mse: 0.2041, mae: 0.3365, huber: 0.1001, swd: 0.0572, ept: 130.8439
      Epoch 3 composite train-obj: 0.134185
            No improvement (0.1596), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3301, mae: 0.3482, huber: 0.1261, swd: 0.1241, ept: 125.4307
    Epoch [4/50], Val Losses: mse: 0.3572, mae: 0.4355, huber: 0.1687, swd: 0.1322, ept: 106.6675
    Epoch [4/50], Test Losses: mse: 0.1960, mae: 0.3248, huber: 0.0962, swd: 0.0516, ept: 132.4599
      Epoch 4 composite train-obj: 0.126072
            No improvement (0.1687), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3061, mae: 0.3380, huber: 0.1187, swd: 0.1120, ept: 126.3451
    Epoch [5/50], Val Losses: mse: 0.3580, mae: 0.4407, huber: 0.1697, swd: 0.1349, ept: 107.7929
    Epoch [5/50], Test Losses: mse: 0.2234, mae: 0.3574, huber: 0.1097, swd: 0.0628, ept: 130.1379
      Epoch 5 composite train-obj: 0.118705
            No improvement (0.1697), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.2891, mae: 0.3276, huber: 0.1125, swd: 0.1030, ept: 127.9301
    Epoch [6/50], Val Losses: mse: 0.3420, mae: 0.4293, huber: 0.1626, swd: 0.1262, ept: 108.6365
    Epoch [6/50], Test Losses: mse: 0.2012, mae: 0.3327, huber: 0.0988, swd: 0.0525, ept: 132.0330
      Epoch 6 composite train-obj: 0.112471
            No improvement (0.1626), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.2771, mae: 0.3197, huber: 0.1079, swd: 0.0975, ept: 129.2215
    Epoch [7/50], Val Losses: mse: 0.3531, mae: 0.4341, huber: 0.1666, swd: 0.1270, ept: 109.1327
    Epoch [7/50], Test Losses: mse: 0.2019, mae: 0.3312, huber: 0.0991, swd: 0.0506, ept: 132.4558
      Epoch 7 composite train-obj: 0.107867
    Epoch [7/50], Test Losses: mse: 0.1821, mae: 0.3058, huber: 0.0891, swd: 0.0555, ept: 132.3034
    Best round's Test MSE: 0.1821, MAE: 0.3058, SWD: 0.0555
    Best round's Validation MSE: 0.3081, MAE: 0.4075, SWD: 0.1082
    Best round's Test verification MSE : 0.1821, MAE: 0.3058, SWD: 0.0555
    Time taken: 59.53 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred196_20250510_2207)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1896 ± 0.0132
      mae: 0.3114 ± 0.0142
      huber: 0.0927 ± 0.0064
      swd: 0.0581 ± 0.0033
      ept: 130.5711 ± 1.6781
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3167 ± 0.0087
      mae: 0.4098 ± 0.0031
      huber: 0.1503 ± 0.0039
      swd: 0.1129 ± 0.0081
      ept: 104.4358 ± 2.1457
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 163.70 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred196_20250510_2207
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 50.5483, mae: 4.0226, huber: 3.5791, swd: 20.3509, ept: 89.1103
    Epoch [1/50], Val Losses: mse: 25.2844, mae: 3.4714, huber: 3.0207, swd: 10.6516, ept: 96.8885
    Epoch [1/50], Test Losses: mse: 16.9368, mae: 2.6341, huber: 2.2107, swd: 7.1942, ept: 127.2311
      Epoch 1 composite train-obj: 3.579068
            Val objective improved inf → 3.0207, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 34.9065, mae: 3.3205, huber: 2.8851, swd: 15.5270, ept: 113.1769
    Epoch [2/50], Val Losses: mse: 25.4103, mae: 3.4508, huber: 3.0050, swd: 10.9350, ept: 99.4784
    Epoch [2/50], Test Losses: mse: 17.9608, mae: 2.7406, huber: 2.3124, swd: 7.6903, ept: 125.0255
      Epoch 2 composite train-obj: 2.885052
            Val objective improved 3.0207 → 3.0050, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 30.3125, mae: 3.0420, huber: 2.6080, swd: 13.1099, ept: 120.9975
    Epoch [3/50], Val Losses: mse: 24.4221, mae: 3.4222, huber: 2.9726, swd: 10.7628, ept: 104.4925
    Epoch [3/50], Test Losses: mse: 15.7334, mae: 2.5778, huber: 2.1483, swd: 6.2823, ept: 132.4468
      Epoch 3 composite train-obj: 2.608046
            Val objective improved 3.0050 → 2.9726, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 27.5681, mae: 2.8602, huber: 2.4280, swd: 11.4243, ept: 125.5791
    Epoch [4/50], Val Losses: mse: 24.4737, mae: 3.4969, huber: 3.0415, swd: 10.8433, ept: 101.8534
    Epoch [4/50], Test Losses: mse: 15.9962, mae: 2.6214, huber: 2.1871, swd: 6.5435, ept: 131.6478
      Epoch 4 composite train-obj: 2.428044
            No improvement (3.0415), counter 1/5
    Epoch [5/50], Train Losses: mse: 26.1278, mae: 2.7587, huber: 2.3281, swd: 10.6169, ept: 127.0768
    Epoch [5/50], Val Losses: mse: 25.1670, mae: 3.4786, huber: 3.0276, swd: 11.6935, ept: 106.3646
    Epoch [5/50], Test Losses: mse: 17.1400, mae: 2.7263, huber: 2.2904, swd: 7.6570, ept: 130.1522
      Epoch 5 composite train-obj: 2.328057
            No improvement (3.0276), counter 2/5
    Epoch [6/50], Train Losses: mse: 25.1833, mae: 2.6923, huber: 2.2624, swd: 10.1055, ept: 128.4008
    Epoch [6/50], Val Losses: mse: 23.9442, mae: 3.4333, huber: 2.9789, swd: 10.3736, ept: 108.4936
    Epoch [6/50], Test Losses: mse: 16.5577, mae: 2.7199, huber: 2.2812, swd: 7.1832, ept: 131.4497
      Epoch 6 composite train-obj: 2.262418
            No improvement (2.9789), counter 3/5
    Epoch [7/50], Train Losses: mse: 24.2129, mae: 2.6203, huber: 2.1915, swd: 9.5848, ept: 129.3070
    Epoch [7/50], Val Losses: mse: 24.7576, mae: 3.4825, huber: 3.0266, swd: 11.1932, ept: 109.2283
    Epoch [7/50], Test Losses: mse: 15.7315, mae: 2.6491, huber: 2.2116, swd: 6.7794, ept: 134.2934
      Epoch 7 composite train-obj: 2.191528
            No improvement (3.0266), counter 4/5
    Epoch [8/50], Train Losses: mse: 23.3898, mae: 2.5592, huber: 2.1317, swd: 9.1812, ept: 130.4207
    Epoch [8/50], Val Losses: mse: 24.7643, mae: 3.4849, huber: 3.0282, swd: 10.8872, ept: 105.1880
    Epoch [8/50], Test Losses: mse: 16.3435, mae: 2.6755, huber: 2.2397, swd: 7.0090, ept: 131.7922
      Epoch 8 composite train-obj: 2.131671
    Epoch [8/50], Test Losses: mse: 15.7334, mae: 2.5778, huber: 2.1483, swd: 6.2823, ept: 132.4468
    Best round's Test MSE: 15.7334, MAE: 2.5778, SWD: 6.2823
    Best round's Validation MSE: 24.4221, MAE: 3.4222, SWD: 10.7628
    Best round's Test verification MSE : 15.7334, MAE: 2.5778, SWD: 6.2823
    Time taken: 68.30 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 50.0894, mae: 4.0028, huber: 3.5594, swd: 20.7797, ept: 90.3600
    Epoch [1/50], Val Losses: mse: 22.5911, mae: 3.3194, huber: 2.8704, swd: 9.0061, ept: 99.5798
    Epoch [1/50], Test Losses: mse: 17.0555, mae: 2.6760, huber: 2.2505, swd: 7.9400, ept: 127.5791
      Epoch 1 composite train-obj: 3.559441
            Val objective improved inf → 2.8704, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 32.3184, mae: 3.1776, huber: 2.7413, swd: 14.9042, ept: 117.8948
    Epoch [2/50], Val Losses: mse: 22.8463, mae: 3.3857, huber: 2.9327, swd: 9.3400, ept: 104.6250
    Epoch [2/50], Test Losses: mse: 16.3112, mae: 2.6751, huber: 2.2392, swd: 6.7520, ept: 131.5252
      Epoch 2 composite train-obj: 2.741318
            No improvement (2.9327), counter 1/5
    Epoch [3/50], Train Losses: mse: 28.6454, mae: 2.9533, huber: 2.5188, swd: 12.5745, ept: 123.9940
    Epoch [3/50], Val Losses: mse: 22.7272, mae: 3.3592, huber: 2.9053, swd: 9.1440, ept: 105.9125
    Epoch [3/50], Test Losses: mse: 15.6787, mae: 2.6378, huber: 2.2021, swd: 6.1552, ept: 131.6858
      Epoch 3 composite train-obj: 2.518810
            No improvement (2.9053), counter 2/5
    Epoch [4/50], Train Losses: mse: 27.1339, mae: 2.8466, huber: 2.4136, swd: 11.7409, ept: 126.2694
    Epoch [4/50], Val Losses: mse: 28.1472, mae: 3.6342, huber: 3.1825, swd: 14.2280, ept: 101.2954
    Epoch [4/50], Test Losses: mse: 17.2082, mae: 2.7331, huber: 2.2959, swd: 7.1617, ept: 130.3416
      Epoch 4 composite train-obj: 2.413570
            No improvement (3.1825), counter 3/5
    Epoch [5/50], Train Losses: mse: 25.3224, mae: 2.7317, huber: 2.2999, swd: 10.5981, ept: 127.3514
    Epoch [5/50], Val Losses: mse: 24.8863, mae: 3.4489, huber: 2.9965, swd: 10.8046, ept: 103.5648
    Epoch [5/50], Test Losses: mse: 17.5460, mae: 2.8163, huber: 2.3738, swd: 7.4021, ept: 127.7647
      Epoch 5 composite train-obj: 2.299912
            No improvement (2.9965), counter 4/5
    Epoch [6/50], Train Losses: mse: 24.3782, mae: 2.6610, huber: 2.2302, swd: 9.9893, ept: 128.3669
    Epoch [6/50], Val Losses: mse: 25.6447, mae: 3.5019, huber: 3.0501, swd: 10.6880, ept: 101.9276
    Epoch [6/50], Test Losses: mse: 19.1422, mae: 2.9800, huber: 2.5344, swd: 8.4542, ept: 123.6978
      Epoch 6 composite train-obj: 2.230178
    Epoch [6/50], Test Losses: mse: 17.0555, mae: 2.6760, huber: 2.2505, swd: 7.9400, ept: 127.5791
    Best round's Test MSE: 17.0555, MAE: 2.6760, SWD: 7.9400
    Best round's Validation MSE: 22.5911, MAE: 3.3194, SWD: 9.0061
    Best round's Test verification MSE : 17.0555, MAE: 2.6760, SWD: 7.9400
    Time taken: 51.72 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 50.6054, mae: 4.0246, huber: 3.5810, swd: 18.5963, ept: 89.1078
    Epoch [1/50], Val Losses: mse: 22.5337, mae: 3.3217, huber: 2.8730, swd: 7.8495, ept: 102.0234
    Epoch [1/50], Test Losses: mse: 17.6988, mae: 2.7415, huber: 2.3148, swd: 7.4539, ept: 126.5459
      Epoch 1 composite train-obj: 3.581021
            Val objective improved inf → 2.8730, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 34.0593, mae: 3.2903, huber: 2.8540, swd: 13.2662, ept: 113.7224
    Epoch [2/50], Val Losses: mse: 22.0910, mae: 3.3201, huber: 2.8692, swd: 7.0462, ept: 103.7989
    Epoch [2/50], Test Losses: mse: 16.8221, mae: 2.6889, huber: 2.2562, swd: 6.2131, ept: 129.8722
      Epoch 2 composite train-obj: 2.853984
            Val objective improved 2.8730 → 2.8692, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 29.1946, mae: 2.9952, huber: 2.5602, swd: 11.1665, ept: 122.8990
    Epoch [3/50], Val Losses: mse: 23.8325, mae: 3.3975, huber: 2.9469, swd: 9.2280, ept: 102.9189
    Epoch [3/50], Test Losses: mse: 15.5959, mae: 2.5617, huber: 2.1336, swd: 5.5619, ept: 132.9020
      Epoch 3 composite train-obj: 2.560213
            No improvement (2.9469), counter 1/5
    Epoch [4/50], Train Losses: mse: 26.9586, mae: 2.8437, huber: 2.4109, swd: 9.9748, ept: 125.4305
    Epoch [4/50], Val Losses: mse: 25.3666, mae: 3.4421, huber: 2.9933, swd: 10.4604, ept: 108.1564
    Epoch [4/50], Test Losses: mse: 16.2353, mae: 2.6481, huber: 2.2162, swd: 6.1363, ept: 134.5784
      Epoch 4 composite train-obj: 2.410873
            No improvement (2.9933), counter 2/5
    Epoch [5/50], Train Losses: mse: 24.9772, mae: 2.7338, huber: 2.3023, swd: 8.8550, ept: 126.7834
    Epoch [5/50], Val Losses: mse: 22.3757, mae: 3.3235, huber: 2.8715, swd: 7.8871, ept: 107.5964
    Epoch [5/50], Test Losses: mse: 16.5093, mae: 2.6979, huber: 2.2617, swd: 6.1634, ept: 131.8983
      Epoch 5 composite train-obj: 2.302293
            No improvement (2.8715), counter 3/5
    Epoch [6/50], Train Losses: mse: 23.3962, mae: 2.6163, huber: 2.1868, swd: 8.0161, ept: 128.5069
    Epoch [6/50], Val Losses: mse: 22.5840, mae: 3.3425, huber: 2.8911, swd: 8.2968, ept: 107.2590
    Epoch [6/50], Test Losses: mse: 17.8750, mae: 2.8583, huber: 2.4163, swd: 7.2356, ept: 130.9410
      Epoch 6 composite train-obj: 2.186795
            No improvement (2.8911), counter 4/5
    Epoch [7/50], Train Losses: mse: 22.7563, mae: 2.5602, huber: 2.1318, swd: 7.7459, ept: 129.5274
    Epoch [7/50], Val Losses: mse: 23.3745, mae: 3.4037, huber: 2.9498, swd: 8.9105, ept: 107.2380
    Epoch [7/50], Test Losses: mse: 16.5447, mae: 2.7103, huber: 2.2741, swd: 6.2356, ept: 133.0441
      Epoch 7 composite train-obj: 2.131789
    Epoch [7/50], Test Losses: mse: 16.8221, mae: 2.6889, huber: 2.2562, swd: 6.2131, ept: 129.8722
    Best round's Test MSE: 16.8221, MAE: 2.6889, SWD: 6.2131
    Best round's Validation MSE: 22.0910, MAE: 3.3201, SWD: 7.0462
    Best round's Test verification MSE : 16.8221, MAE: 2.6889, SWD: 6.2131
    Time taken: 59.80 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred196_20250510_2244)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 16.5370 ± 0.5762
      mae: 2.6476 ± 0.0496
      huber: 2.2183 ± 0.0495
      swd: 6.8118 ± 0.7982
      ept: 129.9661 ± 1.9884
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 23.0347 ± 1.0020
      mae: 3.3539 ± 0.0483
      huber: 2.9040 ± 0.0485
      swd: 8.9384 ± 1.5180
      ept: 102.6238 ± 2.1709
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 179.91 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred196_20250510_2244
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7193, mae: 0.5199, huber: 0.2494, swd: 0.2495, ept: 124.7583
    Epoch [1/50], Val Losses: mse: 0.3955, mae: 0.4628, huber: 0.1855, swd: 0.1237, ept: 130.0916
    Epoch [1/50], Test Losses: mse: 0.2202, mae: 0.3356, huber: 0.1071, swd: 0.0562, ept: 176.4889
      Epoch 1 composite train-obj: 0.249414
            Val objective improved inf → 0.1855, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5178, mae: 0.4438, huber: 0.1912, swd: 0.1855, ept: 155.9851
    Epoch [2/50], Val Losses: mse: 0.4606, mae: 0.4965, huber: 0.2119, swd: 0.1673, ept: 132.3206
    Epoch [2/50], Test Losses: mse: 0.2335, mae: 0.3529, huber: 0.1137, swd: 0.0681, ept: 178.8740
      Epoch 2 composite train-obj: 0.191161
            No improvement (0.2119), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.4411, mae: 0.4053, huber: 0.1637, swd: 0.1724, ept: 173.9040
    Epoch [3/50], Val Losses: mse: 0.5035, mae: 0.5304, huber: 0.2312, swd: 0.1283, ept: 120.3099
    Epoch [3/50], Test Losses: mse: 0.3081, mae: 0.4122, huber: 0.1472, swd: 0.0768, ept: 168.7220
      Epoch 3 composite train-obj: 0.163699
            No improvement (0.2312), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.4104, mae: 0.3894, huber: 0.1526, swd: 0.1629, ept: 177.2493
    Epoch [4/50], Val Losses: mse: 0.4821, mae: 0.5128, huber: 0.2221, swd: 0.1674, ept: 129.9765
    Epoch [4/50], Test Losses: mse: 0.2131, mae: 0.3409, huber: 0.1044, swd: 0.0536, ept: 186.9603
      Epoch 4 composite train-obj: 0.152566
            No improvement (0.2221), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.3809, mae: 0.3711, huber: 0.1412, swd: 0.1524, ept: 182.2258
    Epoch [5/50], Val Losses: mse: 0.4623, mae: 0.5016, huber: 0.2130, swd: 0.1432, ept: 130.5114
    Epoch [5/50], Test Losses: mse: 0.2250, mae: 0.3473, huber: 0.1096, swd: 0.0550, ept: 179.8427
      Epoch 5 composite train-obj: 0.141189
            No improvement (0.2130), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.3632, mae: 0.3600, huber: 0.1345, swd: 0.1451, ept: 183.7558
    Epoch [6/50], Val Losses: mse: 0.4425, mae: 0.4932, huber: 0.2048, swd: 0.1327, ept: 134.5180
    Epoch [6/50], Test Losses: mse: 0.2247, mae: 0.3509, huber: 0.1099, swd: 0.0572, ept: 181.7770
      Epoch 6 composite train-obj: 0.134464
    Epoch [6/50], Test Losses: mse: 0.2202, mae: 0.3356, huber: 0.1071, swd: 0.0562, ept: 176.4889
    Best round's Test MSE: 0.2202, MAE: 0.3356, SWD: 0.0562
    Best round's Validation MSE: 0.3955, MAE: 0.4628, SWD: 0.1237
    Best round's Test verification MSE : 0.2202, MAE: 0.3356, SWD: 0.0562
    Time taken: 50.75 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.7010, mae: 0.5147, huber: 0.2449, swd: 0.2475, ept: 127.3613
    Epoch [1/50], Val Losses: mse: 0.4399, mae: 0.4924, huber: 0.2044, swd: 0.1216, ept: 118.0734
    Epoch [1/50], Test Losses: mse: 0.2333, mae: 0.3467, huber: 0.1129, swd: 0.0561, ept: 166.2394
      Epoch 1 composite train-obj: 0.244872
            Val objective improved inf → 0.2044, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5025, mae: 0.4352, huber: 0.1851, swd: 0.1924, ept: 162.2335
    Epoch [2/50], Val Losses: mse: 0.4118, mae: 0.4747, huber: 0.1927, swd: 0.1222, ept: 126.8774
    Epoch [2/50], Test Losses: mse: 0.2436, mae: 0.3689, huber: 0.1186, swd: 0.0659, ept: 174.9828
      Epoch 2 composite train-obj: 0.185131
            Val objective improved 0.2044 → 0.1927, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4342, mae: 0.4010, huber: 0.1608, swd: 0.1757, ept: 176.1827
    Epoch [3/50], Val Losses: mse: 0.4341, mae: 0.4856, huber: 0.2023, swd: 0.1410, ept: 142.0854
    Epoch [3/50], Test Losses: mse: 0.2298, mae: 0.3564, huber: 0.1125, swd: 0.0583, ept: 189.0582
      Epoch 3 composite train-obj: 0.160791
            No improvement (0.2023), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3962, mae: 0.3821, huber: 0.1478, swd: 0.1604, ept: 179.0707
    Epoch [4/50], Val Losses: mse: 0.4511, mae: 0.4918, huber: 0.2085, swd: 0.1759, ept: 140.4768
    Epoch [4/50], Test Losses: mse: 0.2116, mae: 0.3386, huber: 0.1038, swd: 0.0585, ept: 188.5440
      Epoch 4 composite train-obj: 0.147754
            No improvement (0.2085), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3717, mae: 0.3687, huber: 0.1391, swd: 0.1501, ept: 182.0018
    Epoch [5/50], Val Losses: mse: 0.4235, mae: 0.4855, huber: 0.1975, swd: 0.1559, ept: 133.4052
    Epoch [5/50], Test Losses: mse: 0.2019, mae: 0.3273, huber: 0.0989, swd: 0.0577, ept: 185.9605
      Epoch 5 composite train-obj: 0.139129
            No improvement (0.1975), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.3526, mae: 0.3576, huber: 0.1322, swd: 0.1415, ept: 183.1610
    Epoch [6/50], Val Losses: mse: 0.4673, mae: 0.5025, huber: 0.2140, swd: 0.1668, ept: 130.3026
    Epoch [6/50], Test Losses: mse: 0.2227, mae: 0.3449, huber: 0.1085, swd: 0.0598, ept: 183.3738
      Epoch 6 composite train-obj: 0.132203
            No improvement (0.2140), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.3463, mae: 0.3559, huber: 0.1305, swd: 0.1355, ept: 183.4893
    Epoch [7/50], Val Losses: mse: 0.4275, mae: 0.4838, huber: 0.1988, swd: 0.1328, ept: 138.4778
    Epoch [7/50], Test Losses: mse: 0.2359, mae: 0.3625, huber: 0.1154, swd: 0.0627, ept: 187.4490
      Epoch 7 composite train-obj: 0.130453
    Epoch [7/50], Test Losses: mse: 0.2436, mae: 0.3689, huber: 0.1186, swd: 0.0659, ept: 174.9828
    Best round's Test MSE: 0.2436, MAE: 0.3689, SWD: 0.0659
    Best round's Validation MSE: 0.4118, MAE: 0.4747, SWD: 0.1222
    Best round's Test verification MSE : 0.2436, MAE: 0.3689, SWD: 0.0659
    Time taken: 59.18 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6929, mae: 0.5148, huber: 0.2442, swd: 0.2367, ept: 124.7063
    Epoch [1/50], Val Losses: mse: 0.4151, mae: 0.4707, huber: 0.1930, swd: 0.1333, ept: 136.0690
    Epoch [1/50], Test Losses: mse: 0.2428, mae: 0.3560, huber: 0.1180, swd: 0.0679, ept: 180.4368
      Epoch 1 composite train-obj: 0.244220
            Val objective improved inf → 0.1930, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5097, mae: 0.4393, huber: 0.1887, swd: 0.1863, ept: 160.8267
    Epoch [2/50], Val Losses: mse: 0.3849, mae: 0.4590, huber: 0.1812, swd: 0.1195, ept: 127.4844
    Epoch [2/50], Test Losses: mse: 0.2230, mae: 0.3394, huber: 0.1081, swd: 0.0503, ept: 173.9075
      Epoch 2 composite train-obj: 0.188655
            Val objective improved 0.1930 → 0.1812, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4521, mae: 0.4120, huber: 0.1681, swd: 0.1768, ept: 170.3546
    Epoch [3/50], Val Losses: mse: 0.4561, mae: 0.4930, huber: 0.2076, swd: 0.1531, ept: 129.4779
    Epoch [3/50], Test Losses: mse: 0.2044, mae: 0.3293, huber: 0.1002, swd: 0.0553, ept: 181.9579
      Epoch 3 composite train-obj: 0.168064
            No improvement (0.2076), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4154, mae: 0.3918, huber: 0.1546, swd: 0.1686, ept: 177.0633
    Epoch [4/50], Val Losses: mse: 0.4384, mae: 0.4843, huber: 0.2030, swd: 0.1395, ept: 137.3250
    Epoch [4/50], Test Losses: mse: 0.2111, mae: 0.3388, huber: 0.1036, swd: 0.0521, ept: 185.6564
      Epoch 4 composite train-obj: 0.154572
            No improvement (0.2030), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.4047, mae: 0.3843, huber: 0.1497, swd: 0.1639, ept: 177.9142
    Epoch [5/50], Val Losses: mse: 0.4845, mae: 0.5144, huber: 0.2222, swd: 0.1426, ept: 119.3984
    Epoch [5/50], Test Losses: mse: 0.2590, mae: 0.3800, huber: 0.1258, swd: 0.0665, ept: 169.8087
      Epoch 5 composite train-obj: 0.149740
            No improvement (0.2222), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.3965, mae: 0.3819, huber: 0.1478, swd: 0.1591, ept: 178.3229
    Epoch [6/50], Val Losses: mse: 0.4970, mae: 0.5148, huber: 0.2267, swd: 0.1739, ept: 130.4131
    Epoch [6/50], Test Losses: mse: 0.2505, mae: 0.3717, huber: 0.1219, swd: 0.0685, ept: 178.1525
      Epoch 6 composite train-obj: 0.147834
            No improvement (0.2267), counter 4/5
    Epoch [7/50], Train Losses: mse: 0.3706, mae: 0.3649, huber: 0.1372, swd: 0.1502, ept: 182.4108
    Epoch [7/50], Val Losses: mse: 0.4297, mae: 0.4829, huber: 0.1996, swd: 0.1437, ept: 138.8742
    Epoch [7/50], Test Losses: mse: 0.2343, mae: 0.3591, huber: 0.1146, swd: 0.0617, ept: 184.0669
      Epoch 7 composite train-obj: 0.137235
    Epoch [7/50], Test Losses: mse: 0.2230, mae: 0.3394, huber: 0.1081, swd: 0.0503, ept: 173.9075
    Best round's Test MSE: 0.2230, MAE: 0.3394, SWD: 0.0503
    Best round's Validation MSE: 0.3849, MAE: 0.4590, SWD: 0.1195
    Best round's Test verification MSE : 0.2230, MAE: 0.3394, SWD: 0.0503
    Time taken: 59.06 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred336_20250510_2210)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2289 ± 0.0104
      mae: 0.3479 ± 0.0149
      huber: 0.1113 ± 0.0052
      swd: 0.0575 ± 0.0064
      ept: 175.1264 ± 1.0587
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3974 ± 0.0110
      mae: 0.4655 ± 0.0067
      huber: 0.1865 ± 0.0047
      swd: 0.1218 ± 0.0017
      ept: 128.1512 ± 1.3943
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 169.14 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred336_20250510_2210
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 61.4480, mae: 4.3994, huber: 3.9517, swd: 25.8757, ept: 124.4940
    Epoch [1/50], Val Losses: mse: 25.8802, mae: 3.6253, huber: 3.1695, swd: 7.7551, ept: 134.1989
    Epoch [1/50], Test Losses: mse: 18.5634, mae: 2.7899, huber: 2.3637, swd: 7.4272, ept: 182.5673
      Epoch 1 composite train-obj: 3.951669
            Val objective improved inf → 3.1695, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 45.3172, mae: 3.7900, huber: 3.3470, swd: 20.3224, ept: 149.5374
    Epoch [2/50], Val Losses: mse: 33.9815, mae: 4.0502, huber: 3.5958, swd: 13.9508, ept: 118.9234
    Epoch [2/50], Test Losses: mse: 23.2172, mae: 3.1923, huber: 2.7535, swd: 10.5736, ept: 167.7197
      Epoch 2 composite train-obj: 3.346965
            No improvement (3.5958), counter 1/5
    Epoch [3/50], Train Losses: mse: 38.9432, mae: 3.4342, huber: 2.9929, swd: 17.6890, ept: 170.3705
    Epoch [3/50], Val Losses: mse: 30.2804, mae: 3.9080, huber: 3.4480, swd: 9.4432, ept: 127.2653
    Epoch [3/50], Test Losses: mse: 23.9979, mae: 3.2551, huber: 2.8095, swd: 10.4906, ept: 173.3422
      Epoch 3 composite train-obj: 2.992891
            No improvement (3.4480), counter 2/5
    Epoch [4/50], Train Losses: mse: 36.1930, mae: 3.2712, huber: 2.8314, swd: 15.8498, ept: 176.3183
    Epoch [4/50], Val Losses: mse: 30.1401, mae: 3.8583, huber: 3.4004, swd: 10.4357, ept: 134.0785
    Epoch [4/50], Test Losses: mse: 17.4748, mae: 2.7395, huber: 2.3031, swd: 6.3071, ept: 186.5136
      Epoch 4 composite train-obj: 2.831411
            No improvement (3.4004), counter 3/5
    Epoch [5/50], Train Losses: mse: 35.0847, mae: 3.1961, huber: 2.7576, swd: 15.3535, ept: 179.1273
    Epoch [5/50], Val Losses: mse: 29.3644, mae: 3.8295, huber: 3.3724, swd: 10.8343, ept: 136.9544
    Epoch [5/50], Test Losses: mse: 18.6580, mae: 2.9149, huber: 2.4728, swd: 7.5036, ept: 185.0447
      Epoch 5 composite train-obj: 2.757596
            No improvement (3.3724), counter 4/5
    Epoch [6/50], Train Losses: mse: 32.2458, mae: 3.0013, huber: 2.5657, swd: 13.4547, ept: 182.2981
    Epoch [6/50], Val Losses: mse: 34.0544, mae: 4.0195, huber: 3.5566, swd: 10.5285, ept: 129.0339
    Epoch [6/50], Test Losses: mse: 18.5670, mae: 2.8896, huber: 2.4456, swd: 6.4841, ept: 173.4785
      Epoch 6 composite train-obj: 2.565680
    Epoch [6/50], Test Losses: mse: 18.5634, mae: 2.7899, huber: 2.3637, swd: 7.4272, ept: 182.5673
    Best round's Test MSE: 18.5634, MAE: 2.7899, SWD: 7.4272
    Best round's Validation MSE: 25.8802, MAE: 3.6253, SWD: 7.7551
    Best round's Test verification MSE : 18.5634, MAE: 2.7899, SWD: 7.4272
    Time taken: 51.18 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 59.8075, mae: 4.3454, huber: 3.8979, swd: 25.6896, ept: 126.8002
    Epoch [1/50], Val Losses: mse: 31.3620, mae: 3.9926, huber: 3.5316, swd: 10.8268, ept: 115.7753
    Epoch [1/50], Test Losses: mse: 19.9260, mae: 2.9547, huber: 2.5212, swd: 7.9858, ept: 168.0985
      Epoch 1 composite train-obj: 3.897891
            Val objective improved inf → 3.5316, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 45.4251, mae: 3.7883, huber: 3.3446, swd: 21.2811, ept: 151.9985
    Epoch [2/50], Val Losses: mse: 26.1715, mae: 3.6866, huber: 3.2267, swd: 8.1967, ept: 125.9832
    Epoch [2/50], Test Losses: mse: 20.7110, mae: 3.0183, huber: 2.5775, swd: 9.3453, ept: 174.2934
      Epoch 2 composite train-obj: 3.344646
            Val objective improved 3.5316 → 3.2267, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 37.7492, mae: 3.3665, huber: 2.9259, swd: 17.2157, ept: 173.5732
    Epoch [3/50], Val Losses: mse: 25.7778, mae: 3.5962, huber: 3.1393, swd: 8.3909, ept: 141.0712
    Epoch [3/50], Test Losses: mse: 17.6734, mae: 2.7476, huber: 2.3178, swd: 7.0946, ept: 186.4475
      Epoch 3 composite train-obj: 2.925884
            Val objective improved 3.2267 → 3.1393, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 34.9120, mae: 3.1931, huber: 2.7544, swd: 15.4047, ept: 178.5643
    Epoch [4/50], Val Losses: mse: 31.9746, mae: 3.9613, huber: 3.5069, swd: 13.1322, ept: 131.7777
    Epoch [4/50], Test Losses: mse: 19.3342, mae: 2.9464, huber: 2.5070, swd: 8.2127, ept: 181.0160
      Epoch 4 composite train-obj: 2.754396
            No improvement (3.5069), counter 1/5
    Epoch [5/50], Train Losses: mse: 32.8999, mae: 3.0594, huber: 2.6224, swd: 14.1259, ept: 181.1872
    Epoch [5/50], Val Losses: mse: 28.6780, mae: 3.7431, huber: 3.2860, swd: 11.1841, ept: 145.1196
    Epoch [5/50], Test Losses: mse: 17.4359, mae: 2.7088, huber: 2.2809, swd: 6.5675, ept: 190.3966
      Epoch 5 composite train-obj: 2.622395
            No improvement (3.2860), counter 2/5
    Epoch [6/50], Train Losses: mse: 31.8187, mae: 2.9821, huber: 2.5463, swd: 13.4580, ept: 183.1211
    Epoch [6/50], Val Losses: mse: 28.9040, mae: 3.7957, huber: 3.3386, swd: 12.2112, ept: 144.0795
    Epoch [6/50], Test Losses: mse: 19.2064, mae: 2.9274, huber: 2.4893, swd: 8.5546, ept: 188.3489
      Epoch 6 composite train-obj: 2.546251
            No improvement (3.3386), counter 3/5
    Epoch [7/50], Train Losses: mse: 32.1019, mae: 2.9963, huber: 2.5600, swd: 13.7083, ept: 183.3546
    Epoch [7/50], Val Losses: mse: 28.8468, mae: 3.7749, huber: 3.3197, swd: 12.1310, ept: 149.0151
    Epoch [7/50], Test Losses: mse: 19.0261, mae: 2.9263, huber: 2.4878, swd: 8.0659, ept: 186.8959
      Epoch 7 composite train-obj: 2.559966
            No improvement (3.3197), counter 4/5
    Epoch [8/50], Train Losses: mse: 30.0903, mae: 2.8663, huber: 2.4320, swd: 12.6470, ept: 186.6271
    Epoch [8/50], Val Losses: mse: 25.4629, mae: 3.5578, huber: 3.0990, swd: 8.9397, ept: 155.0897
    Epoch [8/50], Test Losses: mse: 17.5002, mae: 2.7550, huber: 2.3236, swd: 6.7117, ept: 190.1451
      Epoch 8 composite train-obj: 2.432030
            Val objective improved 3.1393 → 3.0990, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 29.8351, mae: 2.8467, huber: 2.4130, swd: 12.5129, ept: 186.6590
    Epoch [9/50], Val Losses: mse: 27.4108, mae: 3.6948, huber: 3.2383, swd: 10.0037, ept: 145.2218
    Epoch [9/50], Test Losses: mse: 17.4996, mae: 2.7511, huber: 2.3176, swd: 6.6993, ept: 189.4234
      Epoch 9 composite train-obj: 2.413048
            No improvement (3.2383), counter 1/5
    Epoch [10/50], Train Losses: mse: 28.4665, mae: 2.7513, huber: 2.3193, swd: 11.8324, ept: 189.7464
    Epoch [10/50], Val Losses: mse: 26.0536, mae: 3.6299, huber: 3.1722, swd: 10.2470, ept: 153.9358
    Epoch [10/50], Test Losses: mse: 18.7702, mae: 2.8938, huber: 2.4568, swd: 7.9965, ept: 191.0031
      Epoch 10 composite train-obj: 2.319344
            No improvement (3.1722), counter 2/5
    Epoch [11/50], Train Losses: mse: 27.7159, mae: 2.7179, huber: 2.2861, swd: 11.4282, ept: 189.8610
    Epoch [11/50], Val Losses: mse: 28.2174, mae: 3.7128, huber: 3.2542, swd: 10.1245, ept: 155.3715
    Epoch [11/50], Test Losses: mse: 19.2686, mae: 2.9326, huber: 2.4928, swd: 7.9473, ept: 186.2360
      Epoch 11 composite train-obj: 2.286139
            No improvement (3.2542), counter 3/5
    Epoch [12/50], Train Losses: mse: 27.1695, mae: 2.6895, huber: 2.2586, swd: 11.0581, ept: 190.5712
    Epoch [12/50], Val Losses: mse: 27.4627, mae: 3.6744, huber: 3.2169, swd: 10.5527, ept: 153.5558
    Epoch [12/50], Test Losses: mse: 18.8380, mae: 2.8570, huber: 2.4239, swd: 7.4386, ept: 187.6497
      Epoch 12 composite train-obj: 2.258553
            No improvement (3.2169), counter 4/5
    Epoch [13/50], Train Losses: mse: 25.6490, mae: 2.6266, huber: 2.1965, swd: 9.8944, ept: 191.3766
    Epoch [13/50], Val Losses: mse: 34.1624, mae: 4.0680, huber: 3.6093, swd: 12.5313, ept: 130.1348
    Epoch [13/50], Test Losses: mse: 19.7796, mae: 2.9601, huber: 2.5192, swd: 7.0054, ept: 172.4535
      Epoch 13 composite train-obj: 2.196458
    Epoch [13/50], Test Losses: mse: 17.5002, mae: 2.7550, huber: 2.3236, swd: 6.7117, ept: 190.1451
    Best round's Test MSE: 17.5002, MAE: 2.7550, SWD: 6.7117
    Best round's Validation MSE: 25.4629, MAE: 3.5578, SWD: 8.9397
    Best round's Test verification MSE : 17.5002, MAE: 2.7550, SWD: 6.7117
    Time taken: 110.55 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 58.9765, mae: 4.3471, huber: 3.8993, swd: 24.3260, ept: 124.8726
    Epoch [1/50], Val Losses: mse: 26.5915, mae: 3.6969, huber: 3.2387, swd: 8.9648, ept: 138.1835
    Epoch [1/50], Test Losses: mse: 21.2939, mae: 3.0465, huber: 2.6137, swd: 9.9175, ept: 182.3615
      Epoch 1 composite train-obj: 3.899314
            Val objective improved inf → 3.2387, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 45.3006, mae: 3.7631, huber: 3.3209, swd: 20.1895, ept: 154.9872
    Epoch [2/50], Val Losses: mse: 27.6640, mae: 3.7818, huber: 3.3234, swd: 7.4998, ept: 115.4075
    Epoch [2/50], Test Losses: mse: 18.3967, mae: 2.8052, huber: 2.3727, swd: 5.6710, ept: 167.5144
      Epoch 2 composite train-obj: 3.320873
            No improvement (3.3234), counter 1/5
    Epoch [3/50], Train Losses: mse: 38.8974, mae: 3.4119, huber: 2.9704, swd: 16.7586, ept: 171.3680
    Epoch [3/50], Val Losses: mse: 25.7905, mae: 3.6214, huber: 3.1592, swd: 6.5442, ept: 138.1055
    Epoch [3/50], Test Losses: mse: 17.3189, mae: 2.8048, huber: 2.3640, swd: 5.5810, ept: 174.6627
      Epoch 3 composite train-obj: 2.970409
            Val objective improved 3.2387 → 3.1592, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 35.3539, mae: 3.2227, huber: 2.7832, swd: 14.7448, ept: 177.6585
    Epoch [4/50], Val Losses: mse: 30.2030, mae: 3.7943, huber: 3.3353, swd: 8.7510, ept: 143.7828
    Epoch [4/50], Test Losses: mse: 17.6459, mae: 2.8878, huber: 2.4433, swd: 5.8378, ept: 178.0716
      Epoch 4 composite train-obj: 2.783205
            No improvement (3.3353), counter 1/5
    Epoch [5/50], Train Losses: mse: 34.4313, mae: 3.1571, huber: 2.7186, swd: 14.0832, ept: 178.0675
    Epoch [5/50], Val Losses: mse: 39.1763, mae: 4.3038, huber: 3.8402, swd: 10.9371, ept: 121.1032
    Epoch [5/50], Test Losses: mse: 23.7970, mae: 3.3780, huber: 2.9225, swd: 7.9336, ept: 140.1965
      Epoch 5 composite train-obj: 2.718596
            No improvement (3.8402), counter 2/5
    Epoch [6/50], Train Losses: mse: 35.7265, mae: 3.2398, huber: 2.7997, swd: 14.9210, ept: 175.8289
    Epoch [6/50], Val Losses: mse: 56.2027, mae: 4.4977, huber: 4.0373, swd: 32.0436, ept: 135.6785
    Epoch [6/50], Test Losses: mse: 24.2858, mae: 3.5957, huber: 3.1368, swd: 9.9811, ept: 146.0693
      Epoch 6 composite train-obj: 2.799658
            No improvement (4.0373), counter 3/5
    Epoch [7/50], Train Losses: mse: 34.1724, mae: 3.0849, huber: 2.6477, swd: 14.1999, ept: 181.4293
    Epoch [7/50], Val Losses: mse: 27.0018, mae: 3.6550, huber: 3.1930, swd: 7.6214, ept: 147.5777
    Epoch [7/50], Test Losses: mse: 17.2576, mae: 2.8715, huber: 2.4270, swd: 5.3346, ept: 169.3409
      Epoch 7 composite train-obj: 2.647726
            No improvement (3.1930), counter 4/5
    Epoch [8/50], Train Losses: mse: 31.5884, mae: 2.9457, huber: 2.5108, swd: 12.5808, ept: 183.5512
    Epoch [8/50], Val Losses: mse: 30.5316, mae: 3.8762, huber: 3.4130, swd: 10.1952, ept: 142.4108
    Epoch [8/50], Test Losses: mse: 18.8116, mae: 3.0016, huber: 2.5543, swd: 6.3133, ept: 168.0154
      Epoch 8 composite train-obj: 2.510793
    Epoch [8/50], Test Losses: mse: 17.3189, mae: 2.8048, huber: 2.3640, swd: 5.5810, ept: 174.6627
    Best round's Test MSE: 17.3189, MAE: 2.8048, SWD: 5.5810
    Best round's Validation MSE: 25.7905, MAE: 3.6214, SWD: 6.5442
    Best round's Test verification MSE : 17.3189, MAE: 2.8048, SWD: 5.5810
    Time taken: 68.58 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred336_20250510_2247)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 17.7942 ± 0.5489
      mae: 2.7832 ± 0.0209
      huber: 2.3505 ± 0.0190
      swd: 6.5733 ± 0.7600
      ept: 182.4584 ± 6.3211
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 25.7112 ± 0.1793
      mae: 3.6015 ± 0.0309
      huber: 3.1426 ± 0.0311
      swd: 7.7463 ± 0.9780
      ept: 142.4647 ± 9.0686
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 230.44 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred336_20250510_2247
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.9181, mae: 0.6053, huber: 0.3134, swd: 0.3236, ept: 199.6674
    Epoch [1/50], Val Losses: mse: 0.4909, mae: 0.5303, huber: 0.2290, swd: 0.0762, ept: 223.6224
    Epoch [1/50], Test Losses: mse: 0.3229, mae: 0.4183, huber: 0.1549, swd: 0.0871, ept: 293.7790
      Epoch 1 composite train-obj: 0.313383
            Val objective improved inf → 0.2290, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.7039, mae: 0.5282, huber: 0.2525, swd: 0.2625, ept: 244.9841
    Epoch [2/50], Val Losses: mse: 0.6815, mae: 0.6311, huber: 0.3028, swd: 0.1235, ept: 199.0965
    Epoch [2/50], Test Losses: mse: 0.4465, mae: 0.5035, huber: 0.2078, swd: 0.1412, ept: 272.4117
      Epoch 2 composite train-obj: 0.252539
            No improvement (0.3028), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.6517, mae: 0.5065, huber: 0.2355, swd: 0.2585, ept: 257.3354
    Epoch [3/50], Val Losses: mse: 0.4890, mae: 0.5379, huber: 0.2288, swd: 0.0901, ept: 208.1896
    Epoch [3/50], Test Losses: mse: 0.2885, mae: 0.3942, huber: 0.1381, swd: 0.0685, ept: 300.0078
      Epoch 3 composite train-obj: 0.235459
            Val objective improved 0.2290 → 0.2288, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.5979, mae: 0.4766, huber: 0.2146, swd: 0.2493, ept: 268.3873
    Epoch [4/50], Val Losses: mse: 0.5281, mae: 0.5561, huber: 0.2447, swd: 0.0861, ept: 203.2049
    Epoch [4/50], Test Losses: mse: 0.3276, mae: 0.4284, huber: 0.1564, swd: 0.0896, ept: 288.6305
      Epoch 4 composite train-obj: 0.214643
            No improvement (0.2447), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.5469, mae: 0.4556, huber: 0.1986, swd: 0.2248, ept: 272.4538
    Epoch [5/50], Val Losses: mse: 0.4159, mae: 0.4954, huber: 0.1983, swd: 0.1041, ept: 227.7410
    Epoch [5/50], Test Losses: mse: 0.2875, mae: 0.3891, huber: 0.1370, swd: 0.0838, ept: 295.4006
      Epoch 5 composite train-obj: 0.198550
            Val objective improved 0.2288 → 0.1983, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.5177, mae: 0.4416, huber: 0.1887, swd: 0.2126, ept: 277.0284
    Epoch [6/50], Val Losses: mse: 0.4705, mae: 0.5246, huber: 0.2212, swd: 0.0972, ept: 214.8277
    Epoch [6/50], Test Losses: mse: 0.2843, mae: 0.3914, huber: 0.1364, swd: 0.0772, ept: 294.5210
      Epoch 6 composite train-obj: 0.188681
            No improvement (0.2212), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.4803, mae: 0.4250, huber: 0.1764, swd: 0.1924, ept: 277.9831
    Epoch [7/50], Val Losses: mse: 0.4252, mae: 0.5078, huber: 0.2033, swd: 0.1043, ept: 219.5682
    Epoch [7/50], Test Losses: mse: 0.2893, mae: 0.3936, huber: 0.1380, swd: 0.0842, ept: 285.0923
      Epoch 7 composite train-obj: 0.176407
            No improvement (0.2033), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.4726, mae: 0.4264, huber: 0.1759, swd: 0.1791, ept: 272.5144
    Epoch [8/50], Val Losses: mse: 0.4697, mae: 0.5252, huber: 0.2209, swd: 0.1061, ept: 233.9693
    Epoch [8/50], Test Losses: mse: 0.2853, mae: 0.3890, huber: 0.1365, swd: 0.0780, ept: 296.8145
      Epoch 8 composite train-obj: 0.175901
            No improvement (0.2209), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.4322, mae: 0.4066, huber: 0.1626, swd: 0.1560, ept: 280.8679
    Epoch [9/50], Val Losses: mse: 0.4457, mae: 0.5193, huber: 0.2127, swd: 0.1044, ept: 213.4995
    Epoch [9/50], Test Losses: mse: 0.3560, mae: 0.4354, huber: 0.1666, swd: 0.1112, ept: 268.7357
      Epoch 9 composite train-obj: 0.162585
            No improvement (0.2127), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.4105, mae: 0.3973, huber: 0.1558, swd: 0.1394, ept: 281.7370
    Epoch [10/50], Val Losses: mse: 0.4720, mae: 0.5283, huber: 0.2223, swd: 0.0894, ept: 224.7395
    Epoch [10/50], Test Losses: mse: 0.3673, mae: 0.4431, huber: 0.1711, swd: 0.1163, ept: 271.5705
      Epoch 10 composite train-obj: 0.155754
    Epoch [10/50], Test Losses: mse: 0.2875, mae: 0.3891, huber: 0.1370, swd: 0.0838, ept: 295.4006
    Best round's Test MSE: 0.2875, MAE: 0.3891, SWD: 0.0838
    Best round's Validation MSE: 0.4159, MAE: 0.4954, SWD: 0.1041
    Best round's Test verification MSE : 0.2875, MAE: 0.3891, SWD: 0.0838
    Time taken: 84.85 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.9147, mae: 0.6068, huber: 0.3143, swd: 0.3089, ept: 199.4774
    Epoch [1/50], Val Losses: mse: 0.3856, mae: 0.4679, huber: 0.1847, swd: 0.0753, ept: 211.0891
    Epoch [1/50], Test Losses: mse: 0.2618, mae: 0.3667, huber: 0.1264, swd: 0.0665, ept: 293.7894
      Epoch 1 composite train-obj: 0.314349
            Val objective improved inf → 0.1847, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.6904, mae: 0.5238, huber: 0.2492, swd: 0.2475, ept: 246.5425
    Epoch [2/50], Val Losses: mse: 0.4923, mae: 0.5337, huber: 0.2309, swd: 0.0906, ept: 204.7442
    Epoch [2/50], Test Losses: mse: 0.3137, mae: 0.4106, huber: 0.1502, swd: 0.0757, ept: 291.5848
      Epoch 2 composite train-obj: 0.249152
            No improvement (0.2309), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.6320, mae: 0.4965, huber: 0.2282, swd: 0.2421, ept: 261.5710
    Epoch [3/50], Val Losses: mse: 0.5551, mae: 0.5646, huber: 0.2553, swd: 0.0954, ept: 196.7733
    Epoch [3/50], Test Losses: mse: 0.2893, mae: 0.3934, huber: 0.1384, swd: 0.0579, ept: 300.5798
      Epoch 3 composite train-obj: 0.228180
            No improvement (0.2553), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.5661, mae: 0.4670, huber: 0.2060, swd: 0.2170, ept: 265.9275
    Epoch [4/50], Val Losses: mse: 0.6434, mae: 0.6083, huber: 0.2879, swd: 0.0885, ept: 154.6751
    Epoch [4/50], Test Losses: mse: 0.3992, mae: 0.4727, huber: 0.1870, swd: 0.1030, ept: 261.9269
      Epoch 4 composite train-obj: 0.205962
            No improvement (0.2879), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.5533, mae: 0.4616, huber: 0.2016, swd: 0.2082, ept: 266.9496
    Epoch [5/50], Val Losses: mse: 0.5113, mae: 0.5476, huber: 0.2386, swd: 0.0836, ept: 195.4500
    Epoch [5/50], Test Losses: mse: 0.3346, mae: 0.4264, huber: 0.1585, swd: 0.0850, ept: 291.1269
      Epoch 5 composite train-obj: 0.201596
            No improvement (0.2386), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.4942, mae: 0.4290, huber: 0.1796, swd: 0.1899, ept: 274.8933
    Epoch [6/50], Val Losses: mse: 0.5529, mae: 0.5642, huber: 0.2515, swd: 0.0696, ept: 200.3074
    Epoch [6/50], Test Losses: mse: 0.3424, mae: 0.4344, huber: 0.1620, swd: 0.0911, ept: 286.8077
      Epoch 6 composite train-obj: 0.179639
    Epoch [6/50], Test Losses: mse: 0.2618, mae: 0.3667, huber: 0.1264, swd: 0.0665, ept: 293.7894
    Best round's Test MSE: 0.2618, MAE: 0.3667, SWD: 0.0665
    Best round's Validation MSE: 0.3856, MAE: 0.4679, SWD: 0.0753
    Best round's Test verification MSE : 0.2618, MAE: 0.3667, SWD: 0.0665
    Time taken: 50.11 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.9038, mae: 0.6037, huber: 0.3116, swd: 0.3293, ept: 199.3513
    Epoch [1/50], Val Losses: mse: 0.4533, mae: 0.5145, huber: 0.2137, swd: 0.0746, ept: 190.8260
    Epoch [1/50], Test Losses: mse: 0.3221, mae: 0.4116, huber: 0.1534, swd: 0.0975, ept: 272.8318
      Epoch 1 composite train-obj: 0.311621
            Val objective improved inf → 0.2137, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.7543, mae: 0.5488, huber: 0.2688, swd: 0.2939, ept: 232.8713
    Epoch [2/50], Val Losses: mse: 0.5523, mae: 0.5711, huber: 0.2545, swd: 0.0931, ept: 212.3169
    Epoch [2/50], Test Losses: mse: 0.3173, mae: 0.4104, huber: 0.1517, swd: 0.1019, ept: 293.0538
      Epoch 2 composite train-obj: 0.268815
            No improvement (0.2545), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.6550, mae: 0.5098, huber: 0.2377, swd: 0.2633, ept: 250.7327
    Epoch [3/50], Val Losses: mse: 0.4377, mae: 0.5000, huber: 0.2065, swd: 0.1066, ept: 207.7128
    Epoch [3/50], Test Losses: mse: 0.2428, mae: 0.3552, huber: 0.1170, swd: 0.0546, ept: 298.9534
      Epoch 3 composite train-obj: 0.237706
            Val objective improved 0.2137 → 0.2065, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.5799, mae: 0.4708, huber: 0.2097, swd: 0.2442, ept: 266.2795
    Epoch [4/50], Val Losses: mse: 0.5242, mae: 0.5445, huber: 0.2406, swd: 0.0785, ept: 216.7668
    Epoch [4/50], Test Losses: mse: 0.3366, mae: 0.4293, huber: 0.1596, swd: 0.0872, ept: 307.9362
      Epoch 4 composite train-obj: 0.209675
            No improvement (0.2406), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.5651, mae: 0.4597, huber: 0.2026, swd: 0.2417, ept: 270.3838
    Epoch [5/50], Val Losses: mse: 0.5384, mae: 0.5540, huber: 0.2474, swd: 0.0830, ept: 220.9093
    Epoch [5/50], Test Losses: mse: 0.3190, mae: 0.4188, huber: 0.1521, swd: 0.0865, ept: 300.3590
      Epoch 5 composite train-obj: 0.202561
            No improvement (0.2474), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.5160, mae: 0.4371, huber: 0.1863, swd: 0.2190, ept: 275.8489
    Epoch [6/50], Val Losses: mse: 0.5656, mae: 0.5664, huber: 0.2568, swd: 0.0844, ept: 227.0096
    Epoch [6/50], Test Losses: mse: 0.3117, mae: 0.4130, huber: 0.1488, swd: 0.0803, ept: 302.7572
      Epoch 6 composite train-obj: 0.186276
            No improvement (0.2568), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.4886, mae: 0.4266, huber: 0.1781, swd: 0.2066, ept: 277.0307
    Epoch [7/50], Val Losses: mse: 0.5511, mae: 0.5576, huber: 0.2503, swd: 0.0957, ept: 219.2580
    Epoch [7/50], Test Losses: mse: 0.2904, mae: 0.3914, huber: 0.1378, swd: 0.0862, ept: 303.2170
      Epoch 7 composite train-obj: 0.178130
            No improvement (0.2503), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.4987, mae: 0.4371, huber: 0.1840, swd: 0.2056, ept: 274.4727
    Epoch [8/50], Val Losses: mse: 0.4410, mae: 0.4971, huber: 0.2066, swd: 0.0714, ept: 237.5664
    Epoch [8/50], Test Losses: mse: 0.3008, mae: 0.4095, huber: 0.1445, swd: 0.0818, ept: 297.1870
      Epoch 8 composite train-obj: 0.183955
    Epoch [8/50], Test Losses: mse: 0.2428, mae: 0.3552, huber: 0.1170, swd: 0.0546, ept: 298.9534
    Best round's Test MSE: 0.2428, MAE: 0.3552, SWD: 0.0546
    Best round's Validation MSE: 0.4377, MAE: 0.5000, SWD: 0.1066
    Best round's Test verification MSE : 0.2428, MAE: 0.3552, SWD: 0.0546
    Time taken: 66.15 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred720_20250510_2213)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2640 ± 0.0183
      mae: 0.3703 ± 0.0141
      huber: 0.1268 ± 0.0082
      swd: 0.0683 ± 0.0120
      ept: 296.0478 ± 2.1573
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.4131 ± 0.0214
      mae: 0.4877 ± 0.0142
      huber: 0.1965 ± 0.0090
      swd: 0.0953 ± 0.0142
      ept: 215.5143 ± 8.7548
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 201.35 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred720_20250510_2213
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    enc_in=data_mgr.datasets['etth2']['channels'],
    dec_in=data_mgr.datasets['etth2']['channels'],
    c_out=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 80.8760, mae: 5.1378, huber: 4.6824, swd: 36.9161, ept: 199.5049
    Epoch [1/50], Val Losses: mse: 26.0125, mae: 3.7514, huber: 3.2949, swd: 8.6890, ept: 216.2609
    Epoch [1/50], Test Losses: mse: 24.3762, mae: 3.2376, huber: 2.8032, swd: 11.5099, ept: 296.9256
      Epoch 1 composite train-obj: 4.682395
            Val objective improved inf → 3.2949, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 65.3657, mae: 4.5554, huber: 4.1042, swd: 32.4168, ept: 236.1984
    Epoch [2/50], Val Losses: mse: 47.8071, mae: 4.8920, huber: 4.4249, swd: 23.3642, ept: 182.4363
    Epoch [2/50], Test Losses: mse: 38.5508, mae: 4.1444, huber: 3.6903, swd: 20.8767, ept: 256.1924
      Epoch 2 composite train-obj: 4.104163
            No improvement (4.4249), counter 1/5
    Epoch [3/50], Train Losses: mse: 60.7102, mae: 4.3577, huber: 3.9067, swd: 29.8832, ept: 248.4689
    Epoch [3/50], Val Losses: mse: 34.9257, mae: 4.2978, huber: 3.8358, swd: 16.5314, ept: 204.3058
    Epoch [3/50], Test Losses: mse: 25.9789, mae: 3.3733, huber: 2.9303, swd: 11.8574, ept: 287.1100
      Epoch 3 composite train-obj: 3.906719
            No improvement (3.8358), counter 2/5
    Epoch [4/50], Train Losses: mse: 54.5605, mae: 4.0167, huber: 3.5674, swd: 26.1984, ept: 263.8067
    Epoch [4/50], Val Losses: mse: 35.9254, mae: 4.3428, huber: 3.8798, swd: 17.2445, ept: 209.4025
    Epoch [4/50], Test Losses: mse: 24.7279, mae: 3.2957, huber: 2.8534, swd: 11.5782, ept: 293.0600
      Epoch 4 composite train-obj: 3.567352
            No improvement (3.8798), counter 3/5
    Epoch [5/50], Train Losses: mse: 49.3101, mae: 3.7656, huber: 3.3187, swd: 22.8294, ept: 272.8389
    Epoch [5/50], Val Losses: mse: 32.7730, mae: 4.2195, huber: 3.7555, swd: 15.4018, ept: 225.1504
    Epoch [5/50], Test Losses: mse: 23.2902, mae: 3.1863, huber: 2.7463, swd: 10.6301, ept: 300.4589
      Epoch 5 composite train-obj: 3.318749
            No improvement (3.7555), counter 4/5
    Epoch [6/50], Train Losses: mse: 48.0369, mae: 3.7021, huber: 3.2560, swd: 22.0233, ept: 272.7725
    Epoch [6/50], Val Losses: mse: 30.0996, mae: 3.9905, huber: 3.5284, swd: 12.8197, ept: 231.1539
    Epoch [6/50], Test Losses: mse: 21.5244, mae: 3.0426, huber: 2.6046, swd: 9.0860, ept: 307.3890
      Epoch 6 composite train-obj: 3.255959
    Epoch [6/50], Test Losses: mse: 24.3762, mae: 3.2376, huber: 2.8032, swd: 11.5099, ept: 296.9256
    Best round's Test MSE: 24.3762, MAE: 3.2376, SWD: 11.5099
    Best round's Validation MSE: 26.0125, MAE: 3.7514, SWD: 8.6890
    Best round's Test verification MSE : 24.3762, MAE: 3.2376, SWD: 11.5099
    Time taken: 51.14 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 81.2685, mae: 5.1578, huber: 4.7024, swd: 34.1810, ept: 198.6907
    Epoch [1/50], Val Losses: mse: 25.7025, mae: 3.6944, huber: 3.2353, swd: 6.5883, ept: 201.7768
    Epoch [1/50], Test Losses: mse: 22.3917, mae: 3.0754, huber: 2.6439, swd: 8.3756, ept: 294.1906
      Epoch 1 composite train-obj: 4.702382
            Val objective improved inf → 3.2353, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 63.4099, mae: 4.5082, huber: 4.0565, swd: 28.5757, ept: 239.4883
    Epoch [2/50], Val Losses: mse: 36.2499, mae: 4.2854, huber: 3.8227, swd: 15.0304, ept: 199.7587
    Epoch [2/50], Test Losses: mse: 28.2181, mae: 3.6455, huber: 3.1930, swd: 11.8390, ept: 267.3141
      Epoch 2 composite train-obj: 4.056463
            No improvement (3.8227), counter 1/5
    Epoch [3/50], Train Losses: mse: 57.4284, mae: 4.2130, huber: 3.7623, swd: 25.9048, ept: 259.1909
    Epoch [3/50], Val Losses: mse: 35.0723, mae: 4.3470, huber: 3.8840, swd: 16.0275, ept: 160.7463
    Epoch [3/50], Test Losses: mse: 25.3104, mae: 3.3933, huber: 2.9475, swd: 10.7237, ept: 282.9170
      Epoch 3 composite train-obj: 3.762286
            No improvement (3.8840), counter 2/5
    Epoch [4/50], Train Losses: mse: 51.4363, mae: 3.9542, huber: 3.5049, swd: 22.5484, ept: 266.7901
    Epoch [4/50], Val Losses: mse: 35.0101, mae: 4.3570, huber: 3.8932, swd: 15.4307, ept: 164.6776
    Epoch [4/50], Test Losses: mse: 26.1157, mae: 3.4461, huber: 2.9967, swd: 10.5221, ept: 270.3234
      Epoch 4 composite train-obj: 3.504894
            No improvement (3.8932), counter 3/5
    Epoch [5/50], Train Losses: mse: 51.3601, mae: 3.9291, huber: 3.4802, swd: 22.2451, ept: 268.7178
    Epoch [5/50], Val Losses: mse: 32.0254, mae: 4.1664, huber: 3.7044, swd: 14.0928, ept: 217.3236
    Epoch [5/50], Test Losses: mse: 25.4803, mae: 3.3345, huber: 2.8955, swd: 10.8800, ept: 305.6075
      Epoch 5 composite train-obj: 3.480160
            No improvement (3.7044), counter 4/5
    Epoch [6/50], Train Losses: mse: 45.2385, mae: 3.6282, huber: 3.1822, swd: 19.0236, ept: 277.5347
    Epoch [6/50], Val Losses: mse: 28.9887, mae: 4.0205, huber: 3.5519, swd: 10.5154, ept: 247.8104
    Epoch [6/50], Test Losses: mse: 22.6363, mae: 3.1183, huber: 2.6818, swd: 8.8152, ept: 312.7398
      Epoch 6 composite train-obj: 3.182213
    Epoch [6/50], Test Losses: mse: 22.3917, mae: 3.0754, huber: 2.6439, swd: 8.3756, ept: 294.1906
    Best round's Test MSE: 22.3917, MAE: 3.0754, SWD: 8.3756
    Best round's Validation MSE: 25.7025, MAE: 3.6944, SWD: 6.5883
    Best round's Test verification MSE : 22.3917, MAE: 3.0754, SWD: 8.3756
    Time taken: 50.53 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 81.3762, mae: 5.1490, huber: 4.6937, swd: 39.3189, ept: 199.0176
    Epoch [1/50], Val Losses: mse: 34.0757, mae: 4.2971, huber: 3.8287, swd: 13.6877, ept: 187.8550
    Epoch [1/50], Test Losses: mse: 27.7392, mae: 3.4630, huber: 3.0253, swd: 13.0438, ept: 274.4117
      Epoch 1 composite train-obj: 4.693670
            Val objective improved inf → 3.8287, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 69.4740, mae: 4.7220, huber: 4.2700, swd: 36.4034, ept: 228.3360
    Epoch [2/50], Val Losses: mse: 34.9784, mae: 4.2918, huber: 3.8257, swd: 14.5285, ept: 199.2150
    Epoch [2/50], Test Losses: mse: 28.5144, mae: 3.4860, huber: 3.0463, swd: 13.3656, ept: 278.2103
      Epoch 2 composite train-obj: 4.269971
            Val objective improved 3.8287 → 3.8257, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 60.2010, mae: 4.3419, huber: 3.8908, swd: 30.4289, ept: 247.5112
    Epoch [3/50], Val Losses: mse: 26.6846, mae: 3.8589, huber: 3.3908, swd: 6.5525, ept: 218.7540
    Epoch [3/50], Test Losses: mse: 21.4877, mae: 2.9794, huber: 2.5431, swd: 7.7282, ept: 289.6149
      Epoch 3 composite train-obj: 3.890789
            Val objective improved 3.8257 → 3.3908, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 54.0990, mae: 4.0333, huber: 3.5831, swd: 26.9534, ept: 263.0655
    Epoch [4/50], Val Losses: mse: 32.1818, mae: 4.1759, huber: 3.7101, swd: 13.6326, ept: 229.5344
    Epoch [4/50], Test Losses: mse: 26.5684, mae: 3.3714, huber: 2.9276, swd: 13.9798, ept: 297.3959
      Epoch 4 composite train-obj: 3.583136
            No improvement (3.7101), counter 1/5
    Epoch [5/50], Train Losses: mse: 51.0166, mae: 3.8368, huber: 3.3890, swd: 25.1025, ept: 269.9467
    Epoch [5/50], Val Losses: mse: 32.2402, mae: 4.1762, huber: 3.7112, swd: 13.0983, ept: 196.0401
    Epoch [5/50], Test Losses: mse: 22.6600, mae: 3.1666, huber: 2.7228, swd: 10.0431, ept: 300.0478
      Epoch 5 composite train-obj: 3.389047
            No improvement (3.7112), counter 2/5
    Epoch [6/50], Train Losses: mse: 46.7756, mae: 3.6376, huber: 3.1919, swd: 22.4676, ept: 276.1818
    Epoch [6/50], Val Losses: mse: 33.5889, mae: 4.3125, huber: 3.8440, swd: 13.9238, ept: 203.8765
    Epoch [6/50], Test Losses: mse: 24.6641, mae: 3.2814, huber: 2.8347, swd: 11.3956, ept: 295.2158
      Epoch 6 composite train-obj: 3.191881
            No improvement (3.8440), counter 3/5
    Epoch [7/50], Train Losses: mse: 45.2867, mae: 3.5602, huber: 3.1151, swd: 21.5049, ept: 277.9178
    Epoch [7/50], Val Losses: mse: 33.6841, mae: 4.3398, huber: 3.8694, swd: 11.9137, ept: 201.4686
    Epoch [7/50], Test Losses: mse: 22.7617, mae: 3.1360, huber: 2.6945, swd: 8.7584, ept: 301.7533
      Epoch 7 composite train-obj: 3.115052
            No improvement (3.8694), counter 4/5
    Epoch [8/50], Train Losses: mse: 45.1076, mae: 3.5702, huber: 3.1251, swd: 21.4715, ept: 278.5557
    Epoch [8/50], Val Losses: mse: 28.8512, mae: 4.0557, huber: 3.5863, swd: 8.2079, ept: 213.5384
    Epoch [8/50], Test Losses: mse: 23.0723, mae: 3.1780, huber: 2.7342, swd: 10.0195, ept: 300.3612
      Epoch 8 composite train-obj: 3.125133
    Epoch [8/50], Test Losses: mse: 21.4877, mae: 2.9794, huber: 2.5431, swd: 7.7282, ept: 289.6149
    Best round's Test MSE: 21.4877, MAE: 2.9794, SWD: 7.7282
    Best round's Validation MSE: 26.6846, MAE: 3.8589, SWD: 6.5525
    Best round's Test verification MSE : 21.4877, MAE: 2.9794, SWD: 7.7282
    Time taken: 66.84 seconds
    
    ==================================================
    Experiment Summary (PatchTST_etth2_seq720_pred720_20250510_2251)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 22.7519 ± 1.2064
      mae: 3.0975 ± 0.1066
      huber: 2.6634 ± 0.1070
      swd: 9.2045 ± 1.6514
      ept: 293.5770 ± 3.0159
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 26.1332 ± 0.4099
      mae: 3.7682 ± 0.0682
      huber: 3.3070 ± 0.0641
      swd: 7.2766 ± 0.9988
      ept: 212.2639 ± 7.4850
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 168.77 seconds
    
    Experiment complete: PatchTST_etth2_seq720_pred720_20250510_2251
    Model: PatchTST
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### DLinear

#### pred=96


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3660, mae: 0.3709, huber: 0.1412, swd: 0.1453, ept: 68.7992
    Epoch [1/50], Val Losses: mse: 0.2515, mae: 0.3626, huber: 0.1216, swd: 0.0967, ept: 66.3390
    Epoch [1/50], Test Losses: mse: 0.1561, mae: 0.2817, huber: 0.0766, swd: 0.0525, ept: 77.0931
      Epoch 1 composite train-obj: 0.141210
            Val objective improved inf → 0.1216, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2779, mae: 0.3116, huber: 0.1068, swd: 0.1152, ept: 79.9296
    Epoch [2/50], Val Losses: mse: 0.2387, mae: 0.3501, huber: 0.1152, swd: 0.0896, ept: 68.9714
    Epoch [2/50], Test Losses: mse: 0.1512, mae: 0.2765, huber: 0.0742, swd: 0.0522, ept: 77.9353
      Epoch 2 composite train-obj: 0.106837
            Val objective improved 0.1216 → 0.1152, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2701, mae: 0.3052, huber: 0.1036, swd: 0.1103, ept: 80.9333
    Epoch [3/50], Val Losses: mse: 0.2390, mae: 0.3477, huber: 0.1152, swd: 0.0899, ept: 68.1471
    Epoch [3/50], Test Losses: mse: 0.1465, mae: 0.2715, huber: 0.0720, swd: 0.0471, ept: 78.4253
      Epoch 3 composite train-obj: 0.103644
            No improvement (0.1152), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.2662, mae: 0.3025, huber: 0.1022, swd: 0.1084, ept: 81.3828
    Epoch [4/50], Val Losses: mse: 0.2369, mae: 0.3474, huber: 0.1144, swd: 0.0885, ept: 68.6911
    Epoch [4/50], Test Losses: mse: 0.1477, mae: 0.2751, huber: 0.0728, swd: 0.0496, ept: 78.3401
      Epoch 4 composite train-obj: 0.102210
            Val objective improved 0.1152 → 0.1144, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.2643, mae: 0.3021, huber: 0.1016, swd: 0.1077, ept: 81.5796
    Epoch [5/50], Val Losses: mse: 0.2370, mae: 0.3477, huber: 0.1146, swd: 0.0883, ept: 68.7193
    Epoch [5/50], Test Losses: mse: 0.1529, mae: 0.2794, huber: 0.0750, swd: 0.0551, ept: 77.7218
      Epoch 5 composite train-obj: 0.101617
            No improvement (0.1146), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.2637, mae: 0.3008, huber: 0.1011, swd: 0.1066, ept: 81.7652
    Epoch [6/50], Val Losses: mse: 0.2562, mae: 0.3642, huber: 0.1243, swd: 0.0976, ept: 67.5129
    Epoch [6/50], Test Losses: mse: 0.1447, mae: 0.2701, huber: 0.0712, swd: 0.0475, ept: 78.4877
      Epoch 6 composite train-obj: 0.101125
            No improvement (0.1243), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.2624, mae: 0.3003, huber: 0.1008, swd: 0.1066, ept: 81.8985
    Epoch [7/50], Val Losses: mse: 0.2342, mae: 0.3460, huber: 0.1132, swd: 0.0829, ept: 70.2794
    Epoch [7/50], Test Losses: mse: 0.1491, mae: 0.2774, huber: 0.0735, swd: 0.0506, ept: 78.1429
      Epoch 7 composite train-obj: 0.100831
            Val objective improved 0.1144 → 0.1132, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 0.2632, mae: 0.3008, huber: 0.1009, swd: 0.1063, ept: 81.8017
    Epoch [8/50], Val Losses: mse: 0.2326, mae: 0.3443, huber: 0.1125, swd: 0.0855, ept: 69.7734
    Epoch [8/50], Test Losses: mse: 0.1509, mae: 0.2740, huber: 0.0740, swd: 0.0537, ept: 77.5463
      Epoch 8 composite train-obj: 0.100932
            Val objective improved 0.1132 → 0.1125, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 0.2624, mae: 0.3007, huber: 0.1008, swd: 0.1060, ept: 81.9373
    Epoch [9/50], Val Losses: mse: 0.2341, mae: 0.3459, huber: 0.1135, swd: 0.0846, ept: 68.9566
    Epoch [9/50], Test Losses: mse: 0.1491, mae: 0.2749, huber: 0.0732, swd: 0.0502, ept: 78.1783
      Epoch 9 composite train-obj: 0.100769
            No improvement (0.1135), counter 1/5
    Epoch [10/50], Train Losses: mse: 0.2617, mae: 0.2997, huber: 0.1005, swd: 0.1055, ept: 81.9362
    Epoch [10/50], Val Losses: mse: 0.2332, mae: 0.3440, huber: 0.1127, swd: 0.0828, ept: 69.1769
    Epoch [10/50], Test Losses: mse: 0.1437, mae: 0.2706, huber: 0.0708, swd: 0.0470, ept: 78.4364
      Epoch 10 composite train-obj: 0.100500
            No improvement (0.1127), counter 2/5
    Epoch [11/50], Train Losses: mse: 0.2614, mae: 0.3000, huber: 0.1005, swd: 0.1065, ept: 81.9495
    Epoch [11/50], Val Losses: mse: 0.2510, mae: 0.3612, huber: 0.1214, swd: 0.0910, ept: 67.0865
    Epoch [11/50], Test Losses: mse: 0.1503, mae: 0.2787, huber: 0.0739, swd: 0.0514, ept: 78.1818
      Epoch 11 composite train-obj: 0.100512
            No improvement (0.1214), counter 3/5
    Epoch [12/50], Train Losses: mse: 0.2622, mae: 0.2999, huber: 0.1005, swd: 0.1054, ept: 82.0048
    Epoch [12/50], Val Losses: mse: 0.2464, mae: 0.3631, huber: 0.1192, swd: 0.1043, ept: 68.9521
    Epoch [12/50], Test Losses: mse: 0.1498, mae: 0.2735, huber: 0.0735, swd: 0.0549, ept: 76.7075
      Epoch 12 composite train-obj: 0.100512
            No improvement (0.1192), counter 4/5
    Epoch [13/50], Train Losses: mse: 0.2619, mae: 0.3004, huber: 0.1006, swd: 0.1058, ept: 81.9607
    Epoch [13/50], Val Losses: mse: 0.2367, mae: 0.3469, huber: 0.1141, swd: 0.0915, ept: 68.2190
    Epoch [13/50], Test Losses: mse: 0.1621, mae: 0.2837, huber: 0.0790, swd: 0.0655, ept: 76.7034
      Epoch 13 composite train-obj: 0.100598
    Epoch [13/50], Test Losses: mse: 0.1509, mae: 0.2740, huber: 0.0740, swd: 0.0537, ept: 77.5463
    Best round's Test MSE: 0.1509, MAE: 0.2740, SWD: 0.0537
    Best round's Validation MSE: 0.2326, MAE: 0.3443, SWD: 0.0855
    Best round's Test verification MSE : 0.1509, MAE: 0.2740, SWD: 0.0537
    Time taken: 15.94 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3652, mae: 0.3706, huber: 0.1408, swd: 0.1428, ept: 68.6251
    Epoch [1/50], Val Losses: mse: 0.2449, mae: 0.3590, huber: 0.1184, swd: 0.0915, ept: 66.7249
    Epoch [1/50], Test Losses: mse: 0.1540, mae: 0.2788, huber: 0.0755, swd: 0.0505, ept: 76.0355
      Epoch 1 composite train-obj: 0.140817
            Val objective improved inf → 0.1184, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2787, mae: 0.3118, huber: 0.1071, swd: 0.1143, ept: 79.7836
    Epoch [2/50], Val Losses: mse: 0.2472, mae: 0.3571, huber: 0.1197, swd: 0.0913, ept: 67.1898
    Epoch [2/50], Test Losses: mse: 0.1482, mae: 0.2750, huber: 0.0729, swd: 0.0469, ept: 78.0490
      Epoch 2 composite train-obj: 0.107105
            No improvement (0.1197), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.2694, mae: 0.3053, huber: 0.1036, swd: 0.1092, ept: 80.9303
    Epoch [3/50], Val Losses: mse: 0.2397, mae: 0.3508, huber: 0.1158, swd: 0.0901, ept: 68.6544
    Epoch [3/50], Test Losses: mse: 0.1455, mae: 0.2699, huber: 0.0715, swd: 0.0484, ept: 77.7820
      Epoch 3 composite train-obj: 0.103595
            Val objective improved 0.1184 → 0.1158, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2669, mae: 0.3029, huber: 0.1024, swd: 0.1078, ept: 81.3718
    Epoch [4/50], Val Losses: mse: 0.2485, mae: 0.3577, huber: 0.1198, swd: 0.0958, ept: 68.8848
    Epoch [4/50], Test Losses: mse: 0.1435, mae: 0.2694, huber: 0.0707, swd: 0.0461, ept: 78.5498
      Epoch 4 composite train-obj: 0.102373
            No improvement (0.1198), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2648, mae: 0.3011, huber: 0.1015, swd: 0.1064, ept: 81.5476
    Epoch [5/50], Val Losses: mse: 0.2378, mae: 0.3483, huber: 0.1150, swd: 0.0871, ept: 69.2631
    Epoch [5/50], Test Losses: mse: 0.1491, mae: 0.2741, huber: 0.0731, swd: 0.0516, ept: 77.9878
      Epoch 5 composite train-obj: 0.101483
            Val objective improved 0.1158 → 0.1150, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.2637, mae: 0.3012, huber: 0.1012, swd: 0.1060, ept: 81.7103
    Epoch [6/50], Val Losses: mse: 0.2417, mae: 0.3548, huber: 0.1172, swd: 0.0920, ept: 68.7539
    Epoch [6/50], Test Losses: mse: 0.1496, mae: 0.2731, huber: 0.0733, swd: 0.0537, ept: 77.4211
      Epoch 6 composite train-obj: 0.101209
            No improvement (0.1172), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.2628, mae: 0.3003, huber: 0.1008, swd: 0.1054, ept: 81.8315
    Epoch [7/50], Val Losses: mse: 0.2466, mae: 0.3586, huber: 0.1192, swd: 0.0970, ept: 68.8838
    Epoch [7/50], Test Losses: mse: 0.1506, mae: 0.2768, huber: 0.0738, swd: 0.0522, ept: 77.9649
      Epoch 7 composite train-obj: 0.100828
            No improvement (0.1192), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.2630, mae: 0.3013, huber: 0.1010, swd: 0.1057, ept: 81.8030
    Epoch [8/50], Val Losses: mse: 0.2443, mae: 0.3538, huber: 0.1175, swd: 0.0959, ept: 68.3458
    Epoch [8/50], Test Losses: mse: 0.1548, mae: 0.2767, huber: 0.0755, swd: 0.0578, ept: 77.3529
      Epoch 8 composite train-obj: 0.101029
            No improvement (0.1175), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.2615, mae: 0.2994, huber: 0.1004, swd: 0.1052, ept: 81.9386
    Epoch [9/50], Val Losses: mse: 0.2509, mae: 0.3580, huber: 0.1209, swd: 0.0888, ept: 65.1958
    Epoch [9/50], Test Losses: mse: 0.1582, mae: 0.2831, huber: 0.0774, swd: 0.0567, ept: 77.3176
      Epoch 9 composite train-obj: 0.100356
            No improvement (0.1209), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.2637, mae: 0.3018, huber: 0.1014, swd: 0.1058, ept: 81.7332
    Epoch [10/50], Val Losses: mse: 0.2459, mae: 0.3549, huber: 0.1186, swd: 0.0939, ept: 67.6908
    Epoch [10/50], Test Losses: mse: 0.1549, mae: 0.2785, huber: 0.0757, swd: 0.0557, ept: 77.3209
      Epoch 10 composite train-obj: 0.101358
    Epoch [10/50], Test Losses: mse: 0.1491, mae: 0.2741, huber: 0.0731, swd: 0.0516, ept: 77.9878
    Best round's Test MSE: 0.1491, MAE: 0.2741, SWD: 0.0516
    Best round's Validation MSE: 0.2378, MAE: 0.3483, SWD: 0.0871
    Best round's Test verification MSE : 0.1491, MAE: 0.2741, SWD: 0.0516
    Time taken: 12.75 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.3683, mae: 0.3712, huber: 0.1415, swd: 0.1348, ept: 69.0555
    Epoch [1/50], Val Losses: mse: 0.2641, mae: 0.3728, huber: 0.1280, swd: 0.0961, ept: 64.7718
    Epoch [1/50], Test Losses: mse: 0.1535, mae: 0.2810, huber: 0.0755, swd: 0.0448, ept: 77.1805
      Epoch 1 composite train-obj: 0.141523
            Val objective improved inf → 0.1280, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.2790, mae: 0.3114, huber: 0.1070, swd: 0.1057, ept: 79.9431
    Epoch [2/50], Val Losses: mse: 0.2428, mae: 0.3525, huber: 0.1173, swd: 0.0811, ept: 68.3215
    Epoch [2/50], Test Losses: mse: 0.1478, mae: 0.2745, huber: 0.0728, swd: 0.0425, ept: 77.9546
      Epoch 2 composite train-obj: 0.107045
            Val objective improved 0.1280 → 0.1173, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.2689, mae: 0.3046, huber: 0.1034, swd: 0.1014, ept: 80.9876
    Epoch [3/50], Val Losses: mse: 0.2409, mae: 0.3528, huber: 0.1166, swd: 0.0841, ept: 68.8183
    Epoch [3/50], Test Losses: mse: 0.1476, mae: 0.2729, huber: 0.0725, swd: 0.0458, ept: 77.9199
      Epoch 3 composite train-obj: 0.103351
            Val objective improved 0.1173 → 0.1166, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.2665, mae: 0.3028, huber: 0.1023, swd: 0.0998, ept: 81.3685
    Epoch [4/50], Val Losses: mse: 0.2453, mae: 0.3553, huber: 0.1180, swd: 0.0899, ept: 67.2193
    Epoch [4/50], Test Losses: mse: 0.1509, mae: 0.2782, huber: 0.0742, swd: 0.0493, ept: 77.3491
      Epoch 4 composite train-obj: 0.102303
            No improvement (0.1180), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.2644, mae: 0.3015, huber: 0.1015, swd: 0.0988, ept: 81.6675
    Epoch [5/50], Val Losses: mse: 0.2366, mae: 0.3461, huber: 0.1147, swd: 0.0779, ept: 68.2201
    Epoch [5/50], Test Losses: mse: 0.1477, mae: 0.2734, huber: 0.0727, swd: 0.0463, ept: 77.9531
      Epoch 5 composite train-obj: 0.101512
            Val objective improved 0.1166 → 0.1147, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.2631, mae: 0.3000, huber: 0.1009, swd: 0.0978, ept: 81.7488
    Epoch [6/50], Val Losses: mse: 0.2337, mae: 0.3469, huber: 0.1133, swd: 0.0739, ept: 68.4493
    Epoch [6/50], Test Losses: mse: 0.1479, mae: 0.2734, huber: 0.0727, swd: 0.0422, ept: 78.6287
      Epoch 6 composite train-obj: 0.100878
            Val objective improved 0.1147 → 0.1133, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.2636, mae: 0.3014, huber: 0.1011, swd: 0.0985, ept: 81.7313
    Epoch [7/50], Val Losses: mse: 0.2427, mae: 0.3539, huber: 0.1178, swd: 0.0824, ept: 68.6926
    Epoch [7/50], Test Losses: mse: 0.1468, mae: 0.2729, huber: 0.0722, swd: 0.0455, ept: 77.8359
      Epoch 7 composite train-obj: 0.101120
            No improvement (0.1178), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.2632, mae: 0.3003, huber: 0.1009, swd: 0.0975, ept: 81.8485
    Epoch [8/50], Val Losses: mse: 0.2443, mae: 0.3538, huber: 0.1173, swd: 0.0863, ept: 68.4200
    Epoch [8/50], Test Losses: mse: 0.1494, mae: 0.2733, huber: 0.0734, swd: 0.0473, ept: 77.6668
      Epoch 8 composite train-obj: 0.100895
            No improvement (0.1173), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.2626, mae: 0.3000, huber: 0.1008, swd: 0.0976, ept: 81.9296
    Epoch [9/50], Val Losses: mse: 0.2408, mae: 0.3505, huber: 0.1165, swd: 0.0799, ept: 68.5208
    Epoch [9/50], Test Losses: mse: 0.1461, mae: 0.2721, huber: 0.0719, swd: 0.0443, ept: 77.6692
      Epoch 9 composite train-obj: 0.100755
            No improvement (0.1165), counter 3/5
    Epoch [10/50], Train Losses: mse: 0.2628, mae: 0.3015, huber: 0.1010, swd: 0.0978, ept: 81.8985
    Epoch [10/50], Val Losses: mse: 0.2343, mae: 0.3491, huber: 0.1137, swd: 0.0752, ept: 69.3918
    Epoch [10/50], Test Losses: mse: 0.1459, mae: 0.2728, huber: 0.0719, swd: 0.0426, ept: 78.5501
      Epoch 10 composite train-obj: 0.101046
            No improvement (0.1137), counter 4/5
    Epoch [11/50], Train Losses: mse: 0.2619, mae: 0.3001, huber: 0.1006, swd: 0.0977, ept: 81.9498
    Epoch [11/50], Val Losses: mse: 0.2362, mae: 0.3452, huber: 0.1139, swd: 0.0765, ept: 68.9121
    Epoch [11/50], Test Losses: mse: 0.1499, mae: 0.2764, huber: 0.0737, swd: 0.0426, ept: 78.5828
      Epoch 11 composite train-obj: 0.100556
    Epoch [11/50], Test Losses: mse: 0.1479, mae: 0.2734, huber: 0.0727, swd: 0.0422, ept: 78.6287
    Best round's Test MSE: 0.1479, MAE: 0.2734, SWD: 0.0422
    Best round's Validation MSE: 0.2337, MAE: 0.3469, SWD: 0.0739
    Best round's Test verification MSE : 0.1479, MAE: 0.2734, SWD: 0.0422
    Time taken: 13.04 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred96_20250510_2254)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1493 ± 0.0013
      mae: 0.2738 ± 0.0003
      huber: 0.0733 ± 0.0005
      swd: 0.0492 ± 0.0050
      ept: 78.0543 ± 0.4444
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.2347 ± 0.0022
      mae: 0.3465 ± 0.0017
      huber: 0.1136 ± 0.0010
      swd: 0.0821 ± 0.0059
      ept: 69.1619 ± 0.5453
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 41.78 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred96_20250510_2254
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=96,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 67.6831, mae: 4.3246, huber: 3.8858, swd: 28.6548, ept: 52.9522
    Epoch [1/50], Val Losses: mse: 21.3765, mae: 3.1858, huber: 2.7433, swd: 9.3119, ept: 58.9251
    Epoch [1/50], Test Losses: mse: 15.9801, mae: 2.6243, huber: 2.1968, swd: 7.8531, ept: 70.5708
      Epoch 1 composite train-obj: 3.885809
            Val objective improved inf → 2.7433, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 26.3744, mae: 2.8309, huber: 2.4072, swd: 14.4824, ept: 74.2678
    Epoch [2/50], Val Losses: mse: 19.3624, mae: 3.0084, huber: 2.5717, swd: 8.8260, ept: 66.8866
    Epoch [2/50], Test Losses: mse: 14.6739, mae: 2.5268, huber: 2.1005, swd: 7.4105, ept: 75.6228
      Epoch 2 composite train-obj: 2.407225
            Val objective improved 2.7433 → 2.5717, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 24.3061, mae: 2.6917, huber: 2.2713, swd: 13.3328, ept: 77.1581
    Epoch [3/50], Val Losses: mse: 18.4064, mae: 2.8878, huber: 2.4523, swd: 7.8278, ept: 68.7810
    Epoch [3/50], Test Losses: mse: 14.4062, mae: 2.4559, huber: 2.0309, swd: 7.0066, ept: 75.5103
      Epoch 3 composite train-obj: 2.271283
            Val objective improved 2.5717 → 2.4523, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 23.5543, mae: 2.6398, huber: 2.2211, swd: 12.7675, ept: 78.2057
    Epoch [4/50], Val Losses: mse: 18.3838, mae: 2.9055, huber: 2.4715, swd: 7.9137, ept: 69.5719
    Epoch [4/50], Test Losses: mse: 13.9653, mae: 2.4269, huber: 2.0047, swd: 6.6572, ept: 76.7876
      Epoch 4 composite train-obj: 2.221071
            No improvement (2.4715), counter 1/5
    Epoch [5/50], Train Losses: mse: 23.4998, mae: 2.6460, huber: 2.2272, swd: 12.7094, ept: 78.0651
    Epoch [5/50], Val Losses: mse: 17.7108, mae: 2.8275, huber: 2.3935, swd: 7.5798, ept: 70.8568
    Epoch [5/50], Test Losses: mse: 14.1583, mae: 2.4591, huber: 2.0322, swd: 6.9001, ept: 76.9241
      Epoch 5 composite train-obj: 2.227244
            Val objective improved 2.4523 → 2.3935, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 22.9308, mae: 2.6030, huber: 2.1849, swd: 12.3369, ept: 78.7765
    Epoch [6/50], Val Losses: mse: 17.8900, mae: 2.8448, huber: 2.4112, swd: 7.6461, ept: 70.2260
    Epoch [6/50], Test Losses: mse: 13.8227, mae: 2.4191, huber: 1.9946, swd: 6.5227, ept: 76.9301
      Epoch 6 composite train-obj: 2.184862
            No improvement (2.4112), counter 1/5
    Epoch [7/50], Train Losses: mse: 22.6152, mae: 2.5784, huber: 2.1608, swd: 12.1126, ept: 78.9855
    Epoch [7/50], Val Losses: mse: 17.9324, mae: 2.8439, huber: 2.4114, swd: 7.9155, ept: 70.6303
    Epoch [7/50], Test Losses: mse: 14.7630, mae: 2.5052, huber: 2.0789, swd: 7.3879, ept: 77.1142
      Epoch 7 composite train-obj: 2.160793
            No improvement (2.4114), counter 2/5
    Epoch [8/50], Train Losses: mse: 22.5520, mae: 2.5662, huber: 2.1493, swd: 12.0713, ept: 79.3096
    Epoch [8/50], Val Losses: mse: 18.0108, mae: 2.8516, huber: 2.4182, swd: 7.8044, ept: 70.3792
    Epoch [8/50], Test Losses: mse: 13.5472, mae: 2.3863, huber: 1.9638, swd: 6.3339, ept: 77.2222
      Epoch 8 composite train-obj: 2.149350
            No improvement (2.4182), counter 3/5
    Epoch [9/50], Train Losses: mse: 22.5907, mae: 2.5768, huber: 2.1594, swd: 12.0956, ept: 78.9573
    Epoch [9/50], Val Losses: mse: 17.8144, mae: 2.8216, huber: 2.3887, swd: 7.5943, ept: 70.2839
    Epoch [9/50], Test Losses: mse: 13.7758, mae: 2.3980, huber: 1.9745, swd: 6.4212, ept: 77.1603
      Epoch 9 composite train-obj: 2.159400
            Val objective improved 2.3935 → 2.3887, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 22.3553, mae: 2.5568, huber: 2.1399, swd: 11.8843, ept: 79.4001
    Epoch [10/50], Val Losses: mse: 17.8717, mae: 2.8327, huber: 2.4002, swd: 7.8984, ept: 70.7953
    Epoch [10/50], Test Losses: mse: 13.2733, mae: 2.3498, huber: 1.9279, swd: 6.1591, ept: 77.6779
      Epoch 10 composite train-obj: 2.139856
            No improvement (2.4002), counter 1/5
    Epoch [11/50], Train Losses: mse: 22.1922, mae: 2.5477, huber: 2.1307, swd: 11.7891, ept: 79.5157
    Epoch [11/50], Val Losses: mse: 18.3607, mae: 2.8723, huber: 2.4392, swd: 8.0590, ept: 69.8252
    Epoch [11/50], Test Losses: mse: 13.6214, mae: 2.4145, huber: 1.9892, swd: 6.2923, ept: 76.7741
      Epoch 11 composite train-obj: 2.130727
            No improvement (2.4392), counter 2/5
    Epoch [12/50], Train Losses: mse: 22.4254, mae: 2.5639, huber: 2.1468, swd: 11.9181, ept: 79.2666
    Epoch [12/50], Val Losses: mse: 17.8987, mae: 2.8316, huber: 2.3990, swd: 7.7905, ept: 69.7906
    Epoch [12/50], Test Losses: mse: 13.8323, mae: 2.3961, huber: 1.9729, swd: 6.3476, ept: 77.0662
      Epoch 12 composite train-obj: 2.146786
            No improvement (2.3990), counter 3/5
    Epoch [13/50], Train Losses: mse: 22.2147, mae: 2.5491, huber: 2.1321, swd: 11.7722, ept: 79.4715
    Epoch [13/50], Val Losses: mse: 17.9538, mae: 2.8427, huber: 2.4094, swd: 7.8693, ept: 70.4211
    Epoch [13/50], Test Losses: mse: 13.7296, mae: 2.4155, huber: 1.9908, swd: 6.4600, ept: 77.2186
      Epoch 13 composite train-obj: 2.132086
            No improvement (2.4094), counter 4/5
    Epoch [14/50], Train Losses: mse: 22.0665, mae: 2.5354, huber: 2.1184, swd: 11.7138, ept: 79.5550
    Epoch [14/50], Val Losses: mse: 17.8695, mae: 2.8209, huber: 2.3882, swd: 7.8001, ept: 70.6057
    Epoch [14/50], Test Losses: mse: 13.5855, mae: 2.3862, huber: 1.9616, swd: 6.2907, ept: 76.8819
      Epoch 14 composite train-obj: 2.118402
            Val objective improved 2.3887 → 2.3882, saving checkpoint.
    Epoch [15/50], Train Losses: mse: 22.1205, mae: 2.5385, huber: 2.1215, swd: 11.7204, ept: 79.5831
    Epoch [15/50], Val Losses: mse: 18.2246, mae: 2.8563, huber: 2.4223, swd: 7.9172, ept: 70.1384
    Epoch [15/50], Test Losses: mse: 13.8174, mae: 2.4254, huber: 2.0004, swd: 6.4720, ept: 77.0890
      Epoch 15 composite train-obj: 2.121518
            No improvement (2.4223), counter 1/5
    Epoch [16/50], Train Losses: mse: 22.1349, mae: 2.5412, huber: 2.1243, swd: 11.7234, ept: 79.4967
    Epoch [16/50], Val Losses: mse: 17.9192, mae: 2.8240, huber: 2.3919, swd: 7.8238, ept: 70.0579
    Epoch [16/50], Test Losses: mse: 13.4180, mae: 2.3812, huber: 1.9567, swd: 6.2870, ept: 77.2205
      Epoch 16 composite train-obj: 2.124299
            No improvement (2.3919), counter 2/5
    Epoch [17/50], Train Losses: mse: 22.0176, mae: 2.5309, huber: 2.1142, swd: 11.6455, ept: 79.6955
    Epoch [17/50], Val Losses: mse: 17.9707, mae: 2.8345, huber: 2.4010, swd: 7.7874, ept: 69.8833
    Epoch [17/50], Test Losses: mse: 13.5416, mae: 2.3956, huber: 1.9701, swd: 6.2581, ept: 77.0184
      Epoch 17 composite train-obj: 2.114239
            No improvement (2.4010), counter 3/5
    Epoch [18/50], Train Losses: mse: 22.1483, mae: 2.5445, huber: 2.1271, swd: 11.7666, ept: 79.4357
    Epoch [18/50], Val Losses: mse: 18.3223, mae: 2.8642, huber: 2.4318, swd: 8.3648, ept: 70.5983
    Epoch [18/50], Test Losses: mse: 13.7641, mae: 2.4309, huber: 2.0047, swd: 6.6594, ept: 77.4809
      Epoch 18 composite train-obj: 2.127142
            No improvement (2.4318), counter 4/5
    Epoch [19/50], Train Losses: mse: 22.0962, mae: 2.5406, huber: 2.1234, swd: 11.6969, ept: 79.3223
    Epoch [19/50], Val Losses: mse: 18.6296, mae: 2.8873, huber: 2.4543, swd: 8.4189, ept: 69.6950
    Epoch [19/50], Test Losses: mse: 13.5881, mae: 2.4017, huber: 1.9777, swd: 6.3095, ept: 76.9914
      Epoch 19 composite train-obj: 2.123369
    Epoch [19/50], Test Losses: mse: 13.5855, mae: 2.3862, huber: 1.9616, swd: 6.2907, ept: 76.8819
    Best round's Test MSE: 13.5855, MAE: 2.3862, SWD: 6.2907
    Best round's Validation MSE: 17.8695, MAE: 2.8209, SWD: 7.8001
    Best round's Test verification MSE : 13.5855, MAE: 2.3862, SWD: 6.2907
    Time taken: 23.14 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 61.9382, mae: 4.2232, huber: 3.7845, swd: 25.3833, ept: 53.1610
    Epoch [1/50], Val Losses: mse: 20.8853, mae: 3.1485, huber: 2.7064, swd: 8.6192, ept: 59.6778
    Epoch [1/50], Test Losses: mse: 15.6363, mae: 2.5738, huber: 2.1488, swd: 6.9795, ept: 70.6113
      Epoch 1 composite train-obj: 3.784499
            Val objective improved inf → 2.7064, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 26.1812, mae: 2.8246, huber: 2.4010, swd: 13.8499, ept: 74.1707
    Epoch [2/50], Val Losses: mse: 19.2818, mae: 2.9911, huber: 2.5545, swd: 8.0377, ept: 65.9330
    Epoch [2/50], Test Losses: mse: 14.6103, mae: 2.4977, huber: 2.0727, swd: 6.7729, ept: 74.1950
      Epoch 2 composite train-obj: 2.401001
            Val objective improved 2.7064 → 2.5545, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 24.3279, mae: 2.6983, huber: 2.2780, swd: 12.8332, ept: 76.8233
    Epoch [3/50], Val Losses: mse: 18.6346, mae: 2.9213, huber: 2.4863, swd: 7.8122, ept: 69.0451
    Epoch [3/50], Test Losses: mse: 14.4041, mae: 2.4684, huber: 2.0448, swd: 6.7909, ept: 75.9974
      Epoch 3 composite train-obj: 2.278017
            Val objective improved 2.5545 → 2.4863, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 23.5542, mae: 2.6448, huber: 2.2258, swd: 12.3396, ept: 78.0316
    Epoch [4/50], Val Losses: mse: 18.0036, mae: 2.8645, huber: 2.4307, swd: 7.2036, ept: 69.3185
    Epoch [4/50], Test Losses: mse: 13.9277, mae: 2.4175, huber: 1.9952, swd: 6.4342, ept: 76.6630
      Epoch 4 composite train-obj: 2.225842
            Val objective improved 2.4863 → 2.4307, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 23.2161, mae: 2.6221, huber: 2.2039, swd: 12.0663, ept: 78.4003
    Epoch [5/50], Val Losses: mse: 17.8033, mae: 2.8504, huber: 2.4169, swd: 7.2717, ept: 70.6515
    Epoch [5/50], Test Losses: mse: 13.7835, mae: 2.4045, huber: 1.9819, swd: 6.3069, ept: 77.2028
      Epoch 5 composite train-obj: 2.203900
            Val objective improved 2.4307 → 2.4169, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 22.9786, mae: 2.6101, huber: 2.1918, swd: 11.9380, ept: 78.8073
    Epoch [6/50], Val Losses: mse: 18.4789, mae: 2.9005, huber: 2.4668, swd: 7.9136, ept: 70.0043
    Epoch [6/50], Test Losses: mse: 14.4786, mae: 2.4779, huber: 2.0533, swd: 6.9085, ept: 76.6893
      Epoch 6 composite train-obj: 2.191839
            No improvement (2.4668), counter 1/5
    Epoch [7/50], Train Losses: mse: 22.7251, mae: 2.5815, huber: 2.1640, swd: 11.7992, ept: 78.9562
    Epoch [7/50], Val Losses: mse: 17.9941, mae: 2.8439, huber: 2.4115, swd: 7.3964, ept: 70.3229
    Epoch [7/50], Test Losses: mse: 13.5662, mae: 2.3889, huber: 1.9657, swd: 6.0419, ept: 77.2400
      Epoch 7 composite train-obj: 2.164049
            Val objective improved 2.4169 → 2.4115, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 22.7283, mae: 2.5935, huber: 2.1754, swd: 11.6948, ept: 78.6808
    Epoch [8/50], Val Losses: mse: 18.3252, mae: 2.8739, huber: 2.4411, swd: 7.8840, ept: 70.3070
    Epoch [8/50], Test Losses: mse: 14.2627, mae: 2.4712, huber: 2.0466, swd: 6.7679, ept: 77.0586
      Epoch 8 composite train-obj: 2.175433
            No improvement (2.4411), counter 1/5
    Epoch [9/50], Train Losses: mse: 22.4568, mae: 2.5677, huber: 2.1501, swd: 11.5598, ept: 79.2045
    Epoch [9/50], Val Losses: mse: 17.9668, mae: 2.8378, huber: 2.4047, swd: 7.3190, ept: 69.1632
    Epoch [9/50], Test Losses: mse: 14.3270, mae: 2.4625, huber: 2.0369, swd: 6.7717, ept: 77.0571
      Epoch 9 composite train-obj: 2.150075
            Val objective improved 2.4115 → 2.4047, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 22.3099, mae: 2.5563, huber: 2.1390, swd: 11.5116, ept: 79.2565
    Epoch [10/50], Val Losses: mse: 17.7887, mae: 2.8245, huber: 2.3919, swd: 7.3973, ept: 70.5921
    Epoch [10/50], Test Losses: mse: 13.5045, mae: 2.3885, huber: 1.9651, swd: 6.1200, ept: 77.0984
      Epoch 10 composite train-obj: 2.138984
            Val objective improved 2.4047 → 2.3919, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 22.2298, mae: 2.5447, huber: 2.1279, swd: 11.4548, ept: 79.4890
    Epoch [11/50], Val Losses: mse: 18.0280, mae: 2.8402, huber: 2.4071, swd: 7.3603, ept: 69.8033
    Epoch [11/50], Test Losses: mse: 13.7796, mae: 2.4045, huber: 1.9807, swd: 6.1352, ept: 77.3109
      Epoch 11 composite train-obj: 2.127856
            No improvement (2.4071), counter 1/5
    Epoch [12/50], Train Losses: mse: 22.1502, mae: 2.5384, huber: 2.1216, swd: 11.3808, ept: 79.5747
    Epoch [12/50], Val Losses: mse: 17.7866, mae: 2.8263, huber: 2.3935, swd: 7.3611, ept: 70.2687
    Epoch [12/50], Test Losses: mse: 13.8880, mae: 2.4062, huber: 1.9833, swd: 6.4033, ept: 76.9916
      Epoch 12 composite train-obj: 2.121606
            No improvement (2.3935), counter 2/5
    Epoch [13/50], Train Losses: mse: 22.1650, mae: 2.5407, huber: 2.1238, swd: 11.3795, ept: 79.6273
    Epoch [13/50], Val Losses: mse: 17.8358, mae: 2.8232, huber: 2.3895, swd: 7.2905, ept: 70.0269
    Epoch [13/50], Test Losses: mse: 13.5255, mae: 2.3865, huber: 1.9615, swd: 5.9752, ept: 77.0984
      Epoch 13 composite train-obj: 2.123762
            Val objective improved 2.3919 → 2.3895, saving checkpoint.
    Epoch [14/50], Train Losses: mse: 22.1733, mae: 2.5480, huber: 2.1306, swd: 11.3487, ept: 79.0892
    Epoch [14/50], Val Losses: mse: 17.9498, mae: 2.8328, huber: 2.3999, swd: 7.3976, ept: 70.0350
    Epoch [14/50], Test Losses: mse: 13.6574, mae: 2.4056, huber: 1.9797, swd: 5.9933, ept: 76.7874
      Epoch 14 composite train-obj: 2.130613
            No improvement (2.3999), counter 1/5
    Epoch [15/50], Train Losses: mse: 22.1218, mae: 2.5441, huber: 2.1267, swd: 11.3106, ept: 79.4299
    Epoch [15/50], Val Losses: mse: 18.4065, mae: 2.8646, huber: 2.4326, swd: 8.0181, ept: 70.1008
    Epoch [15/50], Test Losses: mse: 13.7707, mae: 2.4423, huber: 2.0151, swd: 6.3351, ept: 77.2846
      Epoch 15 composite train-obj: 2.126658
            No improvement (2.4326), counter 2/5
    Epoch [16/50], Train Losses: mse: 22.1976, mae: 2.5487, huber: 2.1313, swd: 11.3573, ept: 79.1737
    Epoch [16/50], Val Losses: mse: 18.0866, mae: 2.8455, huber: 2.4131, swd: 7.6124, ept: 70.0522
    Epoch [16/50], Test Losses: mse: 13.9278, mae: 2.4317, huber: 2.0064, swd: 6.3501, ept: 76.9734
      Epoch 16 composite train-obj: 2.131269
            No improvement (2.4131), counter 3/5
    Epoch [17/50], Train Losses: mse: 22.1347, mae: 2.5428, huber: 2.1257, swd: 11.3399, ept: 79.4843
    Epoch [17/50], Val Losses: mse: 19.0935, mae: 2.9345, huber: 2.5003, swd: 8.4664, ept: 69.7886
    Epoch [17/50], Test Losses: mse: 14.1071, mae: 2.4595, huber: 2.0343, swd: 6.6362, ept: 77.0344
      Epoch 17 composite train-obj: 2.125688
            No improvement (2.5003), counter 4/5
    Epoch [18/50], Train Losses: mse: 22.1809, mae: 2.5486, huber: 2.1312, swd: 11.3224, ept: 79.3634
    Epoch [18/50], Val Losses: mse: 18.0029, mae: 2.8265, huber: 2.3942, swd: 7.5138, ept: 70.2960
    Epoch [18/50], Test Losses: mse: 13.6274, mae: 2.3994, huber: 1.9748, swd: 6.1684, ept: 77.0567
      Epoch 18 composite train-obj: 2.131209
    Epoch [18/50], Test Losses: mse: 13.5255, mae: 2.3865, huber: 1.9615, swd: 5.9752, ept: 77.0984
    Best round's Test MSE: 13.5255, MAE: 2.3865, SWD: 5.9752
    Best round's Validation MSE: 17.8358, MAE: 2.8232, SWD: 7.2905
    Best round's Test verification MSE : 13.5255, MAE: 2.3865, SWD: 5.9752
    Time taken: 21.41 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 64.1540, mae: 4.2535, huber: 3.8146, swd: 23.9549, ept: 53.3632
    Epoch [1/50], Val Losses: mse: 21.2923, mae: 3.1849, huber: 2.7428, swd: 8.3863, ept: 59.5174
    Epoch [1/50], Test Losses: mse: 15.6449, mae: 2.5943, huber: 2.1689, swd: 6.5658, ept: 70.8139
      Epoch 1 composite train-obj: 3.814631
            Val objective improved inf → 2.7428, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 26.2108, mae: 2.8300, huber: 2.4062, swd: 12.8985, ept: 74.0988
    Epoch [2/50], Val Losses: mse: 19.0282, mae: 2.9743, huber: 2.5376, swd: 7.3991, ept: 66.8258
    Epoch [2/50], Test Losses: mse: 14.3542, mae: 2.4583, huber: 2.0357, swd: 6.2430, ept: 74.6998
      Epoch 2 composite train-obj: 2.406217
            Val objective improved 2.7428 → 2.5376, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 24.3537, mae: 2.7008, huber: 2.2804, swd: 11.9476, ept: 77.0041
    Epoch [3/50], Val Losses: mse: 19.0080, mae: 2.9734, huber: 2.5379, swd: 7.8968, ept: 69.0153
    Epoch [3/50], Test Losses: mse: 14.6604, mae: 2.4999, huber: 2.0761, swd: 6.5238, ept: 76.5511
      Epoch 3 composite train-obj: 2.280389
            No improvement (2.5379), counter 1/5
    Epoch [4/50], Train Losses: mse: 23.6314, mae: 2.6524, huber: 2.2332, swd: 11.5519, ept: 77.8960
    Epoch [4/50], Val Losses: mse: 18.0848, mae: 2.8596, huber: 2.4259, swd: 6.9241, ept: 69.7553
    Epoch [4/50], Test Losses: mse: 13.9462, mae: 2.4336, huber: 2.0090, swd: 5.9620, ept: 76.7235
      Epoch 4 composite train-obj: 2.233217
            Val objective improved 2.5376 → 2.4259, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 23.1323, mae: 2.6100, huber: 2.1920, swd: 11.2710, ept: 78.7244
    Epoch [5/50], Val Losses: mse: 17.7349, mae: 2.8248, huber: 2.3918, swd: 6.7548, ept: 70.5236
    Epoch [5/50], Test Losses: mse: 13.7848, mae: 2.4028, huber: 1.9793, swd: 5.8342, ept: 76.7979
      Epoch 5 composite train-obj: 2.191963
            Val objective improved 2.4259 → 2.3918, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 22.7884, mae: 2.5817, huber: 2.1646, swd: 11.0653, ept: 79.1350
    Epoch [6/50], Val Losses: mse: 17.7662, mae: 2.8275, huber: 2.3940, swd: 6.7191, ept: 70.2712
    Epoch [6/50], Test Losses: mse: 13.9000, mae: 2.4220, huber: 1.9968, swd: 5.8917, ept: 76.8565
      Epoch 6 composite train-obj: 2.164571
            No improvement (2.3940), counter 1/5
    Epoch [7/50], Train Losses: mse: 22.8050, mae: 2.5951, huber: 2.1772, swd: 10.9824, ept: 78.8483
    Epoch [7/50], Val Losses: mse: 18.3673, mae: 2.8818, huber: 2.4487, swd: 7.3077, ept: 70.7822
    Epoch [7/50], Test Losses: mse: 13.7588, mae: 2.4204, huber: 1.9962, swd: 5.8827, ept: 77.3448
      Epoch 7 composite train-obj: 2.177192
            No improvement (2.4487), counter 2/5
    Epoch [8/50], Train Losses: mse: 22.6022, mae: 2.5730, huber: 2.1559, swd: 10.8591, ept: 79.2379
    Epoch [8/50], Val Losses: mse: 18.2033, mae: 2.8552, huber: 2.4227, swd: 6.9565, ept: 69.7515
    Epoch [8/50], Test Losses: mse: 13.7319, mae: 2.4031, huber: 1.9791, swd: 5.6550, ept: 76.7737
      Epoch 8 composite train-obj: 2.155874
            No improvement (2.4227), counter 3/5
    Epoch [9/50], Train Losses: mse: 22.5207, mae: 2.5719, huber: 2.1545, swd: 10.7901, ept: 79.1509
    Epoch [9/50], Val Losses: mse: 18.1772, mae: 2.8586, huber: 2.4262, swd: 7.2585, ept: 70.1764
    Epoch [9/50], Test Losses: mse: 13.7602, mae: 2.4153, huber: 1.9915, swd: 5.9166, ept: 77.2342
      Epoch 9 composite train-obj: 2.154489
            No improvement (2.4262), counter 4/5
    Epoch [10/50], Train Losses: mse: 22.2025, mae: 2.5437, huber: 2.1267, swd: 10.6893, ept: 79.4231
    Epoch [10/50], Val Losses: mse: 17.9299, mae: 2.8307, huber: 2.3982, swd: 6.9939, ept: 70.2125
    Epoch [10/50], Test Losses: mse: 13.4555, mae: 2.3847, huber: 1.9609, swd: 5.6804, ept: 77.3726
      Epoch 10 composite train-obj: 2.126681
    Epoch [10/50], Test Losses: mse: 13.7848, mae: 2.4028, huber: 1.9793, swd: 5.8342, ept: 76.7979
    Best round's Test MSE: 13.7848, MAE: 2.4028, SWD: 5.8342
    Best round's Validation MSE: 17.7349, MAE: 2.8248, SWD: 6.7548
    Best round's Test verification MSE : 13.7848, MAE: 2.4028, SWD: 5.8342
    Time taken: 12.21 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred96_20250510_2254)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 13.6319 ± 0.1109
      mae: 2.3918 ± 0.0078
      huber: 1.9675 ± 0.0084
      swd: 6.0334 ± 0.1908
      ept: 76.9261 ± 0.1266
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 17.8134 ± 0.0572
      mae: 2.8229 ± 0.0016
      huber: 2.3898 ± 0.0015
      swd: 7.2818 ± 0.4268
      ept: 70.3854 ± 0.2557
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 56.80 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred96_20250510_2254
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4272, mae: 0.4040, huber: 0.1624, swd: 0.1738, ept: 117.3076
    Epoch [1/50], Val Losses: mse: 0.3338, mae: 0.4233, huber: 0.1593, swd: 0.1251, ept: 97.6377
    Epoch [1/50], Test Losses: mse: 0.1735, mae: 0.2984, huber: 0.0851, swd: 0.0540, ept: 131.3669
      Epoch 1 composite train-obj: 0.162409
            Val objective improved inf → 0.1593, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3512, mae: 0.3534, huber: 0.1326, swd: 0.1506, ept: 140.6073
    Epoch [2/50], Val Losses: mse: 0.3298, mae: 0.4216, huber: 0.1572, swd: 0.1325, ept: 103.1317
    Epoch [2/50], Test Losses: mse: 0.1764, mae: 0.2986, huber: 0.0860, swd: 0.0643, ept: 133.0887
      Epoch 2 composite train-obj: 0.132590
            Val objective improved 0.1593 → 0.1572, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3458, mae: 0.3492, huber: 0.1302, swd: 0.1486, ept: 143.0232
    Epoch [3/50], Val Losses: mse: 0.3324, mae: 0.4194, huber: 0.1580, swd: 0.1309, ept: 105.0461
    Epoch [3/50], Test Losses: mse: 0.1721, mae: 0.2956, huber: 0.0842, swd: 0.0570, ept: 134.8382
      Epoch 3 composite train-obj: 0.130230
            No improvement (0.1580), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3421, mae: 0.3474, huber: 0.1289, swd: 0.1460, ept: 143.9683
    Epoch [4/50], Val Losses: mse: 0.3246, mae: 0.4196, huber: 0.1552, swd: 0.1223, ept: 104.6287
    Epoch [4/50], Test Losses: mse: 0.1719, mae: 0.2962, huber: 0.0843, swd: 0.0551, ept: 134.8670
      Epoch 4 composite train-obj: 0.128939
            Val objective improved 0.1572 → 0.1552, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.3381, mae: 0.3456, huber: 0.1277, swd: 0.1447, ept: 144.8218
    Epoch [5/50], Val Losses: mse: 0.3203, mae: 0.4143, huber: 0.1538, swd: 0.1145, ept: 104.7981
    Epoch [5/50], Test Losses: mse: 0.1782, mae: 0.3030, huber: 0.0872, swd: 0.0613, ept: 133.1186
      Epoch 5 composite train-obj: 0.127722
            Val objective improved 0.1552 → 0.1538, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.3397, mae: 0.3459, huber: 0.1281, swd: 0.1450, ept: 144.6591
    Epoch [6/50], Val Losses: mse: 0.3208, mae: 0.4118, huber: 0.1527, swd: 0.1120, ept: 106.3931
    Epoch [6/50], Test Losses: mse: 0.1806, mae: 0.3033, huber: 0.0884, swd: 0.0581, ept: 131.2488
      Epoch 6 composite train-obj: 0.128135
            Val objective improved 0.1538 → 0.1527, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.3408, mae: 0.3466, huber: 0.1284, swd: 0.1461, ept: 145.0100
    Epoch [7/50], Val Losses: mse: 0.3407, mae: 0.4290, huber: 0.1615, swd: 0.1490, ept: 102.9840
    Epoch [7/50], Test Losses: mse: 0.1875, mae: 0.3050, huber: 0.0908, swd: 0.0761, ept: 131.7667
      Epoch 7 composite train-obj: 0.128398
            No improvement (0.1615), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.3449, mae: 0.3475, huber: 0.1292, swd: 0.1489, ept: 145.3103
    Epoch [8/50], Val Losses: mse: 0.3373, mae: 0.4237, huber: 0.1608, swd: 0.1309, ept: 105.3634
    Epoch [8/50], Test Losses: mse: 0.1710, mae: 0.2985, huber: 0.0840, swd: 0.0540, ept: 135.4625
      Epoch 8 composite train-obj: 0.129216
            No improvement (0.1608), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.3404, mae: 0.3456, huber: 0.1280, swd: 0.1451, ept: 145.2852
    Epoch [9/50], Val Losses: mse: 0.3193, mae: 0.4106, huber: 0.1524, swd: 0.1168, ept: 105.7592
    Epoch [9/50], Test Losses: mse: 0.1733, mae: 0.2981, huber: 0.0849, swd: 0.0583, ept: 134.8863
      Epoch 9 composite train-obj: 0.127996
            Val objective improved 0.1527 → 0.1524, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 0.3362, mae: 0.3445, huber: 0.1271, swd: 0.1437, ept: 145.5918
    Epoch [10/50], Val Losses: mse: 0.3117, mae: 0.4092, huber: 0.1488, swd: 0.1188, ept: 110.0107
    Epoch [10/50], Test Losses: mse: 0.1707, mae: 0.2962, huber: 0.0839, swd: 0.0531, ept: 134.1336
      Epoch 10 composite train-obj: 0.127081
            Val objective improved 0.1524 → 0.1488, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 0.3396, mae: 0.3457, huber: 0.1281, swd: 0.1451, ept: 145.5745
    Epoch [11/50], Val Losses: mse: 0.3284, mae: 0.4196, huber: 0.1555, swd: 0.1364, ept: 105.8451
    Epoch [11/50], Test Losses: mse: 0.1925, mae: 0.3108, huber: 0.0932, swd: 0.0783, ept: 131.1737
      Epoch 11 composite train-obj: 0.128057
            No improvement (0.1555), counter 1/5
    Epoch [12/50], Train Losses: mse: 0.3374, mae: 0.3463, huber: 0.1276, swd: 0.1439, ept: 145.2702
    Epoch [12/50], Val Losses: mse: 0.3267, mae: 0.4143, huber: 0.1556, swd: 0.1158, ept: 107.7234
    Epoch [12/50], Test Losses: mse: 0.1824, mae: 0.3102, huber: 0.0892, swd: 0.0622, ept: 134.0657
      Epoch 12 composite train-obj: 0.127613
            No improvement (0.1556), counter 2/5
    Epoch [13/50], Train Losses: mse: 0.3392, mae: 0.3470, huber: 0.1280, swd: 0.1449, ept: 145.6169
    Epoch [13/50], Val Losses: mse: 0.3602, mae: 0.4380, huber: 0.1693, swd: 0.1487, ept: 102.4404
    Epoch [13/50], Test Losses: mse: 0.1782, mae: 0.3013, huber: 0.0871, swd: 0.0613, ept: 133.1395
      Epoch 13 composite train-obj: 0.128046
            No improvement (0.1693), counter 3/5
    Epoch [14/50], Train Losses: mse: 0.3413, mae: 0.3466, huber: 0.1283, swd: 0.1465, ept: 145.4754
    Epoch [14/50], Val Losses: mse: 0.3248, mae: 0.4168, huber: 0.1559, swd: 0.1204, ept: 106.0531
    Epoch [14/50], Test Losses: mse: 0.1737, mae: 0.3005, huber: 0.0853, swd: 0.0556, ept: 134.7861
      Epoch 14 composite train-obj: 0.128267
            No improvement (0.1559), counter 4/5
    Epoch [15/50], Train Losses: mse: 0.3388, mae: 0.3456, huber: 0.1277, swd: 0.1446, ept: 145.7257
    Epoch [15/50], Val Losses: mse: 0.3368, mae: 0.4271, huber: 0.1596, swd: 0.1391, ept: 104.4831
    Epoch [15/50], Test Losses: mse: 0.1716, mae: 0.2940, huber: 0.0839, swd: 0.0584, ept: 134.2932
      Epoch 15 composite train-obj: 0.127680
    Epoch [15/50], Test Losses: mse: 0.1707, mae: 0.2962, huber: 0.0839, swd: 0.0531, ept: 134.1336
    Best round's Test MSE: 0.1707, MAE: 0.2962, SWD: 0.0531
    Best round's Validation MSE: 0.3117, MAE: 0.4092, SWD: 0.1188
    Best round's Test verification MSE : 0.1707, MAE: 0.2962, SWD: 0.0531
    Time taken: 19.42 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4263, mae: 0.4031, huber: 0.1620, swd: 0.1745, ept: 116.9621
    Epoch [1/50], Val Losses: mse: 0.3327, mae: 0.4244, huber: 0.1583, swd: 0.1337, ept: 96.7514
    Epoch [1/50], Test Losses: mse: 0.1787, mae: 0.3004, huber: 0.0872, swd: 0.0649, ept: 128.5399
      Epoch 1 composite train-obj: 0.162020
            Val objective improved inf → 0.1583, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3504, mae: 0.3540, huber: 0.1326, swd: 0.1527, ept: 139.9010
    Epoch [2/50], Val Losses: mse: 0.3137, mae: 0.4098, huber: 0.1497, swd: 0.1226, ept: 104.5950
    Epoch [2/50], Test Losses: mse: 0.1809, mae: 0.3015, huber: 0.0882, swd: 0.0672, ept: 132.6735
      Epoch 2 composite train-obj: 0.132577
            Val objective improved 0.1583 → 0.1497, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3436, mae: 0.3489, huber: 0.1298, swd: 0.1491, ept: 142.4891
    Epoch [3/50], Val Losses: mse: 0.3194, mae: 0.4096, huber: 0.1527, swd: 0.1194, ept: 107.2327
    Epoch [3/50], Test Losses: mse: 0.1738, mae: 0.3003, huber: 0.0852, swd: 0.0600, ept: 133.0007
      Epoch 3 composite train-obj: 0.129804
            No improvement (0.1527), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3394, mae: 0.3460, huber: 0.1282, swd: 0.1478, ept: 143.9434
    Epoch [4/50], Val Losses: mse: 0.3175, mae: 0.4121, huber: 0.1512, swd: 0.1251, ept: 102.5806
    Epoch [4/50], Test Losses: mse: 0.1787, mae: 0.3003, huber: 0.0872, swd: 0.0649, ept: 131.7788
      Epoch 4 composite train-obj: 0.128235
            No improvement (0.1512), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3428, mae: 0.3478, huber: 0.1292, swd: 0.1490, ept: 144.2434
    Epoch [5/50], Val Losses: mse: 0.3135, mae: 0.4065, huber: 0.1494, swd: 0.1206, ept: 106.9341
    Epoch [5/50], Test Losses: mse: 0.1758, mae: 0.3011, huber: 0.0861, swd: 0.0629, ept: 133.8506
      Epoch 5 composite train-obj: 0.129226
            Val objective improved 0.1497 → 0.1494, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.3413, mae: 0.3468, huber: 0.1286, swd: 0.1482, ept: 144.4144
    Epoch [6/50], Val Losses: mse: 0.3219, mae: 0.4137, huber: 0.1536, swd: 0.1227, ept: 105.8780
    Epoch [6/50], Test Losses: mse: 0.1709, mae: 0.2992, huber: 0.0841, swd: 0.0552, ept: 135.4550
      Epoch 6 composite train-obj: 0.128598
            No improvement (0.1536), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.3424, mae: 0.3464, huber: 0.1286, swd: 0.1494, ept: 145.1365
    Epoch [7/50], Val Losses: mse: 0.3377, mae: 0.4225, huber: 0.1594, swd: 0.1465, ept: 102.9360
    Epoch [7/50], Test Losses: mse: 0.1728, mae: 0.2948, huber: 0.0846, swd: 0.0618, ept: 131.8378
      Epoch 7 composite train-obj: 0.128574
            No improvement (0.1594), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.3364, mae: 0.3447, huber: 0.1271, swd: 0.1462, ept: 145.2869
    Epoch [8/50], Val Losses: mse: 0.3172, mae: 0.4122, huber: 0.1513, swd: 0.1269, ept: 106.3946
    Epoch [8/50], Test Losses: mse: 0.1707, mae: 0.2935, huber: 0.0836, swd: 0.0595, ept: 134.6007
      Epoch 8 composite train-obj: 0.127102
            No improvement (0.1513), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.3364, mae: 0.3444, huber: 0.1271, swd: 0.1457, ept: 145.5485
    Epoch [9/50], Val Losses: mse: 0.3310, mae: 0.4216, huber: 0.1575, swd: 0.1373, ept: 104.0382
    Epoch [9/50], Test Losses: mse: 0.1824, mae: 0.3034, huber: 0.0887, swd: 0.0696, ept: 132.4827
      Epoch 9 composite train-obj: 0.127091
            No improvement (0.1575), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.3386, mae: 0.3458, huber: 0.1277, swd: 0.1470, ept: 145.5287
    Epoch [10/50], Val Losses: mse: 0.3325, mae: 0.4195, huber: 0.1579, swd: 0.1372, ept: 102.9775
    Epoch [10/50], Test Losses: mse: 0.1843, mae: 0.3066, huber: 0.0896, swd: 0.0747, ept: 132.3807
      Epoch 10 composite train-obj: 0.127668
    Epoch [10/50], Test Losses: mse: 0.1758, mae: 0.3011, huber: 0.0861, swd: 0.0629, ept: 133.8506
    Best round's Test MSE: 0.1758, MAE: 0.3011, SWD: 0.0629
    Best round's Validation MSE: 0.3135, MAE: 0.4065, SWD: 0.1206
    Best round's Test verification MSE : 0.1758, MAE: 0.3011, SWD: 0.0629
    Time taken: 11.89 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4319, mae: 0.4054, huber: 0.1637, swd: 0.1605, ept: 116.4684
    Epoch [1/50], Val Losses: mse: 0.3546, mae: 0.4396, huber: 0.1682, swd: 0.1278, ept: 97.5490
    Epoch [1/50], Test Losses: mse: 0.1755, mae: 0.2991, huber: 0.0859, swd: 0.0531, ept: 129.4329
      Epoch 1 composite train-obj: 0.163660
            Val objective improved inf → 0.1682, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.3500, mae: 0.3536, huber: 0.1323, swd: 0.1379, ept: 140.2646
    Epoch [2/50], Val Losses: mse: 0.3262, mae: 0.4166, huber: 0.1560, swd: 0.1071, ept: 103.3953
    Epoch [2/50], Test Losses: mse: 0.1758, mae: 0.3020, huber: 0.0863, swd: 0.0495, ept: 132.9707
      Epoch 2 composite train-obj: 0.132317
            Val objective improved 0.1682 → 0.1560, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.3444, mae: 0.3493, huber: 0.1301, swd: 0.1356, ept: 142.9343
    Epoch [3/50], Val Losses: mse: 0.3285, mae: 0.4181, huber: 0.1565, swd: 0.1062, ept: 107.2544
    Epoch [3/50], Test Losses: mse: 0.1712, mae: 0.2965, huber: 0.0842, swd: 0.0465, ept: 134.6808
      Epoch 3 composite train-obj: 0.130059
            No improvement (0.1565), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.3397, mae: 0.3468, huber: 0.1283, swd: 0.1332, ept: 144.0173
    Epoch [4/50], Val Losses: mse: 0.3337, mae: 0.4251, huber: 0.1590, swd: 0.1197, ept: 103.9119
    Epoch [4/50], Test Losses: mse: 0.1784, mae: 0.3008, huber: 0.0870, swd: 0.0581, ept: 134.4576
      Epoch 4 composite train-obj: 0.128312
            No improvement (0.1590), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.3395, mae: 0.3466, huber: 0.1283, swd: 0.1337, ept: 144.5736
    Epoch [5/50], Val Losses: mse: 0.3193, mae: 0.4093, huber: 0.1514, swd: 0.1053, ept: 106.2845
    Epoch [5/50], Test Losses: mse: 0.1779, mae: 0.3055, huber: 0.0872, swd: 0.0551, ept: 133.9628
      Epoch 5 composite train-obj: 0.128323
            Val objective improved 0.1560 → 0.1514, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.3378, mae: 0.3451, huber: 0.1275, swd: 0.1319, ept: 145.1447
    Epoch [6/50], Val Losses: mse: 0.3187, mae: 0.4094, huber: 0.1508, swd: 0.1179, ept: 105.4023
    Epoch [6/50], Test Losses: mse: 0.1843, mae: 0.3032, huber: 0.0897, swd: 0.0594, ept: 131.7120
      Epoch 6 composite train-obj: 0.127517
            Val objective improved 0.1514 → 0.1508, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.3370, mae: 0.3442, huber: 0.1272, swd: 0.1325, ept: 145.3254
    Epoch [7/50], Val Losses: mse: 0.3197, mae: 0.4137, huber: 0.1532, swd: 0.1108, ept: 105.4999
    Epoch [7/50], Test Losses: mse: 0.1907, mae: 0.3122, huber: 0.0925, swd: 0.0676, ept: 133.4057
      Epoch 7 composite train-obj: 0.127182
            No improvement (0.1532), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.3379, mae: 0.3456, huber: 0.1276, swd: 0.1326, ept: 145.2897
    Epoch [8/50], Val Losses: mse: 0.3210, mae: 0.4144, huber: 0.1530, swd: 0.1101, ept: 106.3786
    Epoch [8/50], Test Losses: mse: 0.1723, mae: 0.2982, huber: 0.0846, swd: 0.0502, ept: 134.8254
      Epoch 8 composite train-obj: 0.127611
            No improvement (0.1530), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.3414, mae: 0.3455, huber: 0.1281, swd: 0.1344, ept: 145.5817
    Epoch [9/50], Val Losses: mse: 0.3102, mae: 0.4088, huber: 0.1489, swd: 0.1021, ept: 108.4110
    Epoch [9/50], Test Losses: mse: 0.1786, mae: 0.3024, huber: 0.0872, swd: 0.0565, ept: 132.6744
      Epoch 9 composite train-obj: 0.128144
            Val objective improved 0.1508 → 0.1489, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 0.3360, mae: 0.3450, huber: 0.1271, swd: 0.1318, ept: 145.7586
    Epoch [10/50], Val Losses: mse: 0.3128, mae: 0.4121, huber: 0.1499, swd: 0.1047, ept: 107.6262
    Epoch [10/50], Test Losses: mse: 0.1738, mae: 0.2962, huber: 0.0849, swd: 0.0533, ept: 134.8379
      Epoch 10 composite train-obj: 0.127070
            No improvement (0.1499), counter 1/5
    Epoch [11/50], Train Losses: mse: 0.3398, mae: 0.3449, huber: 0.1276, swd: 0.1329, ept: 145.9789
    Epoch [11/50], Val Losses: mse: 0.3274, mae: 0.4180, huber: 0.1567, swd: 0.1134, ept: 106.0949
    Epoch [11/50], Test Losses: mse: 0.1762, mae: 0.3001, huber: 0.0861, swd: 0.0556, ept: 134.8467
      Epoch 11 composite train-obj: 0.127577
            No improvement (0.1567), counter 2/5
    Epoch [12/50], Train Losses: mse: 0.3371, mae: 0.3456, huber: 0.1273, swd: 0.1325, ept: 145.5007
    Epoch [12/50], Val Losses: mse: 0.3189, mae: 0.4123, huber: 0.1518, swd: 0.1049, ept: 106.7516
    Epoch [12/50], Test Losses: mse: 0.1970, mae: 0.3145, huber: 0.0954, swd: 0.0704, ept: 132.0861
      Epoch 12 composite train-obj: 0.127316
            No improvement (0.1518), counter 3/5
    Epoch [13/50], Train Losses: mse: 0.3427, mae: 0.3470, huber: 0.1287, swd: 0.1353, ept: 145.4342
    Epoch [13/50], Val Losses: mse: 0.3234, mae: 0.4172, huber: 0.1537, swd: 0.1178, ept: 105.8717
    Epoch [13/50], Test Losses: mse: 0.1849, mae: 0.3043, huber: 0.0898, swd: 0.0629, ept: 132.7322
      Epoch 13 composite train-obj: 0.128711
            No improvement (0.1537), counter 4/5
    Epoch [14/50], Train Losses: mse: 0.3384, mae: 0.3447, huber: 0.1273, swd: 0.1337, ept: 145.8161
    Epoch [14/50], Val Losses: mse: 0.3452, mae: 0.4285, huber: 0.1638, swd: 0.1224, ept: 102.3004
    Epoch [14/50], Test Losses: mse: 0.1709, mae: 0.2974, huber: 0.0839, swd: 0.0516, ept: 134.1853
      Epoch 14 composite train-obj: 0.127348
    Epoch [14/50], Test Losses: mse: 0.1786, mae: 0.3024, huber: 0.0872, swd: 0.0565, ept: 132.6744
    Best round's Test MSE: 0.1786, MAE: 0.3024, SWD: 0.0565
    Best round's Validation MSE: 0.3102, MAE: 0.4088, SWD: 0.1021
    Best round's Test verification MSE : 0.1786, MAE: 0.3024, SWD: 0.0565
    Time taken: 16.71 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred196_20250510_2255)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.1751 ± 0.0033
      mae: 0.2999 ± 0.0027
      huber: 0.0857 ± 0.0014
      swd: 0.0575 ± 0.0041
      ept: 133.5529 ± 0.6318
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3118 ± 0.0013
      mae: 0.4081 ± 0.0012
      huber: 0.1490 ± 0.0003
      swd: 0.1138 ± 0.0083
      ept: 108.4519 ± 1.2563
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 48.12 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred196_20250510_2255
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=196,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 7
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 67.6245, mae: 4.4438, huber: 4.0015, swd: 28.9187, ept: 89.6194
    Epoch [1/50], Val Losses: mse: 25.9641, mae: 3.5548, huber: 3.1055, swd: 10.0795, ept: 90.5307
    Epoch [1/50], Test Losses: mse: 17.5056, mae: 2.7716, huber: 2.3413, swd: 6.7823, ept: 116.6465
      Epoch 1 composite train-obj: 4.001510
            Val objective improved inf → 3.1055, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 32.7353, mae: 3.1435, huber: 2.7137, swd: 16.9492, ept: 127.0324
    Epoch [2/50], Val Losses: mse: 25.0564, mae: 3.4392, huber: 2.9940, swd: 10.3155, ept: 99.0206
    Epoch [2/50], Test Losses: mse: 17.5334, mae: 2.7459, huber: 2.3150, swd: 7.0496, ept: 123.2400
      Epoch 2 composite train-obj: 2.713737
            Val objective improved 3.1055 → 2.9940, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 31.3728, mae: 3.0526, huber: 2.6252, swd: 16.2286, ept: 132.9783
    Epoch [3/50], Val Losses: mse: 25.6150, mae: 3.4951, huber: 3.0504, swd: 11.4831, ept: 103.5405
    Epoch [3/50], Test Losses: mse: 16.9651, mae: 2.7123, huber: 2.2836, swd: 6.7602, ept: 126.7507
      Epoch 3 composite train-obj: 2.625250
            No improvement (3.0504), counter 1/5
    Epoch [4/50], Train Losses: mse: 30.8218, mae: 2.9990, huber: 2.5730, swd: 15.9886, ept: 135.5175
    Epoch [4/50], Val Losses: mse: 25.1039, mae: 3.4575, huber: 3.0130, swd: 10.8936, ept: 103.4347
    Epoch [4/50], Test Losses: mse: 17.0837, mae: 2.7153, huber: 2.2858, swd: 6.5638, ept: 126.0648
      Epoch 4 composite train-obj: 2.572965
            No improvement (3.0130), counter 2/5
    Epoch [5/50], Train Losses: mse: 29.8451, mae: 2.9538, huber: 2.5288, swd: 15.3057, ept: 137.2962
    Epoch [5/50], Val Losses: mse: 25.1802, mae: 3.4485, huber: 3.0040, swd: 10.7914, ept: 104.7548
    Epoch [5/50], Test Losses: mse: 16.9297, mae: 2.6781, huber: 2.2492, swd: 6.6659, ept: 125.4027
      Epoch 5 composite train-obj: 2.528808
            No improvement (3.0040), counter 3/5
    Epoch [6/50], Train Losses: mse: 30.1720, mae: 2.9790, huber: 2.5533, swd: 15.4687, ept: 136.1361
    Epoch [6/50], Val Losses: mse: 25.3354, mae: 3.4553, huber: 3.0102, swd: 10.8382, ept: 107.1016
    Epoch [6/50], Test Losses: mse: 17.7006, mae: 2.7369, huber: 2.3064, swd: 6.9718, ept: 127.8605
      Epoch 6 composite train-obj: 2.553329
            No improvement (3.0102), counter 4/5
    Epoch [7/50], Train Losses: mse: 29.9625, mae: 2.9677, huber: 2.5425, swd: 15.2988, ept: 137.3323
    Epoch [7/50], Val Losses: mse: 24.4586, mae: 3.3714, huber: 2.9278, swd: 10.4623, ept: 106.2733
    Epoch [7/50], Test Losses: mse: 16.9913, mae: 2.7114, huber: 2.2798, swd: 6.9493, ept: 128.5781
      Epoch 7 composite train-obj: 2.542520
            Val objective improved 2.9940 → 2.9278, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 29.8782, mae: 2.9499, huber: 2.5249, swd: 15.3153, ept: 137.3326
    Epoch [8/50], Val Losses: mse: 25.4752, mae: 3.4242, huber: 2.9817, swd: 10.8368, ept: 103.7655
    Epoch [8/50], Test Losses: mse: 17.3538, mae: 2.6860, huber: 2.2586, swd: 6.7286, ept: 124.0201
      Epoch 8 composite train-obj: 2.524856
            No improvement (2.9817), counter 1/5
    Epoch [9/50], Train Losses: mse: 29.9181, mae: 2.9568, huber: 2.5320, swd: 15.2459, ept: 137.4908
    Epoch [9/50], Val Losses: mse: 24.5687, mae: 3.3834, huber: 2.9413, swd: 10.7877, ept: 107.5514
    Epoch [9/50], Test Losses: mse: 17.1626, mae: 2.7184, huber: 2.2889, swd: 7.2858, ept: 128.5219
      Epoch 9 composite train-obj: 2.532002
            No improvement (2.9413), counter 2/5
    Epoch [10/50], Train Losses: mse: 29.4239, mae: 2.9336, huber: 2.5092, swd: 14.9980, ept: 137.9901
    Epoch [10/50], Val Losses: mse: 25.4527, mae: 3.4396, huber: 2.9964, swd: 10.9094, ept: 106.2744
    Epoch [10/50], Test Losses: mse: 17.1630, mae: 2.7057, huber: 2.2766, swd: 6.7272, ept: 127.9655
      Epoch 10 composite train-obj: 2.509196
            No improvement (2.9964), counter 3/5
    Epoch [11/50], Train Losses: mse: 29.6101, mae: 2.9357, huber: 2.5109, swd: 15.1428, ept: 137.7162
    Epoch [11/50], Val Losses: mse: 30.3204, mae: 3.7506, huber: 3.3056, swd: 16.8104, ept: 105.1172
    Epoch [11/50], Test Losses: mse: 19.2920, mae: 2.9547, huber: 2.5190, swd: 9.6241, ept: 125.4982
      Epoch 11 composite train-obj: 2.510926
            No improvement (3.3056), counter 4/5
    Epoch [12/50], Train Losses: mse: 29.4877, mae: 2.9483, huber: 2.5227, swd: 14.9254, ept: 136.2669
    Epoch [12/50], Val Losses: mse: 26.8379, mae: 3.5191, huber: 3.0754, swd: 11.5351, ept: 105.9993
    Epoch [12/50], Test Losses: mse: 18.2752, mae: 2.7983, huber: 2.3651, swd: 6.8210, ept: 127.3553
      Epoch 12 composite train-obj: 2.522716
    Epoch [12/50], Test Losses: mse: 16.9913, mae: 2.7114, huber: 2.2798, swd: 6.9493, ept: 128.5781
    Best round's Test MSE: 16.9913, MAE: 2.7114, SWD: 6.9493
    Best round's Validation MSE: 24.4586, MAE: 3.3714, SWD: 10.4623
    Best round's Test verification MSE : 16.9913, MAE: 2.7114, SWD: 6.9493
    Time taken: 15.78 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 68.6471, mae: 4.4474, huber: 4.0054, swd: 29.2216, ept: 89.3141
    Epoch [1/50], Val Losses: mse: 25.3447, mae: 3.5117, huber: 3.0631, swd: 10.1059, ept: 90.2059
    Epoch [1/50], Test Losses: mse: 17.1315, mae: 2.7265, huber: 2.2977, swd: 6.5345, ept: 116.9962
      Epoch 1 composite train-obj: 4.005416
            Val objective improved inf → 3.0631, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 32.5772, mae: 3.1274, huber: 2.6981, swd: 17.3519, ept: 127.6395
    Epoch [2/50], Val Losses: mse: 25.3049, mae: 3.4831, huber: 3.0390, swd: 10.9841, ept: 101.1117
    Epoch [2/50], Test Losses: mse: 16.7450, mae: 2.7044, huber: 2.2737, swd: 6.5388, ept: 123.9796
      Epoch 2 composite train-obj: 2.698131
            Val objective improved 3.0631 → 3.0390, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 31.1405, mae: 3.0324, huber: 2.6053, swd: 16.6962, ept: 133.4449
    Epoch [3/50], Val Losses: mse: 24.6573, mae: 3.4395, huber: 2.9955, swd: 10.8993, ept: 104.1421
    Epoch [3/50], Test Losses: mse: 17.5248, mae: 2.7440, huber: 2.3149, swd: 7.8020, ept: 126.0854
      Epoch 3 composite train-obj: 2.605344
            Val objective improved 3.0390 → 2.9955, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 30.3202, mae: 2.9906, huber: 2.5647, swd: 16.0791, ept: 135.3865
    Epoch [4/50], Val Losses: mse: 24.3058, mae: 3.3941, huber: 2.9496, swd: 10.5250, ept: 104.7453
    Epoch [4/50], Test Losses: mse: 17.2261, mae: 2.7308, huber: 2.2976, swd: 7.1063, ept: 126.7544
      Epoch 4 composite train-obj: 2.564674
            Val objective improved 2.9955 → 2.9496, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 30.6083, mae: 3.0036, huber: 2.5775, swd: 16.3151, ept: 135.4026
    Epoch [5/50], Val Losses: mse: 25.1298, mae: 3.4237, huber: 2.9797, swd: 11.1949, ept: 106.2083
    Epoch [5/50], Test Losses: mse: 17.4622, mae: 2.7563, huber: 2.3236, swd: 7.2499, ept: 127.1841
      Epoch 5 composite train-obj: 2.577531
            No improvement (2.9797), counter 1/5
    Epoch [6/50], Train Losses: mse: 30.1990, mae: 2.9791, huber: 2.5537, swd: 15.9518, ept: 136.3465
    Epoch [6/50], Val Losses: mse: 24.3511, mae: 3.3632, huber: 2.9212, swd: 10.5918, ept: 106.4231
    Epoch [6/50], Test Losses: mse: 16.7853, mae: 2.6735, huber: 2.2452, swd: 7.0693, ept: 126.2925
      Epoch 6 composite train-obj: 2.553688
            Val objective improved 2.9496 → 2.9212, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 29.9627, mae: 2.9609, huber: 2.5356, swd: 15.8851, ept: 136.8687
    Epoch [7/50], Val Losses: mse: 25.9628, mae: 3.4810, huber: 3.0383, swd: 12.5375, ept: 105.7491
    Epoch [7/50], Test Losses: mse: 17.0466, mae: 2.7497, huber: 2.3175, swd: 7.2793, ept: 126.7135
      Epoch 7 composite train-obj: 2.535625
            No improvement (3.0383), counter 1/5
    Epoch [8/50], Train Losses: mse: 29.4177, mae: 2.9325, huber: 2.5077, swd: 15.5294, ept: 137.4915
    Epoch [8/50], Val Losses: mse: 24.9920, mae: 3.4193, huber: 2.9770, swd: 11.4265, ept: 104.9131
    Epoch [8/50], Test Losses: mse: 16.3322, mae: 2.6562, huber: 2.2262, swd: 6.5554, ept: 128.2289
      Epoch 8 composite train-obj: 2.507667
            No improvement (2.9770), counter 2/5
    Epoch [9/50], Train Losses: mse: 29.3201, mae: 2.9201, huber: 2.4960, swd: 15.4586, ept: 138.7042
    Epoch [9/50], Val Losses: mse: 24.2700, mae: 3.3727, huber: 2.9296, swd: 10.6586, ept: 106.8877
    Epoch [9/50], Test Losses: mse: 17.1102, mae: 2.6866, huber: 2.2583, swd: 7.2479, ept: 128.3126
      Epoch 9 composite train-obj: 2.495970
            No improvement (2.9296), counter 3/5
    Epoch [10/50], Train Losses: mse: 29.9695, mae: 2.9656, huber: 2.5405, swd: 15.8065, ept: 136.9698
    Epoch [10/50], Val Losses: mse: 25.1194, mae: 3.4244, huber: 2.9820, swd: 11.3472, ept: 106.3710
    Epoch [10/50], Test Losses: mse: 16.7191, mae: 2.6808, huber: 2.2505, swd: 6.8701, ept: 127.3071
      Epoch 10 composite train-obj: 2.540542
            No improvement (2.9820), counter 4/5
    Epoch [11/50], Train Losses: mse: 29.3553, mae: 2.9266, huber: 2.5022, swd: 15.4220, ept: 138.3672
    Epoch [11/50], Val Losses: mse: 24.8194, mae: 3.3862, huber: 2.9436, swd: 11.0197, ept: 107.0581
    Epoch [11/50], Test Losses: mse: 17.0699, mae: 2.7112, huber: 2.2787, swd: 7.1937, ept: 125.7924
      Epoch 11 composite train-obj: 2.502230
    Epoch [11/50], Test Losses: mse: 16.7853, mae: 2.6735, huber: 2.2452, swd: 7.0693, ept: 126.2925
    Best round's Test MSE: 16.7853, MAE: 2.6735, SWD: 7.0693
    Best round's Validation MSE: 24.3511, MAE: 3.3632, SWD: 10.5918
    Best round's Test verification MSE : 16.7853, MAE: 2.6735, SWD: 7.0693
    Time taken: 13.62 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 69.8682, mae: 4.4740, huber: 4.0319, swd: 25.5345, ept: 89.3655
    Epoch [1/50], Val Losses: mse: 26.3120, mae: 3.5966, huber: 3.1458, swd: 9.4473, ept: 89.2230
    Epoch [1/50], Test Losses: mse: 17.4103, mae: 2.7839, huber: 2.3513, swd: 5.8122, ept: 114.7834
      Epoch 1 composite train-obj: 4.031934
            Val objective improved inf → 3.1458, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 32.5438, mae: 3.1311, huber: 2.7014, swd: 14.9654, ept: 127.2906
    Epoch [2/50], Val Losses: mse: 26.1618, mae: 3.4975, huber: 3.0520, swd: 10.0093, ept: 98.5007
    Epoch [2/50], Test Losses: mse: 17.6330, mae: 2.7054, huber: 2.2789, swd: 6.1506, ept: 123.0516
      Epoch 2 composite train-obj: 2.701437
            Val objective improved 3.1458 → 3.0520, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 31.2114, mae: 3.0498, huber: 2.6225, swd: 14.3424, ept: 132.6222
    Epoch [3/50], Val Losses: mse: 24.9748, mae: 3.4426, huber: 2.9995, swd: 9.5539, ept: 102.8959
    Epoch [3/50], Test Losses: mse: 16.4795, mae: 2.6623, huber: 2.2342, swd: 5.5818, ept: 125.2301
      Epoch 3 composite train-obj: 2.622475
            Val objective improved 3.0520 → 2.9995, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 30.4472, mae: 2.9994, huber: 2.5733, swd: 13.8922, ept: 135.1443
    Epoch [4/50], Val Losses: mse: 25.5451, mae: 3.4805, huber: 3.0369, swd: 10.1357, ept: 105.6991
    Epoch [4/50], Test Losses: mse: 17.0447, mae: 2.7321, huber: 2.3017, swd: 6.0808, ept: 127.2669
      Epoch 4 composite train-obj: 2.573289
            No improvement (3.0369), counter 1/5
    Epoch [5/50], Train Losses: mse: 30.0509, mae: 2.9757, huber: 2.5501, swd: 13.6919, ept: 136.5717
    Epoch [5/50], Val Losses: mse: 25.0175, mae: 3.4174, huber: 2.9751, swd: 9.4823, ept: 105.1888
    Epoch [5/50], Test Losses: mse: 17.5936, mae: 2.7425, huber: 2.3125, swd: 6.4451, ept: 126.4993
      Epoch 5 composite train-obj: 2.550108
            Val objective improved 2.9995 → 2.9751, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 29.9678, mae: 2.9662, huber: 2.5408, swd: 13.5415, ept: 136.5536
    Epoch [6/50], Val Losses: mse: 25.5490, mae: 3.4762, huber: 3.0331, swd: 10.1166, ept: 105.8948
    Epoch [6/50], Test Losses: mse: 16.5838, mae: 2.6683, huber: 2.2402, swd: 5.6226, ept: 127.8857
      Epoch 6 composite train-obj: 2.540848
            No improvement (3.0331), counter 1/5
    Epoch [7/50], Train Losses: mse: 29.7291, mae: 2.9594, huber: 2.5342, swd: 13.4679, ept: 136.6334
    Epoch [7/50], Val Losses: mse: 24.7273, mae: 3.4328, huber: 2.9875, swd: 9.6980, ept: 104.9242
    Epoch [7/50], Test Losses: mse: 17.2362, mae: 2.7420, huber: 2.3106, swd: 6.7198, ept: 126.3671
      Epoch 7 composite train-obj: 2.534187
            No improvement (2.9875), counter 2/5
    Epoch [8/50], Train Losses: mse: 29.6137, mae: 2.9489, huber: 2.5237, swd: 13.4338, ept: 137.7803
    Epoch [8/50], Val Losses: mse: 26.6706, mae: 3.5288, huber: 3.0858, swd: 11.6663, ept: 106.5636
    Epoch [8/50], Test Losses: mse: 17.2276, mae: 2.7671, huber: 2.3344, swd: 6.3874, ept: 127.4621
      Epoch 8 composite train-obj: 2.523727
            No improvement (3.0858), counter 3/5
    Epoch [9/50], Train Losses: mse: 29.7343, mae: 2.9395, huber: 2.5147, swd: 13.4681, ept: 137.7053
    Epoch [9/50], Val Losses: mse: 25.1704, mae: 3.4268, huber: 2.9828, swd: 9.4707, ept: 104.8817
    Epoch [9/50], Test Losses: mse: 16.7503, mae: 2.6805, huber: 2.2492, swd: 5.6595, ept: 125.4994
      Epoch 9 composite train-obj: 2.514730
            No improvement (2.9828), counter 4/5
    Epoch [10/50], Train Losses: mse: 29.5092, mae: 2.9429, huber: 2.5180, swd: 13.3043, ept: 137.4834
    Epoch [10/50], Val Losses: mse: 24.2396, mae: 3.3610, huber: 2.9184, swd: 9.2085, ept: 107.1545
    Epoch [10/50], Test Losses: mse: 17.6060, mae: 2.7112, huber: 2.2812, swd: 6.3861, ept: 127.1489
      Epoch 10 composite train-obj: 2.517965
            Val objective improved 2.9751 → 2.9184, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 29.7360, mae: 2.9424, huber: 2.5178, swd: 13.4918, ept: 138.0382
    Epoch [11/50], Val Losses: mse: 25.4403, mae: 3.4547, huber: 3.0106, swd: 10.1758, ept: 106.4570
    Epoch [11/50], Test Losses: mse: 17.5571, mae: 2.7384, huber: 2.3082, swd: 6.2340, ept: 128.3560
      Epoch 11 composite train-obj: 2.517756
            No improvement (3.0106), counter 1/5
    Epoch [12/50], Train Losses: mse: 29.5549, mae: 2.9502, huber: 2.5252, swd: 13.3010, ept: 137.2343
    Epoch [12/50], Val Losses: mse: 24.9033, mae: 3.3996, huber: 2.9572, swd: 9.4145, ept: 105.9943
    Epoch [12/50], Test Losses: mse: 16.4280, mae: 2.6379, huber: 2.2097, swd: 5.5380, ept: 127.6975
      Epoch 12 composite train-obj: 2.525156
            No improvement (2.9572), counter 2/5
    Epoch [13/50], Train Losses: mse: 29.5220, mae: 2.9305, huber: 2.5060, swd: 13.2876, ept: 138.1336
    Epoch [13/50], Val Losses: mse: 26.0797, mae: 3.4873, huber: 3.0423, swd: 10.4247, ept: 107.4681
    Epoch [13/50], Test Losses: mse: 17.0340, mae: 2.6963, huber: 2.2667, swd: 5.6047, ept: 129.7200
      Epoch 13 composite train-obj: 2.506031
            No improvement (3.0423), counter 3/5
    Epoch [14/50], Train Losses: mse: 29.5317, mae: 2.9373, huber: 2.5124, swd: 13.2990, ept: 137.7576
    Epoch [14/50], Val Losses: mse: 27.2596, mae: 3.5756, huber: 3.1317, swd: 11.7197, ept: 105.0992
    Epoch [14/50], Test Losses: mse: 17.3416, mae: 2.7630, huber: 2.3317, swd: 6.2545, ept: 127.5915
      Epoch 14 composite train-obj: 2.512394
            No improvement (3.1317), counter 4/5
    Epoch [15/50], Train Losses: mse: 29.2650, mae: 2.9243, huber: 2.4998, swd: 13.1759, ept: 138.0084
    Epoch [15/50], Val Losses: mse: 27.4557, mae: 3.5867, huber: 3.1423, swd: 11.4417, ept: 105.6449
    Epoch [15/50], Test Losses: mse: 17.3817, mae: 2.7817, huber: 2.3482, swd: 6.0186, ept: 127.2764
      Epoch 15 composite train-obj: 2.499772
    Epoch [15/50], Test Losses: mse: 17.6060, mae: 2.7112, huber: 2.2812, swd: 6.3861, ept: 127.1489
    Best round's Test MSE: 17.6060, MAE: 2.7112, SWD: 6.3861
    Best round's Validation MSE: 24.2396, MAE: 3.3610, SWD: 9.2085
    Best round's Test verification MSE : 17.6060, MAE: 2.7112, SWD: 6.3861
    Time taken: 18.44 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred196_20250510_2256)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 17.1275 ± 0.3486
      mae: 2.6987 ± 0.0178
      huber: 2.2687 ± 0.0166
      swd: 6.8016 ± 0.2978
      ept: 127.3399 ± 0.9428
      count: 7.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 24.3498 ± 0.0894
      mae: 3.3652 ± 0.0044
      huber: 2.9225 ± 0.0040
      swd: 10.0875 ± 0.6238
      ept: 106.6170 ± 0.3850
      count: 7.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 47.90 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred196_20250510_2256
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4879, mae: 0.4376, huber: 0.1839, swd: 0.1933, ept: 165.7412
    Epoch [1/50], Val Losses: mse: 0.4045, mae: 0.4718, huber: 0.1900, swd: 0.1464, ept: 123.2872
    Epoch [1/50], Test Losses: mse: 0.2025, mae: 0.3247, huber: 0.0986, swd: 0.0644, ept: 179.1893
      Epoch 1 composite train-obj: 0.183896
            Val objective improved inf → 0.1900, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4205, mae: 0.3952, huber: 0.1577, swd: 0.1779, ept: 200.0273
    Epoch [2/50], Val Losses: mse: 0.3909, mae: 0.4614, huber: 0.1846, swd: 0.1138, ept: 127.5421
    Epoch [2/50], Test Losses: mse: 0.2206, mae: 0.3431, huber: 0.1070, swd: 0.0714, ept: 175.3181
      Epoch 2 composite train-obj: 0.157684
            Val objective improved 0.1900 → 0.1846, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4184, mae: 0.3932, huber: 0.1567, swd: 0.1765, ept: 204.1426
    Epoch [3/50], Val Losses: mse: 0.3999, mae: 0.4675, huber: 0.1870, swd: 0.1480, ept: 133.2191
    Epoch [3/50], Test Losses: mse: 0.1958, mae: 0.3156, huber: 0.0953, swd: 0.0582, ept: 188.6248
      Epoch 3 composite train-obj: 0.156661
            No improvement (0.1870), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4349, mae: 0.3981, huber: 0.1604, swd: 0.1861, ept: 204.5203
    Epoch [4/50], Val Losses: mse: 0.3989, mae: 0.4720, huber: 0.1881, swd: 0.1279, ept: 129.9471
    Epoch [4/50], Test Losses: mse: 0.2029, mae: 0.3304, huber: 0.0991, swd: 0.0534, ept: 188.6184
      Epoch 4 composite train-obj: 0.160392
            No improvement (0.1881), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.4123, mae: 0.3901, huber: 0.1545, swd: 0.1740, ept: 206.0593
    Epoch [5/50], Val Losses: mse: 0.3677, mae: 0.4501, huber: 0.1739, swd: 0.1262, ept: 134.6516
    Epoch [5/50], Test Losses: mse: 0.2153, mae: 0.3335, huber: 0.1041, swd: 0.0792, ept: 186.2031
      Epoch 5 composite train-obj: 0.154550
            Val objective improved 0.1846 → 0.1739, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.4123, mae: 0.3889, huber: 0.1541, swd: 0.1739, ept: 208.0417
    Epoch [6/50], Val Losses: mse: 0.3726, mae: 0.4508, huber: 0.1754, swd: 0.1109, ept: 133.2854
    Epoch [6/50], Test Losses: mse: 0.1991, mae: 0.3270, huber: 0.0978, swd: 0.0564, ept: 175.1937
      Epoch 6 composite train-obj: 0.154117
            No improvement (0.1754), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.4072, mae: 0.3861, huber: 0.1522, swd: 0.1726, ept: 209.8878
    Epoch [7/50], Val Losses: mse: 0.3960, mae: 0.4660, huber: 0.1863, swd: 0.1187, ept: 134.5269
    Epoch [7/50], Test Losses: mse: 0.1934, mae: 0.3179, huber: 0.0948, swd: 0.0527, ept: 189.5924
      Epoch 7 composite train-obj: 0.152180
            No improvement (0.1863), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.4255, mae: 0.3915, huber: 0.1570, swd: 0.1839, ept: 209.2280
    Epoch [8/50], Val Losses: mse: 0.4403, mae: 0.4936, huber: 0.2052, swd: 0.1364, ept: 128.6230
    Epoch [8/50], Test Losses: mse: 0.1957, mae: 0.3183, huber: 0.0959, swd: 0.0530, ept: 187.7605
      Epoch 8 composite train-obj: 0.157031
            No improvement (0.2052), counter 3/5
    Epoch [9/50], Train Losses: mse: 0.4078, mae: 0.3871, huber: 0.1528, swd: 0.1722, ept: 209.4769
    Epoch [9/50], Val Losses: mse: 0.4697, mae: 0.5057, huber: 0.2171, swd: 0.1259, ept: 122.8344
    Epoch [9/50], Test Losses: mse: 0.2061, mae: 0.3341, huber: 0.1012, swd: 0.0564, ept: 179.3062
      Epoch 9 composite train-obj: 0.152802
            No improvement (0.2171), counter 4/5
    Epoch [10/50], Train Losses: mse: 0.4097, mae: 0.3872, huber: 0.1531, swd: 0.1715, ept: 208.6589
    Epoch [10/50], Val Losses: mse: 0.4110, mae: 0.4760, huber: 0.1938, swd: 0.1244, ept: 139.3067
    Epoch [10/50], Test Losses: mse: 0.2004, mae: 0.3282, huber: 0.0984, swd: 0.0507, ept: 183.4862
      Epoch 10 composite train-obj: 0.153147
    Epoch [10/50], Test Losses: mse: 0.2153, mae: 0.3335, huber: 0.1041, swd: 0.0792, ept: 186.2031
    Best round's Test MSE: 0.2153, MAE: 0.3335, SWD: 0.0792
    Best round's Validation MSE: 0.3677, MAE: 0.4501, SWD: 0.1262
    Best round's Test verification MSE : 0.2153, MAE: 0.3335, SWD: 0.0792
    Time taken: 12.28 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4876, mae: 0.4371, huber: 0.1834, swd: 0.2010, ept: 164.5841
    Epoch [1/50], Val Losses: mse: 0.3987, mae: 0.4682, huber: 0.1870, swd: 0.1492, ept: 127.8117
    Epoch [1/50], Test Losses: mse: 0.2184, mae: 0.3340, huber: 0.1053, swd: 0.0764, ept: 181.4295
      Epoch 1 composite train-obj: 0.183435
            Val objective improved inf → 0.1870, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4223, mae: 0.3953, huber: 0.1580, swd: 0.1839, ept: 199.5581
    Epoch [2/50], Val Losses: mse: 0.3976, mae: 0.4650, huber: 0.1870, swd: 0.1293, ept: 131.7822
    Epoch [2/50], Test Losses: mse: 0.2034, mae: 0.3293, huber: 0.0996, swd: 0.0601, ept: 184.7133
      Epoch 2 composite train-obj: 0.157992
            Val objective improved 0.1870 → 0.1870, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4217, mae: 0.3944, huber: 0.1577, swd: 0.1829, ept: 203.7079
    Epoch [3/50], Val Losses: mse: 0.3731, mae: 0.4496, huber: 0.1767, swd: 0.1177, ept: 136.4898
    Epoch [3/50], Test Losses: mse: 0.2115, mae: 0.3348, huber: 0.1028, swd: 0.0749, ept: 185.2927
      Epoch 3 composite train-obj: 0.157733
            Val objective improved 0.1870 → 0.1767, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 0.4113, mae: 0.3891, huber: 0.1541, swd: 0.1795, ept: 207.3624
    Epoch [4/50], Val Losses: mse: 0.4521, mae: 0.4881, huber: 0.2061, swd: 0.1699, ept: 129.7097
    Epoch [4/50], Test Losses: mse: 0.2234, mae: 0.3478, huber: 0.1085, swd: 0.0783, ept: 181.1869
      Epoch 4 composite train-obj: 0.154080
            No improvement (0.2061), counter 1/5
    Epoch [5/50], Train Losses: mse: 0.4127, mae: 0.3898, huber: 0.1544, swd: 0.1791, ept: 207.6176
    Epoch [5/50], Val Losses: mse: 0.3914, mae: 0.4647, huber: 0.1841, swd: 0.1433, ept: 130.3535
    Epoch [5/50], Test Losses: mse: 0.2308, mae: 0.3604, huber: 0.1133, swd: 0.0809, ept: 173.1904
      Epoch 5 composite train-obj: 0.154446
            No improvement (0.1841), counter 2/5
    Epoch [6/50], Train Losses: mse: 0.4089, mae: 0.3869, huber: 0.1528, swd: 0.1783, ept: 209.2437
    Epoch [6/50], Val Losses: mse: 0.4365, mae: 0.4864, huber: 0.2040, swd: 0.1634, ept: 132.8156
    Epoch [6/50], Test Losses: mse: 0.2202, mae: 0.3478, huber: 0.1078, swd: 0.0758, ept: 183.2071
      Epoch 6 composite train-obj: 0.152794
            No improvement (0.2040), counter 3/5
    Epoch [7/50], Train Losses: mse: 0.4130, mae: 0.3876, huber: 0.1540, swd: 0.1803, ept: 209.6109
    Epoch [7/50], Val Losses: mse: 0.5174, mae: 0.5347, huber: 0.2363, swd: 0.2725, ept: 124.0925
    Epoch [7/50], Test Losses: mse: 0.2298, mae: 0.3443, huber: 0.1109, swd: 0.0879, ept: 171.8086
      Epoch 7 composite train-obj: 0.153985
            No improvement (0.2363), counter 4/5
    Epoch [8/50], Train Losses: mse: 0.4179, mae: 0.3920, huber: 0.1560, swd: 0.1828, ept: 207.8427
    Epoch [8/50], Val Losses: mse: 0.4350, mae: 0.4836, huber: 0.2002, swd: 0.1718, ept: 131.0434
    Epoch [8/50], Test Losses: mse: 0.2132, mae: 0.3325, huber: 0.1033, swd: 0.0788, ept: 185.5559
      Epoch 8 composite train-obj: 0.156044
    Epoch [8/50], Test Losses: mse: 0.2115, mae: 0.3348, huber: 0.1028, swd: 0.0749, ept: 185.2927
    Best round's Test MSE: 0.2115, MAE: 0.3348, SWD: 0.0749
    Best round's Validation MSE: 0.3731, MAE: 0.4496, SWD: 0.1177
    Best round's Test verification MSE : 0.2115, MAE: 0.3348, SWD: 0.0749
    Time taken: 9.89 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.4870, mae: 0.4360, huber: 0.1832, swd: 0.1940, ept: 165.6434
    Epoch [1/50], Val Losses: mse: 0.3836, mae: 0.4574, huber: 0.1809, swd: 0.1206, ept: 127.6325
    Epoch [1/50], Test Losses: mse: 0.1998, mae: 0.3205, huber: 0.0973, swd: 0.0554, ept: 181.5922
      Epoch 1 composite train-obj: 0.183157
            Val objective improved inf → 0.1809, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.4194, mae: 0.3943, huber: 0.1572, swd: 0.1779, ept: 200.3911
    Epoch [2/50], Val Losses: mse: 0.3744, mae: 0.4549, huber: 0.1773, swd: 0.1121, ept: 129.7152
    Epoch [2/50], Test Losses: mse: 0.2137, mae: 0.3396, huber: 0.1044, swd: 0.0611, ept: 169.6785
      Epoch 2 composite train-obj: 0.157177
            Val objective improved 0.1809 → 0.1773, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.4174, mae: 0.3926, huber: 0.1563, swd: 0.1776, ept: 204.0216
    Epoch [3/50], Val Losses: mse: 0.4202, mae: 0.4836, huber: 0.1972, swd: 0.1326, ept: 135.5798
    Epoch [3/50], Test Losses: mse: 0.2169, mae: 0.3488, huber: 0.1064, swd: 0.0745, ept: 178.2535
      Epoch 3 composite train-obj: 0.156264
            No improvement (0.1972), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.4324, mae: 0.3960, huber: 0.1592, swd: 0.1884, ept: 206.1432
    Epoch [4/50], Val Losses: mse: 0.3875, mae: 0.4641, huber: 0.1837, swd: 0.1188, ept: 136.7030
    Epoch [4/50], Test Losses: mse: 0.1939, mae: 0.3177, huber: 0.0949, swd: 0.0539, ept: 188.0239
      Epoch 4 composite train-obj: 0.159208
            No improvement (0.1837), counter 2/5
    Epoch [5/50], Train Losses: mse: 0.4131, mae: 0.3892, huber: 0.1546, swd: 0.1752, ept: 207.9250
    Epoch [5/50], Val Losses: mse: 0.4131, mae: 0.4787, huber: 0.1942, swd: 0.1383, ept: 129.0854
    Epoch [5/50], Test Losses: mse: 0.1966, mae: 0.3236, huber: 0.0963, swd: 0.0533, ept: 188.5146
      Epoch 5 composite train-obj: 0.154599
            No improvement (0.1942), counter 3/5
    Epoch [6/50], Train Losses: mse: 0.4158, mae: 0.3911, huber: 0.1553, swd: 0.1772, ept: 208.1687
    Epoch [6/50], Val Losses: mse: 0.3718, mae: 0.4499, huber: 0.1764, swd: 0.1116, ept: 135.3057
    Epoch [6/50], Test Losses: mse: 0.1946, mae: 0.3223, huber: 0.0956, swd: 0.0551, ept: 193.0124
      Epoch 6 composite train-obj: 0.155271
            Val objective improved 0.1773 → 0.1764, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 0.4150, mae: 0.3895, huber: 0.1548, swd: 0.1753, ept: 208.4969
    Epoch [7/50], Val Losses: mse: 0.4046, mae: 0.4702, huber: 0.1888, swd: 0.1278, ept: 134.0501
    Epoch [7/50], Test Losses: mse: 0.2300, mae: 0.3504, huber: 0.1114, swd: 0.0722, ept: 173.6898
      Epoch 7 composite train-obj: 0.154835
            No improvement (0.1888), counter 1/5
    Epoch [8/50], Train Losses: mse: 0.4103, mae: 0.3884, huber: 0.1535, swd: 0.1744, ept: 209.0051
    Epoch [8/50], Val Losses: mse: 0.4826, mae: 0.5144, huber: 0.2228, swd: 0.1155, ept: 118.7049
    Epoch [8/50], Test Losses: mse: 0.2306, mae: 0.3493, huber: 0.1119, swd: 0.0543, ept: 176.5367
      Epoch 8 composite train-obj: 0.153549
            No improvement (0.2228), counter 2/5
    Epoch [9/50], Train Losses: mse: 0.4115, mae: 0.3896, huber: 0.1542, swd: 0.1737, ept: 208.0246
    Epoch [9/50], Val Losses: mse: 0.4088, mae: 0.4769, huber: 0.1927, swd: 0.1380, ept: 132.8312
    Epoch [9/50], Test Losses: mse: 0.1944, mae: 0.3191, huber: 0.0951, swd: 0.0553, ept: 189.8353
      Epoch 9 composite train-obj: 0.154184
            No improvement (0.1927), counter 3/5
    Epoch [10/50], Train Losses: mse: 0.4070, mae: 0.3851, huber: 0.1519, swd: 0.1742, ept: 210.9479
    Epoch [10/50], Val Losses: mse: 0.3515, mae: 0.4368, huber: 0.1665, swd: 0.1070, ept: 139.9183
    Epoch [10/50], Test Losses: mse: 0.2252, mae: 0.3498, huber: 0.1096, swd: 0.0808, ept: 185.9206
      Epoch 10 composite train-obj: 0.151858
            Val objective improved 0.1764 → 0.1665, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 0.4071, mae: 0.3866, huber: 0.1523, swd: 0.1744, ept: 210.8124
    Epoch [11/50], Val Losses: mse: 0.3656, mae: 0.4476, huber: 0.1727, swd: 0.1161, ept: 140.0778
    Epoch [11/50], Test Losses: mse: 0.2141, mae: 0.3330, huber: 0.1037, swd: 0.0720, ept: 188.2447
      Epoch 11 composite train-obj: 0.152306
            No improvement (0.1727), counter 1/5
    Epoch [12/50], Train Losses: mse: 0.4435, mae: 0.3982, huber: 0.1618, swd: 0.1925, ept: 208.2576
    Epoch [12/50], Val Losses: mse: 0.4127, mae: 0.4796, huber: 0.1943, swd: 0.1340, ept: 133.0820
    Epoch [12/50], Test Losses: mse: 0.2018, mae: 0.3242, huber: 0.0983, swd: 0.0609, ept: 187.6603
      Epoch 12 composite train-obj: 0.161764
            No improvement (0.1943), counter 2/5
    Epoch [13/50], Train Losses: mse: 0.4167, mae: 0.3923, huber: 0.1560, swd: 0.1762, ept: 208.9174
    Epoch [13/50], Val Losses: mse: 0.4365, mae: 0.4921, huber: 0.2042, swd: 0.1202, ept: 132.9655
    Epoch [13/50], Test Losses: mse: 0.2242, mae: 0.3487, huber: 0.1090, swd: 0.0628, ept: 184.7657
      Epoch 13 composite train-obj: 0.156044
            No improvement (0.2042), counter 3/5
    Epoch [14/50], Train Losses: mse: 0.4112, mae: 0.3883, huber: 0.1536, swd: 0.1736, ept: 209.7232
    Epoch [14/50], Val Losses: mse: 0.4009, mae: 0.4709, huber: 0.1884, swd: 0.1091, ept: 125.4741
    Epoch [14/50], Test Losses: mse: 0.2377, mae: 0.3612, huber: 0.1154, swd: 0.0595, ept: 157.3667
      Epoch 14 composite train-obj: 0.153570
            No improvement (0.1884), counter 4/5
    Epoch [15/50], Train Losses: mse: 0.4128, mae: 0.3897, huber: 0.1542, swd: 0.1753, ept: 208.6733
    Epoch [15/50], Val Losses: mse: 0.4753, mae: 0.5060, huber: 0.2174, swd: 0.1823, ept: 129.3437
    Epoch [15/50], Test Losses: mse: 0.2196, mae: 0.3333, huber: 0.1057, swd: 0.0796, ept: 186.0346
      Epoch 15 composite train-obj: 0.154222
    Epoch [15/50], Test Losses: mse: 0.2252, mae: 0.3498, huber: 0.1096, swd: 0.0808, ept: 185.9206
    Best round's Test MSE: 0.2252, MAE: 0.3498, SWD: 0.0808
    Best round's Validation MSE: 0.3515, MAE: 0.4368, SWD: 0.1070
    Best round's Test verification MSE : 0.2252, MAE: 0.3498, SWD: 0.0808
    Time taken: 17.96 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred336_20250510_2257)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2173 ± 0.0058
      mae: 0.3394 ± 0.0074
      huber: 0.1055 ± 0.0029
      swd: 0.0783 ± 0.0025
      ept: 185.8055 ± 0.3805
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.3641 ± 0.0092
      mae: 0.4455 ± 0.0062
      huber: 0.1724 ± 0.0043
      swd: 0.1170 ± 0.0078
      ept: 137.0199 ± 2.1826
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 40.23 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred336_20250510_2257
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=336,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 88
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 88
    Validation Batches: 6
    Test Batches: 19
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 78.0498, mae: 4.7878, huber: 4.3412, swd: 32.1895, ept: 127.7844
    Epoch [1/50], Val Losses: mse: 29.1497, mae: 3.8133, huber: 3.3568, swd: 8.2845, ept: 111.0111
    Epoch [1/50], Test Losses: mse: 20.9319, mae: 3.0740, huber: 2.6351, swd: 6.5007, ept: 147.3909
      Epoch 1 composite train-obj: 4.341222
            Val objective improved inf → 3.3568, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 40.6924, mae: 3.4945, huber: 3.0578, swd: 20.4568, ept: 176.3051
    Epoch [2/50], Val Losses: mse: 32.5999, mae: 3.9519, huber: 3.4967, swd: 11.4383, ept: 118.6259
    Epoch [2/50], Test Losses: mse: 21.0840, mae: 3.0594, huber: 2.6221, swd: 6.3598, ept: 140.8433
      Epoch 2 composite train-obj: 3.057842
            No improvement (3.4967), counter 1/5
    Epoch [3/50], Train Losses: mse: 39.5873, mae: 3.4264, huber: 2.9916, swd: 19.8658, ept: 183.2994
    Epoch [3/50], Val Losses: mse: 32.9138, mae: 3.9536, huber: 3.4976, swd: 11.0541, ept: 122.3521
    Epoch [3/50], Test Losses: mse: 21.4812, mae: 3.1345, huber: 2.6829, swd: 7.1351, ept: 157.1313
      Epoch 3 composite train-obj: 2.991599
            No improvement (3.4976), counter 2/5
    Epoch [4/50], Train Losses: mse: 40.7319, mae: 3.4609, huber: 3.0255, swd: 20.7989, ept: 185.8050
    Epoch [4/50], Val Losses: mse: 33.8709, mae: 4.0243, huber: 3.5696, swd: 12.7266, ept: 119.3864
    Epoch [4/50], Test Losses: mse: 22.9066, mae: 3.1696, huber: 2.7302, swd: 8.1286, ept: 145.7398
      Epoch 4 composite train-obj: 3.025455
            No improvement (3.5696), counter 3/5
    Epoch [5/50], Train Losses: mse: 38.6710, mae: 3.3796, huber: 2.9458, swd: 19.3430, ept: 185.5978
    Epoch [5/50], Val Losses: mse: 33.5660, mae: 4.0042, huber: 3.5496, swd: 14.3002, ept: 132.0670
    Epoch [5/50], Test Losses: mse: 23.6614, mae: 3.3893, huber: 2.9412, swd: 9.8859, ept: 154.9116
      Epoch 5 composite train-obj: 2.945808
            No improvement (3.5496), counter 4/5
    Epoch [6/50], Train Losses: mse: 38.5958, mae: 3.3722, huber: 2.9386, swd: 19.4443, ept: 188.9186
    Epoch [6/50], Val Losses: mse: 34.8114, mae: 4.0446, huber: 3.5903, swd: 13.3294, ept: 126.4277
    Epoch [6/50], Test Losses: mse: 22.3653, mae: 3.1073, huber: 2.6690, swd: 7.9146, ept: 157.8525
      Epoch 6 composite train-obj: 2.938572
    Epoch [6/50], Test Losses: mse: 20.9319, mae: 3.0740, huber: 2.6351, swd: 6.5007, ept: 147.3909
    Best round's Test MSE: 20.9319, MAE: 3.0740, SWD: 6.5007
    Best round's Validation MSE: 29.1497, MAE: 3.8133, SWD: 8.2845
    Best round's Test verification MSE : 20.9319, MAE: 3.0740, SWD: 6.5007
    Time taken: 5.93 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 77.2344, mae: 4.7660, huber: 4.3191, swd: 33.9343, ept: 126.9362
    Epoch [1/50], Val Losses: mse: 32.8529, mae: 4.0151, huber: 3.5578, swd: 11.0048, ept: 112.4798
    Epoch [1/50], Test Losses: mse: 20.2190, mae: 3.0048, huber: 2.5662, swd: 6.1664, ept: 150.2816
      Epoch 1 composite train-obj: 4.319102
            Val objective improved inf → 3.5578, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 41.5984, mae: 3.5361, huber: 3.0992, swd: 22.0065, ept: 175.4104
    Epoch [2/50], Val Losses: mse: 31.0150, mae: 3.9510, huber: 3.4927, swd: 9.3730, ept: 120.8440
    Epoch [2/50], Test Losses: mse: 21.6917, mae: 3.0953, huber: 2.6564, swd: 6.7872, ept: 153.9075
      Epoch 2 composite train-obj: 3.099208
            Val objective improved 3.5578 → 3.4927, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 39.8763, mae: 3.4544, huber: 3.0191, swd: 20.9810, ept: 182.8118
    Epoch [3/50], Val Losses: mse: 30.0796, mae: 3.8341, huber: 3.3788, swd: 10.6794, ept: 125.6763
    Epoch [3/50], Test Losses: mse: 19.9176, mae: 2.9760, huber: 2.5401, swd: 6.4032, ept: 159.7229
      Epoch 3 composite train-obj: 3.019129
            Val objective improved 3.4927 → 3.3788, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 38.3334, mae: 3.3458, huber: 2.9126, swd: 20.2872, ept: 190.5524
    Epoch [4/50], Val Losses: mse: 30.0290, mae: 3.8121, huber: 3.3579, swd: 8.4752, ept: 127.8964
    Epoch [4/50], Test Losses: mse: 21.8351, mae: 3.1419, huber: 2.7020, swd: 6.8230, ept: 157.3487
      Epoch 4 composite train-obj: 2.912593
            Val objective improved 3.3788 → 3.3579, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 38.8465, mae: 3.3849, huber: 2.9515, swd: 20.2377, ept: 189.0186
    Epoch [5/50], Val Losses: mse: 30.3852, mae: 3.8851, huber: 3.4310, swd: 10.9673, ept: 129.0152
    Epoch [5/50], Test Losses: mse: 23.7751, mae: 3.3127, huber: 2.8690, swd: 10.5394, ept: 156.4128
      Epoch 5 composite train-obj: 2.951541
            No improvement (3.4310), counter 1/5
    Epoch [6/50], Train Losses: mse: 38.2139, mae: 3.3398, huber: 2.9073, swd: 20.1628, ept: 192.6983
    Epoch [6/50], Val Losses: mse: 30.9322, mae: 3.8675, huber: 3.4112, swd: 10.5137, ept: 132.3059
    Epoch [6/50], Test Losses: mse: 20.6769, mae: 3.0304, huber: 2.5919, swd: 6.4894, ept: 144.5857
      Epoch 6 composite train-obj: 2.907253
            No improvement (3.4112), counter 2/5
    Epoch [7/50], Train Losses: mse: 39.1615, mae: 3.3474, huber: 2.9151, swd: 20.8929, ept: 192.9588
    Epoch [7/50], Val Losses: mse: 35.4735, mae: 4.2022, huber: 3.7427, swd: 16.8043, ept: 126.0481
    Epoch [7/50], Test Losses: mse: 29.9522, mae: 3.7098, huber: 3.2638, swd: 16.0471, ept: 152.3691
      Epoch 7 composite train-obj: 2.915052
            No improvement (3.7427), counter 3/5
    Epoch [8/50], Train Losses: mse: 38.6458, mae: 3.3678, huber: 2.9350, swd: 20.1853, ept: 191.3267
    Epoch [8/50], Val Losses: mse: 32.5882, mae: 3.9810, huber: 3.5244, swd: 10.5943, ept: 130.2451
    Epoch [8/50], Test Losses: mse: 24.7996, mae: 3.4536, huber: 3.0057, swd: 7.5884, ept: 135.8696
      Epoch 8 composite train-obj: 2.934962
            No improvement (3.5244), counter 4/5
    Epoch [9/50], Train Losses: mse: 39.0449, mae: 3.3705, huber: 2.9372, swd: 20.1705, ept: 188.6983
    Epoch [9/50], Val Losses: mse: 31.4503, mae: 4.0355, huber: 3.5746, swd: 10.9380, ept: 131.3113
    Epoch [9/50], Test Losses: mse: 22.5477, mae: 3.2036, huber: 2.7604, swd: 8.6073, ept: 155.9632
      Epoch 9 composite train-obj: 2.937234
    Epoch [9/50], Test Losses: mse: 21.8351, mae: 3.1419, huber: 2.7020, swd: 6.8230, ept: 157.3487
    Best round's Test MSE: 21.8351, MAE: 3.1419, SWD: 6.8230
    Best round's Validation MSE: 30.0290, MAE: 3.8121, SWD: 8.4752
    Best round's Test verification MSE : 21.8351, MAE: 3.1419, SWD: 6.8230
    Time taken: 8.36 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 77.5064, mae: 4.7498, huber: 4.3036, swd: 31.0014, ept: 127.5426
    Epoch [1/50], Val Losses: mse: 30.2134, mae: 3.8358, huber: 3.3808, swd: 8.1433, ept: 112.4267
    Epoch [1/50], Test Losses: mse: 21.3244, mae: 3.0976, huber: 2.6585, swd: 6.4959, ept: 148.9540
      Epoch 1 composite train-obj: 4.303554
            Val objective improved inf → 3.3808, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 40.7665, mae: 3.4941, huber: 3.0579, swd: 20.0007, ept: 175.8187
    Epoch [2/50], Val Losses: mse: 30.2808, mae: 3.8468, huber: 3.3907, swd: 8.7089, ept: 124.0080
    Epoch [2/50], Test Losses: mse: 20.3133, mae: 3.0381, huber: 2.5981, swd: 5.1772, ept: 154.6190
      Epoch 2 composite train-obj: 3.057858
            No improvement (3.3907), counter 1/5
    Epoch [3/50], Train Losses: mse: 39.4352, mae: 3.4198, huber: 2.9850, swd: 19.3042, ept: 185.5720
    Epoch [3/50], Val Losses: mse: 32.0648, mae: 3.9661, huber: 3.5085, swd: 9.2908, ept: 124.4277
    Epoch [3/50], Test Losses: mse: 22.4347, mae: 3.2668, huber: 2.8201, swd: 6.5124, ept: 148.3748
      Epoch 3 composite train-obj: 2.984987
            No improvement (3.5085), counter 2/5
    Epoch [4/50], Train Losses: mse: 40.1436, mae: 3.4124, huber: 2.9787, swd: 19.8825, ept: 188.9793
    Epoch [4/50], Val Losses: mse: 32.7401, mae: 3.9168, huber: 3.4628, swd: 10.8008, ept: 129.8851
    Epoch [4/50], Test Losses: mse: 21.1392, mae: 3.0357, huber: 2.5981, swd: 6.6078, ept: 161.4650
      Epoch 4 composite train-obj: 2.978733
            No improvement (3.4628), counter 3/5
    Epoch [5/50], Train Losses: mse: 38.8330, mae: 3.3728, huber: 2.9397, swd: 18.8415, ept: 189.7791
    Epoch [5/50], Val Losses: mse: 30.8257, mae: 3.9538, huber: 3.4932, swd: 9.3912, ept: 129.3698
    Epoch [5/50], Test Losses: mse: 22.7132, mae: 3.2008, huber: 2.7581, swd: 7.2924, ept: 159.9718
      Epoch 5 composite train-obj: 2.939696
            No improvement (3.4932), counter 4/5
    Epoch [6/50], Train Losses: mse: 38.3470, mae: 3.3490, huber: 2.9159, swd: 18.5789, ept: 191.8135
    Epoch [6/50], Val Losses: mse: 31.9306, mae: 3.9152, huber: 3.4586, swd: 10.2023, ept: 126.7130
    Epoch [6/50], Test Losses: mse: 21.9002, mae: 3.1115, huber: 2.6700, swd: 6.4347, ept: 156.7305
      Epoch 6 composite train-obj: 2.915860
    Epoch [6/50], Test Losses: mse: 21.3244, mae: 3.0976, huber: 2.6585, swd: 6.4959, ept: 148.9540
    Best round's Test MSE: 21.3244, MAE: 3.0976, SWD: 6.4959
    Best round's Validation MSE: 30.2134, MAE: 3.8358, SWD: 8.1433
    Best round's Test verification MSE : 21.3244, MAE: 3.0976, SWD: 6.4959
    Time taken: 5.57 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred336_20250511_0045)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 21.3638 ± 0.3698
      mae: 3.1045 ± 0.0282
      huber: 2.6652 ± 0.0277
      swd: 6.6065 ± 0.1531
      ept: 151.2312 ± 4.3725
      count: 6.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 29.7974 ± 0.4641
      mae: 3.8204 ± 0.0109
      huber: 3.3652 ± 0.0110
      swd: 8.3010 ± 0.1360
      ept: 117.1114 ± 7.6480
      count: 6.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 19.98 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred336_20250511_0045
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=True)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([1.0258, 1.0527, 0.8852, 1.0967, 1.0979, 0.8402, 1.0425],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: Yes
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6207, mae: 0.5082, huber: 0.2310, swd: 0.2698, ept: 249.7384
    Epoch [1/50], Val Losses: mse: 0.4561, mae: 0.5112, huber: 0.2137, swd: 0.1387, ept: 198.3601
    Epoch [1/50], Test Losses: mse: 0.2555, mae: 0.3577, huber: 0.1213, swd: 0.0943, ept: 296.0797
      Epoch 1 composite train-obj: 0.231019
            Val objective improved inf → 0.2137, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5595, mae: 0.4699, huber: 0.2069, swd: 0.2579, ept: 302.8309
    Epoch [2/50], Val Losses: mse: 0.4580, mae: 0.5100, huber: 0.2109, swd: 0.1620, ept: 203.1122
    Epoch [2/50], Test Losses: mse: 0.2963, mae: 0.4004, huber: 0.1405, swd: 0.1283, ept: 232.1581
      Epoch 2 composite train-obj: 0.206893
            Val objective improved 0.2137 → 0.2109, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 0.5555, mae: 0.4682, huber: 0.2052, swd: 0.2553, ept: 308.1264
    Epoch [3/50], Val Losses: mse: 0.4935, mae: 0.5334, huber: 0.2308, swd: 0.1881, ept: 191.6328
    Epoch [3/50], Test Losses: mse: 0.2889, mae: 0.3777, huber: 0.1349, swd: 0.1162, ept: 293.9963
      Epoch 3 composite train-obj: 0.205235
            No improvement (0.2308), counter 1/5
    Epoch [4/50], Train Losses: mse: 0.5507, mae: 0.4660, huber: 0.2037, swd: 0.2553, ept: 312.7689
    Epoch [4/50], Val Losses: mse: 0.4222, mae: 0.4934, huber: 0.1973, swd: 0.1188, ept: 203.5069
    Epoch [4/50], Test Losses: mse: 0.2719, mae: 0.3834, huber: 0.1299, swd: 0.0983, ept: 267.3362
      Epoch 4 composite train-obj: 0.203716
            Val objective improved 0.2109 → 0.1973, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 0.5461, mae: 0.4614, huber: 0.2013, swd: 0.2519, ept: 318.7863
    Epoch [5/50], Val Losses: mse: 0.4566, mae: 0.5127, huber: 0.2129, swd: 0.1626, ept: 196.9195
    Epoch [5/50], Test Losses: mse: 0.2516, mae: 0.3560, huber: 0.1198, swd: 0.0900, ept: 297.7267
      Epoch 5 composite train-obj: 0.201272
            No improvement (0.2129), counter 1/5
    Epoch [6/50], Train Losses: mse: 0.5663, mae: 0.4683, huber: 0.2069, swd: 0.2664, ept: 317.2075
    Epoch [6/50], Val Losses: mse: 0.4865, mae: 0.5378, huber: 0.2272, swd: 0.1401, ept: 208.5648
    Epoch [6/50], Test Losses: mse: 0.2762, mae: 0.3720, huber: 0.1296, swd: 0.0923, ept: 300.8461
      Epoch 6 composite train-obj: 0.206947
            No improvement (0.2272), counter 2/5
    Epoch [7/50], Train Losses: mse: 0.5501, mae: 0.4640, huber: 0.2030, swd: 0.2535, ept: 318.0189
    Epoch [7/50], Val Losses: mse: 0.5329, mae: 0.5455, huber: 0.2398, swd: 0.1339, ept: 204.0994
    Epoch [7/50], Test Losses: mse: 0.2853, mae: 0.3819, huber: 0.1342, swd: 0.1123, ept: 267.9457
      Epoch 7 composite train-obj: 0.202986
            No improvement (0.2398), counter 3/5
    Epoch [8/50], Train Losses: mse: 0.5537, mae: 0.4670, huber: 0.2046, swd: 0.2553, ept: 318.5309
    Epoch [8/50], Val Losses: mse: 0.5702, mae: 0.5526, huber: 0.2565, swd: 0.1638, ept: 210.1627
    Epoch [8/50], Test Losses: mse: 0.3029, mae: 0.4125, huber: 0.1462, swd: 0.1169, ept: 217.7941
      Epoch 8 composite train-obj: 0.204584
            No improvement (0.2565), counter 4/5
    Epoch [9/50], Train Losses: mse: 0.5524, mae: 0.4663, huber: 0.2039, swd: 0.2545, ept: 318.1507
    Epoch [9/50], Val Losses: mse: 0.4822, mae: 0.5202, huber: 0.2219, swd: 0.1220, ept: 221.5235
    Epoch [9/50], Test Losses: mse: 0.2608, mae: 0.3691, huber: 0.1247, swd: 0.0706, ept: 293.0712
      Epoch 9 composite train-obj: 0.203921
    Epoch [9/50], Test Losses: mse: 0.2719, mae: 0.3834, huber: 0.1299, swd: 0.0983, ept: 267.3362
    Best round's Test MSE: 0.2719, MAE: 0.3834, SWD: 0.0983
    Best round's Validation MSE: 0.4222, MAE: 0.4934, SWD: 0.1188
    Best round's Test verification MSE : 0.2719, MAE: 0.3834, SWD: 0.0983
    Time taken: 11.96 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6158, mae: 0.5066, huber: 0.2294, swd: 0.2602, ept: 248.7884
    Epoch [1/50], Val Losses: mse: 0.3992, mae: 0.4813, huber: 0.1898, swd: 0.0772, ept: 194.9538
    Epoch [1/50], Test Losses: mse: 0.2433, mae: 0.3575, huber: 0.1171, swd: 0.0678, ept: 294.5698
      Epoch 1 composite train-obj: 0.229419
            Val objective improved inf → 0.1898, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5629, mae: 0.4726, huber: 0.2080, swd: 0.2513, ept: 301.1844
    Epoch [2/50], Val Losses: mse: 0.4351, mae: 0.4976, huber: 0.2063, swd: 0.0989, ept: 206.1419
    Epoch [2/50], Test Losses: mse: 0.2518, mae: 0.3623, huber: 0.1207, swd: 0.0722, ept: 304.6670
      Epoch 2 composite train-obj: 0.207957
            No improvement (0.2063), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.5523, mae: 0.4652, huber: 0.2040, swd: 0.2492, ept: 311.8174
    Epoch [3/50], Val Losses: mse: 0.4872, mae: 0.5277, huber: 0.2253, swd: 0.1048, ept: 196.8767
    Epoch [3/50], Test Losses: mse: 0.2573, mae: 0.3628, huber: 0.1223, swd: 0.0783, ept: 299.6203
      Epoch 3 composite train-obj: 0.203984
            No improvement (0.2253), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.5480, mae: 0.4635, huber: 0.2024, swd: 0.2461, ept: 313.6706
    Epoch [4/50], Val Losses: mse: 0.4145, mae: 0.4929, huber: 0.1960, swd: 0.1008, ept: 211.6672
    Epoch [4/50], Test Losses: mse: 0.3196, mae: 0.4015, huber: 0.1488, swd: 0.1177, ept: 204.6106
      Epoch 4 composite train-obj: 0.202352
            No improvement (0.1960), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.5503, mae: 0.4646, huber: 0.2031, swd: 0.2466, ept: 315.4467
    Epoch [5/50], Val Losses: mse: 0.4429, mae: 0.5003, huber: 0.2048, swd: 0.1294, ept: 222.7377
    Epoch [5/50], Test Losses: mse: 0.2652, mae: 0.3790, huber: 0.1270, swd: 0.0978, ept: 289.3478
      Epoch 5 composite train-obj: 0.203101
            No improvement (0.2048), counter 4/5
    Epoch [6/50], Train Losses: mse: 0.5540, mae: 0.4657, huber: 0.2042, swd: 0.2478, ept: 317.2030
    Epoch [6/50], Val Losses: mse: 0.4590, mae: 0.5060, huber: 0.2127, swd: 0.1023, ept: 217.0866
    Epoch [6/50], Test Losses: mse: 0.2450, mae: 0.3626, huber: 0.1182, swd: 0.0662, ept: 300.4094
      Epoch 6 composite train-obj: 0.204168
    Epoch [6/50], Test Losses: mse: 0.2433, mae: 0.3575, huber: 0.1171, swd: 0.0678, ept: 294.5698
    Best round's Test MSE: 0.2433, MAE: 0.3575, SWD: 0.0678
    Best round's Validation MSE: 0.3992, MAE: 0.4813, SWD: 0.0772
    Best round's Test verification MSE : 0.2433, MAE: 0.3575, SWD: 0.0678
    Time taken: 7.60 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 0.6143, mae: 0.5058, huber: 0.2289, swd: 0.2824, ept: 250.4285
    Epoch [1/50], Val Losses: mse: 0.4126, mae: 0.4933, huber: 0.1964, swd: 0.0889, ept: 207.1799
    Epoch [1/50], Test Losses: mse: 0.2569, mae: 0.3610, huber: 0.1221, swd: 0.0808, ept: 293.5440
      Epoch 1 composite train-obj: 0.228902
            Val objective improved inf → 0.1964, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 0.5773, mae: 0.4755, huber: 0.2112, swd: 0.2810, ept: 301.1424
    Epoch [2/50], Val Losses: mse: 0.4729, mae: 0.5279, huber: 0.2220, swd: 0.1142, ept: 196.6016
    Epoch [2/50], Test Losses: mse: 0.3048, mae: 0.3974, huber: 0.1430, swd: 0.1091, ept: 273.5835
      Epoch 2 composite train-obj: 0.211207
            No improvement (0.2220), counter 1/5
    Epoch [3/50], Train Losses: mse: 0.5594, mae: 0.4698, huber: 0.2065, swd: 0.2715, ept: 309.5392
    Epoch [3/50], Val Losses: mse: 0.4495, mae: 0.5038, huber: 0.2116, swd: 0.1085, ept: 208.1474
    Epoch [3/50], Test Losses: mse: 0.2330, mae: 0.3488, huber: 0.1123, swd: 0.0715, ept: 304.1426
      Epoch 3 composite train-obj: 0.206544
            No improvement (0.2116), counter 2/5
    Epoch [4/50], Train Losses: mse: 0.5542, mae: 0.4662, huber: 0.2044, swd: 0.2685, ept: 314.5875
    Epoch [4/50], Val Losses: mse: 0.4303, mae: 0.5001, huber: 0.2032, swd: 0.1228, ept: 204.8448
    Epoch [4/50], Test Losses: mse: 0.2813, mae: 0.3742, huber: 0.1322, swd: 0.1101, ept: 292.7704
      Epoch 4 composite train-obj: 0.204365
            No improvement (0.2032), counter 3/5
    Epoch [5/50], Train Losses: mse: 0.5521, mae: 0.4650, huber: 0.2036, swd: 0.2695, ept: 315.1166
    Epoch [5/50], Val Losses: mse: 0.4044, mae: 0.4831, huber: 0.1920, swd: 0.0929, ept: 210.8092
    Epoch [5/50], Test Losses: mse: 0.2478, mae: 0.3629, huber: 0.1192, swd: 0.0737, ept: 278.1654
      Epoch 5 composite train-obj: 0.203646
            Val objective improved 0.1964 → 0.1920, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 0.5698, mae: 0.4726, huber: 0.2086, swd: 0.2748, ept: 314.2069
    Epoch [6/50], Val Losses: mse: 0.4438, mae: 0.5033, huber: 0.2079, swd: 0.0936, ept: 218.0768
    Epoch [6/50], Test Losses: mse: 0.2531, mae: 0.3678, huber: 0.1217, swd: 0.0738, ept: 299.6666
      Epoch 6 composite train-obj: 0.208598
            No improvement (0.2079), counter 1/5
    Epoch [7/50], Train Losses: mse: 0.5648, mae: 0.4687, huber: 0.2068, swd: 0.2761, ept: 319.6196
    Epoch [7/50], Val Losses: mse: 0.4663, mae: 0.5160, huber: 0.2177, swd: 0.1138, ept: 217.3088
    Epoch [7/50], Test Losses: mse: 0.2613, mae: 0.3695, huber: 0.1241, swd: 0.0822, ept: 306.2166
      Epoch 7 composite train-obj: 0.206838
            No improvement (0.2177), counter 2/5
    Epoch [8/50], Train Losses: mse: 0.5449, mae: 0.4613, huber: 0.2010, swd: 0.2662, ept: 319.9777
    Epoch [8/50], Val Losses: mse: 0.3817, mae: 0.4779, huber: 0.1817, swd: 0.0888, ept: 227.7378
    Epoch [8/50], Test Losses: mse: 0.3026, mae: 0.3986, huber: 0.1431, swd: 0.1124, ept: 229.5069
      Epoch 8 composite train-obj: 0.201025
            Val objective improved 0.1920 → 0.1817, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 0.5481, mae: 0.4637, huber: 0.2023, swd: 0.2676, ept: 318.4105
    Epoch [9/50], Val Losses: mse: 0.5020, mae: 0.5361, huber: 0.2318, swd: 0.1482, ept: 205.8702
    Epoch [9/50], Test Losses: mse: 0.2446, mae: 0.3626, huber: 0.1178, swd: 0.0775, ept: 293.2761
      Epoch 9 composite train-obj: 0.202339
            No improvement (0.2318), counter 1/5
    Epoch [10/50], Train Losses: mse: 0.5540, mae: 0.4642, huber: 0.2035, swd: 0.2691, ept: 321.4754
    Epoch [10/50], Val Losses: mse: 0.4566, mae: 0.5183, huber: 0.2130, swd: 0.1612, ept: 201.9909
    Epoch [10/50], Test Losses: mse: 0.3060, mae: 0.4002, huber: 0.1432, swd: 0.1431, ept: 292.8692
      Epoch 10 composite train-obj: 0.203547
            No improvement (0.2130), counter 2/5
    Epoch [11/50], Train Losses: mse: 0.5484, mae: 0.4632, huber: 0.2022, swd: 0.2658, ept: 322.1934
    Epoch [11/50], Val Losses: mse: 0.5501, mae: 0.5593, huber: 0.2513, swd: 0.1504, ept: 208.7386
    Epoch [11/50], Test Losses: mse: 0.2644, mae: 0.3683, huber: 0.1252, swd: 0.0825, ept: 304.7909
      Epoch 11 composite train-obj: 0.202234
            No improvement (0.2513), counter 3/5
    Epoch [12/50], Train Losses: mse: 0.5469, mae: 0.4620, huber: 0.2016, swd: 0.2663, ept: 319.9507
    Epoch [12/50], Val Losses: mse: 0.4647, mae: 0.5177, huber: 0.2181, swd: 0.1121, ept: 191.7925
    Epoch [12/50], Test Losses: mse: 0.2641, mae: 0.3810, huber: 0.1271, swd: 0.0818, ept: 265.5420
      Epoch 12 composite train-obj: 0.201566
            No improvement (0.2181), counter 4/5
    Epoch [13/50], Train Losses: mse: 0.5707, mae: 0.4702, huber: 0.2081, swd: 0.2807, ept: 317.3109
    Epoch [13/50], Val Losses: mse: 0.5031, mae: 0.5390, huber: 0.2339, swd: 0.1119, ept: 191.9525
    Epoch [13/50], Test Losses: mse: 0.2729, mae: 0.3743, huber: 0.1291, swd: 0.0834, ept: 293.8815
      Epoch 13 composite train-obj: 0.208080
    Epoch [13/50], Test Losses: mse: 0.3026, mae: 0.3986, huber: 0.1431, swd: 0.1124, ept: 229.5069
    Best round's Test MSE: 0.3026, MAE: 0.3986, SWD: 0.1124
    Best round's Validation MSE: 0.3817, MAE: 0.4779, SWD: 0.0888
    Best round's Test verification MSE : 0.3026, MAE: 0.3986, SWD: 0.1124
    Time taken: 16.26 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred720_20250510_2257)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 0.2726 ± 0.0242
      mae: 0.3798 ± 0.0170
      huber: 0.1300 ± 0.0106
      swd: 0.0928 ± 0.0186
      ept: 263.8043 ± 26.6790
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 0.4010 ± 0.0166
      mae: 0.4842 ± 0.0066
      huber: 0.1896 ± 0.0064
      swd: 0.0949 ± 0.0176
      ept: 208.7328 ± 13.8848
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 36.02 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred720_20250510_2257
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=720,
    pred_len=720,
    channels=data_mgr.datasets['etth2']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth2', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth2: tensor([10.2186,  6.0203, 13.0564,  4.3659,  6.1442,  6.0126, 11.8879],
           device='cuda:0')
    Train set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([720, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 85
    Batch 0: Data shape torch.Size([128, 720, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth2
    ==================================================
    Sequence Length: 720
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 85
    Validation Batches: 3
    Test Batches: 16
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 97.6026, mae: 5.4716, huber: 5.0176, swd: 43.1829, ept: 207.2241
    Epoch [1/50], Val Losses: mse: 29.5728, mae: 3.8762, huber: 3.4216, swd: 7.7887, ept: 179.9783
    Epoch [1/50], Test Losses: mse: 24.0779, mae: 3.2836, huber: 2.8338, swd: 8.0903, ept: 261.2998
      Epoch 1 composite train-obj: 5.017601
            Val objective improved inf → 3.4216, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 59.1904, mae: 4.2484, huber: 3.8018, swd: 31.4697, ept: 271.0151
    Epoch [2/50], Val Losses: mse: 38.8725, mae: 4.2409, huber: 3.7861, swd: 17.8754, ept: 183.1987
    Epoch [2/50], Test Losses: mse: 32.6252, mae: 3.9796, huber: 3.5189, swd: 14.7666, ept: 213.0795
      Epoch 2 composite train-obj: 3.801830
            No improvement (3.7861), counter 1/5
    Epoch [3/50], Train Losses: mse: 57.8630, mae: 4.1970, huber: 3.7508, swd: 30.7219, ept: 278.1097
    Epoch [3/50], Val Losses: mse: 37.2166, mae: 4.2761, huber: 3.8244, swd: 14.9878, ept: 194.4769
    Epoch [3/50], Test Losses: mse: 26.7288, mae: 3.5877, huber: 3.1294, swd: 9.8435, ept: 247.2698
      Epoch 3 composite train-obj: 3.750784
            No improvement (3.8244), counter 2/5
    Epoch [4/50], Train Losses: mse: 57.1927, mae: 4.1457, huber: 3.7006, swd: 30.2918, ept: 285.3712
    Epoch [4/50], Val Losses: mse: 25.7150, mae: 3.6146, huber: 3.1645, swd: 5.3760, ept: 200.3355
    Epoch [4/50], Test Losses: mse: 26.5727, mae: 3.4623, huber: 3.0084, swd: 9.8976, ept: 235.0925
      Epoch 4 composite train-obj: 3.700558
            Val objective improved 3.4216 → 3.1645, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 56.8423, mae: 4.1155, huber: 3.6711, swd: 30.2491, ept: 291.9177
    Epoch [5/50], Val Losses: mse: 42.7658, mae: 4.4451, huber: 3.9940, swd: 22.8147, ept: 205.2536
    Epoch [5/50], Test Losses: mse: 29.1229, mae: 3.7488, huber: 3.2902, swd: 14.0311, ept: 258.1638
      Epoch 5 composite train-obj: 3.671134
            No improvement (3.9940), counter 1/5
    Epoch [6/50], Train Losses: mse: 58.7364, mae: 4.1734, huber: 3.7289, swd: 31.7414, ept: 289.3043
    Epoch [6/50], Val Losses: mse: 33.1786, mae: 4.0213, huber: 3.5652, swd: 13.3032, ept: 196.5690
    Epoch [6/50], Test Losses: mse: 25.0166, mae: 3.4056, huber: 2.9540, swd: 8.4655, ept: 263.6494
      Epoch 6 composite train-obj: 3.728875
            No improvement (3.5652), counter 2/5
    Epoch [7/50], Train Losses: mse: 56.5024, mae: 4.1006, huber: 3.6565, swd: 30.1231, ept: 293.6384
    Epoch [7/50], Val Losses: mse: 35.0261, mae: 4.0778, huber: 3.6249, swd: 15.1270, ept: 200.7492
    Epoch [7/50], Test Losses: mse: 29.7806, mae: 3.7366, huber: 3.2821, swd: 12.8499, ept: 257.0996
      Epoch 7 composite train-obj: 3.656526
            No improvement (3.6249), counter 3/5
    Epoch [8/50], Train Losses: mse: 56.4787, mae: 4.1109, huber: 3.6663, swd: 30.0399, ept: 292.2440
    Epoch [8/50], Val Losses: mse: 35.0221, mae: 4.2125, huber: 3.7591, swd: 12.5913, ept: 203.1450
    Epoch [8/50], Test Losses: mse: 28.2634, mae: 3.7588, huber: 3.3003, swd: 9.6811, ept: 195.3220
      Epoch 8 composite train-obj: 3.666251
            No improvement (3.7591), counter 4/5
    Epoch [9/50], Train Losses: mse: 57.4000, mae: 4.1130, huber: 3.6685, swd: 30.3372, ept: 292.6760
    Epoch [9/50], Val Losses: mse: 34.1036, mae: 4.1581, huber: 3.7037, swd: 9.7461, ept: 193.8340
    Epoch [9/50], Test Losses: mse: 28.0670, mae: 3.5761, huber: 3.1185, swd: 8.7619, ept: 258.3124
      Epoch 9 composite train-obj: 3.668522
    Epoch [9/50], Test Losses: mse: 26.5727, mae: 3.4623, huber: 3.0084, swd: 9.8976, ept: 235.0925
    Best round's Test MSE: 26.5727, MAE: 3.4623, SWD: 9.8976
    Best round's Validation MSE: 25.7150, MAE: 3.6146, SWD: 5.3760
    Best round's Test verification MSE : 26.5727, MAE: 3.4623, SWD: 9.8976
    Time taken: 9.50 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 96.8300, mae: 5.4570, huber: 5.0029, swd: 39.3011, ept: 205.4223
    Epoch [1/50], Val Losses: mse: 33.1911, mae: 4.0572, huber: 3.6077, swd: 8.4865, ept: 178.9174
    Epoch [1/50], Test Losses: mse: 24.5170, mae: 3.4453, huber: 2.9831, swd: 6.2689, ept: 245.6159
      Epoch 1 composite train-obj: 5.002939
            Val objective improved inf → 3.6077, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 58.9264, mae: 4.2513, huber: 3.8040, swd: 28.7348, ept: 268.7692
    Epoch [2/50], Val Losses: mse: 28.1417, mae: 3.7658, huber: 3.3141, swd: 6.1740, ept: 193.0790
    Epoch [2/50], Test Losses: mse: 24.0726, mae: 3.2405, huber: 2.7926, swd: 7.1656, ept: 271.8232
      Epoch 2 composite train-obj: 3.804030
            Val objective improved 3.6077 → 3.3141, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 57.5943, mae: 4.1687, huber: 3.7232, swd: 28.3076, ept: 281.2256
    Epoch [3/50], Val Losses: mse: 44.7248, mae: 4.5483, huber: 4.0935, swd: 20.3356, ept: 186.6893
    Epoch [3/50], Test Losses: mse: 32.7747, mae: 3.9484, huber: 3.4930, swd: 12.1773, ept: 256.8353
      Epoch 3 composite train-obj: 3.723193
            No improvement (4.0935), counter 1/5
    Epoch [4/50], Train Losses: mse: 57.7185, mae: 4.1739, huber: 3.7286, swd: 28.1939, ept: 283.4921
    Epoch [4/50], Val Losses: mse: 32.9748, mae: 4.0143, huber: 3.5608, swd: 9.7440, ept: 202.9793
    Epoch [4/50], Test Losses: mse: 23.2572, mae: 3.3268, huber: 2.8746, swd: 6.3647, ept: 227.2830
      Epoch 4 composite train-obj: 3.728635
            No improvement (3.5608), counter 2/5
    Epoch [5/50], Train Losses: mse: 56.7565, mae: 4.1200, huber: 3.6754, swd: 27.8739, ept: 289.3153
    Epoch [5/50], Val Losses: mse: 42.9463, mae: 4.4301, huber: 3.9769, swd: 18.5301, ept: 201.8882
    Epoch [5/50], Test Losses: mse: 28.7673, mae: 3.8350, huber: 3.3716, swd: 10.9090, ept: 224.0980
      Epoch 5 composite train-obj: 3.675379
            No improvement (3.9769), counter 3/5
    Epoch [6/50], Train Losses: mse: 56.9050, mae: 4.1314, huber: 3.6865, swd: 27.7915, ept: 288.2938
    Epoch [6/50], Val Losses: mse: 29.9316, mae: 3.8943, huber: 3.4398, swd: 7.6356, ept: 190.9310
    Epoch [6/50], Test Losses: mse: 25.8610, mae: 3.4523, huber: 3.0020, swd: 6.7551, ept: 260.7911
      Epoch 6 composite train-obj: 3.686482
            No improvement (3.4398), counter 4/5
    Epoch [7/50], Train Losses: mse: 56.5042, mae: 4.0955, huber: 3.6513, swd: 27.6013, ept: 288.6957
    Epoch [7/50], Val Losses: mse: 28.0462, mae: 3.7916, huber: 3.3370, swd: 7.1782, ept: 199.5262
    Epoch [7/50], Test Losses: mse: 24.9711, mae: 3.3795, huber: 2.9293, swd: 6.8756, ept: 227.7659
      Epoch 7 composite train-obj: 3.651335
    Epoch [7/50], Test Losses: mse: 24.0726, mae: 3.2405, huber: 2.7926, swd: 7.1656, ept: 271.8232
    Best round's Test MSE: 24.0726, MAE: 3.2405, SWD: 7.1656
    Best round's Validation MSE: 28.1417, MAE: 3.7658, SWD: 6.1740
    Best round's Test verification MSE : 24.0726, MAE: 3.2405, SWD: 7.1656
    Time taken: 7.91 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 97.3572, mae: 5.4666, huber: 5.0126, swd: 44.5246, ept: 206.8712
    Epoch [1/50], Val Losses: mse: 28.4430, mae: 3.7985, huber: 3.3445, swd: 5.9811, ept: 180.3819
    Epoch [1/50], Test Losses: mse: 24.0306, mae: 3.3329, huber: 2.8786, swd: 7.2140, ept: 234.1536
      Epoch 1 composite train-obj: 5.012578
            Val objective improved inf → 3.3445, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 61.4648, mae: 4.3095, huber: 3.8624, swd: 34.6350, ept: 265.0598
    Epoch [2/50], Val Losses: mse: 33.2252, mae: 4.0684, huber: 3.6136, swd: 9.7288, ept: 194.9860
    Epoch [2/50], Test Losses: mse: 24.6509, mae: 3.3889, huber: 2.9376, swd: 7.6285, ept: 258.2071
      Epoch 2 composite train-obj: 3.862431
            No improvement (3.6136), counter 1/5
    Epoch [3/50], Train Losses: mse: 57.8269, mae: 4.1775, huber: 3.7318, swd: 32.2841, ept: 281.1403
    Epoch [3/50], Val Losses: mse: 32.1490, mae: 4.0066, huber: 3.5576, swd: 6.6872, ept: 189.6460
    Epoch [3/50], Test Losses: mse: 27.0506, mae: 3.4564, huber: 3.0023, swd: 7.3374, ept: 265.2836
      Epoch 3 composite train-obj: 3.731793
            No improvement (3.5576), counter 2/5
    Epoch [4/50], Train Losses: mse: 57.4066, mae: 4.1618, huber: 3.7160, swd: 32.0113, ept: 284.3776
    Epoch [4/50], Val Losses: mse: 32.0438, mae: 3.9430, huber: 3.4886, swd: 11.0851, ept: 204.3834
    Epoch [4/50], Test Losses: mse: 26.8080, mae: 3.5324, huber: 3.0792, swd: 10.7925, ept: 251.4716
      Epoch 4 composite train-obj: 3.716042
            No improvement (3.4886), counter 3/5
    Epoch [5/50], Train Losses: mse: 56.7742, mae: 4.1115, huber: 3.6668, swd: 31.8162, ept: 291.1178
    Epoch [5/50], Val Losses: mse: 30.5260, mae: 3.8955, huber: 3.4446, swd: 6.9866, ept: 193.2824
    Epoch [5/50], Test Losses: mse: 27.8078, mae: 3.6281, huber: 3.1643, swd: 8.1989, ept: 220.1154
      Epoch 5 composite train-obj: 3.666819
            No improvement (3.4446), counter 4/5
    Epoch [6/50], Train Losses: mse: 58.9634, mae: 4.2023, huber: 3.7569, swd: 32.8673, ept: 284.5964
    Epoch [6/50], Val Losses: mse: 28.0044, mae: 3.8307, huber: 3.3741, swd: 7.3771, ept: 202.2472
    Epoch [6/50], Test Losses: mse: 25.6926, mae: 3.3470, huber: 2.9021, swd: 8.9310, ept: 271.7744
      Epoch 6 composite train-obj: 3.756896
    Epoch [6/50], Test Losses: mse: 24.0306, mae: 3.3329, huber: 2.8786, swd: 7.2140, ept: 234.1536
    Best round's Test MSE: 24.0306, MAE: 3.3329, SWD: 7.2140
    Best round's Validation MSE: 28.4430, MAE: 3.7985, SWD: 5.9811
    Best round's Test verification MSE : 24.0306, MAE: 3.3329, SWD: 7.2140
    Time taken: 6.81 seconds
    
    ==================================================
    Experiment Summary (DLinear_etth2_seq720_pred720_20250511_0045)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 24.8920 ± 1.1886
      mae: 3.3452 ± 0.0910
      huber: 2.8932 ± 0.0887
      swd: 8.0924 ± 1.2766
      ept: 247.0231 ± 17.5405
      count: 3.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 27.4332 ± 1.2212
      mae: 3.7263 ± 0.0801
      huber: 3.2744 ± 0.0787
      swd: 5.8437 ± 0.3399
      ept: 191.2655 ± 8.2464
      count: 3.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 24.41 seconds
    
    Experiment complete: DLinear_etth2_seq720_pred720_20250511_0045
    Model: DLinear
    Dataset: etth2
    Sequence Length: 720
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    


```python

```


