# data

# ETTh1


```python
import torch 
import importlib
import monotonic
import data_manager
import metrics
import utils
importlib.reload(utils)
import train as Train
from train import execute_model_evaluation
import train_config
from data_manager import DatasetManager
from train_config import FlatACLConfig, FlatDLinearConfig, FlatNaiveConfig, FlatPatchTSTConfig, FlatTimeMixerConfig
from dataclasses import replace

%load_ext autoreload
%autoreload 2
modules_to_reload_list = [
    data_manager,
    Train,
    train_config,
    monotonic,
    # data_manager, # Reloaded only once even if listed twice
    utils,
    # train_config, # Reloaded only once even if listed twice
    metrics
]
data_mgr = DatasetManager(device='cuda')

# Load a synthetic dataset
data_mgr.load_csv('etth1', './etth1.csv')
```

    
    ==================================================
    Dataset: etth1 (csv)
    ==================================================
    Shape: torch.Size([17420, 7])
    Channels: 7
    Length: 17420
    Source: ./etth1.csv
    
    Sample data (first 2 rows):
    tensor([[ 5.8270,  2.0090,  1.5990,  0.4620,  4.2030,  1.3400, 30.5310],
            [ 5.6930,  2.0760,  1.4920,  0.4260,  4.1420,  1.3710, 27.7870]])
    ==================================================
    




    <data_manager.DatasetManager at 0x18b439ed880>



# Exp - 96

## Seq=96

### EigenACL

#### pred=96


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=96,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 94
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 94
    Validation Batches: 13
    Test Batches: 26
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.5014, mae: 2.2397, huber: 1.8381, swd: 7.9842, ept: 31.7370
    Epoch [1/50], Val Losses: mse: 9.4368, mae: 1.6542, huber: 1.2842, swd: 1.6601, ept: 46.7188
    Epoch [1/50], Test Losses: mse: 13.7694, mae: 1.9853, huber: 1.6032, swd: 3.2713, ept: 33.5988
      Epoch 1 composite train-obj: 1.838057
            Val objective improved inf → 1.2842, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.1244, mae: 1.5868, huber: 1.2071, swd: 2.1062, ept: 44.5517
    Epoch [2/50], Val Losses: mse: 8.8613, mae: 1.6292, huber: 1.2628, swd: 1.8421, ept: 46.1524
    Epoch [2/50], Test Losses: mse: 11.0878, mae: 1.8546, huber: 1.4761, swd: 2.7954, ept: 34.3315
      Epoch 2 composite train-obj: 1.207134
            Val objective improved 1.2842 → 1.2628, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.5644, mae: 1.5360, huber: 1.1601, swd: 1.9513, ept: 46.2976
    Epoch [3/50], Val Losses: mse: 8.7928, mae: 1.6369, huber: 1.2716, swd: 2.1862, ept: 46.9517
    Epoch [3/50], Test Losses: mse: 10.4963, mae: 1.8207, huber: 1.4446, swd: 2.9737, ept: 35.8017
      Epoch 3 composite train-obj: 1.160105
            No improvement (1.2716), counter 1/5
    Epoch [4/50], Train Losses: mse: 6.2701, mae: 1.4962, huber: 1.1237, swd: 1.8021, ept: 47.7355
    Epoch [4/50], Val Losses: mse: 8.7489, mae: 1.6204, huber: 1.2557, swd: 1.8887, ept: 46.5721
    Epoch [4/50], Test Losses: mse: 10.0370, mae: 1.7800, huber: 1.4053, swd: 2.4949, ept: 36.1353
      Epoch 4 composite train-obj: 1.123738
            Val objective improved 1.2628 → 1.2557, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.1188, mae: 1.4736, huber: 1.1034, swd: 1.7109, ept: 48.7804
    Epoch [5/50], Val Losses: mse: 8.4980, mae: 1.5848, huber: 1.2222, swd: 1.7809, ept: 48.0027
    Epoch [5/50], Test Losses: mse: 9.9563, mae: 1.7524, huber: 1.3796, swd: 2.2739, ept: 37.2763
      Epoch 5 composite train-obj: 1.103353
            Val objective improved 1.2557 → 1.2222, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 5.9416, mae: 1.4441, huber: 1.0760, swd: 1.5815, ept: 49.7078
    Epoch [6/50], Val Losses: mse: 8.4917, mae: 1.5836, huber: 1.2214, swd: 1.7718, ept: 48.9403
    Epoch [6/50], Test Losses: mse: 9.9824, mae: 1.7490, huber: 1.3770, swd: 2.2974, ept: 38.2517
      Epoch 6 composite train-obj: 1.075995
            Val objective improved 1.2222 → 1.2214, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 5.8965, mae: 1.4362, huber: 1.0689, swd: 1.5716, ept: 50.1713
    Epoch [7/50], Val Losses: mse: 8.4258, mae: 1.5813, huber: 1.2189, swd: 1.7852, ept: 48.9474
    Epoch [7/50], Test Losses: mse: 9.8837, mae: 1.7400, huber: 1.3679, swd: 2.1640, ept: 38.3694
      Epoch 7 composite train-obj: 1.068919
            Val objective improved 1.2214 → 1.2189, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 5.8290, mae: 1.4248, huber: 1.0585, swd: 1.5299, ept: 50.6615
    Epoch [8/50], Val Losses: mse: 8.4324, mae: 1.5773, huber: 1.2158, swd: 1.8222, ept: 49.5483
    Epoch [8/50], Test Losses: mse: 9.9556, mae: 1.7435, huber: 1.3719, swd: 2.3000, ept: 38.7398
      Epoch 8 composite train-obj: 1.058531
            Val objective improved 1.2189 → 1.2158, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 5.8021, mae: 1.4203, huber: 1.0544, swd: 1.5336, ept: 50.9547
    Epoch [9/50], Val Losses: mse: 8.3480, mae: 1.5636, huber: 1.2030, swd: 1.6957, ept: 49.8059
    Epoch [9/50], Test Losses: mse: 9.9247, mae: 1.7387, huber: 1.3676, swd: 2.2842, ept: 39.0715
      Epoch 9 composite train-obj: 1.054390
            Val objective improved 1.2158 → 1.2030, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 5.7216, mae: 1.4067, huber: 1.0419, swd: 1.4833, ept: 51.3440
    Epoch [10/50], Val Losses: mse: 8.4140, mae: 1.5708, huber: 1.2094, swd: 1.7627, ept: 49.8282
    Epoch [10/50], Test Losses: mse: 9.9175, mae: 1.7421, huber: 1.3708, swd: 2.2901, ept: 39.4000
      Epoch 10 composite train-obj: 1.041902
            No improvement (1.2094), counter 1/5
    Epoch [11/50], Train Losses: mse: 5.6626, mae: 1.3986, huber: 1.0343, swd: 1.4588, ept: 51.7075
    Epoch [11/50], Val Losses: mse: 8.5038, mae: 1.6038, huber: 1.2403, swd: 2.0772, ept: 48.9013
    Epoch [11/50], Test Losses: mse: 9.9909, mae: 1.7618, huber: 1.3884, swd: 2.5943, ept: 38.6558
      Epoch 11 composite train-obj: 1.034255
            No improvement (1.2403), counter 2/5
    Epoch [12/50], Train Losses: mse: 5.6768, mae: 1.4012, huber: 1.0368, swd: 1.4948, ept: 51.7735
    Epoch [12/50], Val Losses: mse: 8.4365, mae: 1.6154, huber: 1.2487, swd: 2.1772, ept: 47.3482
    Epoch [12/50], Test Losses: mse: 10.0820, mae: 1.7775, huber: 1.4017, swd: 2.8249, ept: 37.6477
      Epoch 12 composite train-obj: 1.036821
            No improvement (1.2487), counter 3/5
    Epoch [13/50], Train Losses: mse: 5.5998, mae: 1.3896, huber: 1.0260, swd: 1.4382, ept: 52.0108
    Epoch [13/50], Val Losses: mse: 8.2097, mae: 1.5704, huber: 1.2087, swd: 1.8781, ept: 50.1976
    Epoch [13/50], Test Losses: mse: 9.9932, mae: 1.7406, huber: 1.3686, swd: 2.3459, ept: 39.7724
      Epoch 13 composite train-obj: 1.026030
            No improvement (1.2087), counter 4/5
    Epoch [14/50], Train Losses: mse: 5.5607, mae: 1.3832, huber: 1.0201, swd: 1.4239, ept: 52.2316
    Epoch [14/50], Val Losses: mse: 8.6477, mae: 1.6096, huber: 1.2449, swd: 1.8561, ept: 49.5835
    Epoch [14/50], Test Losses: mse: 10.1450, mae: 1.7462, huber: 1.3742, swd: 2.1720, ept: 39.9726
      Epoch 14 composite train-obj: 1.020095
    Epoch [14/50], Test Losses: mse: 9.9247, mae: 1.7387, huber: 1.3676, swd: 2.2842, ept: 39.0836
    Best round's Test MSE: 9.9247, MAE: 1.7387, SWD: 2.2842
    Best round's Validation MSE: 8.3480, MAE: 1.5636, SWD: 1.6957
    Best round's Test verification MSE : 9.9247, MAE: 1.7387, SWD: 2.2842
    Time taken: 35.65 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.4093, mae: 2.2461, huber: 1.8440, swd: 7.7661, ept: 31.1437
    Epoch [1/50], Val Losses: mse: 9.2248, mae: 1.6594, huber: 1.2906, swd: 1.9756, ept: 46.0502
    Epoch [1/50], Test Losses: mse: 13.2666, mae: 1.9819, huber: 1.6002, swd: 3.5412, ept: 32.9374
      Epoch 1 composite train-obj: 1.843999
            Val objective improved inf → 1.2906, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0417, mae: 1.5837, huber: 1.2047, swd: 1.9921, ept: 44.4273
    Epoch [2/50], Val Losses: mse: 8.7538, mae: 1.5999, huber: 1.2347, swd: 1.4360, ept: 46.8051
    Epoch [2/50], Test Losses: mse: 11.0938, mae: 1.8584, huber: 1.4807, swd: 2.5042, ept: 34.6005
      Epoch 2 composite train-obj: 1.204706
            Val objective improved 1.2906 → 1.2347, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.4614, mae: 1.5206, huber: 1.1459, swd: 1.7622, ept: 46.6247
    Epoch [3/50], Val Losses: mse: 8.5814, mae: 1.5919, huber: 1.2294, swd: 1.7125, ept: 47.3323
    Epoch [3/50], Test Losses: mse: 10.3154, mae: 1.7908, huber: 1.4169, swd: 2.4200, ept: 36.3358
      Epoch 3 composite train-obj: 1.145907
            Val objective improved 1.2347 → 1.2294, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.2245, mae: 1.4860, huber: 1.1146, swd: 1.6687, ept: 48.0098
    Epoch [4/50], Val Losses: mse: 8.5325, mae: 1.5717, huber: 1.2091, swd: 1.4432, ept: 48.1247
    Epoch [4/50], Test Losses: mse: 10.1755, mae: 1.7667, huber: 1.3935, swd: 2.0510, ept: 37.4198
      Epoch 4 composite train-obj: 1.114624
            Val objective improved 1.2294 → 1.2091, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.0720, mae: 1.4640, huber: 1.0943, swd: 1.5890, ept: 49.0860
    Epoch [5/50], Val Losses: mse: 8.5585, mae: 1.5866, huber: 1.2248, swd: 1.6688, ept: 48.1923
    Epoch [5/50], Test Losses: mse: 9.9578, mae: 1.7453, huber: 1.3742, swd: 2.1537, ept: 37.9730
      Epoch 5 composite train-obj: 1.094336
            No improvement (1.2248), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.0343, mae: 1.4569, huber: 1.0882, swd: 1.5934, ept: 49.5964
    Epoch [6/50], Val Losses: mse: 8.4718, mae: 1.5760, huber: 1.2150, swd: 1.6928, ept: 48.7302
    Epoch [6/50], Test Losses: mse: 9.8256, mae: 1.7367, huber: 1.3656, swd: 2.1425, ept: 38.2347
      Epoch 6 composite train-obj: 1.088162
            No improvement (1.2150), counter 2/5
    Epoch [7/50], Train Losses: mse: 5.8785, mae: 1.4328, huber: 1.0658, swd: 1.4928, ept: 50.2838
    Epoch [7/50], Val Losses: mse: 8.7135, mae: 1.5779, huber: 1.2169, swd: 1.5268, ept: 49.5576
    Epoch [7/50], Test Losses: mse: 9.9890, mae: 1.7436, huber: 1.3727, swd: 2.0625, ept: 39.1773
      Epoch 7 composite train-obj: 1.065781
            No improvement (1.2169), counter 3/5
    Epoch [8/50], Train Losses: mse: 5.8939, mae: 1.4355, huber: 1.0686, swd: 1.5282, ept: 50.5588
    Epoch [8/50], Val Losses: mse: 8.3599, mae: 1.5538, huber: 1.1933, swd: 1.4837, ept: 49.5106
    Epoch [8/50], Test Losses: mse: 9.9904, mae: 1.7407, huber: 1.3694, swd: 1.9625, ept: 39.1425
      Epoch 8 composite train-obj: 1.068587
            Val objective improved 1.2091 → 1.1933, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 5.7856, mae: 1.4185, huber: 1.0526, swd: 1.4535, ept: 50.9077
    Epoch [9/50], Val Losses: mse: 8.4256, mae: 1.5695, huber: 1.2085, swd: 1.6867, ept: 49.5178
    Epoch [9/50], Test Losses: mse: 9.8232, mae: 1.7339, huber: 1.3629, swd: 2.1658, ept: 39.2051
      Epoch 9 composite train-obj: 1.052560
            No improvement (1.2085), counter 1/5
    Epoch [10/50], Train Losses: mse: 5.7409, mae: 1.4110, huber: 1.0461, swd: 1.4385, ept: 51.2768
    Epoch [10/50], Val Losses: mse: 8.6261, mae: 1.5787, huber: 1.2176, swd: 1.6202, ept: 49.6877
    Epoch [10/50], Test Losses: mse: 9.8616, mae: 1.7306, huber: 1.3596, swd: 2.0148, ept: 39.5759
      Epoch 10 composite train-obj: 1.046130
            No improvement (1.2176), counter 2/5
    Epoch [11/50], Train Losses: mse: 5.8357, mae: 1.4249, huber: 1.0592, swd: 1.5436, ept: 51.3173
    Epoch [11/50], Val Losses: mse: 8.5249, mae: 1.5768, huber: 1.2161, swd: 1.6428, ept: 49.9347
    Epoch [11/50], Test Losses: mse: 9.8192, mae: 1.7236, huber: 1.3533, swd: 2.0195, ept: 39.7884
      Epoch 11 composite train-obj: 1.059248
            No improvement (1.2161), counter 3/5
    Epoch [12/50], Train Losses: mse: 5.6425, mae: 1.3965, huber: 1.0326, swd: 1.3913, ept: 51.7894
    Epoch [12/50], Val Losses: mse: 8.2144, mae: 1.5549, huber: 1.1946, swd: 1.7870, ept: 49.6532
    Epoch [12/50], Test Losses: mse: 9.9295, mae: 1.7421, huber: 1.3709, swd: 2.3452, ept: 39.2807
      Epoch 12 composite train-obj: 1.032603
            No improvement (1.1946), counter 4/5
    Epoch [13/50], Train Losses: mse: 5.5857, mae: 1.3866, huber: 1.0234, swd: 1.3605, ept: 52.0572
    Epoch [13/50], Val Losses: mse: 8.3400, mae: 1.5752, huber: 1.2134, swd: 1.8177, ept: 49.7104
    Epoch [13/50], Test Losses: mse: 9.9094, mae: 1.7382, huber: 1.3669, swd: 2.3109, ept: 39.3266
      Epoch 13 composite train-obj: 1.023429
    Epoch [13/50], Test Losses: mse: 9.9903, mae: 1.7407, huber: 1.3694, swd: 1.9629, ept: 39.1335
    Best round's Test MSE: 9.9904, MAE: 1.7407, SWD: 1.9625
    Best round's Validation MSE: 8.3599, MAE: 1.5538, SWD: 1.4837
    Best round's Test verification MSE : 9.9903, MAE: 1.7407, SWD: 1.9629
    Time taken: 32.75 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.8897, mae: 2.2727, huber: 1.8703, swd: 7.8662, ept: 31.1996
    Epoch [1/50], Val Losses: mse: 9.3256, mae: 1.6472, huber: 1.2773, swd: 1.7033, ept: 46.8138
    Epoch [1/50], Test Losses: mse: 13.9488, mae: 1.9975, huber: 1.6149, swd: 3.4240, ept: 33.4710
      Epoch 1 composite train-obj: 1.870318
            Val objective improved inf → 1.2773, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.1710, mae: 1.5870, huber: 1.2074, swd: 1.9586, ept: 44.5943
    Epoch [2/50], Val Losses: mse: 8.6832, mae: 1.6076, huber: 1.2420, swd: 1.6173, ept: 47.3284
    Epoch [2/50], Test Losses: mse: 11.3327, mae: 1.8600, huber: 1.4816, swd: 2.6453, ept: 34.4569
      Epoch 2 composite train-obj: 1.207407
            Val objective improved 1.2773 → 1.2420, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.5817, mae: 1.5342, huber: 1.1581, swd: 1.7695, ept: 46.4163
    Epoch [3/50], Val Losses: mse: 8.5603, mae: 1.5849, huber: 1.2196, swd: 1.3034, ept: 47.6651
    Epoch [3/50], Test Losses: mse: 10.7375, mae: 1.8179, huber: 1.4410, swd: 2.0133, ept: 35.7937
      Epoch 3 composite train-obj: 1.158073
            Val objective improved 1.2420 → 1.2196, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.2495, mae: 1.4901, huber: 1.1179, swd: 1.5974, ept: 47.8296
    Epoch [4/50], Val Losses: mse: 8.5250, mae: 1.5982, huber: 1.2361, swd: 1.7844, ept: 48.3584
    Epoch [4/50], Test Losses: mse: 10.1322, mae: 1.7761, huber: 1.4033, swd: 2.4759, ept: 37.2329
      Epoch 4 composite train-obj: 1.117852
            No improvement (1.2361), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.0803, mae: 1.4641, huber: 1.0946, swd: 1.5401, ept: 48.9583
    Epoch [5/50], Val Losses: mse: 8.5128, mae: 1.5738, huber: 1.2132, swd: 1.5231, ept: 49.0743
    Epoch [5/50], Test Losses: mse: 9.9806, mae: 1.7477, huber: 1.3762, swd: 2.1157, ept: 38.0750
      Epoch 5 composite train-obj: 1.094552
            Val objective improved 1.2196 → 1.2132, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 5.9538, mae: 1.4439, huber: 1.0763, swd: 1.4720, ept: 49.8030
    Epoch [6/50], Val Losses: mse: 8.5944, mae: 1.5908, huber: 1.2301, swd: 1.7096, ept: 49.0824
    Epoch [6/50], Test Losses: mse: 9.8105, mae: 1.7350, huber: 1.3644, swd: 2.1632, ept: 38.5240
      Epoch 6 composite train-obj: 1.076258
            No improvement (1.2301), counter 1/5
    Epoch [7/50], Train Losses: mse: 5.9103, mae: 1.4373, huber: 1.0704, swd: 1.4669, ept: 50.3258
    Epoch [7/50], Val Losses: mse: 8.2985, mae: 1.5623, huber: 1.2013, swd: 1.5888, ept: 49.4782
    Epoch [7/50], Test Losses: mse: 9.8659, mae: 1.7315, huber: 1.3598, swd: 2.0667, ept: 38.8726
      Epoch 7 composite train-obj: 1.070374
            Val objective improved 1.2132 → 1.2013, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 5.7885, mae: 1.4183, huber: 1.0526, swd: 1.3938, ept: 50.8763
    Epoch [8/50], Val Losses: mse: 8.5973, mae: 1.5840, huber: 1.2231, swd: 1.5889, ept: 49.7525
    Epoch [8/50], Test Losses: mse: 9.9373, mae: 1.7397, huber: 1.3688, swd: 2.1178, ept: 39.1443
      Epoch 8 composite train-obj: 1.052646
            No improvement (1.2231), counter 1/5
    Epoch [9/50], Train Losses: mse: 5.7734, mae: 1.4160, huber: 1.0508, swd: 1.4024, ept: 51.1185
    Epoch [9/50], Val Losses: mse: 8.7483, mae: 1.5975, huber: 1.2366, swd: 1.6624, ept: 50.1354
    Epoch [9/50], Test Losses: mse: 9.9017, mae: 1.7358, huber: 1.3651, swd: 2.0743, ept: 39.4355
      Epoch 9 composite train-obj: 1.050750
            No improvement (1.2366), counter 2/5
    Epoch [10/50], Train Losses: mse: 5.7509, mae: 1.4110, huber: 1.0463, swd: 1.3982, ept: 51.4883
    Epoch [10/50], Val Losses: mse: 8.6840, mae: 1.6205, huber: 1.2573, swd: 1.9702, ept: 49.6687
    Epoch [10/50], Test Losses: mse: 9.7994, mae: 1.7457, huber: 1.3737, swd: 2.3884, ept: 39.1381
      Epoch 10 composite train-obj: 1.046286
            No improvement (1.2573), counter 3/5
    Epoch [11/50], Train Losses: mse: 5.6647, mae: 1.3977, huber: 1.0339, swd: 1.3548, ept: 51.8901
    Epoch [11/50], Val Losses: mse: 8.8886, mae: 1.6412, huber: 1.2776, swd: 2.0193, ept: 49.6340
    Epoch [11/50], Test Losses: mse: 9.9202, mae: 1.7594, huber: 1.3874, swd: 2.4787, ept: 39.2332
      Epoch 11 composite train-obj: 1.033945
            No improvement (1.2776), counter 4/5
    Epoch [12/50], Train Losses: mse: 5.6244, mae: 1.3917, huber: 1.0282, swd: 1.3377, ept: 51.9246
    Epoch [12/50], Val Losses: mse: 8.6848, mae: 1.6142, huber: 1.2522, swd: 1.8716, ept: 49.8986
    Epoch [12/50], Test Losses: mse: 9.8199, mae: 1.7334, huber: 1.3623, swd: 2.0964, ept: 39.5979
      Epoch 12 composite train-obj: 1.028196
    Epoch [12/50], Test Losses: mse: 9.8662, mae: 1.7315, huber: 1.3598, swd: 2.0675, ept: 38.8580
    Best round's Test MSE: 9.8659, MAE: 1.7315, SWD: 2.0667
    Best round's Validation MSE: 8.2985, MAE: 1.5623, SWD: 1.5888
    Best round's Test verification MSE : 9.8662, MAE: 1.7315, SWD: 2.0675
    Time taken: 31.95 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq96_pred96_20250510_1335)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 9.9270 ± 0.0509
      mae: 1.7370 ± 0.0040
      huber: 1.3656 ± 0.0042
      swd: 2.1045 ± 0.1340
      ept: 39.0288 ± 0.1142
      count: 13.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 8.3355 ± 0.0266
      mae: 1.5599 ± 0.0044
      huber: 1.1992 ± 0.0042
      swd: 1.5894 ± 0.0865
      ept: 49.5982 ± 0.1474
      count: 13.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 100.43 seconds
    
    Experiment complete: ACL_etth1_seq96_pred96_20250510_1335
    Model: ACL
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=96,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.8362, mae: 2.3715, huber: 1.9643, swd: 8.7280, ept: 43.4771
    Epoch [1/50], Val Losses: mse: 11.0611, mae: 1.8050, huber: 1.4284, swd: 1.8973, ept: 62.4206
    Epoch [1/50], Test Losses: mse: 15.8564, mae: 2.1473, huber: 1.7565, swd: 3.3526, ept: 49.9372
      Epoch 1 composite train-obj: 1.964292
            Val objective improved inf → 1.4284, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.0859, mae: 1.7074, huber: 1.3199, swd: 2.2336, ept: 64.2146
    Epoch [2/50], Val Losses: mse: 10.7339, mae: 1.8167, huber: 1.4441, swd: 2.3225, ept: 62.6482
    Epoch [2/50], Test Losses: mse: 11.8855, mae: 1.9725, huber: 1.5850, swd: 3.1324, ept: 51.4572
      Epoch 2 composite train-obj: 1.319874
            No improvement (1.4441), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.2532, mae: 1.6406, huber: 1.2560, swd: 1.9556, ept: 67.0907
    Epoch [3/50], Val Losses: mse: 10.7796, mae: 1.8262, huber: 1.4544, swd: 2.5491, ept: 62.4774
    Epoch [3/50], Test Losses: mse: 11.2143, mae: 1.9351, huber: 1.5490, swd: 3.0766, ept: 52.7818
      Epoch 3 composite train-obj: 1.256025
            No improvement (1.4544), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.0026, mae: 1.6125, huber: 1.2306, swd: 1.8832, ept: 68.8458
    Epoch [4/50], Val Losses: mse: 10.8166, mae: 1.8036, huber: 1.4345, swd: 2.1256, ept: 61.4738
    Epoch [4/50], Test Losses: mse: 10.9647, mae: 1.8991, huber: 1.5155, swd: 2.3666, ept: 53.7909
      Epoch 4 composite train-obj: 1.230561
            No improvement (1.4345), counter 3/5
    Epoch [5/50], Train Losses: mse: 6.7278, mae: 1.5759, huber: 1.1966, swd: 1.7113, ept: 71.0844
    Epoch [5/50], Val Losses: mse: 10.7596, mae: 1.7996, huber: 1.4325, swd: 2.2957, ept: 63.7051
    Epoch [5/50], Test Losses: mse: 10.5974, mae: 1.8640, huber: 1.4816, swd: 2.2756, ept: 55.5067
      Epoch 5 composite train-obj: 1.196644
            No improvement (1.4325), counter 4/5
    Epoch [6/50], Train Losses: mse: 6.6634, mae: 1.5676, huber: 1.1893, swd: 1.7016, ept: 72.0190
    Epoch [6/50], Val Losses: mse: 11.1913, mae: 1.8845, huber: 1.5115, swd: 3.0538, ept: 61.2765
    Epoch [6/50], Test Losses: mse: 10.5831, mae: 1.9019, huber: 1.5169, swd: 3.1254, ept: 55.0948
      Epoch 6 composite train-obj: 1.189335
    Epoch [6/50], Test Losses: mse: 15.8568, mae: 2.1474, huber: 1.7565, swd: 3.3551, ept: 49.9081
    Best round's Test MSE: 15.8564, MAE: 2.1473, SWD: 3.3526
    Best round's Validation MSE: 11.0611, MAE: 1.8050, SWD: 1.8973
    Best round's Test verification MSE : 15.8568, MAE: 2.1474, SWD: 3.3551
    Time taken: 16.81 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.1622, mae: 2.3165, huber: 1.9108, swd: 8.0448, ept: 44.9702
    Epoch [1/50], Val Losses: mse: 10.8254, mae: 1.8010, huber: 1.4260, swd: 2.2754, ept: 65.8216
    Epoch [1/50], Test Losses: mse: 15.1714, mae: 2.1107, huber: 1.7215, swd: 3.3809, ept: 50.8928
      Epoch 1 composite train-obj: 1.910836
            Val objective improved inf → 1.4260, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.0231, mae: 1.7010, huber: 1.3141, swd: 2.1880, ept: 64.9341
    Epoch [2/50], Val Losses: mse: 10.5963, mae: 1.8029, huber: 1.4305, swd: 2.3856, ept: 63.2664
    Epoch [2/50], Test Losses: mse: 12.0864, mae: 1.9799, huber: 1.5927, swd: 3.0621, ept: 51.8375
      Epoch 2 composite train-obj: 1.314066
            No improvement (1.4305), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.2695, mae: 1.6416, huber: 1.2574, swd: 1.9643, ept: 67.5098
    Epoch [3/50], Val Losses: mse: 10.8427, mae: 1.8461, huber: 1.4729, swd: 2.7893, ept: 62.0371
    Epoch [3/50], Test Losses: mse: 11.1537, mae: 1.9299, huber: 1.5439, swd: 2.9636, ept: 53.3794
      Epoch 3 composite train-obj: 1.257417
            No improvement (1.4729), counter 2/5
    Epoch [4/50], Train Losses: mse: 6.9660, mae: 1.6064, huber: 1.2250, swd: 1.8622, ept: 69.5768
    Epoch [4/50], Val Losses: mse: 10.8211, mae: 1.8094, huber: 1.4415, swd: 2.3742, ept: 64.2012
    Epoch [4/50], Test Losses: mse: 10.8237, mae: 1.8812, huber: 1.5000, swd: 2.3260, ept: 54.8057
      Epoch 4 composite train-obj: 1.225009
            No improvement (1.4415), counter 3/5
    Epoch [5/50], Train Losses: mse: 6.7356, mae: 1.5764, huber: 1.1971, swd: 1.7254, ept: 71.3907
    Epoch [5/50], Val Losses: mse: 10.7458, mae: 1.8140, huber: 1.4464, swd: 2.6165, ept: 63.9356
    Epoch [5/50], Test Losses: mse: 10.6788, mae: 1.8668, huber: 1.4857, swd: 2.3329, ept: 56.1579
      Epoch 5 composite train-obj: 1.197148
            No improvement (1.4464), counter 4/5
    Epoch [6/50], Train Losses: mse: 6.7689, mae: 1.5817, huber: 1.2026, swd: 1.7979, ept: 71.5273
    Epoch [6/50], Val Losses: mse: 10.8873, mae: 1.8543, huber: 1.4829, swd: 3.0303, ept: 63.4075
    Epoch [6/50], Test Losses: mse: 10.6411, mae: 1.8930, huber: 1.5092, swd: 2.8481, ept: 56.5190
      Epoch 6 composite train-obj: 1.202610
    Epoch [6/50], Test Losses: mse: 15.1717, mae: 2.1107, huber: 1.7216, swd: 3.3813, ept: 50.8864
    Best round's Test MSE: 15.1714, MAE: 2.1107, SWD: 3.3809
    Best round's Validation MSE: 10.8254, MAE: 1.8010, SWD: 2.2754
    Best round's Test verification MSE : 15.1717, MAE: 2.1107, SWD: 3.3813
    Time taken: 16.88 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 18.0595, mae: 2.3751, huber: 1.9691, swd: 7.8308, ept: 43.8273
    Epoch [1/50], Val Losses: mse: 11.1265, mae: 1.8112, huber: 1.4351, swd: 1.9977, ept: 63.7177
    Epoch [1/50], Test Losses: mse: 16.1763, mae: 2.1561, huber: 1.7658, swd: 3.2536, ept: 50.3992
      Epoch 1 composite train-obj: 1.969078
            Val objective improved inf → 1.4351, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.2090, mae: 1.7123, huber: 1.3250, swd: 2.0691, ept: 64.4282
    Epoch [2/50], Val Losses: mse: 10.9396, mae: 1.8291, huber: 1.4553, swd: 1.8698, ept: 60.2093
    Epoch [2/50], Test Losses: mse: 12.3691, mae: 1.9894, huber: 1.6021, swd: 2.5483, ept: 51.1592
      Epoch 2 composite train-obj: 1.325028
            No improvement (1.4553), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.4051, mae: 1.6542, huber: 1.2690, swd: 1.8457, ept: 66.4861
    Epoch [3/50], Val Losses: mse: 10.9995, mae: 1.8337, huber: 1.4619, swd: 2.1042, ept: 61.1452
    Epoch [3/50], Test Losses: mse: 11.4559, mae: 1.9385, huber: 1.5526, swd: 2.4868, ept: 52.3465
      Epoch 3 composite train-obj: 1.269042
            No improvement (1.4619), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.0348, mae: 1.6147, huber: 1.2322, swd: 1.6935, ept: 68.7277
    Epoch [4/50], Val Losses: mse: 10.9089, mae: 1.8498, huber: 1.4777, swd: 2.6163, ept: 61.8063
    Epoch [4/50], Test Losses: mse: 10.9564, mae: 1.9225, huber: 1.5365, swd: 2.9452, ept: 53.5983
      Epoch 4 composite train-obj: 1.232195
            No improvement (1.4777), counter 3/5
    Epoch [5/50], Train Losses: mse: 6.8324, mae: 1.5900, huber: 1.2098, swd: 1.6184, ept: 70.4095
    Epoch [5/50], Val Losses: mse: 10.9952, mae: 1.8224, huber: 1.4541, swd: 2.1098, ept: 61.9969
    Epoch [5/50], Test Losses: mse: 10.9403, mae: 1.8962, huber: 1.5133, swd: 2.3268, ept: 54.3835
      Epoch 5 composite train-obj: 1.209827
            No improvement (1.4541), counter 4/5
    Epoch [6/50], Train Losses: mse: 6.6442, mae: 1.5643, huber: 1.1859, swd: 1.5114, ept: 71.8388
    Epoch [6/50], Val Losses: mse: 10.8256, mae: 1.8122, huber: 1.4454, swd: 2.2641, ept: 64.1049
    Epoch [6/50], Test Losses: mse: 10.7099, mae: 1.8772, huber: 1.4957, swd: 2.3980, ept: 55.5948
      Epoch 6 composite train-obj: 1.185926
    Epoch [6/50], Test Losses: mse: 16.1766, mae: 2.1561, huber: 1.7658, swd: 3.2524, ept: 50.4364
    Best round's Test MSE: 16.1763, MAE: 2.1561, SWD: 3.2536
    Best round's Validation MSE: 11.1265, MAE: 1.8112, SWD: 1.9977
    Best round's Test verification MSE : 16.1766, MAE: 2.1561, SWD: 3.2524
    Time taken: 17.06 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq96_pred196_20250510_1336)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 15.7347 ± 0.4192
      mae: 2.1380 ± 0.0197
      huber: 1.7479 ± 0.0191
      swd: 3.3290 ± 0.0545
      ept: 50.4097 ± 0.3902
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 11.0043 ± 0.1293
      mae: 1.8057 ± 0.0042
      huber: 1.4299 ± 0.0038
      swd: 2.0568 ± 0.1599
      ept: 63.9866 ± 1.4014
      count: 12.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 50.82 seconds
    
    Experiment complete: ACL_etth1_seq96_pred196_20250510_1336
    Model: ACL
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=96,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.6446, mae: 2.3818, huber: 1.9726, swd: 8.4341, ept: 57.2315
    Epoch [1/50], Val Losses: mse: 11.6379, mae: 1.8621, huber: 1.4847, swd: 1.8869, ept: 79.5605
    Epoch [1/50], Test Losses: mse: 15.5122, mae: 2.1637, huber: 1.7701, swd: 2.9681, ept: 70.0268
      Epoch 1 composite train-obj: 1.972592
            Val objective improved inf → 1.4847, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.4506, mae: 1.7719, huber: 1.3795, swd: 2.1774, ept: 82.5206
    Epoch [2/50], Val Losses: mse: 12.0650, mae: 1.9038, huber: 1.5303, swd: 2.1491, ept: 79.2092
    Epoch [2/50], Test Losses: mse: 12.1199, mae: 2.0197, huber: 1.6280, swd: 2.5747, ept: 71.1162
      Epoch 2 composite train-obj: 1.379525
            No improvement (1.5303), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.6898, mae: 1.7128, huber: 1.3226, swd: 1.9371, ept: 85.4099
    Epoch [3/50], Val Losses: mse: 12.1481, mae: 1.9065, huber: 1.5345, swd: 2.4082, ept: 79.2820
    Epoch [3/50], Test Losses: mse: 11.6423, mae: 2.0010, huber: 1.6096, swd: 2.6475, ept: 72.0387
      Epoch 3 composite train-obj: 1.322559
            No improvement (1.5345), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.5977, mae: 1.7058, huber: 1.3167, swd: 2.0062, ept: 85.6460
    Epoch [4/50], Val Losses: mse: 12.2831, mae: 1.9095, huber: 1.5392, swd: 2.3244, ept: 79.4082
    Epoch [4/50], Test Losses: mse: 11.0145, mae: 1.9511, huber: 1.5616, swd: 2.1327, ept: 73.1022
      Epoch 4 composite train-obj: 1.316695
            No improvement (1.5392), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.2087, mae: 1.6587, huber: 1.2725, swd: 1.7475, ept: 89.8642
    Epoch [5/50], Val Losses: mse: 12.4027, mae: 1.9424, huber: 1.5718, swd: 2.8493, ept: 82.9296
    Epoch [5/50], Test Losses: mse: 10.8033, mae: 1.9405, huber: 1.5516, swd: 2.4508, ept: 74.6242
      Epoch 5 composite train-obj: 1.272466
            No improvement (1.5718), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.0245, mae: 1.6352, huber: 1.2506, swd: 1.6462, ept: 92.0653
    Epoch [6/50], Val Losses: mse: 12.5925, mae: 1.9565, huber: 1.5872, swd: 2.9269, ept: 81.7762
    Epoch [6/50], Test Losses: mse: 10.7458, mae: 1.9337, huber: 1.5456, swd: 2.3064, ept: 74.4590
      Epoch 6 composite train-obj: 1.250611
    Epoch [6/50], Test Losses: mse: 15.5134, mae: 2.1637, huber: 1.7702, swd: 2.9686, ept: 70.0313
    Best round's Test MSE: 15.5122, MAE: 2.1637, SWD: 2.9681
    Best round's Validation MSE: 11.6379, MAE: 1.8621, SWD: 1.8869
    Best round's Test verification MSE : 15.5134, MAE: 2.1637, SWD: 2.9686
    Time taken: 16.83 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 18.0214, mae: 2.4050, huber: 1.9956, swd: 8.6534, ept: 55.4867
    Epoch [1/50], Val Losses: mse: 11.6423, mae: 1.8704, huber: 1.4925, swd: 2.4901, ept: 82.3468
    Epoch [1/50], Test Losses: mse: 16.0655, mae: 2.1904, huber: 1.7960, swd: 3.2716, ept: 71.0384
      Epoch 1 composite train-obj: 1.995561
            Val objective improved inf → 1.4925, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.6298, mae: 1.7852, huber: 1.3926, swd: 2.2825, ept: 81.7869
    Epoch [2/50], Val Losses: mse: 11.8850, mae: 1.9041, huber: 1.5294, swd: 2.7259, ept: 81.9390
    Epoch [2/50], Test Losses: mse: 12.2537, mae: 2.0352, huber: 1.6423, swd: 2.9654, ept: 72.0851
      Epoch 2 composite train-obj: 1.392578
            No improvement (1.5294), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.6903, mae: 1.7090, huber: 1.3189, swd: 1.9156, ept: 85.7796
    Epoch [3/50], Val Losses: mse: 12.3669, mae: 1.9338, huber: 1.5599, swd: 2.7838, ept: 79.1785
    Epoch [3/50], Test Losses: mse: 11.4086, mae: 1.9871, huber: 1.5953, swd: 2.5827, ept: 72.3606
      Epoch 3 composite train-obj: 1.318927
            No improvement (1.5599), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.4317, mae: 1.6847, huber: 1.2963, swd: 1.8671, ept: 87.6884
    Epoch [4/50], Val Losses: mse: 12.0868, mae: 1.9126, huber: 1.5399, swd: 2.7966, ept: 81.0670
    Epoch [4/50], Test Losses: mse: 11.0881, mae: 1.9667, huber: 1.5763, swd: 2.5474, ept: 73.4171
      Epoch 4 composite train-obj: 1.296287
            No improvement (1.5399), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.2971, mae: 1.6698, huber: 1.2830, swd: 1.8540, ept: 89.1510
    Epoch [5/50], Val Losses: mse: 12.1646, mae: 1.9035, huber: 1.5342, swd: 2.7187, ept: 81.5455
    Epoch [5/50], Test Losses: mse: 10.7530, mae: 1.9323, huber: 1.5439, swd: 2.2316, ept: 74.8932
      Epoch 5 composite train-obj: 1.283027
            No improvement (1.5342), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.1063, mae: 1.6461, huber: 1.2610, swd: 1.7453, ept: 91.0305
    Epoch [6/50], Val Losses: mse: 12.0115, mae: 1.9128, huber: 1.5419, swd: 3.0636, ept: 81.6131
    Epoch [6/50], Test Losses: mse: 10.7751, mae: 1.9417, huber: 1.5528, swd: 2.5784, ept: 76.4342
      Epoch 6 composite train-obj: 1.260973
    Epoch [6/50], Test Losses: mse: 16.0649, mae: 2.1904, huber: 1.7959, swd: 3.2710, ept: 71.0388
    Best round's Test MSE: 16.0655, MAE: 2.1904, SWD: 3.2716
    Best round's Validation MSE: 11.6423, MAE: 1.8704, SWD: 2.4901
    Best round's Test verification MSE : 16.0649, MAE: 2.1904, SWD: 3.2710
    Time taken: 16.57 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 17.6647, mae: 2.3820, huber: 1.9735, swd: 7.8318, ept: 55.8310
    Epoch [1/50], Val Losses: mse: 11.8569, mae: 1.8734, huber: 1.4939, swd: 1.7817, ept: 74.7016
    Epoch [1/50], Test Losses: mse: 16.3871, mae: 2.2041, huber: 1.8091, swd: 2.9530, ept: 68.4168
      Epoch 1 composite train-obj: 1.973512
            Val objective improved inf → 1.4939, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.6162, mae: 1.7850, huber: 1.3926, swd: 2.2555, ept: 81.7979
    Epoch [2/50], Val Losses: mse: 11.7409, mae: 1.8869, huber: 1.5128, swd: 2.4774, ept: 81.2296
    Epoch [2/50], Test Losses: mse: 12.2652, mae: 2.0355, huber: 1.6424, swd: 3.1287, ept: 72.1563
      Epoch 2 composite train-obj: 1.392567
            No improvement (1.5128), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.7269, mae: 1.7147, huber: 1.3247, swd: 1.9193, ept: 85.8535
    Epoch [3/50], Val Losses: mse: 12.2000, mae: 1.9090, huber: 1.5371, swd: 2.3247, ept: 79.0013
    Epoch [3/50], Test Losses: mse: 11.6175, mae: 1.9917, huber: 1.6014, swd: 2.4884, ept: 72.4943
      Epoch 3 composite train-obj: 1.324712
            No improvement (1.5371), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.4970, mae: 1.6896, huber: 1.3017, swd: 1.8583, ept: 88.1530
    Epoch [4/50], Val Losses: mse: 12.3959, mae: 1.9357, huber: 1.5643, swd: 2.6996, ept: 82.3650
    Epoch [4/50], Test Losses: mse: 10.9794, mae: 1.9550, huber: 1.5657, swd: 2.5762, ept: 74.5944
      Epoch 4 composite train-obj: 1.301674
            No improvement (1.5643), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.1556, mae: 1.6492, huber: 1.2637, swd: 1.6466, ept: 91.1453
    Epoch [5/50], Val Losses: mse: 12.4147, mae: 1.9638, huber: 1.5901, swd: 3.0155, ept: 83.4147
    Epoch [5/50], Test Losses: mse: 10.7625, mae: 1.9519, huber: 1.5623, swd: 2.7517, ept: 76.5866
      Epoch 5 composite train-obj: 1.263691
            No improvement (1.5901), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.0763, mae: 1.6390, huber: 1.2547, swd: 1.6386, ept: 92.3281
    Epoch [6/50], Val Losses: mse: 12.4502, mae: 1.9304, huber: 1.5615, swd: 2.6839, ept: 82.7535
    Epoch [6/50], Test Losses: mse: 10.5752, mae: 1.9135, huber: 1.5265, swd: 2.1844, ept: 76.3569
      Epoch 6 composite train-obj: 1.254730
    Epoch [6/50], Test Losses: mse: 16.3869, mae: 2.2041, huber: 1.8091, swd: 2.9534, ept: 68.3606
    Best round's Test MSE: 16.3871, MAE: 2.2041, SWD: 2.9530
    Best round's Validation MSE: 11.8569, MAE: 1.8734, SWD: 1.7817
    Best round's Test verification MSE : 16.3869, MAE: 2.2041, SWD: 2.9534
    Time taken: 16.92 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq96_pred336_20250510_1337)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 15.9883 ± 0.3613
      mae: 2.1860 ± 0.0168
      huber: 1.7917 ± 0.0162
      swd: 3.0642 ± 0.1468
      ept: 69.8273 ± 1.0795
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 11.7124 ± 0.1022
      mae: 1.8686 ± 0.0048
      huber: 1.4904 ± 0.0041
      swd: 2.0529 ± 0.3121
      ept: 78.8697 ± 3.1592
      count: 11.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 50.39 seconds
    
    Experiment complete: ACL_etth1_seq96_pred336_20250510_1337
    Model: ACL
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
from monotonic import DynamicTanh
import torch.nn as nn

importlib.reload(monotonic)
importlib.reload(train_config) 
cfg = train_config.FlatACLConfig(  # original householder 
    seq_len=96,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],# data_mgr.channels,              # ← number of features in your data
    batch_size=128,
    learning_rate=9e-4, 
    seeds=[1955, 7, 20],  
    epochs=50, 
    dim_hidden=128,
    dim_augment=128, 
    ablate_no_koopman=False,
    use_complex_eigenvalues=True,
    second_delay_use_shift=True,
    ablate_rotate_back_Koopman=True, 
    ablate_shift_inside_scale=False,
    householder_reflects_latent = 2,
    householder_reflects_data = 4,
    mixing_strategy='delay_only', 
    loss_backward_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    loss_validate_weights = [0.0, 0.0, 1.0, 0.0, 0.0],
    ablate_deterministic_y0=False, 
)
cfg.x_to_z_delay.enable_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_delay.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_delay.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_delay.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_delay.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.x_to_z_deri.enable_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_scale_shift = [True, False]
cfg.x_to_z_deri.spectral_flags_magnitudes = [False, True]
cfg.x_to_z_deri.spectral_flags_hidden_layers = [False, False]
cfg.x_to_z_deri.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.x_to_z_deri.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_x_main.enable_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_x_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_x_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_x_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_x_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_push_to_z.enable_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_scale_shift = [True, False]
cfg.z_push_to_z.spectral_flags_magnitudes = [False, True]
cfg.z_push_to_z.spectral_flags_hidden_layers = [False, False]
cfg.z_push_to_z.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_push_to_z.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]

cfg.z_to_y_main.enable_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_scale_shift = [True, False]
cfg.z_to_y_main.spectral_flags_magnitudes = [False, True]
cfg.z_to_y_main.spectral_flags_hidden_layers = [False, False]
cfg.z_to_y_main.activations_scale_shift = ["relu6", "dynamic_tanh"]
cfg.z_to_y_main.activations_hidden_layers = [nn.ELU, nn.LogSigmoid]
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    global_std.shape: torch.Size([7])
    Global Std for etth1: tensor([7.0675, 2.0423, 6.8268, 1.8092, 1.1645, 0.5995, 8.5667],
           device='cuda:0')
    Train set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 18.8162, mae: 2.5222, huber: 2.1066, swd: 8.7933, ept: 66.5393
    Epoch [1/50], Val Losses: mse: 11.5570, mae: 1.8798, huber: 1.5008, swd: 2.5049, ept: 119.6196
    Epoch [1/50], Test Losses: mse: 17.5450, mae: 2.3775, huber: 1.9720, swd: 3.9717, ept: 105.6855
      Epoch 1 composite train-obj: 2.106639
            Val objective improved inf → 1.5008, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.5377, mae: 1.9129, huber: 1.5116, swd: 2.5898, ept: 101.3041
    Epoch [2/50], Val Losses: mse: 11.4141, mae: 1.9317, huber: 1.5553, swd: 2.7883, ept: 105.5224
    Epoch [2/50], Test Losses: mse: 13.1697, mae: 2.1828, huber: 1.7780, swd: 3.2427, ept: 113.3032
      Epoch 2 composite train-obj: 1.511569
            No improvement (1.5553), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.6029, mae: 1.8440, huber: 1.4444, swd: 2.3027, ept: 104.3298
    Epoch [3/50], Val Losses: mse: 11.8608, mae: 1.9944, huber: 1.6166, swd: 3.1300, ept: 95.9431
    Epoch [3/50], Test Losses: mse: 12.2323, mae: 2.1345, huber: 1.7304, swd: 2.9473, ept: 113.6590
      Epoch 3 composite train-obj: 1.444354
            No improvement (1.6166), counter 2/5
    Epoch [4/50], Train Losses: mse: 8.1914, mae: 1.8034, huber: 1.4056, swd: 2.0916, ept: 107.5949
    Epoch [4/50], Val Losses: mse: 12.4424, mae: 2.0762, huber: 1.6956, swd: 3.7860, ept: 94.2448
    Epoch [4/50], Test Losses: mse: 11.8483, mae: 2.1304, huber: 1.7254, swd: 3.2276, ept: 114.8095
      Epoch 4 composite train-obj: 1.405558
            No improvement (1.6956), counter 3/5
    Epoch [5/50], Train Losses: mse: 7.9772, mae: 1.7796, huber: 1.3832, swd: 2.0189, ept: 110.1833
    Epoch [5/50], Val Losses: mse: 12.7280, mae: 2.1146, huber: 1.7336, swd: 4.0451, ept: 94.4384
    Epoch [5/50], Test Losses: mse: 11.6658, mae: 2.1205, huber: 1.7165, swd: 3.2078, ept: 114.1353
      Epoch 5 composite train-obj: 1.383170
            No improvement (1.7336), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.9561, mae: 1.7770, huber: 1.3812, swd: 2.0781, ept: 110.4286
    Epoch [6/50], Val Losses: mse: 13.1093, mae: 2.1705, huber: 1.7856, swd: 4.4721, ept: 97.0235
    Epoch [6/50], Test Losses: mse: 11.6592, mae: 2.1414, huber: 1.7369, swd: 3.7063, ept: 118.1276
      Epoch 6 composite train-obj: 1.381212
    Epoch [6/50], Test Losses: mse: 17.5457, mae: 2.3776, huber: 1.9720, swd: 3.9724, ept: 106.0447
    Best round's Test MSE: 17.5450, MAE: 2.3775, SWD: 3.9717
    Best round's Validation MSE: 11.5570, MAE: 1.8798, SWD: 2.5049
    Best round's Test verification MSE : 17.5457, MAE: 2.3776, SWD: 3.9724
    Time taken: 16.21 seconds
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 19.3383, mae: 2.5521, huber: 2.1362, swd: 8.4962, ept: 64.5833
    Epoch [1/50], Val Losses: mse: 12.0658, mae: 1.8992, huber: 1.5184, swd: 2.5411, ept: 119.5711
    Epoch [1/50], Test Losses: mse: 19.1598, mae: 2.4461, huber: 2.0397, swd: 4.0795, ept: 105.5125
      Epoch 1 composite train-obj: 2.136151
            Val objective improved inf → 1.5184, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.7361, mae: 1.9243, huber: 1.5228, swd: 2.5116, ept: 99.8559
    Epoch [2/50], Val Losses: mse: 11.3307, mae: 1.9470, huber: 1.5672, swd: 3.1093, ept: 114.5961
    Epoch [2/50], Test Losses: mse: 13.3014, mae: 2.2104, huber: 1.8036, swd: 3.8890, ept: 111.9067
      Epoch 2 composite train-obj: 1.522808
            No improvement (1.5672), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.5884, mae: 1.8437, huber: 1.4439, swd: 2.1886, ept: 104.0069
    Epoch [3/50], Val Losses: mse: 11.7888, mae: 2.0024, huber: 1.6239, swd: 3.1493, ept: 96.5645
    Epoch [3/50], Test Losses: mse: 12.1106, mae: 2.1240, huber: 1.7198, swd: 2.9898, ept: 114.4879
      Epoch 3 composite train-obj: 1.443910
            No improvement (1.6239), counter 2/5
    Epoch [4/50], Train Losses: mse: 8.2525, mae: 1.8119, huber: 1.4136, swd: 2.0609, ept: 106.1741
    Epoch [4/50], Val Losses: mse: 12.5127, mae: 2.0698, huber: 1.6912, swd: 3.4836, ept: 97.4599
    Epoch [4/50], Test Losses: mse: 11.7081, mae: 2.1099, huber: 1.7077, swd: 2.9737, ept: 115.9680
      Epoch 4 composite train-obj: 1.413566
            No improvement (1.6912), counter 3/5
    Epoch [5/50], Train Losses: mse: 8.0051, mae: 1.7844, huber: 1.3876, swd: 1.9281, ept: 108.8549
    Epoch [5/50], Val Losses: mse: 12.6832, mae: 2.1120, huber: 1.7297, swd: 3.8591, ept: 94.8280
    Epoch [5/50], Test Losses: mse: 11.5987, mae: 2.1221, huber: 1.7174, swd: 3.3858, ept: 115.9084
      Epoch 5 composite train-obj: 1.387639
            No improvement (1.7297), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.9011, mae: 1.7709, huber: 1.3754, swd: 1.9241, ept: 110.2965
    Epoch [6/50], Val Losses: mse: 12.8871, mae: 2.1295, huber: 1.7487, swd: 3.9086, ept: 97.2560
    Epoch [6/50], Test Losses: mse: 11.4563, mae: 2.1029, huber: 1.7005, swd: 3.1705, ept: 117.5999
      Epoch 6 composite train-obj: 1.375367
    Epoch [6/50], Test Losses: mse: 19.1590, mae: 2.4460, huber: 2.0395, swd: 4.0791, ept: 105.4321
    Best round's Test MSE: 19.1598, MAE: 2.4461, SWD: 4.0795
    Best round's Validation MSE: 12.0658, MAE: 1.8992, SWD: 2.5411
    Best round's Test verification MSE : 19.1590, MAE: 2.4460, SWD: 4.0791
    Time taken: 14.90 seconds
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 18.4526, mae: 2.5062, huber: 2.0912, swd: 8.5622, ept: 65.9119
    Epoch [1/50], Val Losses: mse: 11.9281, mae: 1.9340, huber: 1.5522, swd: 3.2661, ept: 131.8911
    Epoch [1/50], Test Losses: mse: 18.3343, mae: 2.4459, huber: 2.0379, swd: 5.0127, ept: 103.7874
      Epoch 1 composite train-obj: 2.091190
            Val objective improved inf → 1.5522, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.6208, mae: 1.9154, huber: 1.5140, swd: 2.6841, ept: 100.9637
    Epoch [2/50], Val Losses: mse: 11.4740, mae: 1.9437, huber: 1.5665, swd: 2.7835, ept: 104.5291
    Epoch [2/50], Test Losses: mse: 13.2161, mae: 2.1870, huber: 1.7828, swd: 3.2600, ept: 111.8208
      Epoch 2 composite train-obj: 1.514015
            No improvement (1.5665), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.6222, mae: 1.8487, huber: 1.4487, swd: 2.4139, ept: 103.7575
    Epoch [3/50], Val Losses: mse: 12.0292, mae: 2.0245, huber: 1.6456, swd: 3.5100, ept: 97.8655
    Epoch [3/50], Test Losses: mse: 12.2788, mae: 2.1494, huber: 1.7443, swd: 3.3356, ept: 113.8927
      Epoch 3 composite train-obj: 1.448744
            No improvement (1.6456), counter 2/5
    Epoch [4/50], Train Losses: mse: 8.1521, mae: 1.8010, huber: 1.4030, swd: 2.1292, ept: 108.2341
    Epoch [4/50], Val Losses: mse: 12.3232, mae: 2.0535, huber: 1.6753, swd: 3.5936, ept: 97.2525
    Epoch [4/50], Test Losses: mse: 11.7778, mae: 2.1143, huber: 1.7105, swd: 2.9025, ept: 115.0209
      Epoch 4 composite train-obj: 1.402995
            No improvement (1.6753), counter 3/5
    Epoch [5/50], Train Losses: mse: 8.0269, mae: 1.7856, huber: 1.3890, swd: 2.1125, ept: 110.1475
    Epoch [5/50], Val Losses: mse: 12.8046, mae: 2.1132, huber: 1.7334, swd: 4.1052, ept: 98.9562
    Epoch [5/50], Test Losses: mse: 11.5209, mae: 2.1046, huber: 1.7015, swd: 3.1799, ept: 119.0009
      Epoch 5 composite train-obj: 1.389029
            No improvement (1.7334), counter 4/5
    Epoch [6/50], Train Losses: mse: 7.8883, mae: 1.7691, huber: 1.3739, swd: 2.0622, ept: 112.1743
    Epoch [6/50], Val Losses: mse: 13.3017, mae: 2.1447, huber: 1.7672, swd: 4.2644, ept: 88.4111
    Epoch [6/50], Test Losses: mse: 11.4311, mae: 2.0936, huber: 1.6906, swd: 2.8830, ept: 111.4555
      Epoch 6 composite train-obj: 1.373939
    Epoch [6/50], Test Losses: mse: 18.3342, mae: 2.4459, huber: 2.0379, swd: 5.0130, ept: 103.8019
    Best round's Test MSE: 18.3343, MAE: 2.4459, SWD: 5.0127
    Best round's Validation MSE: 11.9281, MAE: 1.9340, SWD: 3.2661
    Best round's Test verification MSE : 18.3342, MAE: 2.4459, SWD: 5.0130
    Time taken: 14.45 seconds
    
    ==================================================
    Experiment Summary (ACL_etth1_seq96_pred720_20250510_1338)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 18.3464 ± 0.6593
      mae: 2.4231 ± 0.0323
      huber: 2.0165 ± 0.0315
      swd: 4.3546 ± 0.4674
      ept: 104.9951 ± 0.8569
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 11.8503 ± 0.2149
      mae: 1.9043 ± 0.0224
      huber: 1.5238 ± 0.0213
      swd: 2.7707 ± 0.3506
      ept: 123.6939 ± 5.7963
      count: 8.0000 ± 0.0000
    ==================================================
    Three seeds Time taken: 45.67 seconds
    
    Experiment complete: ACL_etth1_seq96_pred720_20250510_1338
    Model: ACL
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### Timemixer

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=96,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 94
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 94
    Validation Batches: 13
    Test Batches: 26
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.5897, mae: 1.8248, huber: 1.4426, swd: 2.4411, target_std: 6.4964
    Epoch [1/50], Val Losses: mse: 8.5297, mae: 1.5354, huber: 1.1762, swd: 1.1191, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 11.5328, mae: 1.8547, huber: 1.4830, swd: 2.3665, target_std: 4.7450
      Epoch 1 composite train-obj: 1.442563
            Val objective improved inf → 1.1762, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.6368, mae: 1.5144, huber: 1.1468, swd: 1.8080, target_std: 6.4971
    Epoch [2/50], Val Losses: mse: 8.1871, mae: 1.4739, huber: 1.1191, swd: 1.1150, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 11.1982, mae: 1.8043, huber: 1.4363, swd: 2.3752, target_std: 4.7450
      Epoch 2 composite train-obj: 1.146796
            Val objective improved 1.1762 → 1.1191, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.4315, mae: 1.4769, huber: 1.1123, swd: 1.7582, target_std: 6.4975
    Epoch [3/50], Val Losses: mse: 8.1664, mae: 1.4466, huber: 1.0942, swd: 0.9294, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 11.0346, mae: 1.7648, huber: 1.3989, swd: 1.9985, target_std: 4.7450
      Epoch 3 composite train-obj: 1.112282
            Val objective improved 1.1191 → 1.0942, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.3455, mae: 1.4600, huber: 1.0969, swd: 1.7236, target_std: 6.4972
    Epoch [4/50], Val Losses: mse: 8.0843, mae: 1.4378, huber: 1.0863, swd: 0.9564, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 10.9558, mae: 1.7583, huber: 1.3930, swd: 2.0700, target_std: 4.7450
      Epoch 4 composite train-obj: 1.096881
            Val objective improved 1.0942 → 1.0863, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.2849, mae: 1.4506, huber: 1.0883, swd: 1.7051, target_std: 6.4970
    Epoch [5/50], Val Losses: mse: 8.1055, mae: 1.4404, huber: 1.0893, swd: 0.9779, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 10.8868, mae: 1.7497, huber: 1.3849, swd: 2.0513, target_std: 4.7450
      Epoch 5 composite train-obj: 1.088321
            No improvement (1.0893), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.2428, mae: 1.4447, huber: 1.0830, swd: 1.6987, target_std: 6.4965
    Epoch [6/50], Val Losses: mse: 8.1162, mae: 1.4456, huber: 1.0943, swd: 1.0042, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.8682, mae: 1.7498, huber: 1.3851, swd: 2.0791, target_std: 4.7450
      Epoch 6 composite train-obj: 1.082958
            No improvement (1.0943), counter 2/5
    Epoch [7/50], Train Losses: mse: 6.1989, mae: 1.4380, huber: 1.0769, swd: 1.6790, target_std: 6.4975
    Epoch [7/50], Val Losses: mse: 8.0153, mae: 1.4367, huber: 1.0861, swd: 0.9757, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.7642, mae: 1.7418, huber: 1.3776, swd: 2.0680, target_std: 4.7450
      Epoch 7 composite train-obj: 1.076878
            Val objective improved 1.0863 → 1.0861, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.1564, mae: 1.4325, huber: 1.0719, swd: 1.6664, target_std: 6.4977
    Epoch [8/50], Val Losses: mse: 8.0275, mae: 1.4412, huber: 1.0902, swd: 0.9547, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 10.6379, mae: 1.7293, huber: 1.3656, swd: 1.9635, target_std: 4.7450
      Epoch 8 composite train-obj: 1.071925
            No improvement (1.0902), counter 1/5
    Epoch [9/50], Train Losses: mse: 6.1102, mae: 1.4270, huber: 1.0668, swd: 1.6463, target_std: 6.4979
    Epoch [9/50], Val Losses: mse: 7.9533, mae: 1.4324, huber: 1.0823, swd: 0.9478, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.5965, mae: 1.7302, huber: 1.3663, swd: 2.0506, target_std: 4.7450
      Epoch 9 composite train-obj: 1.066806
            Val objective improved 1.0861 → 1.0823, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 6.0655, mae: 1.4212, huber: 1.0615, swd: 1.6232, target_std: 6.4981
    Epoch [10/50], Val Losses: mse: 7.9543, mae: 1.4364, huber: 1.0852, swd: 0.8967, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 10.5301, mae: 1.7217, huber: 1.3581, swd: 1.8884, target_std: 4.7450
      Epoch 10 composite train-obj: 1.061473
            No improvement (1.0852), counter 1/5
    Epoch [11/50], Train Losses: mse: 6.0328, mae: 1.4168, huber: 1.0573, swd: 1.6073, target_std: 6.4981
    Epoch [11/50], Val Losses: mse: 7.9270, mae: 1.4328, huber: 1.0824, swd: 0.9590, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.5348, mae: 1.7299, huber: 1.3660, swd: 2.0455, target_std: 4.7450
      Epoch 11 composite train-obj: 1.057268
            No improvement (1.0824), counter 2/5
    Epoch [12/50], Train Losses: mse: 5.9800, mae: 1.4105, huber: 1.0514, swd: 1.5794, target_std: 6.4969
    Epoch [12/50], Val Losses: mse: 7.8807, mae: 1.4275, huber: 1.0772, swd: 0.8829, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.4390, mae: 1.7191, huber: 1.3556, swd: 1.9285, target_std: 4.7450
      Epoch 12 composite train-obj: 1.051376
            Val objective improved 1.0823 → 1.0772, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 5.9525, mae: 1.4071, huber: 1.0481, swd: 1.5618, target_std: 6.4968
    Epoch [13/50], Val Losses: mse: 7.8669, mae: 1.4239, huber: 1.0736, swd: 0.9429, target_std: 4.3128
    Epoch [13/50], Test Losses: mse: 10.5221, mae: 1.7355, huber: 1.3708, swd: 2.1070, target_std: 4.7450
      Epoch 13 composite train-obj: 1.048078
            Val objective improved 1.0772 → 1.0736, saving checkpoint.
    Epoch [14/50], Train Losses: mse: 5.9260, mae: 1.4036, huber: 1.0446, swd: 1.5447, target_std: 6.4972
    Epoch [14/50], Val Losses: mse: 7.7833, mae: 1.4266, huber: 1.0752, swd: 1.0887, target_std: 4.3128
    Epoch [14/50], Test Losses: mse: 10.6246, mae: 1.7801, huber: 1.4123, swd: 2.5316, target_std: 4.7450
      Epoch 14 composite train-obj: 1.044628
            No improvement (1.0752), counter 1/5
    Epoch [15/50], Train Losses: mse: 5.8969, mae: 1.4003, huber: 1.0415, swd: 1.5393, target_std: 6.4964
    Epoch [15/50], Val Losses: mse: 7.8938, mae: 1.4320, huber: 1.0799, swd: 0.8324, target_std: 4.3128
    Epoch [15/50], Test Losses: mse: 10.4816, mae: 1.7166, huber: 1.3527, swd: 1.7722, target_std: 4.7450
      Epoch 15 composite train-obj: 1.041474
            No improvement (1.0799), counter 2/5
    Epoch [16/50], Train Losses: mse: 5.8524, mae: 1.3950, huber: 1.0364, swd: 1.5094, target_std: 6.4974
    Epoch [16/50], Val Losses: mse: 7.8029, mae: 1.4257, huber: 1.0742, swd: 0.8357, target_std: 4.3128
    Epoch [16/50], Test Losses: mse: 10.3747, mae: 1.7147, huber: 1.3509, swd: 1.8309, target_std: 4.7450
      Epoch 16 composite train-obj: 1.036351
            No improvement (1.0742), counter 3/5
    Epoch [17/50], Train Losses: mse: 5.8223, mae: 1.3908, huber: 1.0324, swd: 1.4935, target_std: 6.4969
    Epoch [17/50], Val Losses: mse: 7.6871, mae: 1.4135, huber: 1.0623, swd: 0.9301, target_std: 4.3128
    Epoch [17/50], Test Losses: mse: 10.4123, mae: 1.7390, huber: 1.3735, swd: 2.1649, target_std: 4.7450
      Epoch 17 composite train-obj: 1.032393
            Val objective improved 1.0736 → 1.0623, saving checkpoint.
    Epoch [18/50], Train Losses: mse: 5.7812, mae: 1.3857, huber: 1.0273, swd: 1.4743, target_std: 6.4968
    Epoch [18/50], Val Losses: mse: 7.8163, mae: 1.4264, huber: 1.0741, swd: 0.8194, target_std: 4.3128
    Epoch [18/50], Test Losses: mse: 10.4233, mae: 1.7227, huber: 1.3580, swd: 1.8876, target_std: 4.7450
      Epoch 18 composite train-obj: 1.027348
            No improvement (1.0741), counter 1/5
    Epoch [19/50], Train Losses: mse: 5.7567, mae: 1.3822, huber: 1.0240, swd: 1.4580, target_std: 6.4963
    Epoch [19/50], Val Losses: mse: 7.6803, mae: 1.4204, huber: 1.0684, swd: 0.8092, target_std: 4.3128
    Epoch [19/50], Test Losses: mse: 10.3195, mae: 1.7169, huber: 1.3528, swd: 1.8532, target_std: 4.7450
      Epoch 19 composite train-obj: 1.023978
            No improvement (1.0684), counter 2/5
    Epoch [20/50], Train Losses: mse: 5.7218, mae: 1.3781, huber: 1.0201, swd: 1.4452, target_std: 6.4974
    Epoch [20/50], Val Losses: mse: 7.8424, mae: 1.4310, huber: 1.0789, swd: 0.8221, target_std: 4.3128
    Epoch [20/50], Test Losses: mse: 10.3657, mae: 1.7209, huber: 1.3567, swd: 1.8537, target_std: 4.7450
      Epoch 20 composite train-obj: 1.020061
            No improvement (1.0789), counter 3/5
    Epoch [21/50], Train Losses: mse: 5.6924, mae: 1.3744, huber: 1.0164, swd: 1.4256, target_std: 6.4969
    Epoch [21/50], Val Losses: mse: 7.6817, mae: 1.4238, huber: 1.0709, swd: 0.8145, target_std: 4.3128
    Epoch [21/50], Test Losses: mse: 10.2787, mae: 1.7224, huber: 1.3568, swd: 1.8822, target_std: 4.7450
      Epoch 21 composite train-obj: 1.016381
            No improvement (1.0709), counter 4/5
    Epoch [22/50], Train Losses: mse: 5.6564, mae: 1.3707, huber: 1.0127, swd: 1.4072, target_std: 6.4980
    Epoch [22/50], Val Losses: mse: 7.7260, mae: 1.4201, huber: 1.0682, swd: 0.8515, target_std: 4.3128
    Epoch [22/50], Test Losses: mse: 10.4584, mae: 1.7442, huber: 1.3783, swd: 2.0807, target_std: 4.7450
      Epoch 22 composite train-obj: 1.012703
    Epoch [22/50], Test Losses: mse: 10.4123, mae: 1.7390, huber: 1.3735, swd: 2.1649, target_std: 4.7450
    Best round's Test MSE: 10.4123, MAE: 1.7390, SWD: 2.1649
    Best round's Validation MSE: 7.6871, MAE: 1.4135
    Best round's Test verification MSE : 10.4123, MAE: 1.7390, SWD: 2.1649
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.1542, mae: 1.8620, huber: 1.4776, swd: 2.4509, target_std: 6.4969
    Epoch [1/50], Val Losses: mse: 8.6744, mae: 1.5576, huber: 1.1964, swd: 1.1724, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 11.7524, mae: 1.8836, huber: 1.5100, swd: 2.3859, target_std: 4.7450
      Epoch 1 composite train-obj: 1.477613
            Val objective improved inf → 1.1964, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.6486, mae: 1.5189, huber: 1.1504, swd: 1.7535, target_std: 6.4968
    Epoch [2/50], Val Losses: mse: 8.4341, mae: 1.4991, huber: 1.1431, swd: 1.0402, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 11.3256, mae: 1.8083, huber: 1.4400, swd: 2.1641, target_std: 4.7450
      Epoch 2 composite train-obj: 1.150403
            Val objective improved 1.1964 → 1.1431, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.4428, mae: 1.4795, huber: 1.1144, swd: 1.6880, target_std: 6.4972
    Epoch [3/50], Val Losses: mse: 8.3323, mae: 1.4692, huber: 1.1153, swd: 1.0068, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 11.2826, mae: 1.7876, huber: 1.4207, swd: 2.0847, target_std: 4.7450
      Epoch 3 composite train-obj: 1.114368
            Val objective improved 1.1431 → 1.1153, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.3660, mae: 1.4642, huber: 1.1004, swd: 1.6627, target_std: 6.4979
    Epoch [4/50], Val Losses: mse: 8.0632, mae: 1.4370, huber: 1.0848, swd: 0.9295, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 11.0644, mae: 1.7700, huber: 1.4036, swd: 2.0542, target_std: 4.7450
      Epoch 4 composite train-obj: 1.100445
            Val objective improved 1.1153 → 1.0848, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.3226, mae: 1.4546, huber: 1.0920, swd: 1.6483, target_std: 6.4977
    Epoch [5/50], Val Losses: mse: 8.2380, mae: 1.4460, huber: 1.0943, swd: 0.9024, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 11.0971, mae: 1.7556, huber: 1.3906, swd: 1.8801, target_std: 4.7450
      Epoch 5 composite train-obj: 1.091952
            No improvement (1.0943), counter 1/5
    Epoch [6/50], Train Losses: mse: 6.2835, mae: 1.4478, huber: 1.0858, swd: 1.6258, target_std: 6.4973
    Epoch [6/50], Val Losses: mse: 8.1752, mae: 1.4426, huber: 1.0914, swd: 0.9125, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 11.0487, mae: 1.7556, huber: 1.3908, swd: 1.9365, target_std: 4.7450
      Epoch 6 composite train-obj: 1.085828
            No improvement (1.0914), counter 2/5
    Epoch [7/50], Train Losses: mse: 6.2481, mae: 1.4422, huber: 1.0808, swd: 1.6178, target_std: 6.4967
    Epoch [7/50], Val Losses: mse: 8.0358, mae: 1.4354, huber: 1.0836, swd: 0.8674, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.9462, mae: 1.7475, huber: 1.3832, swd: 1.8638, target_std: 4.7450
      Epoch 7 composite train-obj: 1.080819
            Val objective improved 1.0848 → 1.0836, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.2221, mae: 1.4388, huber: 1.0778, swd: 1.6125, target_std: 6.4969
    Epoch [8/50], Val Losses: mse: 8.1119, mae: 1.4422, huber: 1.0906, swd: 0.9245, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 10.9684, mae: 1.7512, huber: 1.3866, swd: 1.9758, target_std: 4.7450
      Epoch 8 composite train-obj: 1.077806
            No improvement (1.0906), counter 1/5
    Epoch [9/50], Train Losses: mse: 6.2006, mae: 1.4362, huber: 1.0754, swd: 1.6141, target_std: 6.4970
    Epoch [9/50], Val Losses: mse: 8.1615, mae: 1.4441, huber: 1.0924, swd: 0.9021, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.9756, mae: 1.7413, huber: 1.3778, swd: 1.8576, target_std: 4.7450
      Epoch 9 composite train-obj: 1.075351
            No improvement (1.0924), counter 2/5
    Epoch [10/50], Train Losses: mse: 6.1723, mae: 1.4312, huber: 1.0707, swd: 1.5913, target_std: 6.4980
    Epoch [10/50], Val Losses: mse: 8.2352, mae: 1.4468, huber: 1.0961, swd: 0.9747, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 11.0339, mae: 1.7494, huber: 1.3855, swd: 2.0043, target_std: 4.7450
      Epoch 10 composite train-obj: 1.070708
            No improvement (1.0961), counter 3/5
    Epoch [11/50], Train Losses: mse: 6.1393, mae: 1.4265, huber: 1.0664, swd: 1.5810, target_std: 6.4965
    Epoch [11/50], Val Losses: mse: 8.0603, mae: 1.4403, huber: 1.0885, swd: 0.8667, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.8467, mae: 1.7361, huber: 1.3722, swd: 1.8413, target_std: 4.7450
      Epoch 11 composite train-obj: 1.066401
            No improvement (1.0885), counter 4/5
    Epoch [12/50], Train Losses: mse: 6.1121, mae: 1.4239, huber: 1.0639, swd: 1.5705, target_std: 6.4972
    Epoch [12/50], Val Losses: mse: 8.0701, mae: 1.4361, huber: 1.0852, swd: 0.9292, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.8532, mae: 1.7377, huber: 1.3741, swd: 1.9484, target_std: 4.7450
      Epoch 12 composite train-obj: 1.063873
    Epoch [12/50], Test Losses: mse: 10.9462, mae: 1.7475, huber: 1.3832, swd: 1.8638, target_std: 4.7450
    Best round's Test MSE: 10.9462, MAE: 1.7475, SWD: 1.8638
    Best round's Validation MSE: 8.0358, MAE: 1.4354
    Best round's Test verification MSE : 10.9462, MAE: 1.7475, SWD: 1.8638
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.3747, mae: 1.9618, huber: 1.5768, swd: 2.8360, target_std: 6.4981
    Epoch [1/50], Val Losses: mse: 8.6378, mae: 1.5489, huber: 1.1884, swd: 1.0016, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 11.5844, mae: 1.8615, huber: 1.4895, swd: 2.0860, target_std: 4.7450
      Epoch 1 composite train-obj: 1.576798
            Val objective improved inf → 1.1884, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.6200, mae: 1.5142, huber: 1.1464, swd: 1.6777, target_std: 6.4969
    Epoch [2/50], Val Losses: mse: 8.3621, mae: 1.4834, huber: 1.1282, swd: 0.9735, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 11.1775, mae: 1.7950, huber: 1.4271, swd: 2.0429, target_std: 4.7450
      Epoch 2 composite train-obj: 1.146379
            Val objective improved 1.1884 → 1.1282, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.4272, mae: 1.4764, huber: 1.1117, swd: 1.6258, target_std: 6.4970
    Epoch [3/50], Val Losses: mse: 8.2436, mae: 1.4519, huber: 1.0989, swd: 0.9268, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 11.1210, mae: 1.7731, huber: 1.4068, swd: 1.9614, target_std: 4.7450
      Epoch 3 composite train-obj: 1.111742
            Val objective improved 1.1282 → 1.0989, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.3501, mae: 1.4601, huber: 1.0970, swd: 1.5952, target_std: 6.4978
    Epoch [4/50], Val Losses: mse: 8.3368, mae: 1.4539, huber: 1.1015, swd: 0.8752, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 11.1689, mae: 1.7617, huber: 1.3965, swd: 1.8210, target_std: 4.7450
      Epoch 4 composite train-obj: 1.096983
            No improvement (1.1015), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.3079, mae: 1.4513, huber: 1.0891, swd: 1.5859, target_std: 6.4963
    Epoch [5/50], Val Losses: mse: 8.1980, mae: 1.4402, huber: 1.0891, swd: 0.9117, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 11.0495, mae: 1.7535, huber: 1.3890, swd: 1.9258, target_std: 4.7450
      Epoch 5 composite train-obj: 1.089099
            Val objective improved 1.0989 → 1.0891, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.2636, mae: 1.4440, huber: 1.0825, swd: 1.5668, target_std: 6.4967
    Epoch [6/50], Val Losses: mse: 8.1401, mae: 1.4398, huber: 1.0884, swd: 0.8575, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.9583, mae: 1.7456, huber: 1.3815, swd: 1.8330, target_std: 4.7450
      Epoch 6 composite train-obj: 1.082542
            Val objective improved 1.0891 → 1.0884, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.2343, mae: 1.4393, huber: 1.0783, swd: 1.5559, target_std: 6.4966
    Epoch [7/50], Val Losses: mse: 8.0039, mae: 1.4273, huber: 1.0766, swd: 0.8784, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.8803, mae: 1.7438, huber: 1.3796, swd: 1.9228, target_std: 4.7450
      Epoch 7 composite train-obj: 1.078320
            Val objective improved 1.0884 → 1.0766, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.2119, mae: 1.4356, huber: 1.0750, swd: 1.5482, target_std: 6.4979
    Epoch [8/50], Val Losses: mse: 8.2091, mae: 1.4408, huber: 1.0902, swd: 0.9217, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 11.0065, mae: 1.7450, huber: 1.3815, swd: 1.9273, target_std: 4.7450
      Epoch 8 composite train-obj: 1.075011
            No improvement (1.0902), counter 1/5
    Epoch [9/50], Train Losses: mse: 6.1783, mae: 1.4306, huber: 1.0704, swd: 1.5319, target_std: 6.4976
    Epoch [9/50], Val Losses: mse: 8.1283, mae: 1.4414, huber: 1.0899, swd: 0.8956, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.8989, mae: 1.7329, huber: 1.3701, swd: 1.8235, target_std: 4.7450
      Epoch 9 composite train-obj: 1.070379
            No improvement (1.0899), counter 2/5
    Epoch [10/50], Train Losses: mse: 6.1482, mae: 1.4264, huber: 1.0666, swd: 1.5192, target_std: 6.4972
    Epoch [10/50], Val Losses: mse: 7.9465, mae: 1.4291, huber: 1.0775, swd: 0.8558, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 10.7778, mae: 1.7323, huber: 1.3688, swd: 1.8328, target_std: 4.7450
      Epoch 10 composite train-obj: 1.066552
            No improvement (1.0775), counter 3/5
    Epoch [11/50], Train Losses: mse: 6.1268, mae: 1.4243, huber: 1.0646, swd: 1.5142, target_std: 6.4966
    Epoch [11/50], Val Losses: mse: 8.2324, mae: 1.4462, huber: 1.0950, swd: 0.9620, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.9905, mae: 1.7485, huber: 1.3846, swd: 1.9818, target_std: 4.7450
      Epoch 11 composite train-obj: 1.064563
            No improvement (1.0950), counter 4/5
    Epoch [12/50], Train Losses: mse: 6.0986, mae: 1.4212, huber: 1.0616, swd: 1.5028, target_std: 6.4965
    Epoch [12/50], Val Losses: mse: 8.0434, mae: 1.4352, huber: 1.0837, swd: 0.8578, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.7290, mae: 1.7223, huber: 1.3596, swd: 1.7761, target_std: 4.7450
      Epoch 12 composite train-obj: 1.061571
    Epoch [12/50], Test Losses: mse: 10.8803, mae: 1.7438, huber: 1.3796, swd: 1.9228, target_std: 4.7450
    Best round's Test MSE: 10.8803, MAE: 1.7438, SWD: 1.9228
    Best round's Validation MSE: 8.0039, MAE: 1.4273
    Best round's Test verification MSE : 10.8803, MAE: 1.7438, SWD: 1.9228
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq96_pred96_20250501_0301)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.7463 ± 0.2377
      mae: 1.7435 ± 0.0035
      huber: 1.3788 ± 0.0040
      swd: 1.9838 ± 0.1303
      target_std: 4.7450 ± 0.0000
      count: 13.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 7.9089 ± 0.1574
      mae: 1.4254 ± 0.0090
      huber: 1.0742 ± 0.0088
      swd: 0.8920 ± 0.0273
      target_std: 4.3128 ± 0.0000
      count: 13.0000 ± 0.0000
    ==================================================
    
    Experiment complete: TimeMixer_etth1_seq96_pred96_20250501_0301
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=96,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.1085, mae: 1.9742, huber: 1.5842, swd: 2.5057, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 10.3411, mae: 1.7117, huber: 1.3458, swd: 1.3346, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 12.5040, mae: 1.9811, huber: 1.6008, swd: 2.3898, target_std: 4.7672
      Epoch 1 composite train-obj: 1.584188
            Val objective improved inf → 1.3458, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6250, mae: 1.6550, huber: 1.2780, swd: 1.9475, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 10.2346, mae: 1.6677, huber: 1.3051, swd: 1.1755, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 12.1495, mae: 1.9224, huber: 1.5458, swd: 2.0964, target_std: 4.7672
      Epoch 2 composite train-obj: 1.277954
            Val objective improved 1.3458 → 1.3051, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3979, mae: 1.6162, huber: 1.2420, swd: 1.8898, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 9.9783, mae: 1.6205, huber: 1.2601, swd: 1.1001, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 11.9936, mae: 1.8989, huber: 1.5231, swd: 2.0130, target_std: 4.7672
      Epoch 3 composite train-obj: 1.241999
            Val objective improved 1.3051 → 1.2601, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.3273, mae: 1.6012, huber: 1.2283, swd: 1.8666, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 9.9084, mae: 1.6059, huber: 1.2467, swd: 1.1320, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.8701, mae: 1.8834, huber: 1.5085, swd: 2.0745, target_std: 4.7672
      Epoch 4 composite train-obj: 1.228306
            Val objective improved 1.2601 → 1.2467, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.2579, mae: 1.5910, huber: 1.2189, swd: 1.8448, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 9.9158, mae: 1.6037, huber: 1.2449, swd: 1.1178, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.8218, mae: 1.8756, huber: 1.5011, swd: 2.0352, target_std: 4.7672
      Epoch 5 composite train-obj: 1.218923
            Val objective improved 1.2467 → 1.2449, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.2100, mae: 1.5844, huber: 1.2129, swd: 1.8327, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 9.9955, mae: 1.6159, huber: 1.2568, swd: 1.2146, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 11.8245, mae: 1.8800, huber: 1.5052, swd: 2.1603, target_std: 4.7672
      Epoch 6 composite train-obj: 1.212879
            No improvement (1.2568), counter 1/5
    Epoch [7/50], Train Losses: mse: 7.1479, mae: 1.5779, huber: 1.2068, swd: 1.8192, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 9.7938, mae: 1.6045, huber: 1.2456, swd: 1.1689, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 11.6913, mae: 1.8704, huber: 1.4960, swd: 2.1065, target_std: 4.7672
      Epoch 7 composite train-obj: 1.206769
            No improvement (1.2456), counter 2/5
    Epoch [8/50], Train Losses: mse: 7.1031, mae: 1.5730, huber: 1.2022, swd: 1.8077, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 9.7465, mae: 1.6064, huber: 1.2473, swd: 1.1722, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 11.6031, mae: 1.8673, huber: 1.4930, swd: 2.0987, target_std: 4.7672
      Epoch 8 composite train-obj: 1.202193
            No improvement (1.2473), counter 3/5
    Epoch [9/50], Train Losses: mse: 7.0478, mae: 1.5678, huber: 1.1972, swd: 1.7927, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 9.7473, mae: 1.6085, huber: 1.2489, swd: 1.1396, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 11.6269, mae: 1.8637, huber: 1.4898, swd: 2.0050, target_std: 4.7672
      Epoch 9 composite train-obj: 1.197238
            No improvement (1.2489), counter 4/5
    Epoch [10/50], Train Losses: mse: 7.0181, mae: 1.5652, huber: 1.1948, swd: 1.7848, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 9.5107, mae: 1.5912, huber: 1.2326, swd: 1.2073, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 11.5040, mae: 1.8701, huber: 1.4955, swd: 2.2519, target_std: 4.7672
      Epoch 10 composite train-obj: 1.194806
            Val objective improved 1.2449 → 1.2326, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 6.9793, mae: 1.5602, huber: 1.1900, swd: 1.7683, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 9.4577, mae: 1.5887, huber: 1.2301, swd: 1.2013, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 11.4333, mae: 1.8669, huber: 1.4918, swd: 2.2066, target_std: 4.7672
      Epoch 11 composite train-obj: 1.190006
            Val objective improved 1.2326 → 1.2301, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 6.9559, mae: 1.5587, huber: 1.1885, swd: 1.7594, target_std: 6.4940
    Epoch [12/50], Val Losses: mse: 9.5510, mae: 1.5946, huber: 1.2358, swd: 1.2079, target_std: 4.3003
    Epoch [12/50], Test Losses: mse: 11.4661, mae: 1.8644, huber: 1.4901, swd: 2.1363, target_std: 4.7672
      Epoch 12 composite train-obj: 1.188497
            No improvement (1.2358), counter 1/5
    Epoch [13/50], Train Losses: mse: 6.9158, mae: 1.5538, huber: 1.1838, swd: 1.7412, target_std: 6.4940
    Epoch [13/50], Val Losses: mse: 9.3460, mae: 1.5889, huber: 1.2302, swd: 1.2909, target_std: 4.3003
    Epoch [13/50], Test Losses: mse: 11.3422, mae: 1.8730, huber: 1.4976, swd: 2.3518, target_std: 4.7672
      Epoch 13 composite train-obj: 1.183818
            No improvement (1.2302), counter 2/5
    Epoch [14/50], Train Losses: mse: 6.8833, mae: 1.5506, huber: 1.1806, swd: 1.7229, target_std: 6.4940
    Epoch [14/50], Val Losses: mse: 9.4879, mae: 1.5955, huber: 1.2365, swd: 1.1868, target_std: 4.3003
    Epoch [14/50], Test Losses: mse: 11.3550, mae: 1.8563, huber: 1.4819, swd: 2.0467, target_std: 4.7672
      Epoch 14 composite train-obj: 1.180633
            No improvement (1.2365), counter 3/5
    Epoch [15/50], Train Losses: mse: 6.8560, mae: 1.5475, huber: 1.1776, swd: 1.7080, target_std: 6.4940
    Epoch [15/50], Val Losses: mse: 9.3940, mae: 1.5904, huber: 1.2316, swd: 1.2244, target_std: 4.3003
    Epoch [15/50], Test Losses: mse: 11.2921, mae: 1.8627, huber: 1.4878, swd: 2.1478, target_std: 4.7672
      Epoch 15 composite train-obj: 1.177582
            No improvement (1.2316), counter 4/5
    Epoch [16/50], Train Losses: mse: 6.8151, mae: 1.5430, huber: 1.1732, swd: 1.6819, target_std: 6.4940
    Epoch [16/50], Val Losses: mse: 9.7059, mae: 1.6174, huber: 1.2573, swd: 1.1618, target_std: 4.3003
    Epoch [16/50], Test Losses: mse: 11.3867, mae: 1.8520, huber: 1.4785, swd: 1.8495, target_std: 4.7672
      Epoch 16 composite train-obj: 1.173202
    Epoch [16/50], Test Losses: mse: 11.4333, mae: 1.8669, huber: 1.4918, swd: 2.2066, target_std: 4.7672
    Best round's Test MSE: 11.4333, MAE: 1.8669, SWD: 2.2066
    Best round's Validation MSE: 9.4577, MAE: 1.5887
    Best round's Test verification MSE : 11.4333, MAE: 1.8669, SWD: 2.2066
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.5114, mae: 1.9495, huber: 1.5610, swd: 2.9581, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 10.3531, mae: 1.7154, huber: 1.3496, swd: 1.3632, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 12.4321, mae: 1.9804, huber: 1.5998, swd: 2.3573, target_std: 4.7672
      Epoch 1 composite train-obj: 1.560953
            Val objective improved inf → 1.3496, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.5537, mae: 1.6450, huber: 1.2688, swd: 1.9791, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 10.0934, mae: 1.6518, huber: 1.2901, swd: 1.2551, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 12.1032, mae: 1.9211, huber: 1.5443, swd: 2.1925, target_std: 4.7672
      Epoch 2 composite train-obj: 1.268843
            Val objective improved 1.3496 → 1.2901, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3650, mae: 1.6093, huber: 1.2361, swd: 1.9154, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 9.9089, mae: 1.6124, huber: 1.2533, swd: 1.2511, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 11.9574, mae: 1.9011, huber: 1.5256, swd: 2.2531, target_std: 4.7672
      Epoch 3 composite train-obj: 1.236094
            Val objective improved 1.2901 → 1.2533, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.2780, mae: 1.5933, huber: 1.2215, swd: 1.8704, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 9.7572, mae: 1.5974, huber: 1.2383, swd: 1.0858, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.8402, mae: 1.8816, huber: 1.5069, swd: 2.0001, target_std: 4.7672
      Epoch 4 composite train-obj: 1.221497
            Val objective improved 1.2533 → 1.2383, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.2217, mae: 1.5848, huber: 1.2137, swd: 1.8496, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 9.6836, mae: 1.5940, huber: 1.2354, swd: 1.1881, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.7883, mae: 1.8833, huber: 1.5086, swd: 2.2110, target_std: 4.7672
      Epoch 5 composite train-obj: 1.213731
            Val objective improved 1.2383 → 1.2354, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.1566, mae: 1.5777, huber: 1.2070, swd: 1.8310, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 9.7848, mae: 1.6026, huber: 1.2438, swd: 1.1809, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 11.7102, mae: 1.8762, huber: 1.5014, swd: 2.1300, target_std: 4.7672
      Epoch 6 composite train-obj: 1.206972
            No improvement (1.2438), counter 1/5
    Epoch [7/50], Train Losses: mse: 7.1030, mae: 1.5718, huber: 1.2015, swd: 1.8105, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 9.7182, mae: 1.6035, huber: 1.2438, swd: 1.0599, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 11.6835, mae: 1.8659, huber: 1.4917, swd: 1.9069, target_std: 4.7672
      Epoch 7 composite train-obj: 1.201471
            No improvement (1.2438), counter 2/5
    Epoch [8/50], Train Losses: mse: 7.0544, mae: 1.5670, huber: 1.1968, swd: 1.7887, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 9.6127, mae: 1.5957, huber: 1.2367, swd: 1.1050, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 11.5495, mae: 1.8658, huber: 1.4911, swd: 2.0104, target_std: 4.7672
      Epoch 8 composite train-obj: 1.196783
            No improvement (1.2367), counter 3/5
    Epoch [9/50], Train Losses: mse: 7.0063, mae: 1.5626, huber: 1.1924, swd: 1.7756, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 9.8309, mae: 1.6137, huber: 1.2540, swd: 1.1028, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 11.6373, mae: 1.8607, huber: 1.4869, swd: 1.8881, target_std: 4.7672
      Epoch 9 composite train-obj: 1.192443
            No improvement (1.2540), counter 4/5
    Epoch [10/50], Train Losses: mse: 6.9443, mae: 1.5561, huber: 1.1863, swd: 1.7469, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 9.3862, mae: 1.5851, huber: 1.2261, swd: 1.1068, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 11.3979, mae: 1.8645, huber: 1.4894, swd: 2.0554, target_std: 4.7672
      Epoch 10 composite train-obj: 1.186296
            Val objective improved 1.2354 → 1.2261, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 6.9008, mae: 1.5520, huber: 1.1821, swd: 1.7241, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 9.3840, mae: 1.5910, huber: 1.2318, swd: 1.1551, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 11.3025, mae: 1.8611, huber: 1.4860, swd: 2.0678, target_std: 4.7672
      Epoch 11 composite train-obj: 1.182129
            No improvement (1.2318), counter 1/5
    Epoch [12/50], Train Losses: mse: 6.8565, mae: 1.5477, huber: 1.1779, swd: 1.7057, target_std: 6.4940
    Epoch [12/50], Val Losses: mse: 9.3022, mae: 1.5849, huber: 1.2248, swd: 1.1002, target_std: 4.3003
    Epoch [12/50], Test Losses: mse: 11.2982, mae: 1.8639, huber: 1.4878, swd: 2.0248, target_std: 4.7672
      Epoch 12 composite train-obj: 1.177920
            Val objective improved 1.2261 → 1.2248, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 6.8083, mae: 1.5432, huber: 1.1735, swd: 1.6782, target_std: 6.4940
    Epoch [13/50], Val Losses: mse: 9.3694, mae: 1.5916, huber: 1.2322, swd: 1.2294, target_std: 4.3003
    Epoch [13/50], Test Losses: mse: 11.3043, mae: 1.8719, huber: 1.4958, swd: 2.1909, target_std: 4.7672
      Epoch 13 composite train-obj: 1.173466
            No improvement (1.2322), counter 1/5
    Epoch [14/50], Train Losses: mse: 6.7756, mae: 1.5390, huber: 1.1693, swd: 1.6594, target_std: 6.4940
    Epoch [14/50], Val Losses: mse: 9.4379, mae: 1.5988, huber: 1.2394, swd: 1.2397, target_std: 4.3003
    Epoch [14/50], Test Losses: mse: 11.2896, mae: 1.8693, huber: 1.4937, swd: 2.1456, target_std: 4.7672
      Epoch 14 composite train-obj: 1.169347
            No improvement (1.2394), counter 2/5
    Epoch [15/50], Train Losses: mse: 6.7343, mae: 1.5353, huber: 1.1656, swd: 1.6359, target_std: 6.4940
    Epoch [15/50], Val Losses: mse: 9.2759, mae: 1.5909, huber: 1.2313, swd: 1.2623, target_std: 4.3003
    Epoch [15/50], Test Losses: mse: 11.2193, mae: 1.8710, huber: 1.4950, swd: 2.2389, target_std: 4.7672
      Epoch 15 composite train-obj: 1.165629
            No improvement (1.2313), counter 3/5
    Epoch [16/50], Train Losses: mse: 6.6974, mae: 1.5315, huber: 1.1620, swd: 1.6204, target_std: 6.4940
    Epoch [16/50], Val Losses: mse: 9.3937, mae: 1.5916, huber: 1.2321, swd: 1.1901, target_std: 4.3003
    Epoch [16/50], Test Losses: mse: 11.3129, mae: 1.8670, huber: 1.4915, swd: 2.0536, target_std: 4.7672
      Epoch 16 composite train-obj: 1.161971
            No improvement (1.2321), counter 4/5
    Epoch [17/50], Train Losses: mse: 6.6430, mae: 1.5255, huber: 1.1560, swd: 1.5863, target_std: 6.4940
    Epoch [17/50], Val Losses: mse: 9.4776, mae: 1.6042, huber: 1.2440, swd: 1.2334, target_std: 4.3003
    Epoch [17/50], Test Losses: mse: 11.2313, mae: 1.8655, huber: 1.4894, swd: 2.0635, target_std: 4.7672
      Epoch 17 composite train-obj: 1.155990
    Epoch [17/50], Test Losses: mse: 11.2982, mae: 1.8639, huber: 1.4878, swd: 2.0248, target_std: 4.7672
    Best round's Test MSE: 11.2982, MAE: 1.8639, SWD: 2.0248
    Best round's Validation MSE: 9.3022, MAE: 1.5849
    Best round's Test verification MSE : 11.2982, MAE: 1.8639, SWD: 2.0248
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.8126, mae: 1.8829, huber: 1.4967, swd: 2.5985, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 10.5238, mae: 1.7208, huber: 1.3557, swd: 1.1431, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 12.3922, mae: 1.9603, huber: 1.5815, swd: 2.0125, target_std: 4.7672
      Epoch 1 composite train-obj: 1.496715
            Val objective improved inf → 1.3557, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.5048, mae: 1.6352, huber: 1.2598, swd: 1.7716, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 10.1143, mae: 1.6515, huber: 1.2900, swd: 1.1198, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 12.0916, mae: 1.9168, huber: 1.5404, swd: 2.0453, target_std: 4.7672
      Epoch 2 composite train-obj: 1.259827
            Val objective improved 1.3557 → 1.2900, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3639, mae: 1.6082, huber: 1.2349, swd: 1.7152, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 9.9456, mae: 1.6110, huber: 1.2517, swd: 1.0720, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 11.9758, mae: 1.8967, huber: 1.5209, swd: 1.9888, target_std: 4.7672
      Epoch 3 composite train-obj: 1.234935
            Val objective improved 1.2900 → 1.2517, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.2890, mae: 1.5944, huber: 1.2221, swd: 1.6838, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 10.1360, mae: 1.6174, huber: 1.2583, swd: 1.0696, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.9894, mae: 1.8863, huber: 1.5109, swd: 1.9012, target_std: 4.7672
      Epoch 4 composite train-obj: 1.222146
            No improvement (1.2583), counter 1/5
    Epoch [5/50], Train Losses: mse: 7.2268, mae: 1.5863, huber: 1.2146, swd: 1.6601, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 9.9882, mae: 1.6111, huber: 1.2520, swd: 1.0476, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.9207, mae: 1.8825, huber: 1.5073, swd: 1.8788, target_std: 4.7672
      Epoch 5 composite train-obj: 1.214629
            No improvement (1.2520), counter 2/5
    Epoch [6/50], Train Losses: mse: 7.1697, mae: 1.5792, huber: 1.2080, swd: 1.6414, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 9.6900, mae: 1.5913, huber: 1.2329, swd: 1.0680, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 11.7627, mae: 1.8802, huber: 1.5047, swd: 1.9950, target_std: 4.7672
      Epoch 6 composite train-obj: 1.208022
            Val objective improved 1.2517 → 1.2329, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.1125, mae: 1.5732, huber: 1.2024, swd: 1.6270, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 9.7622, mae: 1.5992, huber: 1.2407, swd: 1.1185, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 11.7109, mae: 1.8794, huber: 1.5035, swd: 2.0435, target_std: 4.7672
      Epoch 7 composite train-obj: 1.202418
            No improvement (1.2407), counter 1/5
    Epoch [8/50], Train Losses: mse: 7.0593, mae: 1.5677, huber: 1.1971, swd: 1.6092, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 9.7734, mae: 1.6106, huber: 1.2518, swd: 1.2665, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 11.7041, mae: 1.8965, huber: 1.5195, swd: 2.3010, target_std: 4.7672
      Epoch 8 composite train-obj: 1.197131
            No improvement (1.2518), counter 2/5
    Epoch [9/50], Train Losses: mse: 7.0250, mae: 1.5638, huber: 1.1935, swd: 1.5972, target_std: 6.4941
    Epoch [9/50], Val Losses: mse: 9.6684, mae: 1.5981, huber: 1.2392, swd: 1.0808, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 11.5427, mae: 1.8650, huber: 1.4895, swd: 1.9314, target_std: 4.7672
      Epoch 9 composite train-obj: 1.193471
            No improvement (1.2392), counter 3/5
    Epoch [10/50], Train Losses: mse: 6.9644, mae: 1.5575, huber: 1.1873, swd: 1.5709, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 9.7588, mae: 1.6044, huber: 1.2450, swd: 1.0376, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 11.5858, mae: 1.8610, huber: 1.4865, swd: 1.8189, target_std: 4.7672
      Epoch 10 composite train-obj: 1.187338
            No improvement (1.2450), counter 4/5
    Epoch [11/50], Train Losses: mse: 6.9197, mae: 1.5536, huber: 1.1834, swd: 1.5514, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 9.7386, mae: 1.6026, huber: 1.2436, swd: 1.0519, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 11.5096, mae: 1.8569, huber: 1.4823, swd: 1.8349, target_std: 4.7672
      Epoch 11 composite train-obj: 1.183386
    Epoch [11/50], Test Losses: mse: 11.7627, mae: 1.8802, huber: 1.5047, swd: 1.9950, target_std: 4.7672
    Best round's Test MSE: 11.7627, MAE: 1.8802, SWD: 1.9950
    Best round's Validation MSE: 9.6900, MAE: 1.5913
    Best round's Test verification MSE : 11.7627, MAE: 1.8802, SWD: 1.9950
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq96_pred196_20250501_0311)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 11.4981 ± 0.1951
      mae: 1.8703 ± 0.0071
      huber: 1.4947 ± 0.0072
      swd: 2.0754 ± 0.0935
      target_std: 4.7672 ± 0.0000
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.4833 ± 0.1594
      mae: 1.5883 ± 0.0026
      huber: 1.2293 ± 0.0033
      swd: 1.1232 ± 0.0568
      target_std: 4.3003 ± 0.0000
      count: 12.0000 ± 0.0000
    ==================================================
    
    Experiment complete: TimeMixer_etth1_seq96_pred196_20250501_0311
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=96,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 12.6705, mae: 2.1209, huber: 1.7218, swd: 2.4177, target_std: 6.4823
    Epoch [1/50], Val Losses: mse: 11.2897, mae: 1.7798, huber: 1.4123, swd: 1.2419, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 12.7616, mae: 2.0512, huber: 1.6657, swd: 2.2015, target_std: 4.7760
      Epoch 1 composite train-obj: 1.721765
            Val objective improved inf → 1.4123, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.3328, mae: 1.7646, huber: 1.3805, swd: 2.0844, target_std: 6.4823
    Epoch [2/50], Val Losses: mse: 11.2384, mae: 1.7347, huber: 1.3710, swd: 1.1525, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 12.1729, mae: 1.9916, huber: 1.6089, swd: 2.0207, target_std: 4.7760
      Epoch 2 composite train-obj: 1.380507
            Val objective improved 1.4123 → 1.3710, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.0868, mae: 1.7276, huber: 1.3461, swd: 2.0332, target_std: 6.4822
    Epoch [3/50], Val Losses: mse: 10.9831, mae: 1.6857, huber: 1.3245, swd: 1.1856, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 12.0656, mae: 1.9733, huber: 1.5915, swd: 2.1319, target_std: 4.7760
      Epoch 3 composite train-obj: 1.346102
            Val objective improved 1.3710 → 1.3245, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.9968, mae: 1.7112, huber: 1.3309, swd: 1.9888, target_std: 6.4820
    Epoch [4/50], Val Losses: mse: 10.9769, mae: 1.6703, huber: 1.3100, swd: 1.1529, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 11.9844, mae: 1.9617, huber: 1.5803, swd: 2.0768, target_std: 4.7760
      Epoch 4 composite train-obj: 1.330857
            Val objective improved 1.3245 → 1.3100, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.9408, mae: 1.7026, huber: 1.3228, swd: 1.9673, target_std: 6.4821
    Epoch [5/50], Val Losses: mse: 11.0305, mae: 1.6703, huber: 1.3102, swd: 1.1483, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.9253, mae: 1.9554, huber: 1.5740, swd: 2.0558, target_std: 4.7760
      Epoch 5 composite train-obj: 1.322819
            No improvement (1.3102), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.8869, mae: 1.6957, huber: 1.3163, swd: 1.9468, target_std: 6.4820
    Epoch [6/50], Val Losses: mse: 10.6703, mae: 1.6614, huber: 1.3013, swd: 1.3085, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 12.0014, mae: 1.9825, huber: 1.5991, swd: 2.4386, target_std: 4.7760
      Epoch 6 composite train-obj: 1.316334
            Val objective improved 1.3100 → 1.3013, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.8444, mae: 1.6912, huber: 1.3121, swd: 1.9374, target_std: 6.4824
    Epoch [7/50], Val Losses: mse: 10.9792, mae: 1.6714, huber: 1.3109, swd: 1.0758, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.8195, mae: 1.9436, huber: 1.5627, swd: 1.9234, target_std: 4.7760
      Epoch 7 composite train-obj: 1.312099
            No improvement (1.3109), counter 1/5
    Epoch [8/50], Train Losses: mse: 7.7752, mae: 1.6837, huber: 1.3049, swd: 1.9081, target_std: 6.4821
    Epoch [8/50], Val Losses: mse: 11.0495, mae: 1.6729, huber: 1.3126, swd: 1.1261, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.7747, mae: 1.9465, huber: 1.5647, swd: 2.0076, target_std: 4.7760
      Epoch 8 composite train-obj: 1.304908
            No improvement (1.3126), counter 2/5
    Epoch [9/50], Train Losses: mse: 7.7136, mae: 1.6786, huber: 1.2999, swd: 1.8947, target_std: 6.4821
    Epoch [9/50], Val Losses: mse: 10.8283, mae: 1.6696, huber: 1.3092, swd: 1.2826, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.7566, mae: 1.9609, huber: 1.5784, swd: 2.2717, target_std: 4.7760
      Epoch 9 composite train-obj: 1.299909
            No improvement (1.3092), counter 3/5
    Epoch [10/50], Train Losses: mse: 7.6454, mae: 1.6718, huber: 1.2934, swd: 1.8669, target_std: 6.4820
    Epoch [10/50], Val Losses: mse: 10.8595, mae: 1.6682, huber: 1.3073, swd: 1.0763, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.6703, mae: 1.9410, huber: 1.5596, swd: 1.8555, target_std: 4.7760
      Epoch 10 composite train-obj: 1.293375
            No improvement (1.3073), counter 4/5
    Epoch [11/50], Train Losses: mse: 7.5911, mae: 1.6662, huber: 1.2878, swd: 1.8396, target_std: 6.4825
    Epoch [11/50], Val Losses: mse: 10.9324, mae: 1.6841, huber: 1.3232, swd: 1.3058, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.6345, mae: 1.9532, huber: 1.5705, swd: 2.1664, target_std: 4.7760
      Epoch 11 composite train-obj: 1.287849
    Epoch [11/50], Test Losses: mse: 12.0014, mae: 1.9825, huber: 1.5991, swd: 2.4386, target_std: 4.7760
    Best round's Test MSE: 12.0014, MAE: 1.9825, SWD: 2.4386
    Best round's Validation MSE: 10.6703, MAE: 1.6614
    Best round's Test verification MSE : 12.0014, MAE: 1.9825, SWD: 2.4386
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.8171, mae: 1.9779, huber: 1.5830, swd: 2.3339, target_std: 6.4818
    Epoch [1/50], Val Losses: mse: 11.2431, mae: 1.7590, huber: 1.3929, swd: 1.2111, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 12.4493, mae: 2.0250, huber: 1.6400, swd: 2.0826, target_std: 4.7760
      Epoch 1 composite train-obj: 1.582996
            Val objective improved inf → 1.3929, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.1595, mae: 1.7402, huber: 1.3573, swd: 2.0904, target_std: 6.4824
    Epoch [2/50], Val Losses: mse: 11.2683, mae: 1.7160, huber: 1.3529, swd: 1.0723, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 12.1697, mae: 1.9809, huber: 1.5984, swd: 1.8639, target_std: 4.7760
      Epoch 2 composite train-obj: 1.357260
            Val objective improved 1.3929 → 1.3529, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.0039, mae: 1.7132, huber: 1.3321, swd: 2.0309, target_std: 6.4824
    Epoch [3/50], Val Losses: mse: 11.2303, mae: 1.6935, huber: 1.3305, swd: 0.9484, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 12.2075, mae: 1.9771, huber: 1.5944, swd: 1.7002, target_std: 4.7760
      Epoch 3 composite train-obj: 1.332144
            Val objective improved 1.3529 → 1.3305, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.9138, mae: 1.6998, huber: 1.3196, swd: 1.9918, target_std: 6.4824
    Epoch [4/50], Val Losses: mse: 11.1905, mae: 1.6784, huber: 1.3168, swd: 1.1374, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 12.0016, mae: 1.9627, huber: 1.5792, swd: 2.0018, target_std: 4.7760
      Epoch 4 composite train-obj: 1.319563
            Val objective improved 1.3305 → 1.3168, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.8124, mae: 1.6892, huber: 1.3094, swd: 1.9587, target_std: 6.4823
    Epoch [5/50], Val Losses: mse: 11.1746, mae: 1.6841, huber: 1.3218, swd: 1.0150, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.9919, mae: 1.9601, huber: 1.5767, swd: 1.8069, target_std: 4.7760
      Epoch 5 composite train-obj: 1.309362
            No improvement (1.3218), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.7214, mae: 1.6810, huber: 1.3013, swd: 1.9318, target_std: 6.4827
    Epoch [6/50], Val Losses: mse: 10.8854, mae: 1.6694, huber: 1.3075, swd: 1.0358, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.9001, mae: 1.9549, huber: 1.5718, swd: 1.8604, target_std: 4.7760
      Epoch 6 composite train-obj: 1.301333
            Val objective improved 1.3168 → 1.3075, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.6516, mae: 1.6740, huber: 1.2944, swd: 1.9042, target_std: 6.4819
    Epoch [7/50], Val Losses: mse: 10.9019, mae: 1.6751, huber: 1.3131, swd: 1.1867, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.8098, mae: 1.9562, huber: 1.5725, swd: 2.0249, target_std: 4.7760
      Epoch 7 composite train-obj: 1.294438
            No improvement (1.3131), counter 1/5
    Epoch [8/50], Train Losses: mse: 7.5718, mae: 1.6665, huber: 1.2871, swd: 1.8744, target_std: 6.4823
    Epoch [8/50], Val Losses: mse: 11.2191, mae: 1.6879, huber: 1.3260, swd: 1.1456, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.8066, mae: 1.9452, huber: 1.5629, swd: 1.8923, target_std: 4.7760
      Epoch 8 composite train-obj: 1.287054
            No improvement (1.3260), counter 2/5
    Epoch [9/50], Train Losses: mse: 7.5196, mae: 1.6602, huber: 1.2810, swd: 1.8452, target_std: 6.4818
    Epoch [9/50], Val Losses: mse: 11.5122, mae: 1.7065, huber: 1.3440, swd: 1.1507, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.7688, mae: 1.9390, huber: 1.5573, swd: 1.8292, target_std: 4.7760
      Epoch 9 composite train-obj: 1.281040
            No improvement (1.3440), counter 3/5
    Epoch [10/50], Train Losses: mse: 7.4649, mae: 1.6559, huber: 1.2767, swd: 1.8215, target_std: 6.4819
    Epoch [10/50], Val Losses: mse: 11.0726, mae: 1.6873, huber: 1.3251, swd: 1.1749, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.5757, mae: 1.9316, huber: 1.5504, swd: 1.8650, target_std: 4.7760
      Epoch 10 composite train-obj: 1.276743
            No improvement (1.3251), counter 4/5
    Epoch [11/50], Train Losses: mse: 7.3994, mae: 1.6498, huber: 1.2709, swd: 1.7932, target_std: 6.4819
    Epoch [11/50], Val Losses: mse: 10.5997, mae: 1.6767, huber: 1.3141, swd: 1.3577, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.5295, mae: 1.9530, huber: 1.5701, swd: 2.1870, target_std: 4.7760
      Epoch 11 composite train-obj: 1.270947
    Epoch [11/50], Test Losses: mse: 11.9001, mae: 1.9549, huber: 1.5718, swd: 1.8604, target_std: 4.7760
    Best round's Test MSE: 11.9001, MAE: 1.9549, SWD: 1.8604
    Best round's Validation MSE: 10.8854, MAE: 1.6694
    Best round's Test verification MSE : 11.9001, MAE: 1.9549, SWD: 1.8604
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.1376, mae: 1.9457, huber: 1.5544, swd: 2.8459, target_std: 6.4821
    Epoch [1/50], Val Losses: mse: 11.4132, mae: 1.7637, huber: 1.3989, swd: 1.3534, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 12.2945, mae: 2.0182, huber: 1.6335, swd: 2.2411, target_std: 4.7760
      Epoch 1 composite train-obj: 1.554355
            Val objective improved inf → 1.3989, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.1123, mae: 1.7351, huber: 1.3529, swd: 2.0037, target_std: 6.4822
    Epoch [2/50], Val Losses: mse: 11.2925, mae: 1.7131, huber: 1.3510, swd: 1.2592, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 12.0617, mae: 1.9781, huber: 1.5957, swd: 2.1321, target_std: 4.7760
      Epoch 2 composite train-obj: 1.352862
            Val objective improved 1.3989 → 1.3510, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.9704, mae: 1.7101, huber: 1.3296, swd: 1.9410, target_std: 6.4823
    Epoch [3/50], Val Losses: mse: 11.2156, mae: 1.6818, huber: 1.3208, swd: 1.1660, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 11.9740, mae: 1.9618, huber: 1.5798, swd: 2.0296, target_std: 4.7760
      Epoch 3 composite train-obj: 1.329631
            Val objective improved 1.3510 → 1.3208, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.8995, mae: 1.6985, huber: 1.3188, swd: 1.9035, target_std: 6.4823
    Epoch [4/50], Val Losses: mse: 11.0409, mae: 1.6758, huber: 1.3148, swd: 1.2336, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 11.9150, mae: 1.9665, huber: 1.5835, swd: 2.1966, target_std: 4.7760
      Epoch 4 composite train-obj: 1.318754
            Val objective improved 1.3208 → 1.3148, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.8161, mae: 1.6895, huber: 1.3102, swd: 1.8828, target_std: 6.4821
    Epoch [5/50], Val Losses: mse: 10.8589, mae: 1.6641, huber: 1.3031, swd: 1.0804, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.7695, mae: 1.9496, huber: 1.5673, swd: 1.9869, target_std: 4.7760
      Epoch 5 composite train-obj: 1.310190
            Val objective improved 1.3148 → 1.3031, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.7301, mae: 1.6814, huber: 1.3024, swd: 1.8544, target_std: 6.4820
    Epoch [6/50], Val Losses: mse: 10.6016, mae: 1.6561, huber: 1.2951, swd: 1.1764, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.6676, mae: 1.9578, huber: 1.5742, swd: 2.2057, target_std: 4.7760
      Epoch 6 composite train-obj: 1.302362
            Val objective improved 1.3031 → 1.2951, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.6560, mae: 1.6743, huber: 1.2955, swd: 1.8302, target_std: 6.4819
    Epoch [7/50], Val Losses: mse: 10.9736, mae: 1.6783, huber: 1.3172, swd: 1.2249, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.7182, mae: 1.9586, huber: 1.5754, swd: 2.1507, target_std: 4.7760
      Epoch 7 composite train-obj: 1.295452
            No improvement (1.3172), counter 1/5
    Epoch [8/50], Train Losses: mse: 7.5827, mae: 1.6670, huber: 1.2885, swd: 1.7980, target_std: 6.4824
    Epoch [8/50], Val Losses: mse: 10.8465, mae: 1.6732, huber: 1.3119, swd: 1.1366, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.6143, mae: 1.9455, huber: 1.5631, swd: 1.9942, target_std: 4.7760
      Epoch 8 composite train-obj: 1.288462
            No improvement (1.3119), counter 2/5
    Epoch [9/50], Train Losses: mse: 7.5117, mae: 1.6603, huber: 1.2818, swd: 1.7643, target_std: 6.4818
    Epoch [9/50], Val Losses: mse: 10.3598, mae: 1.6504, huber: 1.2891, swd: 1.1460, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.4576, mae: 1.9439, huber: 1.5610, swd: 2.0416, target_std: 4.7760
      Epoch 9 composite train-obj: 1.281812
            Val objective improved 1.2951 → 1.2891, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 7.4541, mae: 1.6549, huber: 1.2765, swd: 1.7331, target_std: 6.4822
    Epoch [10/50], Val Losses: mse: 11.3993, mae: 1.7190, huber: 1.3562, swd: 1.3788, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.6569, mae: 1.9643, huber: 1.5797, swd: 2.1367, target_std: 4.7760
      Epoch 10 composite train-obj: 1.276491
            No improvement (1.3562), counter 1/5
    Epoch [11/50], Train Losses: mse: 7.3957, mae: 1.6497, huber: 1.2712, swd: 1.7051, target_std: 6.4825
    Epoch [11/50], Val Losses: mse: 10.9042, mae: 1.6857, huber: 1.3240, swd: 1.2473, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.4192, mae: 1.9392, huber: 1.5565, swd: 1.9861, target_std: 4.7760
      Epoch 11 composite train-obj: 1.271169
            No improvement (1.3240), counter 2/5
    Epoch [12/50], Train Losses: mse: 7.3339, mae: 1.6432, huber: 1.2648, swd: 1.6691, target_std: 6.4823
    Epoch [12/50], Val Losses: mse: 10.5965, mae: 1.6779, huber: 1.3155, swd: 1.2749, target_std: 4.2818
    Epoch [12/50], Test Losses: mse: 11.3679, mae: 1.9436, huber: 1.5611, swd: 2.0626, target_std: 4.7760
      Epoch 12 composite train-obj: 1.264762
            No improvement (1.3155), counter 3/5
    Epoch [13/50], Train Losses: mse: 7.2847, mae: 1.6387, huber: 1.2603, swd: 1.6481, target_std: 6.4821
    Epoch [13/50], Val Losses: mse: 10.5529, mae: 1.6781, huber: 1.3156, swd: 1.3114, target_std: 4.2818
    Epoch [13/50], Test Losses: mse: 11.3030, mae: 1.9438, huber: 1.5604, swd: 2.0927, target_std: 4.7760
      Epoch 13 composite train-obj: 1.260308
            No improvement (1.3156), counter 4/5
    Epoch [14/50], Train Losses: mse: 7.2127, mae: 1.6314, huber: 1.2530, swd: 1.6079, target_std: 6.4821
    Epoch [14/50], Val Losses: mse: 10.5267, mae: 1.6842, huber: 1.3209, swd: 1.3872, target_std: 4.2818
    Epoch [14/50], Test Losses: mse: 11.2712, mae: 1.9475, huber: 1.5635, swd: 2.1833, target_std: 4.7760
      Epoch 14 composite train-obj: 1.252952
    Epoch [14/50], Test Losses: mse: 11.4576, mae: 1.9439, huber: 1.5610, swd: 2.0416, target_std: 4.7760
    Best round's Test MSE: 11.4576, MAE: 1.9439, SWD: 2.0416
    Best round's Validation MSE: 10.3598, MAE: 1.6504
    Best round's Test verification MSE : 11.4576, MAE: 1.9439, SWD: 2.0416
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq96_pred336_20250501_0313)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 11.7864 ± 0.2361
      mae: 1.9604 ± 0.0162
      huber: 1.5773 ± 0.0161
      swd: 2.1135 ± 0.2415
      target_std: 4.7760 ± 0.0000
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 10.6385 ± 0.2158
      mae: 1.6604 ± 0.0078
      huber: 1.2993 ± 0.0076
      swd: 1.1635 ± 0.1120
      target_std: 4.2818 ± 0.0000
      count: 11.0000 ± 0.0000
    ==================================================
    
    Experiment complete: TimeMixer_etth1_seq96_pred336_20250501_0313
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatTimeMixerConfig(
    seq_len=96,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)

```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 13.9284, mae: 2.3215, huber: 1.9137, swd: 3.5705, target_std: 6.4169
    Epoch [1/50], Val Losses: mse: 10.7326, mae: 1.7783, huber: 1.4107, swd: 1.5762, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 14.0198, mae: 2.2919, huber: 1.8913, swd: 3.0852, target_std: 4.8130
      Epoch 1 composite train-obj: 1.913678
            Val objective improved inf → 1.4107, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.7426, mae: 1.9677, huber: 1.5705, swd: 2.7839, target_std: 6.4168
    Epoch [2/50], Val Losses: mse: 10.5126, mae: 1.7348, huber: 1.3696, swd: 1.6857, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 13.6711, mae: 2.2662, huber: 1.8664, swd: 3.3132, target_std: 4.8130
      Epoch 2 composite train-obj: 1.570537
            Val objective improved 1.4107 → 1.3696, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.4700, mae: 1.9315, huber: 1.5363, swd: 2.7212, target_std: 6.4166
    Epoch [3/50], Val Losses: mse: 10.1408, mae: 1.6603, huber: 1.2973, swd: 1.0412, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 13.4443, mae: 2.2178, huber: 1.8198, swd: 2.6026, target_std: 4.8130
      Epoch 3 composite train-obj: 1.536326
            Val objective improved 1.3696 → 1.2973, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 9.3517, mae: 1.9160, huber: 1.5217, swd: 2.6667, target_std: 6.4167
    Epoch [4/50], Val Losses: mse: 10.5230, mae: 1.7085, huber: 1.3436, swd: 1.5782, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 13.5438, mae: 2.2474, huber: 1.8469, swd: 3.1056, target_std: 4.8130
      Epoch 4 composite train-obj: 1.521683
            No improvement (1.3436), counter 1/5
    Epoch [5/50], Train Losses: mse: 9.2177, mae: 1.9013, huber: 1.5073, swd: 2.5931, target_std: 6.4168
    Epoch [5/50], Val Losses: mse: 10.6765, mae: 1.7228, huber: 1.3574, swd: 1.6537, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 13.4414, mae: 2.2420, huber: 1.8403, swd: 3.0316, target_std: 4.8130
      Epoch 5 composite train-obj: 1.507302
            No improvement (1.3574), counter 2/5
    Epoch [6/50], Train Losses: mse: 9.0906, mae: 1.8893, huber: 1.4953, swd: 2.5344, target_std: 6.4173
    Epoch [6/50], Val Losses: mse: 11.4653, mae: 1.7816, huber: 1.4143, swd: 1.6968, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 13.4189, mae: 2.2283, huber: 1.8261, swd: 2.7852, target_std: 4.8130
      Epoch 6 composite train-obj: 1.495308
            No improvement (1.4143), counter 3/5
    Epoch [7/50], Train Losses: mse: 9.0079, mae: 1.8822, huber: 1.4880, swd: 2.4918, target_std: 6.4167
    Epoch [7/50], Val Losses: mse: 11.1540, mae: 1.7372, huber: 1.3722, swd: 1.4755, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 13.3705, mae: 2.2108, huber: 1.8105, swd: 2.6434, target_std: 4.8130
      Epoch 7 composite train-obj: 1.487998
            No improvement (1.3722), counter 4/5
    Epoch [8/50], Train Losses: mse: 8.9154, mae: 1.8726, huber: 1.4785, swd: 2.4434, target_std: 6.4171
    Epoch [8/50], Val Losses: mse: 11.9664, mae: 1.8326, huber: 1.4640, swd: 1.8918, target_std: 4.3000
    Epoch [8/50], Test Losses: mse: 13.5280, mae: 2.2441, huber: 1.8412, swd: 2.8577, target_std: 4.8130
      Epoch 8 composite train-obj: 1.478543
    Epoch [8/50], Test Losses: mse: 13.4443, mae: 2.2178, huber: 1.8198, swd: 2.6026, target_std: 4.8130
    Best round's Test MSE: 13.4443, MAE: 2.2178, SWD: 2.6026
    Best round's Validation MSE: 10.1408, MAE: 1.6603
    Best round's Test verification MSE : 13.4443, MAE: 2.2178, SWD: 2.6026
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.9979, mae: 2.1408, huber: 1.7358, swd: 2.8515, target_std: 6.4164
    Epoch [1/50], Val Losses: mse: 10.4045, mae: 1.7287, huber: 1.3618, swd: 1.0038, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 13.8601, mae: 2.2560, huber: 1.8565, swd: 2.4048, target_std: 4.8130
      Epoch 1 composite train-obj: 1.735816
            Val objective improved inf → 1.3618, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.5558, mae: 1.9414, huber: 1.5456, swd: 2.5611, target_std: 6.4168
    Epoch [2/50], Val Losses: mse: 10.0661, mae: 1.6793, huber: 1.3154, swd: 1.2022, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 13.3961, mae: 2.2213, huber: 1.8228, swd: 2.6665, target_std: 4.8130
      Epoch 2 composite train-obj: 1.545650
            Val objective improved 1.3618 → 1.3154, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.2580, mae: 1.9090, huber: 1.5147, swd: 2.4682, target_std: 6.4168
    Epoch [3/50], Val Losses: mse: 10.2402, mae: 1.6592, huber: 1.2962, swd: 1.0377, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 13.3136, mae: 2.2031, huber: 1.8042, swd: 2.3538, target_std: 4.8130
      Epoch 3 composite train-obj: 1.514717
            Val objective improved 1.3154 → 1.2962, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 9.0942, mae: 1.8920, huber: 1.4981, swd: 2.3989, target_std: 6.4168
    Epoch [4/50], Val Losses: mse: 10.1765, mae: 1.6900, huber: 1.3252, swd: 1.4131, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 13.1493, mae: 2.2149, huber: 1.8143, swd: 2.7286, target_std: 4.8130
      Epoch 4 composite train-obj: 1.498117
            No improvement (1.3252), counter 1/5
    Epoch [5/50], Train Losses: mse: 8.9661, mae: 1.8798, huber: 1.4862, swd: 2.3578, target_std: 6.4166
    Epoch [5/50], Val Losses: mse: 10.2994, mae: 1.6943, huber: 1.3293, swd: 1.3994, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 13.1429, mae: 2.2182, huber: 1.8172, swd: 2.7417, target_std: 4.8130
      Epoch 5 composite train-obj: 1.486167
            No improvement (1.3293), counter 2/5
    Epoch [6/50], Train Losses: mse: 8.8671, mae: 1.8705, huber: 1.4769, swd: 2.3140, target_std: 6.4169
    Epoch [6/50], Val Losses: mse: 10.6819, mae: 1.7176, huber: 1.3529, swd: 1.3730, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 13.0060, mae: 2.1968, huber: 1.7967, swd: 2.5218, target_std: 4.8130
      Epoch 6 composite train-obj: 1.476935
            No improvement (1.3529), counter 3/5
    Epoch [7/50], Train Losses: mse: 8.7822, mae: 1.8619, huber: 1.4684, swd: 2.2672, target_std: 6.4168
    Epoch [7/50], Val Losses: mse: 11.3279, mae: 1.7438, huber: 1.3790, swd: 1.2512, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 13.0843, mae: 2.1929, huber: 1.7930, swd: 2.3033, target_std: 4.8130
      Epoch 7 composite train-obj: 1.468393
            No improvement (1.3790), counter 4/5
    Epoch [8/50], Train Losses: mse: 8.7056, mae: 1.8544, huber: 1.4610, swd: 2.2265, target_std: 6.4167
    Epoch [8/50], Val Losses: mse: 10.8182, mae: 1.7257, huber: 1.3602, swd: 1.3104, target_std: 4.3000
    Epoch [8/50], Test Losses: mse: 12.9246, mae: 2.1846, huber: 1.7856, swd: 2.3847, target_std: 4.8130
      Epoch 8 composite train-obj: 1.460962
    Epoch [8/50], Test Losses: mse: 13.3136, mae: 2.2031, huber: 1.8042, swd: 2.3538, target_std: 4.8130
    Best round's Test MSE: 13.3136, MAE: 2.2031, SWD: 2.3538
    Best round's Validation MSE: 10.2402, MAE: 1.6592
    Best round's Test verification MSE : 13.3136, MAE: 2.2031, SWD: 2.3538
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 11.8023, mae: 2.1533, huber: 1.7502, swd: 3.4526, target_std: 6.4165
    Epoch [1/50], Val Losses: mse: 10.6073, mae: 1.7583, huber: 1.3918, swd: 1.6926, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 13.7813, mae: 2.2728, huber: 1.8723, swd: 3.2374, target_std: 4.8130
      Epoch 1 composite train-obj: 1.750230
            Val objective improved inf → 1.3918, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.5620, mae: 1.9435, huber: 1.5477, swd: 2.8693, target_std: 6.4167
    Epoch [2/50], Val Losses: mse: 10.2949, mae: 1.6921, huber: 1.3282, swd: 1.3296, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 13.4467, mae: 2.2285, huber: 1.8303, swd: 2.9232, target_std: 4.8130
      Epoch 2 composite train-obj: 1.547742
            Val objective improved 1.3918 → 1.3282, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.4145, mae: 1.9220, huber: 1.5275, swd: 2.8082, target_std: 6.4169
    Epoch [3/50], Val Losses: mse: 10.0990, mae: 1.6688, huber: 1.3055, swd: 1.4013, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 13.3994, mae: 2.2300, huber: 1.8311, swd: 3.0872, target_std: 4.8130
      Epoch 3 composite train-obj: 1.527487
            Val objective improved 1.3282 → 1.3055, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 9.3301, mae: 1.9095, huber: 1.5157, swd: 2.7546, target_std: 6.4168
    Epoch [4/50], Val Losses: mse: 9.9569, mae: 1.6402, huber: 1.2778, swd: 1.1893, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 13.3043, mae: 2.2132, huber: 1.8145, swd: 2.8793, target_std: 4.8130
      Epoch 4 composite train-obj: 1.515654
            Val objective improved 1.3055 → 1.2778, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 9.2503, mae: 1.9007, huber: 1.5072, swd: 2.7169, target_std: 6.4169
    Epoch [5/50], Val Losses: mse: 9.7996, mae: 1.6359, huber: 1.2734, swd: 1.2402, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 13.1906, mae: 2.2112, huber: 1.8120, swd: 2.9541, target_std: 4.8130
      Epoch 5 composite train-obj: 1.507240
            Val objective improved 1.2778 → 1.2734, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 9.1461, mae: 1.8912, huber: 1.4981, swd: 2.6782, target_std: 6.4168
    Epoch [6/50], Val Losses: mse: 9.9710, mae: 1.6648, huber: 1.3010, swd: 1.4689, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 13.2217, mae: 2.2317, huber: 1.8308, swd: 3.1810, target_std: 4.8130
      Epoch 6 composite train-obj: 1.498058
            No improvement (1.3010), counter 1/5
    Epoch [7/50], Train Losses: mse: 9.0060, mae: 1.8814, huber: 1.4883, swd: 2.6313, target_std: 6.4169
    Epoch [7/50], Val Losses: mse: 10.7619, mae: 1.7343, huber: 1.3692, swd: 1.6729, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 13.2210, mae: 2.2289, huber: 1.8277, swd: 3.0678, target_std: 4.8130
      Epoch 7 composite train-obj: 1.488338
            No improvement (1.3692), counter 2/5
    Epoch [8/50], Train Losses: mse: 8.8453, mae: 1.8695, huber: 1.4761, swd: 2.5591, target_std: 6.4169
    Epoch [8/50], Val Losses: mse: 11.6533, mae: 1.7931, huber: 1.4271, swd: 1.6243, target_std: 4.3000
    Epoch [8/50], Test Losses: mse: 13.1664, mae: 2.2098, huber: 1.8091, swd: 2.7653, target_std: 4.8130
      Epoch 8 composite train-obj: 1.476135
            No improvement (1.4271), counter 3/5
    Epoch [9/50], Train Losses: mse: 8.7096, mae: 1.8560, huber: 1.4628, swd: 2.4642, target_std: 6.4165
    Epoch [9/50], Val Losses: mse: 12.0162, mae: 1.8453, huber: 1.4777, swd: 1.9058, target_std: 4.3000
    Epoch [9/50], Test Losses: mse: 12.8350, mae: 2.1963, huber: 1.7943, swd: 2.8068, target_std: 4.8130
      Epoch 9 composite train-obj: 1.462768
            No improvement (1.4777), counter 4/5
    Epoch [10/50], Train Losses: mse: 8.6191, mae: 1.8457, huber: 1.4525, swd: 2.3945, target_std: 6.4170
    Epoch [10/50], Val Losses: mse: 11.1540, mae: 1.8128, huber: 1.4444, swd: 2.1725, target_std: 4.3000
    Epoch [10/50], Test Losses: mse: 13.0517, mae: 2.2422, huber: 1.8395, swd: 3.3659, target_std: 4.8130
      Epoch 10 composite train-obj: 1.452533
    Epoch [10/50], Test Losses: mse: 13.1906, mae: 2.2112, huber: 1.8120, swd: 2.9541, target_std: 4.8130
    Best round's Test MSE: 13.1906, MAE: 2.2112, SWD: 2.9541
    Best round's Validation MSE: 9.7996, MAE: 1.6359
    Best round's Test verification MSE : 13.1906, MAE: 2.2112, SWD: 2.9541
    
    ==================================================
    Experiment Summary (TimeMixer_etth1_seq96_pred720_20250501_0315)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 13.3162 ± 0.1036
      mae: 2.2107 ± 0.0060
      huber: 1.8120 ± 0.0064
      swd: 2.6368 ± 0.2463
      target_std: 4.8130 ± 0.0000
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 10.0602 ± 0.1887
      mae: 1.6518 ± 0.0112
      huber: 1.2890 ± 0.0110
      swd: 1.1064 ± 0.0946
      target_std: 4.3000 ± 0.0000
      count: 8.0000 ± 0.0000
    ==================================================
    
    Experiment complete: TimeMixer_etth1_seq96_pred720_20250501_0315
    Model: TimeMixer
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### PatchTST

#### pred=96


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=96,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 94
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 94
    Validation Batches: 13
    Test Batches: 26
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.8321, mae: 1.6380, huber: 1.2648, swd: 1.8619, target_std: 6.4971
    Epoch [1/50], Val Losses: mse: 7.9848, mae: 1.4356, huber: 1.0825, swd: 0.9339, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 11.0324, mae: 1.7823, huber: 1.4158, swd: 2.1423, target_std: 4.7450
      Epoch 1 composite train-obj: 1.264773
            Val objective improved inf → 1.0825, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0768, mae: 1.5446, huber: 1.1768, swd: 1.7818, target_std: 6.4975
    Epoch [2/50], Val Losses: mse: 7.9674, mae: 1.4420, huber: 1.0882, swd: 0.9481, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 10.7817, mae: 1.7644, huber: 1.3987, swd: 2.0701, target_std: 4.7450
      Epoch 2 composite train-obj: 1.176846
            No improvement (1.0882), counter 1/5
    Epoch [3/50], Train Losses: mse: 6.9238, mae: 1.5246, huber: 1.1580, swd: 1.7396, target_std: 6.4969
    Epoch [3/50], Val Losses: mse: 7.6819, mae: 1.4177, huber: 1.0654, swd: 0.9339, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 10.5406, mae: 1.7536, huber: 1.3871, swd: 2.1580, target_std: 4.7450
      Epoch 3 composite train-obj: 1.158023
            Val objective improved 1.0825 → 1.0654, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.8522, mae: 1.5164, huber: 1.1500, swd: 1.7238, target_std: 6.4969
    Epoch [4/50], Val Losses: mse: 7.6503, mae: 1.4189, huber: 1.0662, swd: 0.9490, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 10.5257, mae: 1.7497, huber: 1.3841, swd: 2.1404, target_std: 4.7450
      Epoch 4 composite train-obj: 1.150046
            No improvement (1.0662), counter 1/5
    Epoch [5/50], Train Losses: mse: 6.7495, mae: 1.5037, huber: 1.1380, swd: 1.6879, target_std: 6.4968
    Epoch [5/50], Val Losses: mse: 7.7678, mae: 1.4305, huber: 1.0788, swd: 0.9538, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 10.3225, mae: 1.7329, huber: 1.3681, swd: 1.9823, target_std: 4.7450
      Epoch 5 composite train-obj: 1.138000
            No improvement (1.0788), counter 2/5
    Epoch [6/50], Train Losses: mse: 6.6645, mae: 1.4948, huber: 1.1294, swd: 1.6646, target_std: 6.4963
    Epoch [6/50], Val Losses: mse: 7.6547, mae: 1.4244, huber: 1.0721, swd: 0.9750, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.2719, mae: 1.7389, huber: 1.3733, swd: 2.1294, target_std: 4.7450
      Epoch 6 composite train-obj: 1.129357
            No improvement (1.0721), counter 3/5
    Epoch [7/50], Train Losses: mse: 6.6116, mae: 1.4886, huber: 1.1233, swd: 1.6486, target_std: 6.4965
    Epoch [7/50], Val Losses: mse: 7.4435, mae: 1.4105, huber: 1.0588, swd: 0.9060, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.2268, mae: 1.7268, huber: 1.3628, swd: 2.0326, target_std: 4.7450
      Epoch 7 composite train-obj: 1.123262
            Val objective improved 1.0654 → 1.0588, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.5400, mae: 1.4796, huber: 1.1145, swd: 1.6117, target_std: 6.4972
    Epoch [8/50], Val Losses: mse: 7.6090, mae: 1.4253, huber: 1.0722, swd: 1.0184, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 10.1795, mae: 1.7412, huber: 1.3750, swd: 2.1835, target_std: 4.7450
      Epoch 8 composite train-obj: 1.114529
            No improvement (1.0722), counter 1/5
    Epoch [9/50], Train Losses: mse: 6.4547, mae: 1.4706, huber: 1.1057, swd: 1.5786, target_std: 6.4973
    Epoch [9/50], Val Losses: mse: 7.4352, mae: 1.4140, huber: 1.0615, swd: 0.9091, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.1307, mae: 1.7225, huber: 1.3581, swd: 2.0810, target_std: 4.7450
      Epoch 9 composite train-obj: 1.105682
            No improvement (1.0615), counter 2/5
    Epoch [10/50], Train Losses: mse: 6.4008, mae: 1.4643, huber: 1.0995, swd: 1.5557, target_std: 6.4969
    Epoch [10/50], Val Losses: mse: 7.4874, mae: 1.4197, huber: 1.0659, swd: 0.9469, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 10.0191, mae: 1.7270, huber: 1.3611, swd: 2.0244, target_std: 4.7450
      Epoch 10 composite train-obj: 1.099452
            No improvement (1.0659), counter 3/5
    Epoch [11/50], Train Losses: mse: 6.3384, mae: 1.4571, huber: 1.0924, swd: 1.5296, target_std: 6.4961
    Epoch [11/50], Val Losses: mse: 7.4374, mae: 1.4224, huber: 1.0687, swd: 1.0752, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.1587, mae: 1.7561, huber: 1.3888, swd: 2.4269, target_std: 4.7450
      Epoch 11 composite train-obj: 1.092405
            No improvement (1.0687), counter 4/5
    Epoch [12/50], Train Losses: mse: 6.2856, mae: 1.4518, huber: 1.0871, swd: 1.5128, target_std: 6.4961
    Epoch [12/50], Val Losses: mse: 7.5519, mae: 1.4288, huber: 1.0752, swd: 0.9124, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.0308, mae: 1.7152, huber: 1.3507, swd: 1.9007, target_std: 4.7450
      Epoch 12 composite train-obj: 1.087137
    Epoch [12/50], Test Losses: mse: 10.2268, mae: 1.7268, huber: 1.3628, swd: 2.0326, target_std: 4.7450
    Best round's Test MSE: 10.2268, MAE: 1.7268, SWD: 2.0326
    Best round's Validation MSE: 7.4435, MAE: 1.4105
    Best round's Test verification MSE : 10.2268, MAE: 1.7268, SWD: 2.0326
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.7971, mae: 1.6336, huber: 1.2606, swd: 1.7713, target_std: 6.4967
    Epoch [1/50], Val Losses: mse: 8.1558, mae: 1.4606, huber: 1.1066, swd: 1.0611, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 11.1612, mae: 1.7978, huber: 1.4312, swd: 2.2224, target_std: 4.7450
      Epoch 1 composite train-obj: 1.260561
            Val objective improved inf → 1.1066, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0777, mae: 1.5447, huber: 1.1771, swd: 1.6841, target_std: 6.4970
    Epoch [2/50], Val Losses: mse: 7.8195, mae: 1.4280, huber: 1.0759, swd: 1.0072, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 10.9451, mae: 1.7839, huber: 1.4170, swd: 2.2670, target_std: 4.7450
      Epoch 2 composite train-obj: 1.177123
            Val objective improved 1.1066 → 1.0759, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.9254, mae: 1.5260, huber: 1.1593, swd: 1.6573, target_std: 6.4972
    Epoch [3/50], Val Losses: mse: 7.7366, mae: 1.4304, huber: 1.0788, swd: 0.9948, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 10.5740, mae: 1.7555, huber: 1.3907, swd: 2.1014, target_std: 4.7450
      Epoch 3 composite train-obj: 1.159338
            No improvement (1.0788), counter 1/5
    Epoch [4/50], Train Losses: mse: 6.8166, mae: 1.5117, huber: 1.1457, swd: 1.6233, target_std: 6.4975
    Epoch [4/50], Val Losses: mse: 7.7887, mae: 1.4330, huber: 1.0810, swd: 0.9965, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 10.5444, mae: 1.7534, huber: 1.3883, swd: 2.0850, target_std: 4.7450
      Epoch 4 composite train-obj: 1.145748
            No improvement (1.0810), counter 2/5
    Epoch [5/50], Train Losses: mse: 6.7294, mae: 1.5016, huber: 1.1361, swd: 1.6035, target_std: 6.4968
    Epoch [5/50], Val Losses: mse: 7.7368, mae: 1.4401, huber: 1.0878, swd: 1.0206, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 10.2778, mae: 1.7413, huber: 1.3756, swd: 2.0500, target_std: 4.7450
      Epoch 5 composite train-obj: 1.136060
            No improvement (1.0878), counter 3/5
    Epoch [6/50], Train Losses: mse: 6.6512, mae: 1.4935, huber: 1.1282, swd: 1.5699, target_std: 6.4969
    Epoch [6/50], Val Losses: mse: 7.6110, mae: 1.4363, huber: 1.0830, swd: 1.0021, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.2302, mae: 1.7240, huber: 1.3603, swd: 1.9393, target_std: 4.7450
      Epoch 6 composite train-obj: 1.128209
            No improvement (1.0830), counter 4/5
    Epoch [7/50], Train Losses: mse: 6.6019, mae: 1.4884, huber: 1.1232, swd: 1.5650, target_std: 6.4977
    Epoch [7/50], Val Losses: mse: 7.5560, mae: 1.4246, huber: 1.0719, swd: 0.9569, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.2623, mae: 1.7385, huber: 1.3731, swd: 2.0323, target_std: 4.7450
      Epoch 7 composite train-obj: 1.123207
            Val objective improved 1.0759 → 1.0719, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.5282, mae: 1.4792, huber: 1.1143, swd: 1.5359, target_std: 6.4968
    Epoch [8/50], Val Losses: mse: 7.4151, mae: 1.4145, huber: 1.0618, swd: 0.9450, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 10.0061, mae: 1.7249, huber: 1.3597, swd: 2.0101, target_std: 4.7450
      Epoch 8 composite train-obj: 1.114311
            Val objective improved 1.0719 → 1.0618, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.4637, mae: 1.4727, huber: 1.1079, swd: 1.5150, target_std: 6.4965
    Epoch [9/50], Val Losses: mse: 7.5593, mae: 1.4259, huber: 1.0725, swd: 0.9072, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.0604, mae: 1.7162, huber: 1.3518, swd: 1.8348, target_std: 4.7450
      Epoch 9 composite train-obj: 1.107923
            No improvement (1.0725), counter 1/5
    Epoch [10/50], Train Losses: mse: 6.3804, mae: 1.4638, huber: 1.0991, swd: 1.4806, target_std: 6.4974
    Epoch [10/50], Val Losses: mse: 7.5653, mae: 1.4377, huber: 1.0832, swd: 1.1453, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 10.1571, mae: 1.7471, huber: 1.3815, swd: 2.3570, target_std: 4.7450
      Epoch 10 composite train-obj: 1.099063
            No improvement (1.0832), counter 2/5
    Epoch [11/50], Train Losses: mse: 6.3320, mae: 1.4580, huber: 1.0935, swd: 1.4658, target_std: 6.4975
    Epoch [11/50], Val Losses: mse: 7.4500, mae: 1.4197, huber: 1.0662, swd: 0.9573, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.1379, mae: 1.7326, huber: 1.3669, swd: 2.0389, target_std: 4.7450
      Epoch 11 composite train-obj: 1.093488
            No improvement (1.0662), counter 3/5
    Epoch [12/50], Train Losses: mse: 6.2549, mae: 1.4508, huber: 1.0863, swd: 1.4411, target_std: 6.4974
    Epoch [12/50], Val Losses: mse: 7.8902, mae: 1.4572, huber: 1.1031, swd: 0.9395, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.1656, mae: 1.7205, huber: 1.3553, swd: 1.7784, target_std: 4.7450
      Epoch 12 composite train-obj: 1.086293
            No improvement (1.1031), counter 4/5
    Epoch [13/50], Train Losses: mse: 6.1941, mae: 1.4435, huber: 1.0793, swd: 1.4172, target_std: 6.4967
    Epoch [13/50], Val Losses: mse: 7.5319, mae: 1.4241, huber: 1.0711, swd: 0.9704, target_std: 4.3128
    Epoch [13/50], Test Losses: mse: 10.0187, mae: 1.7228, huber: 1.3574, swd: 2.0017, target_std: 4.7450
      Epoch 13 composite train-obj: 1.079319
    Epoch [13/50], Test Losses: mse: 10.0061, mae: 1.7249, huber: 1.3597, swd: 2.0101, target_std: 4.7450
    Best round's Test MSE: 10.0061, MAE: 1.7249, SWD: 2.0101
    Best round's Validation MSE: 7.4151, MAE: 1.4145
    Best round's Test verification MSE : 10.0061, MAE: 1.7249, SWD: 2.0101
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 7.8212, mae: 1.6379, huber: 1.2647, swd: 1.7163, target_std: 6.4973
    Epoch [1/50], Val Losses: mse: 8.1936, mae: 1.4624, huber: 1.1087, swd: 0.9923, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 11.0895, mae: 1.7894, huber: 1.4234, swd: 2.1192, target_std: 4.7450
      Epoch 1 composite train-obj: 1.264725
            Val objective improved inf → 1.1087, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.0833, mae: 1.5452, huber: 1.1776, swd: 1.6391, target_std: 6.4970
    Epoch [2/50], Val Losses: mse: 8.0920, mae: 1.4489, huber: 1.0969, swd: 0.9738, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 10.8470, mae: 1.7678, huber: 1.4027, swd: 2.0623, target_std: 4.7450
      Epoch 2 composite train-obj: 1.177587
            Val objective improved 1.1087 → 1.0969, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.9434, mae: 1.5269, huber: 1.1602, swd: 1.6033, target_std: 6.4969
    Epoch [3/50], Val Losses: mse: 7.6777, mae: 1.4196, huber: 1.0679, swd: 1.0252, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 10.6773, mae: 1.7764, huber: 1.4093, swd: 2.3318, target_std: 4.7450
      Epoch 3 composite train-obj: 1.160212
            Val objective improved 1.0969 → 1.0679, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.8532, mae: 1.5165, huber: 1.1502, swd: 1.5748, target_std: 6.4964
    Epoch [4/50], Val Losses: mse: 7.5760, mae: 1.4176, huber: 1.0655, swd: 0.9918, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 10.4591, mae: 1.7466, huber: 1.3812, swd: 2.1029, target_std: 4.7450
      Epoch 4 composite train-obj: 1.150206
            Val objective improved 1.0679 → 1.0655, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.7518, mae: 1.5051, huber: 1.1394, swd: 1.5570, target_std: 6.4984
    Epoch [5/50], Val Losses: mse: 7.5634, mae: 1.4135, huber: 1.0619, swd: 0.9626, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 10.2840, mae: 1.7496, huber: 1.3831, swd: 2.1848, target_std: 4.7450
      Epoch 5 composite train-obj: 1.139399
            Val objective improved 1.0655 → 1.0619, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.6764, mae: 1.4977, huber: 1.1321, swd: 1.5441, target_std: 6.4974
    Epoch [6/50], Val Losses: mse: 7.8047, mae: 1.4451, huber: 1.0920, swd: 0.8992, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.2502, mae: 1.7161, huber: 1.3528, swd: 1.6863, target_std: 4.7450
      Epoch 6 composite train-obj: 1.132077
            No improvement (1.0920), counter 1/5
    Epoch [7/50], Train Losses: mse: 6.5934, mae: 1.4871, huber: 1.1219, swd: 1.5077, target_std: 6.4967
    Epoch [7/50], Val Losses: mse: 7.6009, mae: 1.4231, huber: 1.0711, swd: 0.9123, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.0609, mae: 1.7187, huber: 1.3546, swd: 1.9219, target_std: 4.7450
      Epoch 7 composite train-obj: 1.121874
            No improvement (1.0711), counter 2/5
    Epoch [8/50], Train Losses: mse: 6.5432, mae: 1.4825, huber: 1.1174, swd: 1.4993, target_std: 6.4971
    Epoch [8/50], Val Losses: mse: 7.4974, mae: 1.4220, huber: 1.0688, swd: 0.9508, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 10.0822, mae: 1.7351, huber: 1.3684, swd: 2.0326, target_std: 4.7450
      Epoch 8 composite train-obj: 1.117399
            No improvement (1.0688), counter 3/5
    Epoch [9/50], Train Losses: mse: 6.4623, mae: 1.4734, huber: 1.1085, swd: 1.4692, target_std: 6.4978
    Epoch [9/50], Val Losses: mse: 7.6368, mae: 1.4296, huber: 1.0758, swd: 0.8475, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.0315, mae: 1.7142, huber: 1.3497, swd: 1.7148, target_std: 4.7450
      Epoch 9 composite train-obj: 1.108498
            No improvement (1.0758), counter 4/5
    Epoch [10/50], Train Losses: mse: 6.3895, mae: 1.4654, huber: 1.1008, swd: 1.4415, target_std: 6.4972
    Epoch [10/50], Val Losses: mse: 7.4271, mae: 1.4217, huber: 1.0688, swd: 0.9588, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 9.9870, mae: 1.7262, huber: 1.3604, swd: 1.9653, target_std: 4.7450
      Epoch 10 composite train-obj: 1.100826
    Epoch [10/50], Test Losses: mse: 10.2840, mae: 1.7496, huber: 1.3831, swd: 2.1848, target_std: 4.7450
    Best round's Test MSE: 10.2840, MAE: 1.7496, SWD: 2.1848
    Best round's Validation MSE: 7.5634, MAE: 1.4135
    Best round's Test verification MSE : 10.2840, MAE: 1.7496, SWD: 2.1848
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq96_pred96_20250501_0300)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.1723 ± 0.1198
      mae: 1.7338 ± 0.0112
      huber: 1.3686 ± 0.0104
      swd: 2.0758 ± 0.0776
      target_std: 4.7450 ± 0.0000
      count: 13.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 7.4740 ± 0.0643
      mae: 1.4129 ± 0.0017
      huber: 1.0608 ± 0.0014
      swd: 0.9379 ± 0.0236
      target_std: 4.3128 ± 0.0000
      count: 13.0000 ± 0.0000
    ==================================================
    
    Experiment complete: PatchTST_etth1_seq96_pred96_20250501_0300
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=96,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.7198, mae: 1.7603, huber: 1.3791, swd: 2.0117, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 9.6874, mae: 1.6140, huber: 1.2536, swd: 1.2119, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 12.0032, mae: 1.9185, huber: 1.5430, swd: 2.3472, target_std: 4.7672
      Epoch 1 composite train-obj: 1.379126
            Val objective improved inf → 1.2536, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.9810, mae: 1.6742, huber: 1.2977, swd: 1.9379, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 9.4121, mae: 1.5990, huber: 1.2385, swd: 1.1063, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 11.5944, mae: 1.8864, huber: 1.5116, swd: 1.9867, target_std: 4.7672
      Epoch 2 composite train-obj: 1.297679
            Val objective improved 1.2536 → 1.2385, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.7511, mae: 1.6534, huber: 1.2770, swd: 1.9064, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 9.3222, mae: 1.6081, huber: 1.2478, swd: 1.2347, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 11.1937, mae: 1.8665, huber: 1.4910, swd: 2.0590, target_std: 4.7672
      Epoch 3 composite train-obj: 1.276955
            No improvement (1.2478), counter 1/5
    Epoch [4/50], Train Losses: mse: 7.5856, mae: 1.6375, huber: 1.2612, swd: 1.8507, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 8.9813, mae: 1.5869, huber: 1.2258, swd: 1.2703, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.1522, mae: 1.8754, huber: 1.4986, swd: 2.2857, target_std: 4.7672
      Epoch 4 composite train-obj: 1.261174
            Val objective improved 1.2385 → 1.2258, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.4802, mae: 1.6273, huber: 1.2509, swd: 1.8182, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 9.1640, mae: 1.5996, huber: 1.2378, swd: 1.2352, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.0181, mae: 1.8658, huber: 1.4876, swd: 2.1007, target_std: 4.7672
      Epoch 5 composite train-obj: 1.250928
            No improvement (1.2378), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.3684, mae: 1.6154, huber: 1.2392, swd: 1.7706, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 9.1256, mae: 1.6044, huber: 1.2435, swd: 1.3122, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 10.8988, mae: 1.8634, huber: 1.4844, swd: 2.1697, target_std: 4.7672
      Epoch 6 composite train-obj: 1.239242
            No improvement (1.2435), counter 2/5
    Epoch [7/50], Train Losses: mse: 7.2979, mae: 1.6072, huber: 1.2312, swd: 1.7433, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 9.0776, mae: 1.6033, huber: 1.2413, swd: 1.3004, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 10.9366, mae: 1.8591, huber: 1.4811, swd: 2.0273, target_std: 4.7672
      Epoch 7 composite train-obj: 1.231212
            No improvement (1.2413), counter 3/5
    Epoch [8/50], Train Losses: mse: 7.2060, mae: 1.5980, huber: 1.2222, swd: 1.7044, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 8.8407, mae: 1.5855, huber: 1.2232, swd: 1.4314, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 11.2079, mae: 1.8914, huber: 1.5119, swd: 2.6105, target_std: 4.7672
      Epoch 8 composite train-obj: 1.222162
            Val objective improved 1.2258 → 1.2232, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 7.1171, mae: 1.5885, huber: 1.2128, swd: 1.6651, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 8.8439, mae: 1.5832, huber: 1.2205, swd: 1.1101, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 11.0100, mae: 1.8635, huber: 1.4849, swd: 1.9520, target_std: 4.7672
      Epoch 9 composite train-obj: 1.212797
            Val objective improved 1.2232 → 1.2205, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 7.0357, mae: 1.5796, huber: 1.2042, swd: 1.6315, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 9.6229, mae: 1.6335, huber: 1.2696, swd: 1.1439, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 10.9933, mae: 1.8613, huber: 1.4820, swd: 1.7762, target_std: 4.7672
      Epoch 10 composite train-obj: 1.204207
            No improvement (1.2696), counter 1/5
    Epoch [11/50], Train Losses: mse: 6.9708, mae: 1.5713, huber: 1.1962, swd: 1.6023, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 8.7626, mae: 1.5906, huber: 1.2273, swd: 1.3504, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 10.9599, mae: 1.8817, huber: 1.4999, swd: 2.3971, target_std: 4.7672
      Epoch 11 composite train-obj: 1.196234
            No improvement (1.2273), counter 2/5
    Epoch [12/50], Train Losses: mse: 6.8855, mae: 1.5626, huber: 1.1877, swd: 1.5657, target_std: 6.4940
    Epoch [12/50], Val Losses: mse: 9.1502, mae: 1.6197, huber: 1.2550, swd: 1.2545, target_std: 4.3003
    Epoch [12/50], Test Losses: mse: 10.8338, mae: 1.8621, huber: 1.4813, swd: 2.0962, target_std: 4.7672
      Epoch 12 composite train-obj: 1.187665
            No improvement (1.2550), counter 3/5
    Epoch [13/50], Train Losses: mse: 6.8370, mae: 1.5566, huber: 1.1820, swd: 1.5391, target_std: 6.4940
    Epoch [13/50], Val Losses: mse: 9.7075, mae: 1.6445, huber: 1.2796, swd: 1.2376, target_std: 4.3003
    Epoch [13/50], Test Losses: mse: 10.8660, mae: 1.8698, huber: 1.4888, swd: 2.0426, target_std: 4.7672
      Epoch 13 composite train-obj: 1.181977
            No improvement (1.2796), counter 4/5
    Epoch [14/50], Train Losses: mse: 6.7536, mae: 1.5457, huber: 1.1714, swd: 1.4944, target_std: 6.4940
    Epoch [14/50], Val Losses: mse: 9.3328, mae: 1.6255, huber: 1.2612, swd: 1.3420, target_std: 4.3003
    Epoch [14/50], Test Losses: mse: 10.9440, mae: 1.8793, huber: 1.4980, swd: 2.2770, target_std: 4.7672
      Epoch 14 composite train-obj: 1.171359
    Epoch [14/50], Test Losses: mse: 11.0100, mae: 1.8635, huber: 1.4849, swd: 1.9520, target_std: 4.7672
    Best round's Test MSE: 11.0100, MAE: 1.8635, SWD: 1.9520
    Best round's Validation MSE: 8.8439, MAE: 1.5832
    Best round's Test verification MSE : 11.0100, MAE: 1.8635, SWD: 1.9520
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.6839, mae: 1.7574, huber: 1.3763, swd: 1.9861, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 9.3682, mae: 1.5977, huber: 1.2362, swd: 1.2151, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 12.1682, mae: 1.9357, huber: 1.5588, swd: 2.3291, target_std: 4.7672
      Epoch 1 composite train-obj: 1.376313
            Val objective improved inf → 1.2362, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.9248, mae: 1.6716, huber: 1.2949, swd: 1.9151, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 9.3278, mae: 1.5997, huber: 1.2394, swd: 1.2014, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 11.4092, mae: 1.8803, huber: 1.5058, swd: 2.0981, target_std: 4.7672
      Epoch 2 composite train-obj: 1.294888
            No improvement (1.2394), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.7223, mae: 1.6515, huber: 1.2750, swd: 1.8691, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 9.5608, mae: 1.6253, huber: 1.2634, swd: 1.2677, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 11.1348, mae: 1.8618, huber: 1.4848, swd: 1.9015, target_std: 4.7672
      Epoch 3 composite train-obj: 1.275043
            No improvement (1.2634), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.5742, mae: 1.6380, huber: 1.2614, swd: 1.8270, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 9.0074, mae: 1.5834, huber: 1.2224, swd: 1.2242, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.0865, mae: 1.8626, huber: 1.4867, swd: 2.1335, target_std: 4.7672
      Epoch 4 composite train-obj: 1.261356
            Val objective improved 1.2362 → 1.2224, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.4704, mae: 1.6265, huber: 1.2503, swd: 1.7886, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 9.1060, mae: 1.5963, huber: 1.2353, swd: 1.3933, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 10.9246, mae: 1.8675, huber: 1.4898, swd: 2.3424, target_std: 4.7672
      Epoch 5 composite train-obj: 1.250251
            No improvement (1.2353), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.3620, mae: 1.6164, huber: 1.2403, swd: 1.7559, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 9.1786, mae: 1.5973, huber: 1.2355, swd: 1.1286, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 10.8424, mae: 1.8525, huber: 1.4752, swd: 1.9226, target_std: 4.7672
      Epoch 6 composite train-obj: 1.240342
            No improvement (1.2355), counter 2/5
    Epoch [7/50], Train Losses: mse: 7.2927, mae: 1.6087, huber: 1.2329, swd: 1.7336, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 9.0857, mae: 1.5911, huber: 1.2290, swd: 1.2837, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 10.8411, mae: 1.8633, huber: 1.4852, swd: 2.2941, target_std: 4.7672
      Epoch 7 composite train-obj: 1.232861
            No improvement (1.2290), counter 3/5
    Epoch [8/50], Train Losses: mse: 7.1739, mae: 1.5964, huber: 1.2207, swd: 1.6868, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 9.2965, mae: 1.6094, huber: 1.2473, swd: 1.2046, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 10.6512, mae: 1.8427, huber: 1.4644, swd: 1.9850, target_std: 4.7672
      Epoch 8 composite train-obj: 1.220718
            No improvement (1.2473), counter 4/5
    Epoch [9/50], Train Losses: mse: 7.0914, mae: 1.5878, huber: 1.2124, swd: 1.6496, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 9.4107, mae: 1.6226, huber: 1.2602, swd: 1.3663, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 10.6829, mae: 1.8568, huber: 1.4778, swd: 2.1637, target_std: 4.7672
      Epoch 9 composite train-obj: 1.212449
    Epoch [9/50], Test Losses: mse: 11.0865, mae: 1.8626, huber: 1.4867, swd: 2.1335, target_std: 4.7672
    Best round's Test MSE: 11.0865, MAE: 1.8626, SWD: 2.1335
    Best round's Validation MSE: 9.0074, MAE: 1.5834
    Best round's Test verification MSE : 11.0865, MAE: 1.8626, SWD: 2.1335
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 8.7669, mae: 1.7643, huber: 1.3830, swd: 1.7888, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 9.5424, mae: 1.6057, huber: 1.2451, swd: 1.2064, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 12.0379, mae: 1.9285, huber: 1.5526, swd: 2.3729, target_std: 4.7672
      Epoch 1 composite train-obj: 1.383049
            Val objective improved inf → 1.2451, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.9411, mae: 1.6718, huber: 1.2953, swd: 1.7151, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 9.4311, mae: 1.6105, huber: 1.2501, swd: 1.2112, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 11.4755, mae: 1.8837, huber: 1.5093, swd: 2.0645, target_std: 4.7672
      Epoch 2 composite train-obj: 1.295279
            No improvement (1.2501), counter 1/5
    Epoch [3/50], Train Losses: mse: 7.7123, mae: 1.6510, huber: 1.2744, swd: 1.6730, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 9.3706, mae: 1.6186, huber: 1.2575, swd: 1.2117, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 11.2527, mae: 1.8783, huber: 1.5031, swd: 1.9983, target_std: 4.7672
      Epoch 3 composite train-obj: 1.274377
            No improvement (1.2575), counter 2/5
    Epoch [4/50], Train Losses: mse: 7.5816, mae: 1.6374, huber: 1.2610, swd: 1.6400, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 9.0378, mae: 1.5959, huber: 1.2340, swd: 1.1686, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.0492, mae: 1.8624, huber: 1.4856, swd: 1.9677, target_std: 4.7672
      Epoch 4 composite train-obj: 1.260967
            Val objective improved 1.2451 → 1.2340, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.4309, mae: 1.6239, huber: 1.2475, swd: 1.6005, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 8.9861, mae: 1.5866, huber: 1.2251, swd: 1.1751, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.0598, mae: 1.8720, huber: 1.4942, swd: 2.1642, target_std: 4.7672
      Epoch 5 composite train-obj: 1.247532
            Val objective improved 1.2340 → 1.2251, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.3555, mae: 1.6146, huber: 1.2385, swd: 1.5764, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 9.1812, mae: 1.6027, huber: 1.2406, swd: 1.1784, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 10.8889, mae: 1.8533, huber: 1.4755, swd: 1.9961, target_std: 4.7672
      Epoch 6 composite train-obj: 1.238497
            No improvement (1.2406), counter 1/5
    Epoch [7/50], Train Losses: mse: 7.2439, mae: 1.6026, huber: 1.2268, swd: 1.5319, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 8.6222, mae: 1.5603, huber: 1.1988, swd: 1.2598, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 11.1857, mae: 1.8835, huber: 1.5046, swd: 2.4980, target_std: 4.7672
      Epoch 7 composite train-obj: 1.226787
            Val objective improved 1.2251 → 1.1988, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 7.1584, mae: 1.5935, huber: 1.2178, swd: 1.5034, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 9.3076, mae: 1.6147, huber: 1.2517, swd: 1.1551, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 10.7257, mae: 1.8494, huber: 1.4704, swd: 1.8991, target_std: 4.7672
      Epoch 8 composite train-obj: 1.217770
            No improvement (1.2517), counter 1/5
    Epoch [9/50], Train Losses: mse: 7.0638, mae: 1.5828, huber: 1.2074, swd: 1.4646, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 8.8862, mae: 1.5885, huber: 1.2259, swd: 1.2434, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 10.8876, mae: 1.8826, huber: 1.5020, swd: 2.3540, target_std: 4.7672
      Epoch 9 composite train-obj: 1.207389
            No improvement (1.2259), counter 2/5
    Epoch [10/50], Train Losses: mse: 6.9684, mae: 1.5728, huber: 1.1974, swd: 1.4330, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 8.9613, mae: 1.5930, huber: 1.2298, swd: 1.2098, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 10.7715, mae: 1.8695, huber: 1.4889, swd: 2.3579, target_std: 4.7672
      Epoch 10 composite train-obj: 1.197426
            No improvement (1.2298), counter 3/5
    Epoch [11/50], Train Losses: mse: 6.8820, mae: 1.5637, huber: 1.1886, swd: 1.4009, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 9.1435, mae: 1.6091, huber: 1.2447, swd: 1.1737, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 10.6705, mae: 1.8505, huber: 1.4705, swd: 2.0950, target_std: 4.7672
      Epoch 11 composite train-obj: 1.188584
            No improvement (1.2447), counter 4/5
    Epoch [12/50], Train Losses: mse: 6.8198, mae: 1.5544, huber: 1.1797, swd: 1.3688, target_std: 6.4940
    Epoch [12/50], Val Losses: mse: 9.2296, mae: 1.6146, huber: 1.2502, swd: 1.1426, target_std: 4.3003
    Epoch [12/50], Test Losses: mse: 10.6381, mae: 1.8455, huber: 1.4661, swd: 1.9700, target_std: 4.7672
      Epoch 12 composite train-obj: 1.179690
    Epoch [12/50], Test Losses: mse: 11.1857, mae: 1.8835, huber: 1.5046, swd: 2.4980, target_std: 4.7672
    Best round's Test MSE: 11.1857, MAE: 1.8835, SWD: 2.4980
    Best round's Validation MSE: 8.6222, MAE: 1.5603
    Best round's Test verification MSE : 11.1857, MAE: 1.8835, SWD: 2.4980
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq96_pred196_20250501_0309)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 11.0941 ± 0.0720
      mae: 1.8699 ± 0.0097
      huber: 1.4921 ± 0.0089
      swd: 2.1945 ± 0.2270
      target_std: 4.7672 ± 0.0000
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 8.8245 ± 0.1579
      mae: 1.5756 ± 0.0108
      huber: 1.2139 ± 0.0107
      swd: 1.1981 ± 0.0639
      target_std: 4.3003 ± 0.0000
      count: 12.0000 ± 0.0000
    ==================================================
    
    Experiment complete: PatchTST_etth1_seq96_pred196_20250501_0309
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=96,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.3440, mae: 1.8585, huber: 1.4708, swd: 2.1005, target_std: 6.4829
    Epoch [1/50], Val Losses: mse: 10.6477, mae: 1.6865, huber: 1.3248, swd: 1.3881, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 12.1361, mae: 1.9945, huber: 1.6132, swd: 2.4529, target_std: 4.7760
      Epoch 1 composite train-obj: 1.470755
            Val objective improved inf → 1.3248, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.5461, mae: 1.7740, huber: 1.3899, swd: 2.0166, target_std: 6.4825
    Epoch [2/50], Val Losses: mse: 10.3389, mae: 1.6737, huber: 1.3104, swd: 1.0784, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 11.6027, mae: 1.9580, huber: 1.5755, swd: 1.9891, target_std: 4.7760
      Epoch 2 composite train-obj: 1.389870
            Val objective improved 1.3248 → 1.3104, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.2592, mae: 1.7497, huber: 1.3652, swd: 1.9458, target_std: 6.4823
    Epoch [3/50], Val Losses: mse: 11.4314, mae: 1.7372, huber: 1.3705, swd: 1.0654, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 11.2666, mae: 1.9392, huber: 1.5532, swd: 1.6927, target_std: 4.7760
      Epoch 3 composite train-obj: 1.365218
            No improvement (1.3705), counter 1/5
    Epoch [4/50], Train Losses: mse: 8.0467, mae: 1.7299, huber: 1.3456, swd: 1.8748, target_std: 6.4820
    Epoch [4/50], Val Losses: mse: 10.2565, mae: 1.6800, huber: 1.3160, swd: 1.4492, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 11.4395, mae: 1.9900, huber: 1.6013, swd: 2.6883, target_std: 4.7760
      Epoch 4 composite train-obj: 1.345593
            No improvement (1.3160), counter 2/5
    Epoch [5/50], Train Losses: mse: 7.9322, mae: 1.7182, huber: 1.3341, swd: 1.8428, target_std: 6.4820
    Epoch [5/50], Val Losses: mse: 11.1521, mae: 1.7173, huber: 1.3509, swd: 1.1822, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.2163, mae: 1.9502, huber: 1.5640, swd: 2.0289, target_std: 4.7760
      Epoch 5 composite train-obj: 1.334113
            No improvement (1.3509), counter 3/5
    Epoch [6/50], Train Losses: mse: 7.8063, mae: 1.7052, huber: 1.3215, swd: 1.7891, target_std: 6.4822
    Epoch [6/50], Val Losses: mse: 10.2533, mae: 1.6739, huber: 1.3086, swd: 1.3360, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.3867, mae: 1.9769, huber: 1.5880, swd: 2.5567, target_std: 4.7760
      Epoch 6 composite train-obj: 1.321503
            Val objective improved 1.3104 → 1.3086, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.6992, mae: 1.6934, huber: 1.3099, swd: 1.7489, target_std: 6.4825
    Epoch [7/50], Val Losses: mse: 10.8000, mae: 1.7019, huber: 1.3350, swd: 1.0749, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.0439, mae: 1.9408, huber: 1.5538, swd: 1.8756, target_std: 4.7760
      Epoch 7 composite train-obj: 1.309914
            No improvement (1.3350), counter 1/5
    Epoch [8/50], Train Losses: mse: 7.6391, mae: 1.6855, huber: 1.3024, swd: 1.7167, target_std: 6.4819
    Epoch [8/50], Val Losses: mse: 11.4124, mae: 1.7344, huber: 1.3670, swd: 1.1278, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.1299, mae: 1.9521, huber: 1.5628, swd: 1.8492, target_std: 4.7760
      Epoch 8 composite train-obj: 1.302376
            No improvement (1.3670), counter 2/5
    Epoch [9/50], Train Losses: mse: 7.5241, mae: 1.6738, huber: 1.2910, swd: 1.6689, target_std: 6.4825
    Epoch [9/50], Val Losses: mse: 11.0674, mae: 1.7087, huber: 1.3421, swd: 1.1216, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.1865, mae: 1.9511, huber: 1.5632, swd: 2.0512, target_std: 4.7760
      Epoch 9 composite train-obj: 1.290973
            No improvement (1.3421), counter 3/5
    Epoch [10/50], Train Losses: mse: 7.4372, mae: 1.6632, huber: 1.2806, swd: 1.6255, target_std: 6.4825
    Epoch [10/50], Val Losses: mse: 11.2014, mae: 1.7251, huber: 1.3566, swd: 1.1383, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.1256, mae: 1.9580, huber: 1.5681, swd: 1.9908, target_std: 4.7760
      Epoch 10 composite train-obj: 1.280638
            No improvement (1.3566), counter 4/5
    Epoch [11/50], Train Losses: mse: 7.3829, mae: 1.6573, huber: 1.2749, swd: 1.6062, target_std: 6.4822
    Epoch [11/50], Val Losses: mse: 10.0617, mae: 1.6742, huber: 1.3069, swd: 1.2845, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.3382, mae: 1.9694, huber: 1.5808, swd: 2.3965, target_std: 4.7760
      Epoch 11 composite train-obj: 1.274867
            Val objective improved 1.3086 → 1.3069, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 7.3063, mae: 1.6479, huber: 1.2658, swd: 1.5664, target_std: 6.4819
    Epoch [12/50], Val Losses: mse: 11.1471, mae: 1.7196, huber: 1.3511, swd: 1.0419, target_std: 4.2818
    Epoch [12/50], Test Losses: mse: 11.1410, mae: 1.9347, huber: 1.5475, swd: 1.7250, target_std: 4.7760
      Epoch 12 composite train-obj: 1.265817
            No improvement (1.3511), counter 1/5
    Epoch [13/50], Train Losses: mse: 7.2395, mae: 1.6391, huber: 1.2572, swd: 1.5284, target_std: 6.4825
    Epoch [13/50], Val Losses: mse: 10.3084, mae: 1.6776, huber: 1.3109, swd: 1.0473, target_std: 4.2818
    Epoch [13/50], Test Losses: mse: 11.3520, mae: 1.9530, huber: 1.5660, swd: 2.0029, target_std: 4.7760
      Epoch 13 composite train-obj: 1.257234
            No improvement (1.3109), counter 2/5
    Epoch [14/50], Train Losses: mse: 7.1883, mae: 1.6334, huber: 1.2517, swd: 1.5049, target_std: 6.4819
    Epoch [14/50], Val Losses: mse: 10.0263, mae: 1.6558, huber: 1.2895, swd: 1.0985, target_std: 4.2818
    Epoch [14/50], Test Losses: mse: 11.2508, mae: 1.9620, huber: 1.5738, swd: 2.2387, target_std: 4.7760
      Epoch 14 composite train-obj: 1.251725
            Val objective improved 1.3069 → 1.2895, saving checkpoint.
    Epoch [15/50], Train Losses: mse: 7.1141, mae: 1.6238, huber: 1.2423, swd: 1.4650, target_std: 6.4822
    Epoch [15/50], Val Losses: mse: 9.6647, mae: 1.6484, huber: 1.2812, swd: 1.1940, target_std: 4.2818
    Epoch [15/50], Test Losses: mse: 11.5658, mae: 1.9923, huber: 1.6030, swd: 2.5239, target_std: 4.7760
      Epoch 15 composite train-obj: 1.242314
            Val objective improved 1.2895 → 1.2812, saving checkpoint.
    Epoch [16/50], Train Losses: mse: 7.0432, mae: 1.6155, huber: 1.2343, swd: 1.4295, target_std: 6.4825
    Epoch [16/50], Val Losses: mse: 12.0987, mae: 1.7643, huber: 1.3962, swd: 1.1698, target_std: 4.2818
    Epoch [16/50], Test Losses: mse: 11.3643, mae: 1.9666, huber: 1.5788, swd: 2.2084, target_std: 4.7760
      Epoch 16 composite train-obj: 1.234276
            No improvement (1.3962), counter 1/5
    Epoch [17/50], Train Losses: mse: 6.9887, mae: 1.6082, huber: 1.2271, swd: 1.4005, target_std: 6.4824
    Epoch [17/50], Val Losses: mse: 12.0621, mae: 1.7607, huber: 1.3918, swd: 1.1654, target_std: 4.2818
    Epoch [17/50], Test Losses: mse: 11.3236, mae: 1.9659, huber: 1.5783, swd: 2.2243, target_std: 4.7760
      Epoch 17 composite train-obj: 1.227100
            No improvement (1.3918), counter 2/5
    Epoch [18/50], Train Losses: mse: 6.9364, mae: 1.6015, huber: 1.2207, swd: 1.3736, target_std: 6.4825
    Epoch [18/50], Val Losses: mse: 10.9246, mae: 1.7209, huber: 1.3518, swd: 1.1580, target_std: 4.2818
    Epoch [18/50], Test Losses: mse: 11.3932, mae: 1.9708, huber: 1.5832, swd: 2.2542, target_std: 4.7760
      Epoch 18 composite train-obj: 1.220709
            No improvement (1.3518), counter 3/5
    Epoch [19/50], Train Losses: mse: 6.9066, mae: 1.5973, huber: 1.2166, swd: 1.3580, target_std: 6.4822
    Epoch [19/50], Val Losses: mse: 10.5402, mae: 1.7091, huber: 1.3387, swd: 1.1744, target_std: 4.2818
    Epoch [19/50], Test Losses: mse: 11.4508, mae: 1.9785, huber: 1.5907, swd: 2.3327, target_std: 4.7760
      Epoch 19 composite train-obj: 1.216610
            No improvement (1.3387), counter 4/5
    Epoch [20/50], Train Losses: mse: 6.8345, mae: 1.5885, huber: 1.2081, swd: 1.3184, target_std: 6.4824
    Epoch [20/50], Val Losses: mse: 10.7040, mae: 1.7069, huber: 1.3375, swd: 1.1183, target_std: 4.2818
    Epoch [20/50], Test Losses: mse: 11.4097, mae: 1.9694, huber: 1.5820, swd: 2.2688, target_std: 4.7760
      Epoch 20 composite train-obj: 1.208091
    Epoch [20/50], Test Losses: mse: 11.5658, mae: 1.9923, huber: 1.6030, swd: 2.5239, target_std: 4.7760
    Best round's Test MSE: 11.5658, MAE: 1.9923, SWD: 2.5239
    Best round's Validation MSE: 9.6647, MAE: 1.6484
    Best round's Test verification MSE : 11.5658, MAE: 1.9923, SWD: 2.5239
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.3506, mae: 1.8601, huber: 1.4723, swd: 2.1454, target_std: 6.4825
    Epoch [1/50], Val Losses: mse: 10.7993, mae: 1.6908, huber: 1.3278, swd: 1.0689, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 11.9625, mae: 1.9689, huber: 1.5886, swd: 1.7616, target_std: 4.7760
      Epoch 1 composite train-obj: 1.472277
            Val objective improved inf → 1.3278, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.4825, mae: 1.7715, huber: 1.3871, swd: 2.0402, target_std: 6.4827
    Epoch [2/50], Val Losses: mse: 10.2758, mae: 1.6747, huber: 1.3112, swd: 1.4138, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 11.5467, mae: 1.9644, huber: 1.5807, swd: 2.3051, target_std: 4.7760
      Epoch 2 composite train-obj: 1.387092
            Val objective improved 1.3278 → 1.3112, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 8.2192, mae: 1.7499, huber: 1.3653, swd: 1.9749, target_std: 6.4825
    Epoch [3/50], Val Losses: mse: 11.2641, mae: 1.7252, huber: 1.3602, swd: 1.1700, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 11.1813, mae: 1.9380, huber: 1.5532, swd: 1.8092, target_std: 4.7760
      Epoch 3 composite train-obj: 1.365294
            No improvement (1.3602), counter 1/5
    Epoch [4/50], Train Losses: mse: 8.0555, mae: 1.7338, huber: 1.3494, swd: 1.9232, target_std: 6.4828
    Epoch [4/50], Val Losses: mse: 9.9699, mae: 1.6619, huber: 1.2967, swd: 1.2865, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 11.4469, mae: 1.9703, huber: 1.5845, swd: 2.3828, target_std: 4.7760
      Epoch 4 composite train-obj: 1.349385
            Val objective improved 1.3112 → 1.2967, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.9289, mae: 1.7203, huber: 1.3362, swd: 1.8829, target_std: 6.4822
    Epoch [5/50], Val Losses: mse: 10.2337, mae: 1.6695, huber: 1.3049, swd: 1.3014, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.1391, mae: 1.9553, huber: 1.5686, swd: 2.3142, target_std: 4.7760
      Epoch 5 composite train-obj: 1.336174
            No improvement (1.3049), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.8142, mae: 1.7082, huber: 1.3245, swd: 1.8322, target_std: 6.4818
    Epoch [6/50], Val Losses: mse: 10.1188, mae: 1.6618, huber: 1.2973, swd: 1.2970, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.2316, mae: 1.9664, huber: 1.5787, swd: 2.3977, target_std: 4.7760
      Epoch 6 composite train-obj: 1.324488
            No improvement (1.2973), counter 2/5
    Epoch [7/50], Train Losses: mse: 7.7139, mae: 1.6968, huber: 1.3134, swd: 1.7895, target_std: 6.4824
    Epoch [7/50], Val Losses: mse: 10.0675, mae: 1.6636, huber: 1.2981, swd: 1.3489, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.2371, mae: 1.9568, huber: 1.5705, swd: 2.3218, target_std: 4.7760
      Epoch 7 composite train-obj: 1.313437
            No improvement (1.2981), counter 3/5
    Epoch [8/50], Train Losses: mse: 7.6385, mae: 1.6871, huber: 1.3039, swd: 1.7544, target_std: 6.4823
    Epoch [8/50], Val Losses: mse: 10.7676, mae: 1.6952, huber: 1.3289, swd: 1.0614, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.2609, mae: 1.9392, huber: 1.5528, swd: 1.9031, target_std: 4.7760
      Epoch 8 composite train-obj: 1.303851
            No improvement (1.3289), counter 4/5
    Epoch [9/50], Train Losses: mse: 7.5384, mae: 1.6763, huber: 1.2933, swd: 1.7117, target_std: 6.4823
    Epoch [9/50], Val Losses: mse: 9.7970, mae: 1.6472, huber: 1.2813, swd: 1.2163, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.3923, mae: 1.9662, huber: 1.5791, swd: 2.3838, target_std: 4.7760
      Epoch 9 composite train-obj: 1.293335
            Val objective improved 1.2967 → 1.2813, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 7.4712, mae: 1.6683, huber: 1.2856, swd: 1.6819, target_std: 6.4824
    Epoch [10/50], Val Losses: mse: 10.4687, mae: 1.6906, huber: 1.3230, swd: 1.0792, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.0869, mae: 1.9383, huber: 1.5514, swd: 1.9354, target_std: 4.7760
      Epoch 10 composite train-obj: 1.285585
            No improvement (1.3230), counter 1/5
    Epoch [11/50], Train Losses: mse: 7.4000, mae: 1.6588, huber: 1.2764, swd: 1.6449, target_std: 6.4819
    Epoch [11/50], Val Losses: mse: 10.6280, mae: 1.7064, huber: 1.3394, swd: 1.2667, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.1952, mae: 1.9578, huber: 1.5705, swd: 2.3267, target_std: 4.7760
      Epoch 11 composite train-obj: 1.276399
            No improvement (1.3394), counter 2/5
    Epoch [12/50], Train Losses: mse: 7.3393, mae: 1.6517, huber: 1.2695, swd: 1.6088, target_std: 6.4820
    Epoch [12/50], Val Losses: mse: 9.8655, mae: 1.6680, huber: 1.3000, swd: 1.0363, target_std: 4.2818
    Epoch [12/50], Test Losses: mse: 11.3096, mae: 1.9497, huber: 1.5633, swd: 2.0380, target_std: 4.7760
      Epoch 12 composite train-obj: 1.269516
            No improvement (1.3000), counter 3/5
    Epoch [13/50], Train Losses: mse: 7.2542, mae: 1.6416, huber: 1.2598, swd: 1.5709, target_std: 6.4822
    Epoch [13/50], Val Losses: mse: 10.6353, mae: 1.7122, huber: 1.3429, swd: 1.1366, target_std: 4.2818
    Epoch [13/50], Test Losses: mse: 11.2516, mae: 1.9576, huber: 1.5694, swd: 2.2456, target_std: 4.7760
      Epoch 13 composite train-obj: 1.259819
            No improvement (1.3429), counter 4/5
    Epoch [14/50], Train Losses: mse: 7.2094, mae: 1.6354, huber: 1.2538, swd: 1.5332, target_std: 6.4820
    Epoch [14/50], Val Losses: mse: 11.4533, mae: 1.7449, huber: 1.3764, swd: 1.1614, target_std: 4.2818
    Epoch [14/50], Test Losses: mse: 11.1848, mae: 1.9462, huber: 1.5592, swd: 2.0068, target_std: 4.7760
      Epoch 14 composite train-obj: 1.253840
    Epoch [14/50], Test Losses: mse: 11.3923, mae: 1.9662, huber: 1.5791, swd: 2.3838, target_std: 4.7760
    Best round's Test MSE: 11.3923, MAE: 1.9662, SWD: 2.3838
    Best round's Validation MSE: 9.7970, MAE: 1.6472
    Best round's Test verification MSE : 11.3923, MAE: 1.9662, SWD: 2.3838
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 9.3693, mae: 1.8602, huber: 1.4727, swd: 2.0649, target_std: 6.4823
    Epoch [1/50], Val Losses: mse: 10.9277, mae: 1.7014, huber: 1.3393, swd: 1.3283, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 12.0867, mae: 1.9902, huber: 1.6090, swd: 2.2922, target_std: 4.7760
      Epoch 1 composite train-obj: 1.472675
            Val objective improved inf → 1.3393, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.5480, mae: 1.7755, huber: 1.3914, swd: 1.9762, target_std: 6.4823
    Epoch [2/50], Val Losses: mse: 10.8266, mae: 1.7125, huber: 1.3486, swd: 1.3848, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 11.5857, mae: 1.9739, huber: 1.5888, swd: 2.1744, target_std: 4.7760
      Epoch 2 composite train-obj: 1.391361
            No improvement (1.3486), counter 1/5
    Epoch [3/50], Train Losses: mse: 8.2183, mae: 1.7476, huber: 1.3631, swd: 1.8763, target_std: 6.4821
    Epoch [3/50], Val Losses: mse: 10.5822, mae: 1.6883, huber: 1.3240, swd: 1.0824, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 11.4327, mae: 1.9511, huber: 1.5665, swd: 1.7949, target_std: 4.7760
      Epoch 3 composite train-obj: 1.363134
            Val objective improved 1.3393 → 1.3240, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 8.0601, mae: 1.7329, huber: 1.3487, swd: 1.8308, target_std: 6.4824
    Epoch [4/50], Val Losses: mse: 10.4056, mae: 1.6847, huber: 1.3203, swd: 1.2357, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 11.3040, mae: 1.9533, huber: 1.5673, swd: 2.0843, target_std: 4.7760
      Epoch 4 composite train-obj: 1.348707
            Val objective improved 1.3240 → 1.3203, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.8962, mae: 1.7159, huber: 1.3320, swd: 1.7776, target_std: 6.4822
    Epoch [5/50], Val Losses: mse: 11.1054, mae: 1.7292, huber: 1.3625, swd: 1.2483, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.1885, mae: 1.9597, huber: 1.5710, swd: 1.9602, target_std: 4.7760
      Epoch 5 composite train-obj: 1.331990
            No improvement (1.3625), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.7728, mae: 1.7037, huber: 1.3201, swd: 1.7320, target_std: 6.4820
    Epoch [6/50], Val Losses: mse: 10.1737, mae: 1.6720, huber: 1.3074, swd: 1.2100, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.1049, mae: 1.9433, huber: 1.5571, swd: 2.1079, target_std: 4.7760
      Epoch 6 composite train-obj: 1.320063
            Val objective improved 1.3203 → 1.3074, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.6767, mae: 1.6925, huber: 1.3092, swd: 1.6899, target_std: 6.4820
    Epoch [7/50], Val Losses: mse: 10.6597, mae: 1.7054, huber: 1.3389, swd: 1.2409, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.2547, mae: 1.9576, huber: 1.5706, swd: 2.2456, target_std: 4.7760
      Epoch 7 composite train-obj: 1.309183
            No improvement (1.3389), counter 1/5
    Epoch [8/50], Train Losses: mse: 7.5977, mae: 1.6828, huber: 1.2998, swd: 1.6558, target_std: 6.4825
    Epoch [8/50], Val Losses: mse: 10.3978, mae: 1.6859, huber: 1.3200, swd: 1.1722, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.2944, mae: 1.9568, huber: 1.5698, swd: 2.2382, target_std: 4.7760
      Epoch 8 composite train-obj: 1.299771
            No improvement (1.3200), counter 2/5
    Epoch [9/50], Train Losses: mse: 7.4794, mae: 1.6692, huber: 1.2866, swd: 1.6088, target_std: 6.4821
    Epoch [9/50], Val Losses: mse: 10.6237, mae: 1.6918, huber: 1.3255, swd: 1.1430, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.2210, mae: 1.9531, huber: 1.5658, swd: 2.0566, target_std: 4.7760
      Epoch 9 composite train-obj: 1.286557
            No improvement (1.3255), counter 3/5
    Epoch [10/50], Train Losses: mse: 7.4119, mae: 1.6606, huber: 1.2781, swd: 1.5635, target_std: 6.4824
    Epoch [10/50], Val Losses: mse: 11.3688, mae: 1.7380, huber: 1.3703, swd: 1.2309, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.1103, mae: 1.9472, huber: 1.5601, swd: 2.0969, target_std: 4.7760
      Epoch 10 composite train-obj: 1.278145
            No improvement (1.3703), counter 4/5
    Epoch [11/50], Train Losses: mse: 7.3415, mae: 1.6523, huber: 1.2700, swd: 1.5343, target_std: 6.4820
    Epoch [11/50], Val Losses: mse: 11.8822, mae: 1.7534, huber: 1.3857, swd: 1.2046, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.1383, mae: 1.9539, huber: 1.5652, swd: 2.0864, target_std: 4.7760
      Epoch 11 composite train-obj: 1.270046
    Epoch [11/50], Test Losses: mse: 11.1049, mae: 1.9433, huber: 1.5571, swd: 2.1079, target_std: 4.7760
    Best round's Test MSE: 11.1049, MAE: 1.9433, SWD: 2.1079
    Best round's Validation MSE: 10.1737, MAE: 1.6720
    Best round's Test verification MSE : 11.1049, MAE: 1.9433, SWD: 2.1079
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq96_pred336_20250501_0310)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 11.3544 ± 0.1901
      mae: 1.9672 ± 0.0200
      huber: 1.5797 ± 0.0188
      swd: 2.3385 ± 0.1728
      target_std: 4.7760 ± 0.0000
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.8785 ± 0.2156
      mae: 1.6559 ± 0.0114
      huber: 1.2900 ± 0.0123
      swd: 1.2068 ± 0.0094
      target_std: 4.2818 ± 0.0000
      count: 11.0000 ± 0.0000
    ==================================================
    
    Experiment complete: PatchTST_etth1_seq96_pred336_20250501_0310
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
utils.reload_modules([utils])
cfg = train_config.FlatPatchTSTConfig(
    seq_len=96,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],
    enc_in=data_mgr.datasets['etth1']['channels'],
    dec_in=data_mgr.datasets['etth1']['channels'],
    c_out=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50,
    task_name='long_term_forecast',
    factor=3,
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.7697, mae: 2.0541, huber: 1.6543, swd: 2.8211, target_std: 6.4170
    Epoch [1/50], Val Losses: mse: 10.5166, mae: 1.7213, huber: 1.3556, swd: 1.3906, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 13.2772, mae: 2.2184, huber: 1.8203, swd: 2.5657, target_std: 4.8130
      Epoch 1 composite train-obj: 1.654257
            Val objective improved inf → 1.3556, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.8525, mae: 1.9697, huber: 1.5716, swd: 2.6593, target_std: 6.4168
    Epoch [2/50], Val Losses: mse: 10.0517, mae: 1.7056, huber: 1.3380, swd: 1.3866, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 12.9500, mae: 2.2030, huber: 1.8008, swd: 2.5414, target_std: 4.8130
      Epoch 2 composite train-obj: 1.571602
            Val objective improved 1.3556 → 1.3380, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.4759, mae: 1.9369, huber: 1.5382, swd: 2.5019, target_std: 6.4170
    Epoch [3/50], Val Losses: mse: 12.5732, mae: 1.8727, huber: 1.5003, swd: 1.7883, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 12.6437, mae: 2.2111, huber: 1.8047, swd: 2.5280, target_std: 4.8130
      Epoch 3 composite train-obj: 1.538237
            No improvement (1.5003), counter 1/5
    Epoch [4/50], Train Losses: mse: 9.2350, mae: 1.9108, huber: 1.5126, swd: 2.3766, target_std: 6.4166
    Epoch [4/50], Val Losses: mse: 10.9855, mae: 1.7583, huber: 1.3887, swd: 1.4767, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 12.5604, mae: 2.1995, huber: 1.7941, swd: 2.5897, target_std: 4.8130
      Epoch 4 composite train-obj: 1.512610
            No improvement (1.3887), counter 2/5
    Epoch [5/50], Train Losses: mse: 9.0705, mae: 1.8909, huber: 1.4933, swd: 2.2902, target_std: 6.4170
    Epoch [5/50], Val Losses: mse: 11.1015, mae: 1.7912, huber: 1.4193, swd: 1.8156, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 12.7467, mae: 2.2356, huber: 1.8289, swd: 2.9045, target_std: 4.8130
      Epoch 5 composite train-obj: 1.493303
            No improvement (1.4193), counter 3/5
    Epoch [6/50], Train Losses: mse: 8.9018, mae: 1.8720, huber: 1.4748, swd: 2.1922, target_std: 6.4164
    Epoch [6/50], Val Losses: mse: 11.8170, mae: 1.8377, huber: 1.4651, swd: 1.8642, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 12.6381, mae: 2.2280, huber: 1.8215, swd: 2.8687, target_std: 4.8130
      Epoch 6 composite train-obj: 1.474821
            No improvement (1.4651), counter 4/5
    Epoch [7/50], Train Losses: mse: 8.7765, mae: 1.8587, huber: 1.4618, swd: 2.1309, target_std: 6.4168
    Epoch [7/50], Val Losses: mse: 10.5359, mae: 1.7394, huber: 1.3698, swd: 1.4920, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 12.3943, mae: 2.1868, huber: 1.7846, swd: 2.6650, target_std: 4.8130
      Epoch 7 composite train-obj: 1.461819
    Epoch [7/50], Test Losses: mse: 12.9500, mae: 2.2030, huber: 1.8008, swd: 2.5414, target_std: 4.8130
    Best round's Test MSE: 12.9500, MAE: 2.2030, SWD: 2.5414
    Best round's Validation MSE: 10.0517, MAE: 1.7056
    Best round's Test verification MSE : 12.9500, MAE: 2.2030, SWD: 2.5414
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.7387, mae: 2.0531, huber: 1.6529, swd: 2.6064, target_std: 6.4167
    Epoch [1/50], Val Losses: mse: 11.0861, mae: 1.7917, huber: 1.4241, swd: 1.7871, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 13.3474, mae: 2.2460, huber: 1.8452, swd: 2.9078, target_std: 4.8130
      Epoch 1 composite train-obj: 1.652946
            Val objective improved inf → 1.4241, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.7337, mae: 1.9628, huber: 1.5640, swd: 2.4463, target_std: 6.4168
    Epoch [2/50], Val Losses: mse: 9.5028, mae: 1.6841, huber: 1.3169, swd: 1.6067, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 13.4144, mae: 2.2320, huber: 1.8298, swd: 3.0609, target_std: 4.8130
      Epoch 2 composite train-obj: 1.563999
            Val objective improved 1.4241 → 1.3169, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.4228, mae: 1.9322, huber: 1.5337, swd: 2.3189, target_std: 6.4170
    Epoch [3/50], Val Losses: mse: 10.6841, mae: 1.7364, huber: 1.3681, swd: 1.1351, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 12.5739, mae: 2.1874, huber: 1.7833, swd: 2.2232, target_std: 4.8130
      Epoch 3 composite train-obj: 1.533724
            No improvement (1.3681), counter 1/5
    Epoch [4/50], Train Losses: mse: 9.2188, mae: 1.9097, huber: 1.5117, swd: 2.2126, target_std: 6.4166
    Epoch [4/50], Val Losses: mse: 10.4448, mae: 1.7254, huber: 1.3582, swd: 1.4307, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 12.6906, mae: 2.2082, huber: 1.8057, swd: 2.7526, target_std: 4.8130
      Epoch 4 composite train-obj: 1.511726
            No improvement (1.3582), counter 2/5
    Epoch [5/50], Train Losses: mse: 9.0514, mae: 1.8895, huber: 1.4922, swd: 2.1510, target_std: 6.4167
    Epoch [5/50], Val Losses: mse: 10.4501, mae: 1.7201, huber: 1.3517, swd: 1.3202, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 12.4410, mae: 2.1771, huber: 1.7751, swd: 2.4275, target_std: 4.8130
      Epoch 5 composite train-obj: 1.492198
            No improvement (1.3517), counter 3/5
    Epoch [6/50], Train Losses: mse: 8.9142, mae: 1.8726, huber: 1.4758, swd: 2.0738, target_std: 6.4166
    Epoch [6/50], Val Losses: mse: 10.3998, mae: 1.7110, huber: 1.3415, swd: 1.1971, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 12.5962, mae: 2.2012, huber: 1.7963, swd: 2.4985, target_std: 4.8130
      Epoch 6 composite train-obj: 1.475832
            No improvement (1.3415), counter 4/5
    Epoch [7/50], Train Losses: mse: 8.8001, mae: 1.8588, huber: 1.4625, swd: 2.0357, target_std: 6.4168
    Epoch [7/50], Val Losses: mse: 11.0505, mae: 1.7531, huber: 1.3835, swd: 1.3018, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 12.7206, mae: 2.2078, huber: 1.8034, swd: 2.4914, target_std: 4.8130
      Epoch 7 composite train-obj: 1.462462
    Epoch [7/50], Test Losses: mse: 13.4144, mae: 2.2320, huber: 1.8298, swd: 3.0609, target_std: 4.8130
    Best round's Test MSE: 13.4144, MAE: 2.2320, SWD: 3.0609
    Best round's Validation MSE: 9.5028, MAE: 1.6841
    Best round's Test verification MSE : 13.4144, MAE: 2.2320, SWD: 3.0609
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 10.7712, mae: 2.0529, huber: 1.6531, swd: 2.9146, target_std: 6.4166
    Epoch [1/50], Val Losses: mse: 10.7393, mae: 1.7455, huber: 1.3789, swd: 1.4926, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 13.4195, mae: 2.2300, huber: 1.8302, swd: 2.6268, target_std: 4.8130
      Epoch 1 composite train-obj: 1.653088
            Val objective improved inf → 1.3789, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.8377, mae: 1.9678, huber: 1.5698, swd: 2.7459, target_std: 6.4169
    Epoch [2/50], Val Losses: mse: 10.0453, mae: 1.7028, huber: 1.3361, swd: 1.5410, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 12.8267, mae: 2.2057, huber: 1.8035, swd: 2.8663, target_std: 4.8130
      Epoch 2 composite train-obj: 1.569779
            Val objective improved 1.3789 → 1.3361, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.4712, mae: 1.9365, huber: 1.5382, swd: 2.5916, target_std: 6.4168
    Epoch [3/50], Val Losses: mse: 9.8598, mae: 1.6989, huber: 1.3285, swd: 1.4110, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 12.7140, mae: 2.1986, huber: 1.7942, swd: 2.6665, target_std: 4.8130
      Epoch 3 composite train-obj: 1.538231
            Val objective improved 1.3361 → 1.3285, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 9.2257, mae: 1.9093, huber: 1.5114, swd: 2.4723, target_std: 6.4165
    Epoch [4/50], Val Losses: mse: 10.6557, mae: 1.7402, huber: 1.3712, swd: 1.4025, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 12.5646, mae: 2.1824, huber: 1.7790, swd: 2.5455, target_std: 4.8130
      Epoch 4 composite train-obj: 1.511401
            No improvement (1.3712), counter 1/5
    Epoch [5/50], Train Losses: mse: 9.0577, mae: 1.8886, huber: 1.4914, swd: 2.3707, target_std: 6.4170
    Epoch [5/50], Val Losses: mse: 9.7390, mae: 1.6710, huber: 1.3031, swd: 1.2645, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 12.5944, mae: 2.1840, huber: 1.7816, swd: 2.6351, target_std: 4.8130
      Epoch 5 composite train-obj: 1.491369
            Val objective improved 1.3285 → 1.3031, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 8.9216, mae: 1.8727, huber: 1.4759, swd: 2.3011, target_std: 6.4169
    Epoch [6/50], Val Losses: mse: 11.1630, mae: 1.7717, huber: 1.4020, swd: 1.5715, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 12.8222, mae: 2.2382, huber: 1.8313, swd: 2.9132, target_std: 4.8130
      Epoch 6 composite train-obj: 1.475854
            No improvement (1.4020), counter 1/5
    Epoch [7/50], Train Losses: mse: 8.7797, mae: 1.8566, huber: 1.4602, swd: 2.2180, target_std: 6.4170
    Epoch [7/50], Val Losses: mse: 10.3171, mae: 1.7130, huber: 1.3436, swd: 1.3348, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 12.4722, mae: 2.1868, huber: 1.7823, swd: 2.6092, target_std: 4.8130
      Epoch 7 composite train-obj: 1.460239
            No improvement (1.3436), counter 2/5
    Epoch [8/50], Train Losses: mse: 8.6564, mae: 1.8427, huber: 1.4466, swd: 2.1411, target_std: 6.4169
    Epoch [8/50], Val Losses: mse: 10.6992, mae: 1.7398, huber: 1.3685, swd: 1.2648, target_std: 4.3000
    Epoch [8/50], Test Losses: mse: 12.5884, mae: 2.1978, huber: 1.7924, swd: 2.3374, target_std: 4.8130
      Epoch 8 composite train-obj: 1.446636
            No improvement (1.3685), counter 3/5
    Epoch [9/50], Train Losses: mse: 8.5481, mae: 1.8300, huber: 1.4343, swd: 2.0768, target_std: 6.4167
    Epoch [9/50], Val Losses: mse: 10.4748, mae: 1.7122, huber: 1.3430, swd: 1.2028, target_std: 4.3000
    Epoch [9/50], Test Losses: mse: 12.3607, mae: 2.1684, huber: 1.7659, swd: 2.3104, target_std: 4.8130
      Epoch 9 composite train-obj: 1.434307
            No improvement (1.3430), counter 4/5
    Epoch [10/50], Train Losses: mse: 8.4459, mae: 1.8189, huber: 1.4234, swd: 2.0162, target_std: 6.4169
    Epoch [10/50], Val Losses: mse: 10.2753, mae: 1.7143, huber: 1.3449, swd: 1.3833, target_std: 4.3000
    Epoch [10/50], Test Losses: mse: 12.4900, mae: 2.2015, huber: 1.7961, swd: 2.7422, target_std: 4.8130
      Epoch 10 composite train-obj: 1.423365
    Epoch [10/50], Test Losses: mse: 12.5944, mae: 2.1840, huber: 1.7816, swd: 2.6351, target_std: 4.8130
    Best round's Test MSE: 12.5944, MAE: 2.1840, SWD: 2.6351
    Best round's Validation MSE: 9.7390, MAE: 1.6710
    Best round's Test verification MSE : 12.5944, MAE: 2.1840, SWD: 2.6351
    
    ==================================================
    Experiment Summary (PatchTST_etth1_seq96_pred720_20250501_0311)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 12.9863 ± 0.3357
      mae: 2.2063 ± 0.0197
      huber: 1.8041 ± 0.0198
      swd: 2.7458 ± 0.2261
      target_std: 4.8130 ± 0.0000
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.7645 ± 0.2248
      mae: 1.6869 ± 0.0142
      huber: 1.3194 ± 0.0143
      swd: 1.4193 ± 0.1416
      target_std: 4.3000 ± 0.0000
      count: 8.0000 ± 0.0000
    ==================================================
    
    Experiment complete: PatchTST_etth1_seq96_pred720_20250501_0311
    Model: PatchTST
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    

### DLinear

#### pred=96


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=96,
    pred_len=96,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([96, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 94
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 96, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 96
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 94
    Validation Batches: 13
    Test Batches: 26
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 14.1374, mae: 2.0753, huber: 1.6845, swd: 3.2517, target_std: 6.4967
    Epoch [1/50], Val Losses: mse: 9.2856, mae: 1.6197, huber: 1.2564, swd: 1.0762, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 12.2896, mae: 1.9291, huber: 1.5532, swd: 2.1986, target_std: 4.7450
      Epoch 1 composite train-obj: 1.684527
            Val objective improved inf → 1.2564, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.8224, mae: 1.5365, huber: 1.1675, swd: 1.8939, target_std: 6.4967
    Epoch [2/50], Val Losses: mse: 8.6060, mae: 1.5051, huber: 1.1483, swd: 0.9496, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 11.5308, mae: 1.8259, huber: 1.4558, swd: 2.0502, target_std: 4.7450
      Epoch 2 composite train-obj: 1.167509
            Val objective improved 1.2564 → 1.1483, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.5033, mae: 1.4832, huber: 1.1184, swd: 1.8148, target_std: 6.4969
    Epoch [3/50], Val Losses: mse: 8.4400, mae: 1.4749, huber: 1.1211, swd: 1.0138, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 11.2332, mae: 1.7831, huber: 1.4161, swd: 2.0220, target_std: 4.7450
      Epoch 3 composite train-obj: 1.118366
            Val objective improved 1.1483 → 1.1211, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.3773, mae: 1.4604, huber: 1.0975, swd: 1.7705, target_std: 6.4972
    Epoch [4/50], Val Losses: mse: 8.2458, mae: 1.4493, huber: 1.0970, swd: 0.9781, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 11.0647, mae: 1.7639, huber: 1.3978, swd: 1.9951, target_std: 4.7450
      Epoch 4 composite train-obj: 1.097474
            Val objective improved 1.1211 → 1.0970, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.3097, mae: 1.4484, huber: 1.0865, swd: 1.7501, target_std: 6.4969
    Epoch [5/50], Val Losses: mse: 8.2281, mae: 1.4414, huber: 1.0901, swd: 0.9709, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 11.0100, mae: 1.7497, huber: 1.3854, swd: 1.9327, target_std: 4.7450
      Epoch 5 composite train-obj: 1.086508
            Val objective improved 1.0970 → 1.0901, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.2845, mae: 1.4433, huber: 1.0819, swd: 1.7439, target_std: 6.4979
    Epoch [6/50], Val Losses: mse: 8.1316, mae: 1.4272, huber: 1.0765, swd: 0.8955, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.9719, mae: 1.7447, huber: 1.3805, swd: 1.8854, target_std: 4.7450
      Epoch 6 composite train-obj: 1.081935
            Val objective improved 1.0901 → 1.0765, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.2577, mae: 1.4385, huber: 1.0776, swd: 1.7338, target_std: 6.4963
    Epoch [7/50], Val Losses: mse: 8.1216, mae: 1.4269, huber: 1.0766, swd: 0.9211, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.9403, mae: 1.7397, huber: 1.3756, swd: 1.8789, target_std: 4.7450
      Epoch 7 composite train-obj: 1.077612
            No improvement (1.0766), counter 1/5
    Epoch [8/50], Train Losses: mse: 6.2399, mae: 1.4349, huber: 1.0744, swd: 1.7301, target_std: 6.4973
    Epoch [8/50], Val Losses: mse: 8.0945, mae: 1.4234, huber: 1.0734, swd: 0.9342, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 10.9244, mae: 1.7342, huber: 1.3714, swd: 1.8854, target_std: 4.7450
      Epoch 8 composite train-obj: 1.074444
            Val objective improved 1.0765 → 1.0734, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.2168, mae: 1.4316, huber: 1.0713, swd: 1.7226, target_std: 6.4978
    Epoch [9/50], Val Losses: mse: 8.0780, mae: 1.4188, huber: 1.0694, swd: 0.9066, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.9540, mae: 1.7353, huber: 1.3724, swd: 1.8578, target_std: 4.7450
      Epoch 9 composite train-obj: 1.071327
            Val objective improved 1.0734 → 1.0694, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 6.2168, mae: 1.4307, huber: 1.0707, swd: 1.7216, target_std: 6.4967
    Epoch [10/50], Val Losses: mse: 8.0515, mae: 1.4236, huber: 1.0739, swd: 1.0200, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 10.8193, mae: 1.7235, huber: 1.3614, swd: 1.9166, target_std: 4.7450
      Epoch 10 composite train-obj: 1.070682
            No improvement (1.0739), counter 1/5
    Epoch [11/50], Train Losses: mse: 6.2068, mae: 1.4293, huber: 1.0694, swd: 1.7203, target_std: 6.4966
    Epoch [11/50], Val Losses: mse: 8.0286, mae: 1.4208, huber: 1.0712, swd: 0.9819, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.8241, mae: 1.7279, huber: 1.3651, swd: 1.9086, target_std: 4.7450
      Epoch 11 composite train-obj: 1.069386
            No improvement (1.0712), counter 2/5
    Epoch [12/50], Train Losses: mse: 6.2033, mae: 1.4282, huber: 1.0684, swd: 1.7212, target_std: 6.4981
    Epoch [12/50], Val Losses: mse: 8.0526, mae: 1.4245, huber: 1.0750, swd: 1.0198, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.7889, mae: 1.7203, huber: 1.3587, swd: 1.8939, target_std: 4.7450
      Epoch 12 composite train-obj: 1.068444
            No improvement (1.0750), counter 3/5
    Epoch [13/50], Train Losses: mse: 6.1916, mae: 1.4264, huber: 1.0668, swd: 1.7123, target_std: 6.4965
    Epoch [13/50], Val Losses: mse: 7.9834, mae: 1.4146, huber: 1.0653, swd: 0.9529, target_std: 4.3128
    Epoch [13/50], Test Losses: mse: 10.8123, mae: 1.7244, huber: 1.3622, swd: 1.8730, target_std: 4.7450
      Epoch 13 composite train-obj: 1.066810
            Val objective improved 1.0694 → 1.0653, saving checkpoint.
    Epoch [14/50], Train Losses: mse: 6.1754, mae: 1.4256, huber: 1.0659, swd: 1.7091, target_std: 6.4980
    Epoch [14/50], Val Losses: mse: 8.1274, mae: 1.4306, huber: 1.0808, swd: 1.0125, target_std: 4.3128
    Epoch [14/50], Test Losses: mse: 10.9142, mae: 1.7279, huber: 1.3660, swd: 1.8719, target_std: 4.7450
      Epoch 14 composite train-obj: 1.065893
            No improvement (1.0808), counter 1/5
    Epoch [15/50], Train Losses: mse: 6.1846, mae: 1.4250, huber: 1.0655, swd: 1.7089, target_std: 6.4968
    Epoch [15/50], Val Losses: mse: 8.0897, mae: 1.4280, huber: 1.0784, swd: 1.0116, target_std: 4.3128
    Epoch [15/50], Test Losses: mse: 10.8422, mae: 1.7248, huber: 1.3626, swd: 1.8882, target_std: 4.7450
      Epoch 15 composite train-obj: 1.065545
            No improvement (1.0784), counter 2/5
    Epoch [16/50], Train Losses: mse: 6.1747, mae: 1.4245, huber: 1.0649, swd: 1.7059, target_std: 6.4969
    Epoch [16/50], Val Losses: mse: 7.9753, mae: 1.4097, huber: 1.0608, swd: 0.9259, target_std: 4.3128
    Epoch [16/50], Test Losses: mse: 10.8160, mae: 1.7209, huber: 1.3590, swd: 1.8296, target_std: 4.7450
      Epoch 16 composite train-obj: 1.064916
            Val objective improved 1.0653 → 1.0608, saving checkpoint.
    Epoch [17/50], Train Losses: mse: 6.1733, mae: 1.4236, huber: 1.0641, swd: 1.7067, target_std: 6.4974
    Epoch [17/50], Val Losses: mse: 8.0186, mae: 1.4154, huber: 1.0662, swd: 0.9600, target_std: 4.3128
    Epoch [17/50], Test Losses: mse: 10.8317, mae: 1.7209, huber: 1.3593, swd: 1.8368, target_std: 4.7450
      Epoch 17 composite train-obj: 1.064107
            No improvement (1.0662), counter 1/5
    Epoch [18/50], Train Losses: mse: 6.1714, mae: 1.4234, huber: 1.0641, swd: 1.7041, target_std: 6.4966
    Epoch [18/50], Val Losses: mse: 7.9911, mae: 1.4143, huber: 1.0654, swd: 0.9818, target_std: 4.3128
    Epoch [18/50], Test Losses: mse: 10.7692, mae: 1.7170, huber: 1.3542, swd: 1.8442, target_std: 4.7450
      Epoch 18 composite train-obj: 1.064111
            No improvement (1.0654), counter 2/5
    Epoch [19/50], Train Losses: mse: 6.1639, mae: 1.4228, huber: 1.0634, swd: 1.6991, target_std: 6.4967
    Epoch [19/50], Val Losses: mse: 7.9579, mae: 1.4134, huber: 1.0643, swd: 0.9839, target_std: 4.3128
    Epoch [19/50], Test Losses: mse: 10.7967, mae: 1.7218, huber: 1.3600, swd: 1.8897, target_std: 4.7450
      Epoch 19 composite train-obj: 1.063372
            No improvement (1.0643), counter 3/5
    Epoch [20/50], Train Losses: mse: 6.1627, mae: 1.4221, huber: 1.0628, swd: 1.6993, target_std: 6.4983
    Epoch [20/50], Val Losses: mse: 8.0075, mae: 1.4253, huber: 1.0750, swd: 1.0909, target_std: 4.3128
    Epoch [20/50], Test Losses: mse: 10.7184, mae: 1.7127, huber: 1.3515, swd: 1.9091, target_std: 4.7450
      Epoch 20 composite train-obj: 1.062815
            No improvement (1.0750), counter 4/5
    Epoch [21/50], Train Losses: mse: 6.1745, mae: 1.4242, huber: 1.0647, swd: 1.7083, target_std: 6.4975
    Epoch [21/50], Val Losses: mse: 8.0417, mae: 1.4194, huber: 1.0700, swd: 0.9825, target_std: 4.3128
    Epoch [21/50], Test Losses: mse: 10.8375, mae: 1.7216, huber: 1.3597, swd: 1.8325, target_std: 4.7450
      Epoch 21 composite train-obj: 1.064730
    Epoch [21/50], Test Losses: mse: 10.8160, mae: 1.7209, huber: 1.3590, swd: 1.8296, target_std: 4.7450
    Best round's Test MSE: 10.8160, MAE: 1.7209, SWD: 1.8296
    Best round's Validation MSE: 7.9753, MAE: 1.4097
    Best round's Test verification MSE : 10.8160, MAE: 1.7209, SWD: 1.8296
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 14.1919, mae: 2.0675, huber: 1.6772, swd: 3.1220, target_std: 6.4976
    Epoch [1/50], Val Losses: mse: 9.2296, mae: 1.6005, huber: 1.2375, swd: 0.9318, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 12.3769, mae: 1.9321, huber: 1.5556, swd: 2.0719, target_std: 4.7450
      Epoch 1 composite train-obj: 1.677184
            Val objective improved inf → 1.2375, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.8233, mae: 1.5341, huber: 1.1653, swd: 1.8203, target_std: 6.4959
    Epoch [2/50], Val Losses: mse: 8.6120, mae: 1.5078, huber: 1.1510, swd: 0.9584, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 11.5464, mae: 1.8271, huber: 1.4571, swd: 2.0078, target_std: 4.7450
      Epoch 2 composite train-obj: 1.165266
            Val objective improved 1.2375 → 1.1510, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.5152, mae: 1.4836, huber: 1.1187, swd: 1.7447, target_std: 6.4973
    Epoch [3/50], Val Losses: mse: 8.4364, mae: 1.4678, huber: 1.1140, swd: 0.8706, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 11.3115, mae: 1.7878, huber: 1.4208, swd: 1.8651, target_std: 4.7450
      Epoch 3 composite train-obj: 1.118746
            Val objective improved 1.1510 → 1.1140, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.3846, mae: 1.4613, huber: 1.0984, swd: 1.6959, target_std: 6.4968
    Epoch [4/50], Val Losses: mse: 8.3115, mae: 1.4490, huber: 1.0967, swd: 0.8610, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 11.1835, mae: 1.7694, huber: 1.4032, swd: 1.8116, target_std: 4.7450
      Epoch 4 composite train-obj: 1.098378
            Val objective improved 1.1140 → 1.0967, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.3165, mae: 1.4495, huber: 1.0876, swd: 1.6729, target_std: 6.4977
    Epoch [5/50], Val Losses: mse: 8.3042, mae: 1.4445, huber: 1.0933, swd: 0.8750, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 11.1031, mae: 1.7531, huber: 1.3885, swd: 1.7661, target_std: 4.7450
      Epoch 5 composite train-obj: 1.087614
            Val objective improved 1.0967 → 1.0933, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.2843, mae: 1.4431, huber: 1.0818, swd: 1.6640, target_std: 6.4971
    Epoch [6/50], Val Losses: mse: 8.1759, mae: 1.4391, huber: 1.0879, swd: 0.9550, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.9409, mae: 1.7416, huber: 1.3781, swd: 1.8483, target_std: 4.7450
      Epoch 6 composite train-obj: 1.081842
            Val objective improved 1.0933 → 1.0879, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.2522, mae: 1.4372, huber: 1.0765, swd: 1.6535, target_std: 6.4969
    Epoch [7/50], Val Losses: mse: 8.1178, mae: 1.4288, huber: 1.0786, swd: 0.9101, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.9246, mae: 1.7363, huber: 1.3731, swd: 1.8027, target_std: 4.7450
      Epoch 7 composite train-obj: 1.076518
            Val objective improved 1.0879 → 1.0786, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.2306, mae: 1.4345, huber: 1.0740, swd: 1.6524, target_std: 6.4969
    Epoch [8/50], Val Losses: mse: 8.1501, mae: 1.4238, huber: 1.0733, swd: 0.8193, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 11.0080, mae: 1.7392, huber: 1.3759, swd: 1.7043, target_std: 4.7450
      Epoch 8 composite train-obj: 1.074033
            Val objective improved 1.0786 → 1.0733, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 6.2223, mae: 1.4319, huber: 1.0717, swd: 1.6444, target_std: 6.4976
    Epoch [9/50], Val Losses: mse: 8.1013, mae: 1.4280, huber: 1.0784, swd: 0.9701, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.8453, mae: 1.7243, huber: 1.3625, swd: 1.8010, target_std: 4.7450
      Epoch 9 composite train-obj: 1.071713
            No improvement (1.0784), counter 1/5
    Epoch [10/50], Train Losses: mse: 6.2109, mae: 1.4296, huber: 1.0697, swd: 1.6383, target_std: 6.4976
    Epoch [10/50], Val Losses: mse: 8.1274, mae: 1.4425, huber: 1.0916, swd: 1.0846, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 10.7756, mae: 1.7224, huber: 1.3603, swd: 1.8677, target_std: 4.7450
      Epoch 10 composite train-obj: 1.069669
            No improvement (1.0916), counter 2/5
    Epoch [11/50], Train Losses: mse: 6.2059, mae: 1.4299, huber: 1.0698, swd: 1.6419, target_std: 6.4966
    Epoch [11/50], Val Losses: mse: 8.0375, mae: 1.4208, huber: 1.0713, swd: 0.9664, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.7911, mae: 1.7216, huber: 1.3592, swd: 1.7965, target_std: 4.7450
      Epoch 11 composite train-obj: 1.069791
            Val objective improved 1.0733 → 1.0713, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 6.1854, mae: 1.4264, huber: 1.0667, swd: 1.6315, target_std: 6.4972
    Epoch [12/50], Val Losses: mse: 8.0267, mae: 1.4178, huber: 1.0687, swd: 0.9182, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.8415, mae: 1.7262, huber: 1.3634, swd: 1.7904, target_std: 4.7450
      Epoch 12 composite train-obj: 1.066667
            Val objective improved 1.0713 → 1.0687, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 6.1839, mae: 1.4257, huber: 1.0661, swd: 1.6322, target_std: 6.4965
    Epoch [13/50], Val Losses: mse: 8.0482, mae: 1.4162, huber: 1.0668, swd: 0.8862, target_std: 4.3128
    Epoch [13/50], Test Losses: mse: 10.8669, mae: 1.7255, huber: 1.3625, swd: 1.7271, target_std: 4.7450
      Epoch 13 composite train-obj: 1.066149
            Val objective improved 1.0687 → 1.0668, saving checkpoint.
    Epoch [14/50], Train Losses: mse: 6.1770, mae: 1.4247, huber: 1.0652, swd: 1.6295, target_std: 6.4975
    Epoch [14/50], Val Losses: mse: 8.0622, mae: 1.4277, huber: 1.0784, swd: 1.0041, target_std: 4.3128
    Epoch [14/50], Test Losses: mse: 10.7804, mae: 1.7185, huber: 1.3570, swd: 1.8114, target_std: 4.7450
      Epoch 14 composite train-obj: 1.065212
            No improvement (1.0784), counter 1/5
    Epoch [15/50], Train Losses: mse: 6.1833, mae: 1.4254, huber: 1.0657, swd: 1.6293, target_std: 6.4972
    Epoch [15/50], Val Losses: mse: 7.9669, mae: 1.4182, huber: 1.0684, swd: 0.9722, target_std: 4.3128
    Epoch [15/50], Test Losses: mse: 10.7750, mae: 1.7215, huber: 1.3595, swd: 1.8341, target_std: 4.7450
      Epoch 15 composite train-obj: 1.065742
            No improvement (1.0684), counter 2/5
    Epoch [16/50], Train Losses: mse: 6.1897, mae: 1.4258, huber: 1.0663, swd: 1.6360, target_std: 6.4969
    Epoch [16/50], Val Losses: mse: 7.9660, mae: 1.4148, huber: 1.0656, swd: 0.9725, target_std: 4.3128
    Epoch [16/50], Test Losses: mse: 10.7295, mae: 1.7145, huber: 1.3530, swd: 1.8118, target_std: 4.7450
      Epoch 16 composite train-obj: 1.066330
            Val objective improved 1.0668 → 1.0656, saving checkpoint.
    Epoch [17/50], Train Losses: mse: 6.1792, mae: 1.4249, huber: 1.0653, swd: 1.6330, target_std: 6.4974
    Epoch [17/50], Val Losses: mse: 8.0649, mae: 1.4256, huber: 1.0760, swd: 0.9039, target_std: 4.3128
    Epoch [17/50], Test Losses: mse: 10.8399, mae: 1.7231, huber: 1.3607, swd: 1.7370, target_std: 4.7450
      Epoch 17 composite train-obj: 1.065320
            No improvement (1.0760), counter 1/5
    Epoch [18/50], Train Losses: mse: 6.1644, mae: 1.4229, huber: 1.0635, swd: 1.6218, target_std: 6.4981
    Epoch [18/50], Val Losses: mse: 8.0328, mae: 1.4208, huber: 1.0718, swd: 0.9849, target_std: 4.3128
    Epoch [18/50], Test Losses: mse: 10.7497, mae: 1.7134, huber: 1.3518, swd: 1.7645, target_std: 4.7450
      Epoch 18 composite train-obj: 1.063455
            No improvement (1.0718), counter 2/5
    Epoch [19/50], Train Losses: mse: 6.1596, mae: 1.4224, huber: 1.0630, swd: 1.6215, target_std: 6.4969
    Epoch [19/50], Val Losses: mse: 7.9768, mae: 1.4144, huber: 1.0653, swd: 0.9567, target_std: 4.3128
    Epoch [19/50], Test Losses: mse: 10.7683, mae: 1.7154, huber: 1.3539, swd: 1.7698, target_std: 4.7450
      Epoch 19 composite train-obj: 1.062991
            Val objective improved 1.0656 → 1.0653, saving checkpoint.
    Epoch [20/50], Train Losses: mse: 6.1606, mae: 1.4219, huber: 1.0626, swd: 1.6178, target_std: 6.4973
    Epoch [20/50], Val Losses: mse: 8.0646, mae: 1.4277, huber: 1.0779, swd: 1.0268, target_std: 4.3128
    Epoch [20/50], Test Losses: mse: 10.7534, mae: 1.7136, huber: 1.3520, swd: 1.7871, target_std: 4.7450
      Epoch 20 composite train-obj: 1.062590
            No improvement (1.0779), counter 1/5
    Epoch [21/50], Train Losses: mse: 6.1710, mae: 1.4234, huber: 1.0639, swd: 1.6242, target_std: 6.4973
    Epoch [21/50], Val Losses: mse: 7.9241, mae: 1.4140, huber: 1.0648, swd: 0.9770, target_std: 4.3128
    Epoch [21/50], Test Losses: mse: 10.7318, mae: 1.7158, huber: 1.3539, swd: 1.8066, target_std: 4.7450
      Epoch 21 composite train-obj: 1.063925
            Val objective improved 1.0653 → 1.0648, saving checkpoint.
    Epoch [22/50], Train Losses: mse: 6.1548, mae: 1.4216, huber: 1.0623, swd: 1.6174, target_std: 6.4983
    Epoch [22/50], Val Losses: mse: 8.0153, mae: 1.4159, huber: 1.0665, swd: 0.9124, target_std: 4.3128
    Epoch [22/50], Test Losses: mse: 10.8475, mae: 1.7242, huber: 1.3619, swd: 1.7579, target_std: 4.7450
      Epoch 22 composite train-obj: 1.062282
            No improvement (1.0665), counter 1/5
    Epoch [23/50], Train Losses: mse: 6.1563, mae: 1.4214, huber: 1.0621, swd: 1.6170, target_std: 6.4979
    Epoch [23/50], Val Losses: mse: 7.9910, mae: 1.4215, huber: 1.0723, swd: 1.0051, target_std: 4.3128
    Epoch [23/50], Test Losses: mse: 10.7482, mae: 1.7160, huber: 1.3545, swd: 1.8076, target_std: 4.7450
      Epoch 23 composite train-obj: 1.062082
            No improvement (1.0723), counter 2/5
    Epoch [24/50], Train Losses: mse: 6.1662, mae: 1.4224, huber: 1.0631, swd: 1.6182, target_std: 6.4964
    Epoch [24/50], Val Losses: mse: 7.9694, mae: 1.4099, huber: 1.0605, swd: 0.8969, target_std: 4.3128
    Epoch [24/50], Test Losses: mse: 10.8057, mae: 1.7186, huber: 1.3567, swd: 1.7169, target_std: 4.7450
      Epoch 24 composite train-obj: 1.063106
            Val objective improved 1.0648 → 1.0605, saving checkpoint.
    Epoch [25/50], Train Losses: mse: 6.1515, mae: 1.4205, huber: 1.0613, swd: 1.6124, target_std: 6.4972
    Epoch [25/50], Val Losses: mse: 7.9804, mae: 1.4239, huber: 1.0742, swd: 1.0463, target_std: 4.3128
    Epoch [25/50], Test Losses: mse: 10.6870, mae: 1.7124, huber: 1.3511, swd: 1.8284, target_std: 4.7450
      Epoch 25 composite train-obj: 1.061302
            No improvement (1.0742), counter 1/5
    Epoch [26/50], Train Losses: mse: 6.1568, mae: 1.4220, huber: 1.0627, swd: 1.6200, target_std: 6.4965
    Epoch [26/50], Val Losses: mse: 8.0315, mae: 1.4236, huber: 1.0746, swd: 1.0380, target_std: 4.3128
    Epoch [26/50], Test Losses: mse: 10.7475, mae: 1.7134, huber: 1.3520, swd: 1.7932, target_std: 4.7450
      Epoch 26 composite train-obj: 1.062676
            No improvement (1.0746), counter 2/5
    Epoch [27/50], Train Losses: mse: 6.1545, mae: 1.4212, huber: 1.0619, swd: 1.6142, target_std: 6.4973
    Epoch [27/50], Val Losses: mse: 7.9114, mae: 1.4021, huber: 1.0533, swd: 0.8733, target_std: 4.3128
    Epoch [27/50], Test Losses: mse: 10.7630, mae: 1.7164, huber: 1.3539, swd: 1.7139, target_std: 4.7450
      Epoch 27 composite train-obj: 1.061890
            Val objective improved 1.0605 → 1.0533, saving checkpoint.
    Epoch [28/50], Train Losses: mse: 6.1535, mae: 1.4213, huber: 1.0620, swd: 1.6148, target_std: 6.4975
    Epoch [28/50], Val Losses: mse: 8.0460, mae: 1.4213, huber: 1.0715, swd: 0.9495, target_std: 4.3128
    Epoch [28/50], Test Losses: mse: 10.8161, mae: 1.7186, huber: 1.3568, swd: 1.7140, target_std: 4.7450
      Epoch 28 composite train-obj: 1.062019
            No improvement (1.0715), counter 1/5
    Epoch [29/50], Train Losses: mse: 6.1616, mae: 1.4218, huber: 1.0624, swd: 1.6139, target_std: 6.4967
    Epoch [29/50], Val Losses: mse: 7.9898, mae: 1.4251, huber: 1.0754, swd: 1.0279, target_std: 4.3128
    Epoch [29/50], Test Losses: mse: 10.7023, mae: 1.7107, huber: 1.3497, swd: 1.8008, target_std: 4.7450
      Epoch 29 composite train-obj: 1.062420
            No improvement (1.0754), counter 2/5
    Epoch [30/50], Train Losses: mse: 6.1537, mae: 1.4214, huber: 1.0620, swd: 1.6146, target_std: 6.4968
    Epoch [30/50], Val Losses: mse: 7.9793, mae: 1.4161, huber: 1.0663, swd: 0.9334, target_std: 4.3128
    Epoch [30/50], Test Losses: mse: 10.7903, mae: 1.7194, huber: 1.3579, swd: 1.7510, target_std: 4.7450
      Epoch 30 composite train-obj: 1.062038
            No improvement (1.0663), counter 3/5
    Epoch [31/50], Train Losses: mse: 6.1531, mae: 1.4213, huber: 1.0619, swd: 1.6135, target_std: 6.4965
    Epoch [31/50], Val Losses: mse: 8.0157, mae: 1.4202, huber: 1.0701, swd: 0.9251, target_std: 4.3128
    Epoch [31/50], Test Losses: mse: 10.8030, mae: 1.7187, huber: 1.3568, swd: 1.7182, target_std: 4.7450
      Epoch 31 composite train-obj: 1.061903
            No improvement (1.0701), counter 4/5
    Epoch [32/50], Train Losses: mse: 6.1604, mae: 1.4220, huber: 1.0627, swd: 1.6182, target_std: 6.4975
    Epoch [32/50], Val Losses: mse: 8.0101, mae: 1.4186, huber: 1.0696, swd: 0.9740, target_std: 4.3128
    Epoch [32/50], Test Losses: mse: 10.7509, mae: 1.7154, huber: 1.3530, swd: 1.7585, target_std: 4.7450
      Epoch 32 composite train-obj: 1.062729
    Epoch [32/50], Test Losses: mse: 10.7630, mae: 1.7164, huber: 1.3539, swd: 1.7139, target_std: 4.7450
    Best round's Test MSE: 10.7630, MAE: 1.7164, SWD: 1.7139
    Best round's Validation MSE: 7.9114, MAE: 1.4021
    Best round's Test verification MSE : 10.7630, MAE: 1.7164, SWD: 1.7139
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 13.6563, mae: 2.0545, huber: 1.6638, swd: 2.6796, target_std: 6.4979
    Epoch [1/50], Val Losses: mse: 9.2284, mae: 1.6137, huber: 1.2501, swd: 1.0190, target_std: 4.3128
    Epoch [1/50], Test Losses: mse: 12.2678, mae: 1.9292, huber: 1.5531, swd: 2.1134, target_std: 4.7450
      Epoch 1 composite train-obj: 1.663780
            Val objective improved inf → 1.2501, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 6.8021, mae: 1.5338, huber: 1.1648, swd: 1.7401, target_std: 6.4968
    Epoch [2/50], Val Losses: mse: 8.5981, mae: 1.5056, huber: 1.1487, swd: 0.9627, target_std: 4.3128
    Epoch [2/50], Test Losses: mse: 11.4949, mae: 1.8249, huber: 1.4547, swd: 1.9986, target_std: 4.7450
      Epoch 2 composite train-obj: 1.164784
            Val objective improved 1.2501 → 1.1487, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 6.5041, mae: 1.4829, huber: 1.1180, swd: 1.6628, target_std: 6.4970
    Epoch [3/50], Val Losses: mse: 8.4238, mae: 1.4656, huber: 1.1114, swd: 0.8581, target_std: 4.3128
    Epoch [3/50], Test Losses: mse: 11.2885, mae: 1.7865, huber: 1.4188, swd: 1.8349, target_std: 4.7450
      Epoch 3 composite train-obj: 1.117958
            Val objective improved 1.1487 → 1.1114, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 6.3753, mae: 1.4604, huber: 1.0974, swd: 1.6230, target_std: 6.4976
    Epoch [4/50], Val Losses: mse: 8.3145, mae: 1.4521, huber: 1.1003, swd: 0.9210, target_std: 4.3128
    Epoch [4/50], Test Losses: mse: 11.1036, mae: 1.7618, huber: 1.3961, swd: 1.8492, target_std: 4.7450
      Epoch 4 composite train-obj: 1.097387
            Val objective improved 1.1114 → 1.1003, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 6.3141, mae: 1.4490, huber: 1.0872, swd: 1.6069, target_std: 6.4972
    Epoch [5/50], Val Losses: mse: 8.2118, mae: 1.4374, huber: 1.0863, swd: 0.8745, target_std: 4.3128
    Epoch [5/50], Test Losses: mse: 11.0704, mae: 1.7555, huber: 1.3904, swd: 1.8223, target_std: 4.7450
      Epoch 5 composite train-obj: 1.087162
            Val objective improved 1.1003 → 1.0863, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 6.2803, mae: 1.4424, huber: 1.0811, swd: 1.5993, target_std: 6.4980
    Epoch [6/50], Val Losses: mse: 8.1738, mae: 1.4303, huber: 1.0794, swd: 0.8761, target_std: 4.3128
    Epoch [6/50], Test Losses: mse: 10.9958, mae: 1.7443, huber: 1.3799, swd: 1.7798, target_std: 4.7450
      Epoch 6 composite train-obj: 1.081126
            Val objective improved 1.0863 → 1.0794, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 6.2445, mae: 1.4366, huber: 1.0758, swd: 1.5846, target_std: 6.4965
    Epoch [7/50], Val Losses: mse: 8.1383, mae: 1.4253, huber: 1.0748, swd: 0.8294, target_std: 4.3128
    Epoch [7/50], Test Losses: mse: 10.9900, mae: 1.7417, huber: 1.3778, swd: 1.7452, target_std: 4.7450
      Epoch 7 composite train-obj: 1.075773
            Val objective improved 1.0794 → 1.0748, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 6.2347, mae: 1.4343, huber: 1.0738, swd: 1.5854, target_std: 6.4974
    Epoch [8/50], Val Losses: mse: 8.1434, mae: 1.4289, huber: 1.0793, swd: 0.9324, target_std: 4.3128
    Epoch [8/50], Test Losses: mse: 10.9067, mae: 1.7314, huber: 1.3684, swd: 1.7933, target_std: 4.7450
      Epoch 8 composite train-obj: 1.073824
            No improvement (1.0793), counter 1/5
    Epoch [9/50], Train Losses: mse: 6.2272, mae: 1.4328, huber: 1.0726, swd: 1.5869, target_std: 6.4973
    Epoch [9/50], Val Losses: mse: 8.0815, mae: 1.4236, huber: 1.0736, swd: 0.9008, target_std: 4.3128
    Epoch [9/50], Test Losses: mse: 10.9168, mae: 1.7333, huber: 1.3705, swd: 1.7899, target_std: 4.7450
      Epoch 9 composite train-obj: 1.072610
            Val objective improved 1.0748 → 1.0736, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 6.2256, mae: 1.4319, huber: 1.0718, swd: 1.5876, target_std: 6.4963
    Epoch [10/50], Val Losses: mse: 8.1275, mae: 1.4288, huber: 1.0790, swd: 0.9291, target_std: 4.3128
    Epoch [10/50], Test Losses: mse: 10.9025, mae: 1.7317, huber: 1.3685, swd: 1.7940, target_std: 4.7450
      Epoch 10 composite train-obj: 1.071815
            No improvement (1.0790), counter 1/5
    Epoch [11/50], Train Losses: mse: 6.2057, mae: 1.4290, huber: 1.0691, swd: 1.5788, target_std: 6.4973
    Epoch [11/50], Val Losses: mse: 8.0530, mae: 1.4288, huber: 1.0788, swd: 1.0152, target_std: 4.3128
    Epoch [11/50], Test Losses: mse: 10.7987, mae: 1.7233, huber: 1.3613, swd: 1.8567, target_std: 4.7450
      Epoch 11 composite train-obj: 1.069123
            No improvement (1.0788), counter 2/5
    Epoch [12/50], Train Losses: mse: 6.1974, mae: 1.4280, huber: 1.0681, swd: 1.5774, target_std: 6.4974
    Epoch [12/50], Val Losses: mse: 8.0224, mae: 1.4152, huber: 1.0663, swd: 0.9049, target_std: 4.3128
    Epoch [12/50], Test Losses: mse: 10.8444, mae: 1.7245, huber: 1.3620, swd: 1.7775, target_std: 4.7450
      Epoch 12 composite train-obj: 1.068148
            Val objective improved 1.0736 → 1.0663, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 6.1927, mae: 1.4271, huber: 1.0672, swd: 1.5745, target_std: 6.4972
    Epoch [13/50], Val Losses: mse: 8.0781, mae: 1.4286, huber: 1.0785, swd: 0.9664, target_std: 4.3128
    Epoch [13/50], Test Losses: mse: 10.8493, mae: 1.7271, huber: 1.3646, swd: 1.7996, target_std: 4.7450
      Epoch 13 composite train-obj: 1.067224
            No improvement (1.0785), counter 1/5
    Epoch [14/50], Train Losses: mse: 6.1887, mae: 1.4262, huber: 1.0665, swd: 1.5693, target_std: 6.4976
    Epoch [14/50], Val Losses: mse: 8.0218, mae: 1.4184, huber: 1.0690, swd: 0.9149, target_std: 4.3128
    Epoch [14/50], Test Losses: mse: 10.8637, mae: 1.7273, huber: 1.3646, swd: 1.7866, target_std: 4.7450
      Epoch 14 composite train-obj: 1.066530
            No improvement (1.0690), counter 2/5
    Epoch [15/50], Train Losses: mse: 6.1802, mae: 1.4250, huber: 1.0654, swd: 1.5694, target_std: 6.4963
    Epoch [15/50], Val Losses: mse: 7.9897, mae: 1.4193, huber: 1.0697, swd: 0.9696, target_std: 4.3128
    Epoch [15/50], Test Losses: mse: 10.7609, mae: 1.7181, huber: 1.3561, swd: 1.8034, target_std: 4.7450
      Epoch 15 composite train-obj: 1.065394
            No improvement (1.0697), counter 3/5
    Epoch [16/50], Train Losses: mse: 6.1876, mae: 1.4259, huber: 1.0663, swd: 1.5761, target_std: 6.4972
    Epoch [16/50], Val Losses: mse: 8.0343, mae: 1.4300, huber: 1.0787, swd: 1.0468, target_std: 4.3128
    Epoch [16/50], Test Losses: mse: 10.7592, mae: 1.7202, huber: 1.3579, swd: 1.8386, target_std: 4.7450
      Epoch 16 composite train-obj: 1.066251
            No improvement (1.0787), counter 4/5
    Epoch [17/50], Train Losses: mse: 6.1732, mae: 1.4239, huber: 1.0644, swd: 1.5667, target_std: 6.4970
    Epoch [17/50], Val Losses: mse: 7.9585, mae: 1.4145, huber: 1.0649, swd: 0.9643, target_std: 4.3128
    Epoch [17/50], Test Losses: mse: 10.7322, mae: 1.7168, huber: 1.3549, swd: 1.8112, target_std: 4.7450
      Epoch 17 composite train-obj: 1.064435
            Val objective improved 1.0663 → 1.0649, saving checkpoint.
    Epoch [18/50], Train Losses: mse: 6.1681, mae: 1.4235, huber: 1.0639, swd: 1.5653, target_std: 6.4972
    Epoch [18/50], Val Losses: mse: 7.9935, mae: 1.4156, huber: 1.0663, swd: 0.9356, target_std: 4.3128
    Epoch [18/50], Test Losses: mse: 10.7789, mae: 1.7175, huber: 1.3556, swd: 1.7561, target_std: 4.7450
      Epoch 18 composite train-obj: 1.063925
            No improvement (1.0663), counter 1/5
    Epoch [19/50], Train Losses: mse: 6.1774, mae: 1.4247, huber: 1.0651, swd: 1.5682, target_std: 6.4967
    Epoch [19/50], Val Losses: mse: 7.9687, mae: 1.4107, huber: 1.0613, swd: 0.9136, target_std: 4.3128
    Epoch [19/50], Test Losses: mse: 10.8029, mae: 1.7206, huber: 1.3585, swd: 1.7657, target_std: 4.7450
      Epoch 19 composite train-obj: 1.065150
            Val objective improved 1.0649 → 1.0613, saving checkpoint.
    Epoch [20/50], Train Losses: mse: 6.1652, mae: 1.4227, huber: 1.0634, swd: 1.5633, target_std: 6.4975
    Epoch [20/50], Val Losses: mse: 7.9720, mae: 1.4167, huber: 1.0672, swd: 0.9895, target_std: 4.3128
    Epoch [20/50], Test Losses: mse: 10.7397, mae: 1.7158, huber: 1.3537, swd: 1.8047, target_std: 4.7450
      Epoch 20 composite train-obj: 1.063350
            No improvement (1.0672), counter 1/5
    Epoch [21/50], Train Losses: mse: 6.1663, mae: 1.4231, huber: 1.0636, swd: 1.5668, target_std: 6.4975
    Epoch [21/50], Val Losses: mse: 7.9638, mae: 1.4071, huber: 1.0583, swd: 0.8640, target_std: 4.3128
    Epoch [21/50], Test Losses: mse: 10.8555, mae: 1.7247, huber: 1.3618, swd: 1.7168, target_std: 4.7450
      Epoch 21 composite train-obj: 1.063631
            Val objective improved 1.0613 → 1.0583, saving checkpoint.
    Epoch [22/50], Train Losses: mse: 6.1577, mae: 1.4222, huber: 1.0626, swd: 1.5578, target_std: 6.4973
    Epoch [22/50], Val Losses: mse: 7.9591, mae: 1.4151, huber: 1.0654, swd: 0.9763, target_std: 4.3128
    Epoch [22/50], Test Losses: mse: 10.7231, mae: 1.7135, huber: 1.3518, swd: 1.7943, target_std: 4.7450
      Epoch 22 composite train-obj: 1.062621
            No improvement (1.0654), counter 1/5
    Epoch [23/50], Train Losses: mse: 6.1555, mae: 1.4209, huber: 1.0617, swd: 1.5573, target_std: 6.4977
    Epoch [23/50], Val Losses: mse: 8.0102, mae: 1.4270, huber: 1.0766, swd: 1.0122, target_std: 4.3128
    Epoch [23/50], Test Losses: mse: 10.7211, mae: 1.7146, huber: 1.3529, swd: 1.8043, target_std: 4.7450
      Epoch 23 composite train-obj: 1.061708
            No improvement (1.0766), counter 2/5
    Epoch [24/50], Train Losses: mse: 6.1546, mae: 1.4216, huber: 1.0623, swd: 1.5602, target_std: 6.4966
    Epoch [24/50], Val Losses: mse: 7.9931, mae: 1.4158, huber: 1.0671, swd: 0.9498, target_std: 4.3128
    Epoch [24/50], Test Losses: mse: 10.8130, mae: 1.7199, huber: 1.3583, swd: 1.7989, target_std: 4.7450
      Epoch 24 composite train-obj: 1.062268
            No improvement (1.0671), counter 3/5
    Epoch [25/50], Train Losses: mse: 6.1741, mae: 1.4230, huber: 1.0637, swd: 1.5625, target_std: 6.4967
    Epoch [25/50], Val Losses: mse: 8.0695, mae: 1.4316, huber: 1.0819, swd: 1.0543, target_std: 4.3128
    Epoch [25/50], Test Losses: mse: 10.7583, mae: 1.7172, huber: 1.3552, swd: 1.8101, target_std: 4.7450
      Epoch 25 composite train-obj: 1.063721
            No improvement (1.0819), counter 4/5
    Epoch [26/50], Train Losses: mse: 6.1668, mae: 1.4228, huber: 1.0634, swd: 1.5605, target_std: 6.4977
    Epoch [26/50], Val Losses: mse: 7.9257, mae: 1.4057, huber: 1.0561, swd: 0.9088, target_std: 4.3128
    Epoch [26/50], Test Losses: mse: 10.7761, mae: 1.7173, huber: 1.3556, swd: 1.7488, target_std: 4.7450
      Epoch 26 composite train-obj: 1.063370
            Val objective improved 1.0583 → 1.0561, saving checkpoint.
    Epoch [27/50], Train Losses: mse: 6.1546, mae: 1.4215, huber: 1.0622, swd: 1.5577, target_std: 6.4964
    Epoch [27/50], Val Losses: mse: 8.0022, mae: 1.4189, huber: 1.0696, swd: 0.9767, target_std: 4.3128
    Epoch [27/50], Test Losses: mse: 10.7656, mae: 1.7153, huber: 1.3541, swd: 1.7727, target_std: 4.7450
      Epoch 27 composite train-obj: 1.062185
            No improvement (1.0696), counter 1/5
    Epoch [28/50], Train Losses: mse: 6.1585, mae: 1.4216, huber: 1.0623, swd: 1.5534, target_std: 6.4963
    Epoch [28/50], Val Losses: mse: 8.0163, mae: 1.4359, huber: 1.0855, swd: 1.1341, target_std: 4.3128
    Epoch [28/50], Test Losses: mse: 10.6483, mae: 1.7108, huber: 1.3488, swd: 1.8821, target_std: 4.7450
      Epoch 28 composite train-obj: 1.062294
            No improvement (1.0855), counter 2/5
    Epoch [29/50], Train Losses: mse: 6.1500, mae: 1.4210, huber: 1.0617, swd: 1.5543, target_std: 6.4972
    Epoch [29/50], Val Losses: mse: 7.9877, mae: 1.4143, huber: 1.0655, swd: 0.9505, target_std: 4.3128
    Epoch [29/50], Test Losses: mse: 10.7719, mae: 1.7158, huber: 1.3538, swd: 1.7626, target_std: 4.7450
      Epoch 29 composite train-obj: 1.061659
            No improvement (1.0655), counter 3/5
    Epoch [30/50], Train Losses: mse: 6.1541, mae: 1.4212, huber: 1.0619, swd: 1.5546, target_std: 6.4966
    Epoch [30/50], Val Losses: mse: 8.0091, mae: 1.4142, huber: 1.0640, swd: 0.9160, target_std: 4.3128
    Epoch [30/50], Test Losses: mse: 10.8155, mae: 1.7190, huber: 1.3571, swd: 1.7050, target_std: 4.7450
      Epoch 30 composite train-obj: 1.061853
            No improvement (1.0640), counter 4/5
    Epoch [31/50], Train Losses: mse: 6.1569, mae: 1.4218, huber: 1.0623, swd: 1.5552, target_std: 6.4971
    Epoch [31/50], Val Losses: mse: 8.0539, mae: 1.4307, huber: 1.0807, swd: 1.0639, target_std: 4.3128
    Epoch [31/50], Test Losses: mse: 10.7076, mae: 1.7108, huber: 1.3489, swd: 1.7910, target_std: 4.7450
      Epoch 31 composite train-obj: 1.062349
    Epoch [31/50], Test Losses: mse: 10.7761, mae: 1.7173, huber: 1.3556, swd: 1.7488, target_std: 4.7450
    Best round's Test MSE: 10.7761, MAE: 1.7173, SWD: 1.7488
    Best round's Validation MSE: 7.9257, MAE: 1.4057
    Best round's Test verification MSE : 10.7761, MAE: 1.7173, SWD: 1.7488
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq96_pred96_20250501_0257)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 10.7850 ± 0.0225
      mae: 1.7182 ± 0.0019
      huber: 1.3562 ± 0.0021
      swd: 1.7641 ± 0.0484
      target_std: 4.7450 ± 0.0000
      count: 13.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 7.9375 ± 0.0274
      mae: 1.4058 ± 0.0031
      huber: 1.0567 ± 0.0031
      swd: 0.9027 ± 0.0219
      target_std: 4.3128 ± 0.0000
      count: 13.0000 ± 0.0000
    ==================================================
    
    Experiment complete: DLinear_etth1_seq96_pred96_20250501_0257
    Model: DLinear
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 96
    Seeds: [1955, 7, 20]
    

#### pred=196


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=96,
    pred_len=196,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([196, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 93
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 196, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 196
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 93
    Validation Batches: 12
    Test Batches: 25
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 15.8256, mae: 2.1845, huber: 1.7883, swd: 3.2276, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 11.1058, mae: 1.7804, huber: 1.4114, swd: 1.3116, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 13.0342, mae: 2.0285, huber: 1.6430, swd: 2.2289, target_std: 4.7672
      Epoch 1 composite train-obj: 1.788271
            Val objective improved inf → 1.4114, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6682, mae: 1.6550, huber: 1.2773, swd: 2.0197, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 10.5311, mae: 1.6881, huber: 1.3238, swd: 1.3222, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 12.3165, mae: 1.9369, huber: 1.5566, swd: 2.2025, target_std: 4.7672
      Epoch 2 composite train-obj: 1.277298
            Val objective improved 1.4114 → 1.3238, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3888, mae: 1.6107, huber: 1.2362, swd: 1.9661, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 10.4000, mae: 1.6531, huber: 1.2918, swd: 1.2511, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 12.1123, mae: 1.9016, huber: 1.5240, swd: 2.0796, target_std: 4.7672
      Epoch 3 composite train-obj: 1.236162
            Val objective improved 1.3238 → 1.2918, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.2850, mae: 1.5926, huber: 1.2194, swd: 1.9353, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 10.3198, mae: 1.6424, huber: 1.2822, swd: 1.3153, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.9321, mae: 1.8802, huber: 1.5038, swd: 2.1000, target_std: 4.7672
      Epoch 4 composite train-obj: 1.219430
            Val objective improved 1.2918 → 1.2822, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.2200, mae: 1.5820, huber: 1.2096, swd: 1.9152, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 10.2151, mae: 1.6324, huber: 1.2724, swd: 1.3037, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.8609, mae: 1.8731, huber: 1.4970, swd: 2.0922, target_std: 4.7672
      Epoch 5 composite train-obj: 1.209573
            Val objective improved 1.2822 → 1.2724, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.1875, mae: 1.5762, huber: 1.2042, swd: 1.9085, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 10.1596, mae: 1.6314, huber: 1.2716, swd: 1.3638, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 11.7777, mae: 1.8635, huber: 1.4891, swd: 2.1188, target_std: 4.7672
      Epoch 6 composite train-obj: 1.204241
            Val objective improved 1.2724 → 1.2716, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.1652, mae: 1.5723, huber: 1.2006, swd: 1.9027, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 10.1569, mae: 1.6227, huber: 1.2637, swd: 1.3196, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 11.7577, mae: 1.8579, huber: 1.4829, swd: 2.0602, target_std: 4.7672
      Epoch 7 composite train-obj: 1.200650
            Val objective improved 1.2716 → 1.2637, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 7.1464, mae: 1.5691, huber: 1.1979, swd: 1.8978, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 10.0902, mae: 1.6102, huber: 1.2517, swd: 1.1573, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 11.8387, mae: 1.8624, huber: 1.4871, swd: 1.9533, target_std: 4.7672
      Epoch 8 composite train-obj: 1.197871
            Val objective improved 1.2637 → 1.2517, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 7.1251, mae: 1.5663, huber: 1.1952, swd: 1.8872, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 10.1093, mae: 1.6226, huber: 1.2639, swd: 1.3499, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 11.7115, mae: 1.8537, huber: 1.4793, swd: 2.0685, target_std: 4.7672
      Epoch 9 composite train-obj: 1.195154
            No improvement (1.2639), counter 1/5
    Epoch [10/50], Train Losses: mse: 7.1124, mae: 1.5636, huber: 1.1927, swd: 1.8815, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 10.0351, mae: 1.6096, huber: 1.2518, swd: 1.2295, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 11.7414, mae: 1.8539, huber: 1.4794, swd: 1.9901, target_std: 4.7672
      Epoch 10 composite train-obj: 1.192715
            No improvement (1.2518), counter 2/5
    Epoch [11/50], Train Losses: mse: 7.1008, mae: 1.5615, huber: 1.1908, swd: 1.8760, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 9.9407, mae: 1.6026, huber: 1.2447, swd: 1.2628, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 11.6840, mae: 1.8505, huber: 1.4767, swd: 2.0344, target_std: 4.7672
      Epoch 11 composite train-obj: 1.190838
            Val objective improved 1.2517 → 1.2447, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 7.0932, mae: 1.5603, huber: 1.1898, swd: 1.8761, target_std: 6.4940
    Epoch [12/50], Val Losses: mse: 9.9814, mae: 1.6047, huber: 1.2468, swd: 1.2244, target_std: 4.3003
    Epoch [12/50], Test Losses: mse: 11.6974, mae: 1.8495, huber: 1.4748, swd: 1.9755, target_std: 4.7672
      Epoch 12 composite train-obj: 1.189811
            No improvement (1.2468), counter 1/5
    Epoch [13/50], Train Losses: mse: 7.0747, mae: 1.5579, huber: 1.1874, swd: 1.8665, target_std: 6.4940
    Epoch [13/50], Val Losses: mse: 9.9874, mae: 1.6115, huber: 1.2538, swd: 1.3563, target_std: 4.3003
    Epoch [13/50], Test Losses: mse: 11.5896, mae: 1.8415, huber: 1.4676, swd: 2.0480, target_std: 4.7672
      Epoch 13 composite train-obj: 1.187435
            No improvement (1.2538), counter 2/5
    Epoch [14/50], Train Losses: mse: 7.0840, mae: 1.5590, huber: 1.1885, swd: 1.8680, target_std: 6.4940
    Epoch [14/50], Val Losses: mse: 10.0439, mae: 1.6204, huber: 1.2623, swd: 1.4354, target_std: 4.3003
    Epoch [14/50], Test Losses: mse: 11.5705, mae: 1.8379, huber: 1.4654, swd: 2.0603, target_std: 4.7672
      Epoch 14 composite train-obj: 1.188488
            No improvement (1.2623), counter 3/5
    Epoch [15/50], Train Losses: mse: 7.0689, mae: 1.5570, huber: 1.1866, swd: 1.8652, target_std: 6.4940
    Epoch [15/50], Val Losses: mse: 10.0316, mae: 1.6110, huber: 1.2528, swd: 1.2522, target_std: 4.3003
    Epoch [15/50], Test Losses: mse: 11.6831, mae: 1.8459, huber: 1.4720, swd: 1.9304, target_std: 4.7672
      Epoch 15 composite train-obj: 1.186590
            No improvement (1.2528), counter 4/5
    Epoch [16/50], Train Losses: mse: 7.0657, mae: 1.5568, huber: 1.1864, swd: 1.8589, target_std: 6.4940
    Epoch [16/50], Val Losses: mse: 9.9975, mae: 1.6139, huber: 1.2557, swd: 1.3608, target_std: 4.3003
    Epoch [16/50], Test Losses: mse: 11.6107, mae: 1.8423, huber: 1.4686, swd: 2.0251, target_std: 4.7672
      Epoch 16 composite train-obj: 1.186387
    Epoch [16/50], Test Losses: mse: 11.6840, mae: 1.8505, huber: 1.4767, swd: 2.0344, target_std: 4.7672
    Best round's Test MSE: 11.6840, MAE: 1.8505, SWD: 2.0344
    Best round's Validation MSE: 9.9407, MAE: 1.6026
    Best round's Test verification MSE : 11.6840, MAE: 1.8505, SWD: 2.0344
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 14.7648, mae: 2.1495, huber: 1.7537, swd: 3.3006, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 11.0999, mae: 1.7781, huber: 1.4093, swd: 1.2631, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 13.0170, mae: 2.0291, huber: 1.6441, swd: 2.1193, target_std: 4.7672
      Epoch 1 composite train-obj: 1.753750
            Val objective improved inf → 1.4093, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6706, mae: 1.6548, huber: 1.2771, swd: 2.0122, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 10.5023, mae: 1.6801, huber: 1.3164, swd: 1.2014, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 12.3453, mae: 1.9374, huber: 1.5581, swd: 2.0387, target_std: 4.7672
      Epoch 2 composite train-obj: 1.277133
            Val objective improved 1.4093 → 1.3164, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3999, mae: 1.6116, huber: 1.2371, swd: 1.9643, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 10.2773, mae: 1.6408, huber: 1.2795, swd: 1.1431, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 12.1279, mae: 1.9073, huber: 1.5288, swd: 1.9768, target_std: 4.7672
      Epoch 3 composite train-obj: 1.237074
            Val objective improved 1.3164 → 1.2795, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.2834, mae: 1.5923, huber: 1.2191, swd: 1.9243, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 10.2244, mae: 1.6326, huber: 1.2715, swd: 1.1696, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.9808, mae: 1.8860, huber: 1.5091, swd: 1.9574, target_std: 4.7672
      Epoch 4 composite train-obj: 1.219136
            Val objective improved 1.2795 → 1.2715, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.2239, mae: 1.5822, huber: 1.2098, swd: 1.9064, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 10.1702, mae: 1.6262, huber: 1.2666, swd: 1.2403, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.8749, mae: 1.8743, huber: 1.4981, swd: 1.9708, target_std: 4.7672
      Epoch 5 composite train-obj: 1.209806
            Val objective improved 1.2715 → 1.2666, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.1894, mae: 1.5766, huber: 1.2047, swd: 1.8989, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 10.1256, mae: 1.6165, huber: 1.2579, swd: 1.1820, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 11.8390, mae: 1.8666, huber: 1.4912, swd: 1.9189, target_std: 4.7672
      Epoch 6 composite train-obj: 1.204673
            Val objective improved 1.2666 → 1.2579, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.1574, mae: 1.5715, huber: 1.1999, swd: 1.8899, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 10.0070, mae: 1.6033, huber: 1.2455, swd: 1.1328, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 11.8012, mae: 1.8626, huber: 1.4871, swd: 1.8998, target_std: 4.7672
      Epoch 7 composite train-obj: 1.199933
            Val objective improved 1.2579 → 1.2455, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 7.1393, mae: 1.5685, huber: 1.1972, swd: 1.8833, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 10.0855, mae: 1.6148, huber: 1.2561, swd: 1.2191, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 11.7423, mae: 1.8572, huber: 1.4817, swd: 1.9205, target_std: 4.7672
      Epoch 8 composite train-obj: 1.197186
            No improvement (1.2561), counter 1/5
    Epoch [9/50], Train Losses: mse: 7.1236, mae: 1.5658, huber: 1.1946, swd: 1.8752, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 10.1083, mae: 1.6187, huber: 1.2605, swd: 1.2754, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 11.7204, mae: 1.8522, huber: 1.4780, swd: 1.9181, target_std: 4.7672
      Epoch 9 composite train-obj: 1.194639
            No improvement (1.2605), counter 2/5
    Epoch [10/50], Train Losses: mse: 7.1146, mae: 1.5648, huber: 1.1937, swd: 1.8746, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 10.0273, mae: 1.6102, huber: 1.2524, swd: 1.2133, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 11.7332, mae: 1.8526, huber: 1.4787, swd: 1.8913, target_std: 4.7672
      Epoch 10 composite train-obj: 1.193717
            No improvement (1.2524), counter 3/5
    Epoch [11/50], Train Losses: mse: 7.0950, mae: 1.5614, huber: 1.1907, swd: 1.8638, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 10.1212, mae: 1.6237, huber: 1.2655, swd: 1.3770, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 11.6264, mae: 1.8439, huber: 1.4705, swd: 1.9398, target_std: 4.7672
      Epoch 11 composite train-obj: 1.190667
            No improvement (1.2655), counter 4/5
    Epoch [12/50], Train Losses: mse: 7.0959, mae: 1.5613, huber: 1.1905, swd: 1.8605, target_std: 6.4940
    Epoch [12/50], Val Losses: mse: 9.9870, mae: 1.6157, huber: 1.2571, swd: 1.3370, target_std: 4.3003
    Epoch [12/50], Test Losses: mse: 11.6019, mae: 1.8444, huber: 1.4713, swd: 1.9655, target_std: 4.7672
      Epoch 12 composite train-obj: 1.190543
    Epoch [12/50], Test Losses: mse: 11.8012, mae: 1.8626, huber: 1.4871, swd: 1.8998, target_std: 4.7672
    Best round's Test MSE: 11.8012, MAE: 1.8626, SWD: 1.8998
    Best round's Validation MSE: 10.0070, MAE: 1.6033
    Best round's Test verification MSE : 11.8012, MAE: 1.8626, SWD: 1.8998
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 15.2428, mae: 2.1728, huber: 1.7765, swd: 2.9076, target_std: 6.4940
    Epoch [1/50], Val Losses: mse: 11.0548, mae: 1.7768, huber: 1.4077, swd: 1.2202, target_std: 4.3003
    Epoch [1/50], Test Losses: mse: 13.0129, mae: 2.0270, huber: 1.6425, swd: 2.0697, target_std: 4.7672
      Epoch 1 composite train-obj: 1.776468
            Val objective improved inf → 1.4077, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 7.6688, mae: 1.6545, huber: 1.2769, swd: 1.8105, target_std: 6.4940
    Epoch [2/50], Val Losses: mse: 10.5396, mae: 1.6881, huber: 1.3237, swd: 1.1924, target_std: 4.3003
    Epoch [2/50], Test Losses: mse: 12.3364, mae: 1.9377, huber: 1.5575, swd: 2.0010, target_std: 4.7672
      Epoch 2 composite train-obj: 1.276944
            Val objective improved 1.4077 → 1.3237, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.3896, mae: 1.6104, huber: 1.2359, swd: 1.7601, target_std: 6.4940
    Epoch [3/50], Val Losses: mse: 10.3375, mae: 1.6493, huber: 1.2875, swd: 1.1371, target_std: 4.3003
    Epoch [3/50], Test Losses: mse: 12.0994, mae: 1.9026, huber: 1.5244, swd: 1.9301, target_std: 4.7672
      Epoch 3 composite train-obj: 1.235943
            Val objective improved 1.3237 → 1.2875, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.2795, mae: 1.5920, huber: 1.2188, swd: 1.7331, target_std: 6.4940
    Epoch [4/50], Val Losses: mse: 10.2916, mae: 1.6389, huber: 1.2785, swd: 1.1618, target_std: 4.3003
    Epoch [4/50], Test Losses: mse: 11.9854, mae: 1.8848, huber: 1.5084, swd: 1.8934, target_std: 4.7672
      Epoch 4 composite train-obj: 1.218826
            Val objective improved 1.2875 → 1.2785, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.2277, mae: 1.5827, huber: 1.2104, swd: 1.7210, target_std: 6.4940
    Epoch [5/50], Val Losses: mse: 10.2700, mae: 1.6399, huber: 1.2797, swd: 1.2254, target_std: 4.3003
    Epoch [5/50], Test Losses: mse: 11.8867, mae: 1.8725, huber: 1.4976, swd: 1.9139, target_std: 4.7672
      Epoch 5 composite train-obj: 1.210358
            No improvement (1.2797), counter 1/5
    Epoch [6/50], Train Losses: mse: 7.1784, mae: 1.5749, huber: 1.2031, swd: 1.7057, target_std: 6.4940
    Epoch [6/50], Val Losses: mse: 10.1693, mae: 1.6243, huber: 1.2653, swd: 1.1798, target_std: 4.3003
    Epoch [6/50], Test Losses: mse: 11.8128, mae: 1.8656, huber: 1.4900, swd: 1.8843, target_std: 4.7672
      Epoch 6 composite train-obj: 1.203083
            Val objective improved 1.2785 → 1.2653, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.1484, mae: 1.5703, huber: 1.1989, swd: 1.6983, target_std: 6.4940
    Epoch [7/50], Val Losses: mse: 10.1300, mae: 1.6182, huber: 1.2593, swd: 1.1524, target_std: 4.3003
    Epoch [7/50], Test Losses: mse: 11.8054, mae: 1.8609, huber: 1.4862, swd: 1.8561, target_std: 4.7672
      Epoch 7 composite train-obj: 1.198873
            Val objective improved 1.2653 → 1.2593, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 7.1303, mae: 1.5674, huber: 1.1962, swd: 1.6895, target_std: 6.4940
    Epoch [8/50], Val Losses: mse: 10.0016, mae: 1.6143, huber: 1.2550, swd: 1.1961, target_std: 4.3003
    Epoch [8/50], Test Losses: mse: 11.7292, mae: 1.8594, huber: 1.4843, swd: 1.9260, target_std: 4.7672
      Epoch 8 composite train-obj: 1.196157
            Val objective improved 1.2593 → 1.2550, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 7.1135, mae: 1.5643, huber: 1.1934, swd: 1.6872, target_std: 6.4940
    Epoch [9/50], Val Losses: mse: 10.0556, mae: 1.6136, huber: 1.2558, swd: 1.1946, target_std: 4.3003
    Epoch [9/50], Test Losses: mse: 11.7129, mae: 1.8529, huber: 1.4787, swd: 1.8631, target_std: 4.7672
      Epoch 9 composite train-obj: 1.193392
            No improvement (1.2558), counter 1/5
    Epoch [10/50], Train Losses: mse: 7.1048, mae: 1.5628, huber: 1.1919, swd: 1.6833, target_std: 6.4940
    Epoch [10/50], Val Losses: mse: 10.1219, mae: 1.6239, huber: 1.2655, swd: 1.2931, target_std: 4.3003
    Epoch [10/50], Test Losses: mse: 11.6484, mae: 1.8463, huber: 1.4724, swd: 1.9045, target_std: 4.7672
      Epoch 10 composite train-obj: 1.191946
            No improvement (1.2655), counter 2/5
    Epoch [11/50], Train Losses: mse: 7.1004, mae: 1.5621, huber: 1.1914, swd: 1.6845, target_std: 6.4940
    Epoch [11/50], Val Losses: mse: 9.9797, mae: 1.6002, huber: 1.2426, swd: 1.0408, target_std: 4.3003
    Epoch [11/50], Test Losses: mse: 11.8031, mae: 1.8572, huber: 1.4830, swd: 1.7688, target_std: 4.7672
      Epoch 11 composite train-obj: 1.191370
            Val objective improved 1.2550 → 1.2426, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 7.0938, mae: 1.5608, huber: 1.1902, swd: 1.6753, target_std: 6.4940
    Epoch [12/50], Val Losses: mse: 9.9336, mae: 1.6022, huber: 1.2444, swd: 1.1587, target_std: 4.3003
    Epoch [12/50], Test Losses: mse: 11.6583, mae: 1.8457, huber: 1.4728, swd: 1.8582, target_std: 4.7672
      Epoch 12 composite train-obj: 1.190190
            No improvement (1.2444), counter 1/5
    Epoch [13/50], Train Losses: mse: 7.0837, mae: 1.5589, huber: 1.1885, swd: 1.6755, target_std: 6.4940
    Epoch [13/50], Val Losses: mse: 9.9416, mae: 1.6166, huber: 1.2577, swd: 1.3168, target_std: 4.3003
    Epoch [13/50], Test Losses: mse: 11.5655, mae: 1.8430, huber: 1.4697, swd: 1.9593, target_std: 4.7672
      Epoch 13 composite train-obj: 1.188505
            No improvement (1.2577), counter 2/5
    Epoch [14/50], Train Losses: mse: 7.0782, mae: 1.5585, huber: 1.1879, swd: 1.6756, target_std: 6.4940
    Epoch [14/50], Val Losses: mse: 9.8924, mae: 1.5985, huber: 1.2417, swd: 1.1692, target_std: 4.3003
    Epoch [14/50], Test Losses: mse: 11.6336, mae: 1.8438, huber: 1.4705, swd: 1.8458, target_std: 4.7672
      Epoch 14 composite train-obj: 1.187944
            Val objective improved 1.2426 → 1.2417, saving checkpoint.
    Epoch [15/50], Train Losses: mse: 7.0656, mae: 1.5565, huber: 1.1861, swd: 1.6654, target_std: 6.4940
    Epoch [15/50], Val Losses: mse: 9.9018, mae: 1.6123, huber: 1.2538, swd: 1.2893, target_std: 4.3003
    Epoch [15/50], Test Losses: mse: 11.5917, mae: 1.8445, huber: 1.4714, swd: 1.9513, target_std: 4.7672
      Epoch 15 composite train-obj: 1.186126
            No improvement (1.2538), counter 1/5
    Epoch [16/50], Train Losses: mse: 7.0634, mae: 1.5564, huber: 1.1860, swd: 1.6702, target_std: 6.4940
    Epoch [16/50], Val Losses: mse: 9.9662, mae: 1.6088, huber: 1.2517, swd: 1.2497, target_std: 4.3003
    Epoch [16/50], Test Losses: mse: 11.5966, mae: 1.8406, huber: 1.4673, swd: 1.8575, target_std: 4.7672
      Epoch 16 composite train-obj: 1.185999
            No improvement (1.2517), counter 2/5
    Epoch [17/50], Train Losses: mse: 7.0542, mae: 1.5549, huber: 1.1847, swd: 1.6616, target_std: 6.4940
    Epoch [17/50], Val Losses: mse: 9.8970, mae: 1.6077, huber: 1.2500, swd: 1.2555, target_std: 4.3003
    Epoch [17/50], Test Losses: mse: 11.5695, mae: 1.8414, huber: 1.4676, swd: 1.8960, target_std: 4.7672
      Epoch 17 composite train-obj: 1.184714
            No improvement (1.2500), counter 3/5
    Epoch [18/50], Train Losses: mse: 7.0496, mae: 1.5540, huber: 1.1838, swd: 1.6596, target_std: 6.4940
    Epoch [18/50], Val Losses: mse: 9.9532, mae: 1.6145, huber: 1.2569, swd: 1.3095, target_std: 4.3003
    Epoch [18/50], Test Losses: mse: 11.5405, mae: 1.8362, huber: 1.4637, swd: 1.9047, target_std: 4.7672
      Epoch 18 composite train-obj: 1.183804
            No improvement (1.2569), counter 4/5
    Epoch [19/50], Train Losses: mse: 7.0537, mae: 1.5549, huber: 1.1847, swd: 1.6606, target_std: 6.4940
    Epoch [19/50], Val Losses: mse: 9.9375, mae: 1.6149, huber: 1.2565, swd: 1.2563, target_std: 4.3003
    Epoch [19/50], Test Losses: mse: 11.5921, mae: 1.8421, huber: 1.4690, swd: 1.8732, target_std: 4.7672
      Epoch 19 composite train-obj: 1.184652
    Epoch [19/50], Test Losses: mse: 11.6336, mae: 1.8438, huber: 1.4705, swd: 1.8458, target_std: 4.7672
    Best round's Test MSE: 11.6336, MAE: 1.8438, SWD: 1.8458
    Best round's Validation MSE: 9.8924, MAE: 1.5985
    Best round's Test verification MSE : 11.6336, MAE: 1.8438, SWD: 1.8458
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq96_pred196_20250501_0306)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 11.7063 ± 0.0702
      mae: 1.8523 ± 0.0078
      huber: 1.4781 ± 0.0069
      swd: 1.9267 ± 0.0793
      target_std: 4.7672 ± 0.0000
      count: 12.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.9467 ± 0.0470
      mae: 1.6015 ± 0.0021
      huber: 1.2440 ± 0.0017
      swd: 1.1883 ± 0.0548
      target_std: 4.3003 ± 0.0000
      count: 12.0000 ± 0.0000
    ==================================================
    
    Experiment complete: DLinear_etth1_seq96_pred196_20250501_0306
    Model: DLinear
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 196
    Seeds: [1955, 7, 20]
    

#### pred=336


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=96,
    pred_len=336,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([336, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 92
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 336, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 336
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 92
    Validation Batches: 11
    Test Batches: 24
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 15.4959, mae: 2.2446, huber: 1.8432, swd: 3.3981, target_std: 6.4820
    Epoch [1/50], Val Losses: mse: 12.2474, mae: 1.8563, huber: 1.4846, swd: 1.3933, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 13.0625, mae: 2.0991, huber: 1.7066, swd: 2.2054, target_std: 4.7760
      Epoch 1 composite train-obj: 1.843213
            Val objective improved inf → 1.4846, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.2596, mae: 1.7486, huber: 1.3638, swd: 2.1113, target_std: 6.4822
    Epoch [2/50], Val Losses: mse: 11.6327, mae: 1.7529, huber: 1.3867, swd: 1.2923, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 12.4113, mae: 2.0149, huber: 1.6258, swd: 2.1039, target_std: 4.7760
      Epoch 2 composite train-obj: 1.363837
            Val objective improved 1.4846 → 1.3867, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.9906, mae: 1.7078, huber: 1.3256, swd: 2.0671, target_std: 6.4820
    Epoch [3/50], Val Losses: mse: 11.4546, mae: 1.7218, huber: 1.3583, swd: 1.3368, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 12.1403, mae: 1.9783, huber: 1.5919, swd: 2.1003, target_std: 4.7760
      Epoch 3 composite train-obj: 1.325591
            Val objective improved 1.3867 → 1.3583, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.8782, mae: 1.6900, huber: 1.3090, swd: 2.0377, target_std: 6.4820
    Epoch [4/50], Val Losses: mse: 11.4019, mae: 1.7029, huber: 1.3405, swd: 1.2692, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 12.0362, mae: 1.9598, huber: 1.5751, swd: 2.0148, target_std: 4.7760
      Epoch 4 composite train-obj: 1.308998
            Val objective improved 1.3583 → 1.3405, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.8144, mae: 1.6798, huber: 1.2995, swd: 2.0163, target_std: 6.4821
    Epoch [5/50], Val Losses: mse: 11.3136, mae: 1.6940, huber: 1.3325, swd: 1.2605, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.9788, mae: 1.9517, huber: 1.5674, swd: 1.9808, target_std: 4.7760
      Epoch 5 composite train-obj: 1.299536
            Val objective improved 1.3405 → 1.3325, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.7760, mae: 1.6734, huber: 1.2936, swd: 2.0076, target_std: 6.4820
    Epoch [6/50], Val Losses: mse: 11.2638, mae: 1.6911, huber: 1.3292, swd: 1.2491, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.9347, mae: 1.9460, huber: 1.5622, swd: 1.9589, target_std: 4.7760
      Epoch 6 composite train-obj: 1.293635
            Val objective improved 1.3325 → 1.3292, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.7562, mae: 1.6701, huber: 1.2906, swd: 1.9994, target_std: 6.4821
    Epoch [7/50], Val Losses: mse: 11.2110, mae: 1.6799, huber: 1.3198, swd: 1.2279, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.8707, mae: 1.9362, huber: 1.5526, swd: 1.9177, target_std: 4.7760
      Epoch 7 composite train-obj: 1.290583
            Val objective improved 1.3292 → 1.3198, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 7.7349, mae: 1.6662, huber: 1.2870, swd: 1.9866, target_std: 6.4824
    Epoch [8/50], Val Losses: mse: 11.1211, mae: 1.6867, huber: 1.3255, swd: 1.3874, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.8094, mae: 1.9366, huber: 1.5533, swd: 2.0785, target_std: 4.7760
      Epoch 8 composite train-obj: 1.287015
            No improvement (1.3255), counter 1/5
    Epoch [9/50], Train Losses: mse: 7.7102, mae: 1.6626, huber: 1.2836, swd: 1.9781, target_std: 6.4824
    Epoch [9/50], Val Losses: mse: 11.1051, mae: 1.6751, huber: 1.3157, swd: 1.2801, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.8098, mae: 1.9304, huber: 1.5478, swd: 1.9611, target_std: 4.7760
      Epoch 9 composite train-obj: 1.283594
            Val objective improved 1.3198 → 1.3157, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 7.6826, mae: 1.6589, huber: 1.2802, swd: 1.9628, target_std: 6.4822
    Epoch [10/50], Val Losses: mse: 10.9509, mae: 1.6693, huber: 1.3085, swd: 1.2982, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.8308, mae: 1.9384, huber: 1.5545, swd: 2.0506, target_std: 4.7760
      Epoch 10 composite train-obj: 1.280165
            Val objective improved 1.3157 → 1.3085, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 7.6841, mae: 1.6580, huber: 1.2794, swd: 1.9647, target_std: 6.4824
    Epoch [11/50], Val Losses: mse: 11.0370, mae: 1.6718, huber: 1.3117, swd: 1.2510, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.8185, mae: 1.9306, huber: 1.5477, swd: 1.9217, target_std: 4.7760
      Epoch 11 composite train-obj: 1.279423
            No improvement (1.3117), counter 1/5
    Epoch [12/50], Train Losses: mse: 7.6670, mae: 1.6557, huber: 1.2772, swd: 1.9549, target_std: 6.4824
    Epoch [12/50], Val Losses: mse: 11.1374, mae: 1.6835, huber: 1.3221, swd: 1.3066, target_std: 4.2818
    Epoch [12/50], Test Losses: mse: 11.7453, mae: 1.9239, huber: 1.5410, swd: 1.9216, target_std: 4.7760
      Epoch 12 composite train-obj: 1.277248
            No improvement (1.3221), counter 2/5
    Epoch [13/50], Train Losses: mse: 7.6614, mae: 1.6547, huber: 1.2763, swd: 1.9472, target_std: 6.4821
    Epoch [13/50], Val Losses: mse: 11.0089, mae: 1.6615, huber: 1.3031, swd: 1.1992, target_std: 4.2818
    Epoch [13/50], Test Losses: mse: 11.7690, mae: 1.9206, huber: 1.5386, swd: 1.8768, target_std: 4.7760
      Epoch 13 composite train-obj: 1.276314
            Val objective improved 1.3085 → 1.3031, saving checkpoint.
    Epoch [14/50], Train Losses: mse: 7.6551, mae: 1.6534, huber: 1.2751, swd: 1.9493, target_std: 6.4822
    Epoch [14/50], Val Losses: mse: 10.9468, mae: 1.6693, huber: 1.3095, swd: 1.3118, target_std: 4.2818
    Epoch [14/50], Test Losses: mse: 11.7380, mae: 1.9213, huber: 1.5389, swd: 1.9455, target_std: 4.7760
      Epoch 14 composite train-obj: 1.275137
            No improvement (1.3095), counter 1/5
    Epoch [15/50], Train Losses: mse: 7.6525, mae: 1.6525, huber: 1.2744, swd: 1.9411, target_std: 6.4821
    Epoch [15/50], Val Losses: mse: 10.9799, mae: 1.6846, huber: 1.3229, swd: 1.4339, target_std: 4.2818
    Epoch [15/50], Test Losses: mse: 11.7046, mae: 1.9233, huber: 1.5409, swd: 2.0363, target_std: 4.7760
      Epoch 15 composite train-obj: 1.274420
            No improvement (1.3229), counter 2/5
    Epoch [16/50], Train Losses: mse: 7.6444, mae: 1.6513, huber: 1.2731, swd: 1.9396, target_std: 6.4820
    Epoch [16/50], Val Losses: mse: 11.0576, mae: 1.6835, huber: 1.3211, swd: 1.2805, target_std: 4.2818
    Epoch [16/50], Test Losses: mse: 11.7545, mae: 1.9247, huber: 1.5410, swd: 1.8741, target_std: 4.7760
      Epoch 16 composite train-obj: 1.273102
            No improvement (1.3211), counter 3/5
    Epoch [17/50], Train Losses: mse: 7.6446, mae: 1.6512, huber: 1.2731, swd: 1.9364, target_std: 6.4820
    Epoch [17/50], Val Losses: mse: 10.9334, mae: 1.6713, huber: 1.3110, swd: 1.3161, target_std: 4.2818
    Epoch [17/50], Test Losses: mse: 11.7287, mae: 1.9217, huber: 1.5386, swd: 1.9253, target_std: 4.7760
      Epoch 17 composite train-obj: 1.273066
            No improvement (1.3110), counter 4/5
    Epoch [18/50], Train Losses: mse: 7.6299, mae: 1.6492, huber: 1.2712, swd: 1.9230, target_std: 6.4824
    Epoch [18/50], Val Losses: mse: 11.0218, mae: 1.6837, huber: 1.3218, swd: 1.3976, target_std: 4.2818
    Epoch [18/50], Test Losses: mse: 11.6733, mae: 1.9209, huber: 1.5376, swd: 1.9746, target_std: 4.7760
      Epoch 18 composite train-obj: 1.271223
    Epoch [18/50], Test Losses: mse: 11.7690, mae: 1.9206, huber: 1.5386, swd: 1.8768, target_std: 4.7760
    Best round's Test MSE: 11.7690, MAE: 1.9206, SWD: 1.8768
    Best round's Validation MSE: 11.0089, MAE: 1.6615
    Best round's Test verification MSE : 11.7690, MAE: 1.9206, SWD: 1.8768
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 15.5101, mae: 2.2319, huber: 1.8309, swd: 3.3841, target_std: 6.4822
    Epoch [1/50], Val Losses: mse: 12.2084, mae: 1.8500, huber: 1.4785, swd: 1.3567, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 13.0604, mae: 2.0957, huber: 1.7029, swd: 2.1276, target_std: 4.7760
      Epoch 1 composite train-obj: 1.830933
            Val objective improved inf → 1.4785, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.2482, mae: 1.7465, huber: 1.3617, swd: 2.1562, target_std: 6.4827
    Epoch [2/50], Val Losses: mse: 11.5937, mae: 1.7543, huber: 1.3876, swd: 1.3496, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 12.3961, mae: 2.0136, huber: 1.6249, swd: 2.1030, target_std: 4.7760
      Epoch 2 composite train-obj: 1.361710
            Val objective improved 1.4785 → 1.3876, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.9806, mae: 1.7063, huber: 1.3242, swd: 2.1052, target_std: 6.4823
    Epoch [3/50], Val Losses: mse: 11.4399, mae: 1.7136, huber: 1.3504, swd: 1.2758, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 12.1585, mae: 1.9776, huber: 1.5914, swd: 2.0069, target_std: 4.7760
      Epoch 3 composite train-obj: 1.324220
            Val objective improved 1.3876 → 1.3504, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.8747, mae: 1.6893, huber: 1.3083, swd: 2.0732, target_std: 6.4826
    Epoch [4/50], Val Losses: mse: 11.2844, mae: 1.6957, huber: 1.3342, swd: 1.3153, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 12.0254, mae: 1.9618, huber: 1.5771, swd: 2.0330, target_std: 4.7760
      Epoch 4 composite train-obj: 1.308296
            Val objective improved 1.3504 → 1.3342, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.8215, mae: 1.6805, huber: 1.3003, swd: 2.0620, target_std: 6.4826
    Epoch [5/50], Val Losses: mse: 11.2498, mae: 1.6879, huber: 1.3271, swd: 1.2868, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.9617, mae: 1.9516, huber: 1.5664, swd: 1.9498, target_std: 4.7760
      Epoch 5 composite train-obj: 1.300253
            Val objective improved 1.3342 → 1.3271, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.7706, mae: 1.6731, huber: 1.2933, swd: 2.0374, target_std: 6.4820
    Epoch [6/50], Val Losses: mse: 11.2534, mae: 1.6859, huber: 1.3245, swd: 1.2341, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.9643, mae: 1.9467, huber: 1.5629, swd: 1.8962, target_std: 4.7760
      Epoch 6 composite train-obj: 1.293314
            Val objective improved 1.3271 → 1.3245, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.7423, mae: 1.6682, huber: 1.2889, swd: 2.0287, target_std: 6.4823
    Epoch [7/50], Val Losses: mse: 11.1690, mae: 1.6763, huber: 1.3162, swd: 1.2424, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.8947, mae: 1.9386, huber: 1.5553, swd: 1.8914, target_std: 4.7760
      Epoch 7 composite train-obj: 1.288853
            Val objective improved 1.3245 → 1.3162, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 7.7338, mae: 1.6664, huber: 1.2871, swd: 2.0252, target_std: 6.4821
    Epoch [8/50], Val Losses: mse: 11.0530, mae: 1.6745, huber: 1.3142, swd: 1.3197, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.8618, mae: 1.9380, huber: 1.5552, swd: 1.9692, target_std: 4.7760
      Epoch 8 composite train-obj: 1.287086
            Val objective improved 1.3162 → 1.3142, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 7.7055, mae: 1.6619, huber: 1.2830, swd: 2.0093, target_std: 6.4822
    Epoch [9/50], Val Losses: mse: 11.0815, mae: 1.6795, huber: 1.3183, swd: 1.2969, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.8330, mae: 1.9355, huber: 1.5525, swd: 1.9264, target_std: 4.7760
      Epoch 9 composite train-obj: 1.282989
            No improvement (1.3183), counter 1/5
    Epoch [10/50], Train Losses: mse: 7.6851, mae: 1.6589, huber: 1.2802, swd: 2.0009, target_std: 6.4819
    Epoch [10/50], Val Losses: mse: 11.0294, mae: 1.6753, huber: 1.3140, swd: 1.3118, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.8100, mae: 1.9357, huber: 1.5520, swd: 1.9512, target_std: 4.7760
      Epoch 10 composite train-obj: 1.280250
            Val objective improved 1.3142 → 1.3140, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 7.6823, mae: 1.6581, huber: 1.2795, swd: 1.9989, target_std: 6.4821
    Epoch [11/50], Val Losses: mse: 10.9717, mae: 1.6647, huber: 1.3040, swd: 1.2344, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.8474, mae: 1.9331, huber: 1.5500, swd: 1.8664, target_std: 4.7760
      Epoch 11 composite train-obj: 1.279516
            Val objective improved 1.3140 → 1.3040, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 7.6801, mae: 1.6574, huber: 1.2788, swd: 1.9998, target_std: 6.4826
    Epoch [12/50], Val Losses: mse: 11.0750, mae: 1.6661, huber: 1.3074, swd: 1.1934, target_std: 4.2818
    Epoch [12/50], Test Losses: mse: 11.8083, mae: 1.9218, huber: 1.5402, swd: 1.7657, target_std: 4.7760
      Epoch 12 composite train-obj: 1.278786
            No improvement (1.3074), counter 1/5
    Epoch [13/50], Train Losses: mse: 7.6686, mae: 1.6554, huber: 1.2770, swd: 1.9858, target_std: 6.4823
    Epoch [13/50], Val Losses: mse: 10.8737, mae: 1.6651, huber: 1.3043, swd: 1.3127, target_std: 4.2818
    Epoch [13/50], Test Losses: mse: 11.7893, mae: 1.9288, huber: 1.5462, swd: 1.9355, target_std: 4.7760
      Epoch 13 composite train-obj: 1.276998
            No improvement (1.3043), counter 2/5
    Epoch [14/50], Train Losses: mse: 7.6549, mae: 1.6532, huber: 1.2750, swd: 1.9787, target_std: 6.4823
    Epoch [14/50], Val Losses: mse: 10.8608, mae: 1.6648, huber: 1.3056, swd: 1.3843, target_std: 4.2818
    Epoch [14/50], Test Losses: mse: 11.7390, mae: 1.9252, huber: 1.5424, swd: 1.9690, target_std: 4.7760
      Epoch 14 composite train-obj: 1.275005
            No improvement (1.3056), counter 3/5
    Epoch [15/50], Train Losses: mse: 7.6548, mae: 1.6529, huber: 1.2747, swd: 1.9851, target_std: 6.4823
    Epoch [15/50], Val Losses: mse: 11.0235, mae: 1.6768, huber: 1.3171, swd: 1.4139, target_std: 4.2818
    Epoch [15/50], Test Losses: mse: 11.6593, mae: 1.9167, huber: 1.5341, swd: 1.9141, target_std: 4.7760
      Epoch 15 composite train-obj: 1.274696
            No improvement (1.3171), counter 4/5
    Epoch [16/50], Train Losses: mse: 7.6375, mae: 1.6508, huber: 1.2727, swd: 1.9695, target_std: 6.4825
    Epoch [16/50], Val Losses: mse: 10.9295, mae: 1.6660, huber: 1.3061, swd: 1.2749, target_std: 4.2818
    Epoch [16/50], Test Losses: mse: 11.7644, mae: 1.9233, huber: 1.5405, swd: 1.8423, target_std: 4.7760
      Epoch 16 composite train-obj: 1.272713
    Epoch [16/50], Test Losses: mse: 11.8474, mae: 1.9331, huber: 1.5500, swd: 1.8664, target_std: 4.7760
    Best round's Test MSE: 11.8474, MAE: 1.9331, SWD: 1.8664
    Best round's Validation MSE: 10.9717, MAE: 1.6647
    Best round's Test verification MSE : 11.8474, MAE: 1.9331, SWD: 1.8664
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 15.3151, mae: 2.2335, huber: 1.8323, swd: 3.3914, target_std: 6.4826
    Epoch [1/50], Val Losses: mse: 12.2183, mae: 1.8488, huber: 1.4778, swd: 1.3425, target_std: 4.2818
    Epoch [1/50], Test Losses: mse: 13.0574, mae: 2.0954, huber: 1.7029, swd: 2.1609, target_std: 4.7760
      Epoch 1 composite train-obj: 1.832323
            Val objective improved inf → 1.4778, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 8.2370, mae: 1.7462, huber: 1.3614, swd: 2.0670, target_std: 6.4823
    Epoch [2/50], Val Losses: mse: 11.5792, mae: 1.7479, huber: 1.3820, swd: 1.2985, target_std: 4.2818
    Epoch [2/50], Test Losses: mse: 12.4171, mae: 2.0138, huber: 1.6255, swd: 2.1246, target_std: 4.7760
      Epoch 2 composite train-obj: 1.361441
            Val objective improved 1.4778 → 1.3820, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 7.9866, mae: 1.7074, huber: 1.3253, swd: 2.0290, target_std: 6.4824
    Epoch [3/50], Val Losses: mse: 11.4209, mae: 1.7204, huber: 1.3556, swd: 1.3366, target_std: 4.2818
    Epoch [3/50], Test Losses: mse: 12.1783, mae: 1.9861, huber: 1.5986, swd: 2.1334, target_std: 4.7760
      Epoch 3 composite train-obj: 1.325268
            Val objective improved 1.3820 → 1.3556, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 7.8699, mae: 1.6893, huber: 1.3083, swd: 1.9977, target_std: 6.4821
    Epoch [4/50], Val Losses: mse: 11.3922, mae: 1.7089, huber: 1.3461, swd: 1.3861, target_std: 4.2818
    Epoch [4/50], Test Losses: mse: 12.0046, mae: 1.9630, huber: 1.5771, swd: 2.1056, target_std: 4.7760
      Epoch 4 composite train-obj: 1.308297
            Val objective improved 1.3556 → 1.3461, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 7.8117, mae: 1.6797, huber: 1.2994, swd: 1.9780, target_std: 6.4824
    Epoch [5/50], Val Losses: mse: 11.2878, mae: 1.6933, huber: 1.3315, swd: 1.3512, target_std: 4.2818
    Epoch [5/50], Test Losses: mse: 11.9329, mae: 1.9513, huber: 1.5674, swd: 2.0866, target_std: 4.7760
      Epoch 5 composite train-obj: 1.299387
            Val objective improved 1.3461 → 1.3315, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 7.7753, mae: 1.6737, huber: 1.2938, swd: 1.9687, target_std: 6.4822
    Epoch [6/50], Val Losses: mse: 11.2517, mae: 1.6896, huber: 1.3282, swd: 1.2815, target_std: 4.2818
    Epoch [6/50], Test Losses: mse: 11.9295, mae: 1.9477, huber: 1.5624, swd: 1.9809, target_std: 4.7760
      Epoch 6 composite train-obj: 1.293842
            Val objective improved 1.3315 → 1.3282, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 7.7429, mae: 1.6687, huber: 1.2892, swd: 1.9522, target_std: 6.4824
    Epoch [7/50], Val Losses: mse: 11.1728, mae: 1.6753, huber: 1.3157, swd: 1.2662, target_std: 4.2818
    Epoch [7/50], Test Losses: mse: 11.9080, mae: 1.9398, huber: 1.5560, swd: 1.9528, target_std: 4.7760
      Epoch 7 composite train-obj: 1.289178
            Val objective improved 1.3282 → 1.3157, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 7.7218, mae: 1.6650, huber: 1.2858, swd: 1.9448, target_std: 6.4822
    Epoch [8/50], Val Losses: mse: 11.2311, mae: 1.6826, huber: 1.3220, swd: 1.3006, target_std: 4.2818
    Epoch [8/50], Test Losses: mse: 11.8509, mae: 1.9349, huber: 1.5508, swd: 1.9570, target_std: 4.7760
      Epoch 8 composite train-obj: 1.285800
            No improvement (1.3220), counter 1/5
    Epoch [9/50], Train Losses: mse: 7.7030, mae: 1.6618, huber: 1.2829, swd: 1.9346, target_std: 6.4819
    Epoch [9/50], Val Losses: mse: 11.0795, mae: 1.6845, huber: 1.3227, swd: 1.3739, target_std: 4.2818
    Epoch [9/50], Test Losses: mse: 11.8045, mae: 1.9363, huber: 1.5521, swd: 2.0427, target_std: 4.7760
      Epoch 9 composite train-obj: 1.282857
            No improvement (1.3227), counter 2/5
    Epoch [10/50], Train Losses: mse: 7.6914, mae: 1.6597, huber: 1.2810, swd: 1.9297, target_std: 6.4825
    Epoch [10/50], Val Losses: mse: 11.0974, mae: 1.6747, huber: 1.3149, swd: 1.3480, target_std: 4.2818
    Epoch [10/50], Test Losses: mse: 11.7878, mae: 1.9313, huber: 1.5482, swd: 2.0179, target_std: 4.7760
      Epoch 10 composite train-obj: 1.281030
            Val objective improved 1.3157 → 1.3149, saving checkpoint.
    Epoch [11/50], Train Losses: mse: 7.6771, mae: 1.6574, huber: 1.2788, swd: 1.9240, target_std: 6.4822
    Epoch [11/50], Val Losses: mse: 10.9900, mae: 1.6632, huber: 1.3040, swd: 1.2454, target_std: 4.2818
    Epoch [11/50], Test Losses: mse: 11.8245, mae: 1.9307, huber: 1.5469, swd: 1.9249, target_std: 4.7760
      Epoch 11 composite train-obj: 1.278844
            Val objective improved 1.3149 → 1.3040, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 7.6754, mae: 1.6567, huber: 1.2781, swd: 1.9193, target_std: 6.4821
    Epoch [12/50], Val Losses: mse: 11.0213, mae: 1.6843, huber: 1.3226, swd: 1.4910, target_std: 4.2818
    Epoch [12/50], Test Losses: mse: 11.7014, mae: 1.9271, huber: 1.5438, swd: 2.1201, target_std: 4.7760
      Epoch 12 composite train-obj: 1.278124
            No improvement (1.3226), counter 1/5
    Epoch [13/50], Train Losses: mse: 7.6627, mae: 1.6553, huber: 1.2768, swd: 1.9199, target_std: 6.4824
    Epoch [13/50], Val Losses: mse: 11.0239, mae: 1.6657, huber: 1.3067, swd: 1.2203, target_std: 4.2818
    Epoch [13/50], Test Losses: mse: 11.8068, mae: 1.9241, huber: 1.5417, swd: 1.8724, target_std: 4.7760
      Epoch 13 composite train-obj: 1.276795
            No improvement (1.3067), counter 2/5
    Epoch [14/50], Train Losses: mse: 7.6512, mae: 1.6534, huber: 1.2751, swd: 1.9070, target_std: 6.4824
    Epoch [14/50], Val Losses: mse: 11.0316, mae: 1.6648, huber: 1.3051, swd: 1.2435, target_std: 4.2818
    Epoch [14/50], Test Losses: mse: 11.7762, mae: 1.9248, huber: 1.5409, swd: 1.8750, target_std: 4.7760
      Epoch 14 composite train-obj: 1.275052
            No improvement (1.3051), counter 3/5
    Epoch [15/50], Train Losses: mse: 7.6497, mae: 1.6526, huber: 1.2744, swd: 1.9043, target_std: 6.4825
    Epoch [15/50], Val Losses: mse: 10.9501, mae: 1.6718, huber: 1.3111, swd: 1.3040, target_std: 4.2818
    Epoch [15/50], Test Losses: mse: 11.7958, mae: 1.9277, huber: 1.5452, swd: 1.9428, target_std: 4.7760
      Epoch 15 composite train-obj: 1.274386
            No improvement (1.3111), counter 4/5
    Epoch [16/50], Train Losses: mse: 7.6462, mae: 1.6517, huber: 1.2736, swd: 1.9036, target_std: 6.4824
    Epoch [16/50], Val Losses: mse: 10.9559, mae: 1.6639, huber: 1.3051, swd: 1.3513, target_std: 4.2818
    Epoch [16/50], Test Losses: mse: 11.6910, mae: 1.9145, huber: 1.5335, swd: 1.9510, target_std: 4.7760
      Epoch 16 composite train-obj: 1.273559
    Epoch [16/50], Test Losses: mse: 11.8245, mae: 1.9307, huber: 1.5469, swd: 1.9249, target_std: 4.7760
    Best round's Test MSE: 11.8245, MAE: 1.9307, SWD: 1.9249
    Best round's Validation MSE: 10.9900, MAE: 1.6632
    Best round's Test verification MSE : 11.8245, MAE: 1.9307, SWD: 1.9249
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq96_pred336_20250501_0307)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 11.8136 ± 0.0329
      mae: 1.9281 ± 0.0054
      huber: 1.5452 ± 0.0048
      swd: 1.8894 ± 0.0255
      target_std: 4.7760 ± 0.0000
      count: 11.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 10.9902 ± 0.0152
      mae: 1.6632 ± 0.0013
      huber: 1.3037 ± 0.0004
      swd: 1.2263 ± 0.0197
      target_std: 4.2818 ± 0.0000
      count: 11.0000 ± 0.0000
    ==================================================
    
    Experiment complete: DLinear_etth1_seq96_pred336_20250501_0307
    Model: DLinear
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 336
    Seeds: [1955, 7, 20]
    

#### pred=720


```python
importlib.reload(monotonic)
importlib.reload(train_config)
utils.reload_modules([utils])
cfg = train_config.FlatDLinearConfig(
    seq_len=96,
    pred_len=720,
    channels=data_mgr.datasets['etth1']['channels'],
    batch_size=128,
    learning_rate=9e-4,
    seeds=[1955, 7, 20],
    epochs=50, 
)
exp = execute_model_evaluation('etth1', cfg, data_mgr, scale=False)
```

    Reloading modules...
      Reloaded: utils
    Module reload complete.
    Shape of training data: torch.Size([12194, 7])
    Shape of validation data: torch.Size([1742, 7])
    Shape of testing data: torch.Size([3484, 7])
    Train set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Validation set sample shapes: torch.Size([96, 7]), torch.Size([720, 7])
    Test set data shapes: torch.Size([3484, 7]), torch.Size([3484, 7])
    Number of batches in train_loader: 89
    Batch 0: Data shape torch.Size([128, 96, 7]), Target shape torch.Size([128, 720, 7])
    
    ==================================================
    Data Preparation: etth1
    ==================================================
    Sequence Length: 96
    Prediction Length: 720
    Batch Size: 128
    Scaling: No
    Train Split: 0.7
    Val Split: 0.8
    Training Batches: 89
    Validation Batches: 8
    Test Batches: 21
    ==================================================
    
    ==================================================
     Running experiment with seed 1955 (1/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.8221, mae: 2.3950, huber: 1.9833, swd: 3.7681, target_std: 6.4167
    Epoch [1/50], Val Losses: mse: 10.9154, mae: 1.8074, huber: 1.4325, swd: 1.3874, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 14.6625, mae: 2.3485, huber: 1.9367, swd: 2.8739, target_std: 4.8130
      Epoch 1 composite train-obj: 1.983294
            Val objective improved inf → 1.4325, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.4009, mae: 1.9210, huber: 1.5226, swd: 2.6939, target_std: 6.4168
    Epoch [2/50], Val Losses: mse: 10.3860, mae: 1.7215, huber: 1.3519, swd: 1.3379, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 13.9223, mae: 2.2629, huber: 1.8562, swd: 2.8070, target_std: 4.8130
      Epoch 2 composite train-obj: 1.522641
            Val objective improved 1.4325 → 1.3519, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.1423, mae: 1.8842, huber: 1.4883, swd: 2.6573, target_std: 6.4166
    Epoch [3/50], Val Losses: mse: 10.1788, mae: 1.6967, huber: 1.3270, swd: 1.3874, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 13.6547, mae: 2.2333, huber: 1.8282, swd: 2.8791, target_std: 4.8130
      Epoch 3 composite train-obj: 1.488304
            Val objective improved 1.3519 → 1.3270, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 9.0122, mae: 1.8651, huber: 1.4706, swd: 2.6176, target_std: 6.4167
    Epoch [4/50], Val Losses: mse: 10.0953, mae: 1.6759, huber: 1.3084, swd: 1.3160, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 13.5158, mae: 2.2128, huber: 1.8098, swd: 2.7608, target_std: 4.8130
      Epoch 4 composite train-obj: 1.470588
            Val objective improved 1.3270 → 1.3084, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 8.9392, mae: 1.8541, huber: 1.4605, swd: 2.5874, target_std: 6.4172
    Epoch [5/50], Val Losses: mse: 10.0600, mae: 1.6775, huber: 1.3087, swd: 1.3399, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 13.4062, mae: 2.2010, huber: 1.7972, swd: 2.7446, target_std: 4.8130
      Epoch 5 composite train-obj: 1.460514
            No improvement (1.3087), counter 1/5
    Epoch [6/50], Train Losses: mse: 8.8971, mae: 1.8464, huber: 1.4535, swd: 2.5658, target_std: 6.4166
    Epoch [6/50], Val Losses: mse: 10.0458, mae: 1.6689, huber: 1.3031, swd: 1.3720, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 13.2828, mae: 2.1866, huber: 1.7845, swd: 2.6907, target_std: 4.8130
      Epoch 6 composite train-obj: 1.453465
            Val objective improved 1.3084 → 1.3031, saving checkpoint.
    Epoch [7/50], Train Losses: mse: 8.8580, mae: 1.8406, huber: 1.4482, swd: 2.5445, target_std: 6.4168
    Epoch [7/50], Val Losses: mse: 9.9587, mae: 1.6567, huber: 1.2912, swd: 1.2907, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 13.2434, mae: 2.1780, huber: 1.7754, swd: 2.5666, target_std: 4.8130
      Epoch 7 composite train-obj: 1.448173
            Val objective improved 1.3031 → 1.2912, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 8.8365, mae: 1.8372, huber: 1.4451, swd: 2.5331, target_std: 6.4169
    Epoch [8/50], Val Losses: mse: 9.9911, mae: 1.6762, huber: 1.3074, swd: 1.3908, target_std: 4.3000
    Epoch [8/50], Test Losses: mse: 13.1862, mae: 2.1830, huber: 1.7786, swd: 2.6723, target_std: 4.8130
      Epoch 8 composite train-obj: 1.445071
            No improvement (1.3074), counter 1/5
    Epoch [9/50], Train Losses: mse: 8.7994, mae: 1.8319, huber: 1.4403, swd: 2.5014, target_std: 6.4169
    Epoch [9/50], Val Losses: mse: 9.9776, mae: 1.6719, huber: 1.3041, swd: 1.4062, target_std: 4.3000
    Epoch [9/50], Test Losses: mse: 13.1061, mae: 2.1643, huber: 1.7618, swd: 2.5465, target_std: 4.8130
      Epoch 9 composite train-obj: 1.440257
            No improvement (1.3041), counter 2/5
    Epoch [10/50], Train Losses: mse: 8.7841, mae: 1.8290, huber: 1.4376, swd: 2.4923, target_std: 6.4168
    Epoch [10/50], Val Losses: mse: 9.8533, mae: 1.6651, huber: 1.2985, swd: 1.4434, target_std: 4.3000
    Epoch [10/50], Test Losses: mse: 13.0950, mae: 2.1608, huber: 1.7608, swd: 2.6375, target_std: 4.8130
      Epoch 10 composite train-obj: 1.437574
            No improvement (1.2985), counter 3/5
    Epoch [11/50], Train Losses: mse: 8.7682, mae: 1.8261, huber: 1.4349, swd: 2.4838, target_std: 6.4167
    Epoch [11/50], Val Losses: mse: 9.8656, mae: 1.6580, huber: 1.2931, swd: 1.4234, target_std: 4.3000
    Epoch [11/50], Test Losses: mse: 13.0564, mae: 2.1576, huber: 1.7588, swd: 2.5998, target_std: 4.8130
      Epoch 11 composite train-obj: 1.434928
            No improvement (1.2931), counter 4/5
    Epoch [12/50], Train Losses: mse: 8.7496, mae: 1.8234, huber: 1.4324, swd: 2.4658, target_std: 6.4170
    Epoch [12/50], Val Losses: mse: 9.9998, mae: 1.6835, huber: 1.3153, swd: 1.5289, target_std: 4.3000
    Epoch [12/50], Test Losses: mse: 12.9963, mae: 2.1562, huber: 1.7559, swd: 2.6091, target_std: 4.8130
      Epoch 12 composite train-obj: 1.432374
    Epoch [12/50], Test Losses: mse: 13.2434, mae: 2.1780, huber: 1.7754, swd: 2.5666, target_std: 4.8130
    Best round's Test MSE: 13.2434, MAE: 2.1780, SWD: 2.5666
    Best round's Validation MSE: 9.9587, MAE: 1.6567
    Best round's Test verification MSE : 13.2434, MAE: 2.1780, SWD: 2.5666
    
    ==================================================
     Running experiment with seed 7 (2/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.4637, mae: 2.3805, huber: 1.9685, swd: 3.3985, target_std: 6.4169
    Epoch [1/50], Val Losses: mse: 10.9431, mae: 1.8016, huber: 1.4282, swd: 1.2823, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 14.6659, mae: 2.3517, huber: 1.9399, swd: 2.7832, target_std: 4.8130
      Epoch 1 composite train-obj: 1.968523
            Val objective improved inf → 1.4282, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.4013, mae: 1.9212, huber: 1.5229, swd: 2.5309, target_std: 6.4168
    Epoch [2/50], Val Losses: mse: 10.4174, mae: 1.7354, huber: 1.3643, swd: 1.3872, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 13.8991, mae: 2.2694, huber: 1.8618, swd: 2.8504, target_std: 4.8130
      Epoch 2 composite train-obj: 1.522870
            Val objective improved 1.4282 → 1.3643, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.1352, mae: 1.8838, huber: 1.4879, swd: 2.4963, target_std: 6.4170
    Epoch [3/50], Val Losses: mse: 10.1254, mae: 1.6880, huber: 1.3198, swd: 1.2672, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 13.6610, mae: 2.2335, huber: 1.8294, swd: 2.7450, target_std: 4.8130
      Epoch 3 composite train-obj: 1.487932
            Val objective improved 1.3643 → 1.3198, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 9.0212, mae: 1.8661, huber: 1.4715, swd: 2.4645, target_std: 6.4171
    Epoch [4/50], Val Losses: mse: 10.0180, mae: 1.6652, huber: 1.2987, swd: 1.2085, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 13.5114, mae: 2.2130, huber: 1.8086, swd: 2.6359, target_std: 4.8130
      Epoch 4 composite train-obj: 1.471504
            Val objective improved 1.3198 → 1.2987, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 8.9421, mae: 1.8543, huber: 1.4606, swd: 2.4337, target_std: 6.4172
    Epoch [5/50], Val Losses: mse: 10.0414, mae: 1.6620, huber: 1.2966, swd: 1.1866, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 13.3592, mae: 2.1940, huber: 1.7905, swd: 2.5479, target_std: 4.8130
      Epoch 5 composite train-obj: 1.460594
            Val objective improved 1.2987 → 1.2966, saving checkpoint.
    Epoch [6/50], Train Losses: mse: 8.8951, mae: 1.8465, huber: 1.4535, swd: 2.4062, target_std: 6.4169
    Epoch [6/50], Val Losses: mse: 9.9487, mae: 1.6640, huber: 1.2980, swd: 1.2518, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 13.2958, mae: 2.1875, huber: 1.7845, swd: 2.5730, target_std: 4.8130
      Epoch 6 composite train-obj: 1.453511
            No improvement (1.2980), counter 1/5
    Epoch [7/50], Train Losses: mse: 8.8570, mae: 1.8404, huber: 1.4480, swd: 2.3871, target_std: 6.4167
    Epoch [7/50], Val Losses: mse: 10.1450, mae: 1.6887, huber: 1.3216, swd: 1.4336, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 13.2444, mae: 2.1869, huber: 1.7872, swd: 2.7511, target_std: 4.8130
      Epoch 7 composite train-obj: 1.447951
            No improvement (1.3216), counter 2/5
    Epoch [8/50], Train Losses: mse: 8.8278, mae: 1.8362, huber: 1.4441, swd: 2.3836, target_std: 6.4170
    Epoch [8/50], Val Losses: mse: 10.0383, mae: 1.6794, huber: 1.3127, swd: 1.3814, target_std: 4.3000
    Epoch [8/50], Test Losses: mse: 13.1209, mae: 2.1686, huber: 1.7669, swd: 2.5544, target_std: 4.8130
      Epoch 8 composite train-obj: 1.444102
            No improvement (1.3127), counter 3/5
    Epoch [9/50], Train Losses: mse: 8.8016, mae: 1.8320, huber: 1.4404, swd: 2.3632, target_std: 6.4169
    Epoch [9/50], Val Losses: mse: 9.9904, mae: 1.6546, huber: 1.2910, swd: 1.2217, target_std: 4.3000
    Epoch [9/50], Test Losses: mse: 13.1279, mae: 2.1630, huber: 1.7619, swd: 2.3925, target_std: 4.8130
      Epoch 9 composite train-obj: 1.440374
            Val objective improved 1.2966 → 1.2910, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 8.7808, mae: 1.8283, huber: 1.4370, swd: 2.3460, target_std: 6.4167
    Epoch [10/50], Val Losses: mse: 9.8720, mae: 1.6660, huber: 1.2965, swd: 1.2762, target_std: 4.3000
    Epoch [10/50], Test Losses: mse: 13.0934, mae: 2.1616, huber: 1.7578, swd: 2.4633, target_std: 4.8130
      Epoch 10 composite train-obj: 1.436995
            No improvement (1.2965), counter 1/5
    Epoch [11/50], Train Losses: mse: 8.7578, mae: 1.8258, huber: 1.4345, swd: 2.3331, target_std: 6.4171
    Epoch [11/50], Val Losses: mse: 10.0158, mae: 1.6728, huber: 1.3084, swd: 1.3675, target_std: 4.3000
    Epoch [11/50], Test Losses: mse: 12.9937, mae: 2.1484, huber: 1.7503, swd: 2.4568, target_std: 4.8130
      Epoch 11 composite train-obj: 1.434476
            No improvement (1.3084), counter 2/5
    Epoch [12/50], Train Losses: mse: 8.7438, mae: 1.8229, huber: 1.4319, swd: 2.3230, target_std: 6.4170
    Epoch [12/50], Val Losses: mse: 9.8581, mae: 1.6540, huber: 1.2899, swd: 1.2368, target_std: 4.3000
    Epoch [12/50], Test Losses: mse: 13.0597, mae: 2.1503, huber: 1.7521, swd: 2.3894, target_std: 4.8130
      Epoch 12 composite train-obj: 1.431882
            Val objective improved 1.2910 → 1.2899, saving checkpoint.
    Epoch [13/50], Train Losses: mse: 8.7388, mae: 1.8213, huber: 1.4305, swd: 2.3118, target_std: 6.4165
    Epoch [13/50], Val Losses: mse: 9.8218, mae: 1.6622, huber: 1.2946, swd: 1.3325, target_std: 4.3000
    Epoch [13/50], Test Losses: mse: 13.0463, mae: 2.1563, huber: 1.7539, swd: 2.4634, target_std: 4.8130
      Epoch 13 composite train-obj: 1.430484
            No improvement (1.2946), counter 1/5
    Epoch [14/50], Train Losses: mse: 8.7247, mae: 1.8192, huber: 1.4284, swd: 2.3060, target_std: 6.4171
    Epoch [14/50], Val Losses: mse: 9.9555, mae: 1.6869, huber: 1.3184, swd: 1.3979, target_std: 4.3000
    Epoch [14/50], Test Losses: mse: 12.9524, mae: 2.1419, huber: 1.7435, swd: 2.4117, target_std: 4.8130
      Epoch 14 composite train-obj: 1.428423
            No improvement (1.3184), counter 2/5
    Epoch [15/50], Train Losses: mse: 8.7121, mae: 1.8171, huber: 1.4266, swd: 2.2888, target_std: 6.4167
    Epoch [15/50], Val Losses: mse: 9.9164, mae: 1.6792, huber: 1.3108, swd: 1.4321, target_std: 4.3000
    Epoch [15/50], Test Losses: mse: 12.9207, mae: 2.1459, huber: 1.7453, swd: 2.4664, target_std: 4.8130
      Epoch 15 composite train-obj: 1.426562
            No improvement (1.3108), counter 3/5
    Epoch [16/50], Train Losses: mse: 8.6922, mae: 1.8145, huber: 1.4241, swd: 2.2897, target_std: 6.4171
    Epoch [16/50], Val Losses: mse: 9.8897, mae: 1.6661, huber: 1.3017, swd: 1.3318, target_std: 4.3000
    Epoch [16/50], Test Losses: mse: 12.8963, mae: 2.1365, huber: 1.7362, swd: 2.3361, target_std: 4.8130
      Epoch 16 composite train-obj: 1.424053
            No improvement (1.3017), counter 4/5
    Epoch [17/50], Train Losses: mse: 8.6847, mae: 1.8129, huber: 1.4226, swd: 2.2726, target_std: 6.4170
    Epoch [17/50], Val Losses: mse: 9.8748, mae: 1.6678, huber: 1.3016, swd: 1.3122, target_std: 4.3000
    Epoch [17/50], Test Losses: mse: 12.9304, mae: 2.1367, huber: 1.7369, swd: 2.2970, target_std: 4.8130
      Epoch 17 composite train-obj: 1.422634
    Epoch [17/50], Test Losses: mse: 13.0597, mae: 2.1503, huber: 1.7521, swd: 2.3894, target_std: 4.8130
    Best round's Test MSE: 13.0597, MAE: 2.1503, SWD: 2.3894
    Best round's Validation MSE: 9.8581, MAE: 1.6540
    Best round's Test verification MSE : 13.0597, MAE: 2.1503, SWD: 2.3894
    
    ==================================================
     Running experiment with seed 20 (3/3)==================================================
    
    Epoch [1/50], Train Losses: mse: 16.7732, mae: 2.3967, huber: 1.9848, swd: 3.9425, target_std: 6.4167
    Epoch [1/50], Val Losses: mse: 10.9808, mae: 1.8114, huber: 1.4366, swd: 1.4379, target_std: 4.3000
    Epoch [1/50], Test Losses: mse: 14.6790, mae: 2.3552, huber: 1.9429, swd: 3.0074, target_std: 4.8130
      Epoch 1 composite train-obj: 1.984772
            Val objective improved inf → 1.4366, saving checkpoint.
    Epoch [2/50], Train Losses: mse: 9.4187, mae: 1.9225, huber: 1.5241, swd: 2.7975, target_std: 6.4171
    Epoch [2/50], Val Losses: mse: 10.5328, mae: 1.7518, huber: 1.3788, swd: 1.5691, target_std: 4.3000
    Epoch [2/50], Test Losses: mse: 13.8949, mae: 2.2720, huber: 1.8629, swd: 3.0336, target_std: 4.8130
      Epoch 2 composite train-obj: 1.524072
            Val objective improved 1.4366 → 1.3788, saving checkpoint.
    Epoch [3/50], Train Losses: mse: 9.1406, mae: 1.8844, huber: 1.4884, swd: 2.7521, target_std: 6.4170
    Epoch [3/50], Val Losses: mse: 10.1769, mae: 1.6897, huber: 1.3209, swd: 1.3122, target_std: 4.3000
    Epoch [3/50], Test Losses: mse: 13.6675, mae: 2.2321, huber: 1.8262, swd: 2.8628, target_std: 4.8130
      Epoch 3 composite train-obj: 1.488430
            Val objective improved 1.3788 → 1.3209, saving checkpoint.
    Epoch [4/50], Train Losses: mse: 9.0144, mae: 1.8655, huber: 1.4709, swd: 2.7194, target_std: 6.4170
    Epoch [4/50], Val Losses: mse: 10.0992, mae: 1.6784, huber: 1.3119, swd: 1.3787, target_std: 4.3000
    Epoch [4/50], Test Losses: mse: 13.4601, mae: 2.2071, huber: 1.8038, swd: 2.8152, target_std: 4.8130
      Epoch 4 composite train-obj: 1.470907
            Val objective improved 1.3209 → 1.3119, saving checkpoint.
    Epoch [5/50], Train Losses: mse: 8.9415, mae: 1.8543, huber: 1.4606, swd: 2.6760, target_std: 6.4165
    Epoch [5/50], Val Losses: mse: 10.1104, mae: 1.6930, huber: 1.3226, swd: 1.4636, target_std: 4.3000
    Epoch [5/50], Test Losses: mse: 13.4159, mae: 2.2032, huber: 1.8004, swd: 2.9197, target_std: 4.8130
      Epoch 5 composite train-obj: 1.460607
            No improvement (1.3226), counter 1/5
    Epoch [6/50], Train Losses: mse: 8.8984, mae: 1.8472, huber: 1.4542, swd: 2.6598, target_std: 6.4168
    Epoch [6/50], Val Losses: mse: 10.0642, mae: 1.6857, huber: 1.3170, swd: 1.4808, target_std: 4.3000
    Epoch [6/50], Test Losses: mse: 13.2735, mae: 2.1887, huber: 1.7867, swd: 2.8617, target_std: 4.8130
      Epoch 6 composite train-obj: 1.454194
            No improvement (1.3170), counter 2/5
    Epoch [7/50], Train Losses: mse: 8.8694, mae: 1.8417, huber: 1.4493, swd: 2.6513, target_std: 6.4167
    Epoch [7/50], Val Losses: mse: 9.9900, mae: 1.6738, huber: 1.3058, swd: 1.3853, target_std: 4.3000
    Epoch [7/50], Test Losses: mse: 13.2312, mae: 2.1790, huber: 1.7765, swd: 2.6794, target_std: 4.8130
      Epoch 7 composite train-obj: 1.449257
            Val objective improved 1.3119 → 1.3058, saving checkpoint.
    Epoch [8/50], Train Losses: mse: 8.8298, mae: 1.8361, huber: 1.4442, swd: 2.6198, target_std: 6.4167
    Epoch [8/50], Val Losses: mse: 9.9319, mae: 1.6615, huber: 1.2953, swd: 1.3698, target_std: 4.3000
    Epoch [8/50], Test Losses: mse: 13.1818, mae: 2.1740, huber: 1.7720, swd: 2.6885, target_std: 4.8130
      Epoch 8 composite train-obj: 1.444154
            Val objective improved 1.3058 → 1.2953, saving checkpoint.
    Epoch [9/50], Train Losses: mse: 8.8288, mae: 1.8345, huber: 1.4427, swd: 2.6184, target_std: 6.4168
    Epoch [9/50], Val Losses: mse: 9.9376, mae: 1.6584, huber: 1.2941, swd: 1.4422, target_std: 4.3000
    Epoch [9/50], Test Losses: mse: 13.1062, mae: 2.1666, huber: 1.7655, swd: 2.7212, target_std: 4.8130
      Epoch 9 composite train-obj: 1.442711
            Val objective improved 1.2953 → 1.2941, saving checkpoint.
    Epoch [10/50], Train Losses: mse: 8.7778, mae: 1.8281, huber: 1.4368, swd: 2.5842, target_std: 6.4170
    Epoch [10/50], Val Losses: mse: 9.9919, mae: 1.6759, huber: 1.3088, swd: 1.4733, target_std: 4.3000
    Epoch [10/50], Test Losses: mse: 13.0601, mae: 2.1605, huber: 1.7596, swd: 2.6889, target_std: 4.8130
      Epoch 10 composite train-obj: 1.436768
            No improvement (1.3088), counter 1/5
    Epoch [11/50], Train Losses: mse: 8.7696, mae: 1.8262, huber: 1.4350, swd: 2.5761, target_std: 6.4166
    Epoch [11/50], Val Losses: mse: 9.7710, mae: 1.6527, huber: 1.2870, swd: 1.3773, target_std: 4.3000
    Epoch [11/50], Test Losses: mse: 13.1117, mae: 2.1579, huber: 1.7578, swd: 2.6320, target_std: 4.8130
      Epoch 11 composite train-obj: 1.435027
            Val objective improved 1.2941 → 1.2870, saving checkpoint.
    Epoch [12/50], Train Losses: mse: 8.7591, mae: 1.8243, huber: 1.4333, swd: 2.5713, target_std: 6.4171
    Epoch [12/50], Val Losses: mse: 9.8758, mae: 1.6588, huber: 1.2944, swd: 1.4467, target_std: 4.3000
    Epoch [12/50], Test Losses: mse: 12.9906, mae: 2.1514, huber: 1.7512, swd: 2.6194, target_std: 4.8130
      Epoch 12 composite train-obj: 1.433339
            No improvement (1.2944), counter 1/5
    Epoch [13/50], Train Losses: mse: 8.7360, mae: 1.8215, huber: 1.4306, swd: 2.5447, target_std: 6.4166
    Epoch [13/50], Val Losses: mse: 9.8858, mae: 1.6623, huber: 1.2972, swd: 1.4446, target_std: 4.3000
    Epoch [13/50], Test Losses: mse: 13.0081, mae: 2.1496, huber: 1.7518, swd: 2.6425, target_std: 4.8130
      Epoch 13 composite train-obj: 1.430580
            No improvement (1.2972), counter 2/5
    Epoch [14/50], Train Losses: mse: 8.7345, mae: 1.8204, huber: 1.4296, swd: 2.5433, target_std: 6.4166
    Epoch [14/50], Val Losses: mse: 9.8889, mae: 1.6892, huber: 1.3188, swd: 1.5958, target_std: 4.3000
    Epoch [14/50], Test Losses: mse: 12.9583, mae: 2.1498, huber: 1.7502, swd: 2.7211, target_std: 4.8130
      Epoch 14 composite train-obj: 1.429641
            No improvement (1.3188), counter 3/5
    Epoch [15/50], Train Losses: mse: 8.7128, mae: 1.8172, huber: 1.4266, swd: 2.5273, target_std: 6.4167
    Epoch [15/50], Val Losses: mse: 9.9354, mae: 1.6811, huber: 1.3137, swd: 1.5653, target_std: 4.3000
    Epoch [15/50], Test Losses: mse: 12.8755, mae: 2.1397, huber: 1.7390, swd: 2.5521, target_std: 4.8130
      Epoch 15 composite train-obj: 1.426636
            No improvement (1.3137), counter 4/5
    Epoch [16/50], Train Losses: mse: 8.7012, mae: 1.8156, huber: 1.4251, swd: 2.5174, target_std: 6.4167
    Epoch [16/50], Val Losses: mse: 9.9683, mae: 1.6777, huber: 1.3124, swd: 1.5669, target_std: 4.3000
    Epoch [16/50], Test Losses: mse: 12.8736, mae: 2.1387, huber: 1.7386, swd: 2.5331, target_std: 4.8130
      Epoch 16 composite train-obj: 1.425073
    Epoch [16/50], Test Losses: mse: 13.1117, mae: 2.1579, huber: 1.7578, swd: 2.6320, target_std: 4.8130
    Best round's Test MSE: 13.1117, MAE: 2.1579, SWD: 2.6320
    Best round's Validation MSE: 9.7710, MAE: 1.6527
    Best round's Test verification MSE : 13.1117, MAE: 2.1579, SWD: 2.6320
    
    ==================================================
    Experiment Summary (DLinear_etth1_seq96_pred720_20250501_0308)
    ==================================================
    Number of runs: 3
    Seeds: [1955, 7, 20]
    
    Test Performance at Best Validation (mean ± std):
      mse: 13.1382 ± 0.0773
      mae: 2.1621 ± 0.0117
      huber: 1.7618 ± 0.0099
      swd: 2.5293 ± 0.1025
      target_std: 4.8130 ± 0.0000
      count: 8.0000 ± 0.0000
    
    Corresponding Validation Performance (mean ± std):
      mse: 9.8626 ± 0.0767
      mae: 1.6545 ± 0.0016
      huber: 1.2893 ± 0.0017
      swd: 1.3016 ± 0.0579
      target_std: 4.3000 ± 0.0000
      count: 8.0000 ± 0.0000
    ==================================================
    
    Experiment complete: DLinear_etth1_seq96_pred720_20250501_0308
    Model: DLinear
    Dataset: etth1
    Sequence Length: 96
    Prediction Length: 720
    Seeds: [1955, 7, 20]
    






